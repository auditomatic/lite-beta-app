var Ht=Object.defineProperty;var Wt=(a,e,t)=>e in a?Ht(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var ce=(a,e,t)=>Wt(a,typeof e!="symbol"?e+"":e,t);import{b as E,I as _e,i as ie,r as K,c as D,n as fe,o as me,w as re,j as c,aa as te,k as s,y as O,aL as Te,af as ve,m as i,_ as oe,ae as ye,aM as Bt,aN as jt,aO as Gt,q as Y,aP as qt,aQ as Kt,v as ee,ac as kt,ab as $e,t as L,F as X,A as se,aH as lt,aR as Qt,aS as Jt,aT as it,D as z,au as St,ag as We,al as Xt,z as C,aU as Yt,x as H,P as Zt,aV as es,ax as ot,aW as Be,aD as ts,J as ss,K as wt,G as as,L as ns,N as rt,aw as ls,u as Xe,B as le,a as v,s as Ae,d as je,aX as Se,aY as we,aZ as ze,W as It,aK as Rt,a_ as is,ah as Et,a4 as os,aq as rs,X as Vt,M as Ye,aJ as Ge,E as us,ai as At,H as ds}from"./index-VqxE_YFg.js";import{F as cs}from"./FilterOutlined-nMX--4l-.js";import{I as ps,S as fs}from"./StopOutlined-CX6R74Y0.js";import{F as vs,C as ms,b as Ot,u as gs,a as hs,c as bs}from"./useV4TrialCommands-QZNuC9GQ.js";import{u as ys}from"./useHeatmapStylingV3-B9GYjv5W.js";var _s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M840 836H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm0-724H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM610.8 378c6 0 9.4-7 5.7-11.7L515.7 238.7a7.14 7.14 0 00-11.3 0L403.6 366.3a7.23 7.23 0 005.7 11.7H476v268h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V378h62.8z"}}]},name:"column-height",theme:"outlined"};function ut(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Ts(a,o,t[o])})}return a}function Ts(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var Ze=function(e,t){var l=ut({},e,t.attrs);return E(_e,ut({},l,{icon:_s}),null)};Ze.displayName="ColumnHeightOutlined";Ze.inheritAttrs=!1;var $s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"}}]},name:"dollar",theme:"outlined"};function dt(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Cs(a,o,t[o])})}return a}function Cs(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var et=function(e,t){var l=dt({},e,t.attrs);return E(_e,dt({},l,{icon:$s}),null)};et.displayName="DollarOutlined";et.inheritAttrs=!1;var ks={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"}},{tag:"path",attrs:{d:"M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"}}]},name:"field-time",theme:"outlined"};function ct(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Ss(a,o,t[o])})}return a}function Ss(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var tt=function(e,t){var l=ct({},e,t.attrs);return E(_e,ct({},l,{icon:ks}),null)};tt.displayName="FieldTimeOutlined";tt.inheritAttrs=!1;var ws={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};function pt(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Is(a,o,t[o])})}return a}function Is(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var st=function(e,t){var l=pt({},e,t.attrs);return E(_e,pt({},l,{icon:ws}),null)};st.displayName="PauseCircleOutlined";st.inheritAttrs=!1;var Rs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function ft(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Es(a,o,t[o])})}return a}function Es(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var at=function(e,t){var l=ft({},e,t.attrs);return E(_e,ft({},l,{icon:Rs}),null)};at.displayName="SyncOutlined";at.inheritAttrs=!1;var Vs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M848 359.3H627.7L825.8 109c4.1-5.3.4-13-6.3-13H436c-2.8 0-5.5 1.5-6.9 4L170 547.5c-3.1 5.3.7 12 6.9 12h174.4l-89.4 357.6c-1.9 7.8 7.5 13.3 13.3 7.7L853.5 373c5.2-4.9 1.7-13.7-5.5-13.7zM378.2 732.5l60.3-241H281.1l189.6-327.4h224.6L487 427.4h211L378.2 732.5z"}}]},name:"thunderbolt",theme:"outlined"};function vt(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){As(a,o,t[o])})}return a}function As(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var nt=function(e,t){var l=vt({},e,t.attrs);return E(_e,vt({},l,{icon:Vs}),null)};nt.displayName="ThunderboltOutlined";nt.inheritAttrs=!1;var Os={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"};function mt(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Fs(a,o,t[o])})}return a}function Fs(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var Me=function(e,t){var l=mt({},e,t.attrs);return E(_e,mt({},l,{icon:Os}),null)};Me.displayName="WarningOutlined";Me.inheritAttrs=!1;const Ps={class:"right-panel"},Ls=ie({__name:"ResizablePanelContainer",props:{storageKey:{default:"trial-list-width"},defaultWidth:{default:250},minWidth:{default:200},maxWidth:{default:600},mobileBreakpoint:{default:768}},emits:["resize","mobile-overlay-change"],setup(a,{expose:e,emit:t}){const l=a,o=t,u=K(l.defaultWidth),d=K(!1),b=K(0),r=K(0),f=K(window.innerWidth),h=K(!1),g=D(()=>f.value<l.mobileBreakpoint),$=D(()=>g.value?{width:`${Math.min(f.value*.85,400)}px`}:{width:`${u.value}px`});function y(){const A=localStorage.getItem(l.storageKey);if(A){const p=parseInt(A,10);!isNaN(p)&&p>=l.minWidth&&p<=l.maxWidth&&(u.value=p)}}function k(A){localStorage.setItem(l.storageKey,A.toString()),o("resize",A)}function _(A){d.value=!0,b.value=A.clientX,r.value=u.value,document.addEventListener("mousemove",w),document.addEventListener("mouseup",W),document.body.style.userSelect="none",document.body.style.cursor="col-resize"}function w(A){if(!d.value)return;const p=A.clientX-b.value,I=Math.max(l.minWidth,Math.min(l.maxWidth,r.value+p));u.value=I}function W(){d.value&&(d.value=!1,k(u.value),document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",W),document.body.style.userSelect="",document.body.style.cursor="")}function P(){u.value=l.defaultWidth,k(l.defaultWidth)}function m(){f.value=window.innerWidth,!g.value&&h.value&&(h.value=!1,o("mobile-overlay-change",!1))}function V(){g.value&&(h.value=!h.value,o("mobile-overlay-change",h.value))}function x(){h.value=!1,o("mobile-overlay-change",!1)}return e({toggleMobileOverlay:V,closeMobileOverlay:x}),fe(()=>{y(),window.addEventListener("resize",m)}),me(()=>{window.removeEventListener("resize",m),W()}),re(()=>l.defaultWidth,A=>{u.value===l.defaultWidth&&(u.value=A)}),(A,p)=>(i(),c("div",{class:te(["resizable-panel-container",{"mobile-overlay":g.value}])},[s("div",{class:te(["left-panel",{"overlay-visible":g.value&&h.value}]),style:ve($.value)},[Te(A.$slots,"left",{},void 0,!0)],6),g.value?O("",!0):(i(),c("div",{key:0,class:te(["resize-handle",{dragging:d.value}]),onMousedown:_,onDblclick:P},p[0]||(p[0]=[s("div",{class:"handle-bar"},null,-1)]),34)),s("div",Ps,[Te(A.$slots,"right",{},void 0,!0)]),g.value&&h.value?(i(),c("div",{key:1,class:"mobile-overlay-bg",onClick:x})):O("",!0)],2))}}),Ms=oe(Ls,[["__scopeId","data-v-949e1df1"]]);function Ds(){var a=window.navigator.userAgent,e=a.indexOf("MSIE ");if(e>0)return parseInt(a.substring(e+5,a.indexOf(".",e)),10);var t=a.indexOf("Trident/");if(t>0){var l=a.indexOf("rv:");return parseInt(a.substring(l+3,a.indexOf(".",l)),10)}var o=a.indexOf("Edge/");return o>0?parseInt(a.substring(o+5,a.indexOf(".",o)),10):-1}let Oe;function qe(){qe.init||(qe.init=!0,Oe=Ds()!==-1)}var De={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){qe(),ye(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const a=document.createElement("object");this._resizeObject=a,a.setAttribute("aria-hidden","true"),a.setAttribute("tabindex",-1),a.onload=this.addResizeHandlers,a.type="text/html",Oe&&this.$el.appendChild(a),a.data="about:blank",Oe||this.$el.appendChild(a)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Oe&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const xs=Gt();Bt("data-v-b329ee4c");const Us={class:"resize-observer",tabindex:"-1"};jt();const Ns=xs((a,e,t,l,o,u)=>(i(),Y("div",Us)));De.render=Ns;De.__scopeId="data-v-b329ee4c";De.__file="src/components/ResizeObserver.vue";function Fe(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Fe=function(e){return typeof e}:Fe=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(a)}function zs(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function Hs(a,e){for(var t=0;t<e.length;t++){var l=e[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(a,l.key,l)}}function Ws(a,e,t){return e&&Hs(a.prototype,e),a}function gt(a){return Bs(a)||js(a)||Gs(a)||qs()}function Bs(a){if(Array.isArray(a))return Ke(a)}function js(a){if(typeof Symbol<"u"&&Symbol.iterator in Object(a))return Array.from(a)}function Gs(a,e){if(a){if(typeof a=="string")return Ke(a,e);var t=Object.prototype.toString.call(a).slice(8,-1);if(t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set")return Array.from(a);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ke(a,e)}}function Ke(a,e){(e==null||e>a.length)&&(e=a.length);for(var t=0,l=new Array(e);t<e;t++)l[t]=a[t];return l}function qs(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ks(a){var e;return typeof a=="function"?e={callback:a}:e=a,e}function Qs(a,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l,o,u,d=function(r){for(var f=arguments.length,h=new Array(f>1?f-1:0),g=1;g<f;g++)h[g-1]=arguments[g];if(u=h,!(l&&r===o)){var $=t.leading;typeof $=="function"&&($=$(r,o)),(!l||r!==o)&&$&&a.apply(void 0,[r].concat(gt(u))),o=r,clearTimeout(l),l=setTimeout(function(){a.apply(void 0,[r].concat(gt(u))),l=0},e)}};return d._clear=function(){clearTimeout(l),l=null},d}function Ft(a,e){if(a===e)return!0;if(Fe(a)==="object"){for(var t in a)if(!Ft(a[t],e[t]))return!1;return!0}return!1}var Js=function(){function a(e,t,l){zs(this,a),this.el=e,this.observer=null,this.frozen=!1,this.createObserver(t,l)}return Ws(a,[{key:"createObserver",value:function(t,l){var o=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Ks(t),this.callback=function(b,r){o.options.callback(b,r),b&&o.options.once&&(o.frozen=!0,o.destroyObserver())},this.callback&&this.options.throttle){var u=this.options.throttleOptions||{},d=u.leading;this.callback=Qs(this.callback,this.options.throttle,{leading:function(r){return d==="both"||d==="visible"&&r||d==="hidden"&&!r}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(b){var r=b[0];if(b.length>1){var f=b.find(function(g){return g.isIntersecting});f&&(r=f)}if(o.callback){var h=r.isIntersecting&&r.intersectionRatio>=o.threshold;if(h===o.oldResult)return;o.oldResult=h,o.callback(h,r)}},this.options.intersection),ye(function(){o.observer&&o.observer.observe(o.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),a}();function Pt(a,e,t){var l=e.value;if(l)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var o=new Js(a,l,t);a._vue_visibilityState=o}}function Xs(a,e,t){var l=e.value,o=e.oldValue;if(!Ft(l,o)){var u=a._vue_visibilityState;if(!l){Lt(a);return}u?u.createObserver(l,t):Pt(a,{value:l},t)}}function Lt(a){var e=a._vue_visibilityState;e&&(e.destroyObserver(),delete a._vue_visibilityState)}var Ys={beforeMount:Pt,updated:Xs,unmounted:Lt},Zs={itemsLimit:1e3},ea=/(auto|scroll)/;function Mt(a,e){return a.parentNode===null?e:Mt(a.parentNode,e.concat([a]))}var He=function(e,t){return getComputedStyle(e,null).getPropertyValue(t)},ta=function(e){return He(e,"overflow")+He(e,"overflow-y")+He(e,"overflow-x")},sa=function(e){return ea.test(ta(e))};function ht(a){if(a instanceof HTMLElement||a instanceof SVGElement){for(var e=Mt(a.parentNode,[]),t=0;t<e.length;t+=1)if(sa(e[t]))return e[t];return document.scrollingElement||document.documentElement}}function Qe(a){"@babel/helpers - typeof";return Qe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe(a)}var aa={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(e){return["vertical","horizontal"].includes(e)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function na(){return this.items.length&&Qe(this.items[0])!=="object"}var Je=!1;if(typeof window<"u"){Je=!1;try{var la=Object.defineProperty({},"passive",{get:function(){Je=!0}});window.addEventListener("test",null,la)}catch{}}let ia=0;var xe={name:"RecycleScroller",components:{ResizeObserver:De},directives:{ObserveVisibility:Ys},props:{...aa,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const a={"-1":{accumulator:0}},e=this.items,t=this.sizeField,l=this.minItemSize;let o=1e4,u=0,d;for(let b=0,r=e.length;b<r;b++)d=e[b][t]||l,d<o&&(o=d),u+=d,a[b]={accumulator:u,size:d};return this.$_computedMinItemSize=o,a}return[]},simpleArray:na,itemIndexByKey(){const{keyField:a,items:e}=this,t={};for(let l=0,o=e.length;l<o;l++)t[e[l][a]]=l;return t}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const a=this.$_lastUpdateScrollPosition;typeof a=="number"&&this.$nextTick(()=>{this.scrollToPosition(a)})},beforeUnmount(){this.removeListeners()},methods:{addView(a,e,t,l,o){const u=qt({id:ia++,index:e,used:!0,key:l,type:o}),d=Kt({item:t,position:0,nr:u});return a.push(d),d},unuseView(a,e=!1){const t=this.$_unusedViews,l=a.nr.type;let o=t.get(l);o||(o=[],t.set(l,o)),o.push(a),e||(a.nr.used=!1,a.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(a){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const e=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:t}=this.updateVisibleItems(!1,!0);t||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});e(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&e()},this.updateInterval))}},handleVisibilityChange(a,e){this.ready&&(a||e.boundingClientRect.width!==0||e.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(a,e=!1){const t=this.itemSize,l=this.gridItems||1,o=this.itemSecondarySize||t,u=this.$_computedMinItemSize,d=this.typeField,b=this.simpleArray?null:this.keyField,r=this.items,f=r.length,h=this.sizes,g=this.$_views,$=this.$_unusedViews,y=this.pool,k=this.itemIndexByKey;let _,w,W,P,m;if(!f)_=w=P=m=W=0;else if(this.$_prerender)_=P=0,w=m=Math.min(this.prerender,r.length),W=null;else{const n=this.getScroll();if(e){let T=n.start-this.$_lastUpdateScrollPosition;if(T<0&&(T=-T),t===null&&T<u||T<t)return{continuous:!0}}this.$_lastUpdateScrollPosition=n.start;const R=this.buffer;n.start-=R,n.end+=R;let N=0;if(this.$refs.before&&(N=this.$refs.before.scrollHeight,n.start-=N),this.$refs.after){const T=this.$refs.after.scrollHeight;n.end+=T}if(t===null){let T,B=0,ae=f-1,S=~~(f/2),Z;do Z=S,T=h[S].accumulator,T<n.start?B=S:S<f-1&&h[S+1].accumulator>n.start&&(ae=S),S=~~((B+ae)/2);while(S!==Z);for(S<0&&(S=0),_=S,W=h[f-1].accumulator,w=S;w<f&&h[w].accumulator<n.end;w++);for(w===-1?w=r.length-1:(w++,w>f&&(w=f)),P=_;P<f&&N+h[P].accumulator<n.start;P++);for(m=P;m<f&&N+h[m].accumulator<n.end;m++);}else{_=~~(n.start/t*l);const T=_%l;_-=T,w=Math.ceil(n.end/t*l),P=Math.max(0,Math.floor((n.start-N)/t*l)),m=Math.floor((n.end-N)/t*l),_<0&&(_=0),w>f&&(w=f),P<0&&(P=0),m>f&&(m=f),W=Math.ceil(f/l)*t}}w-_>Zs.itemsLimit&&this.itemsLimitError(),this.totalSize=W;let V;const x=_<=this.$_endIndex&&w>=this.$_startIndex;if(x)for(let n=0,R=y.length;n<R;n++)V=y[n],V.nr.used&&(a&&(V.nr.index=k[V.item[b]]),(V.nr.index==null||V.nr.index<_||V.nr.index>=w)&&this.unuseView(V));const A=x?null:new Map;let p,I,U;for(let n=_;n<w;n++){p=r[n];const R=b?p[b]:p;if(R==null)throw new Error(`Key is ${R} on item (keyField is '${b}')`);if(V=g.get(R),!t&&!h[n].size){V&&this.unuseView(V);continue}I=p[d];let N=$.get(I),T=!1;if(!V)x?N&&N.length?V=N.pop():V=this.addView(y,n,p,R,I):(U=A.get(I)||0,(!N||U>=N.length)&&(V=this.addView(y,n,p,R,I),this.unuseView(V,!0),N=$.get(I)),V=N[U],A.set(I,U+1)),g.delete(V.nr.key),V.nr.used=!0,V.nr.index=n,V.nr.key=R,V.nr.type=I,g.set(R,V),T=!0;else if(!V.nr.used&&(V.nr.used=!0,T=!0,N)){const B=N.indexOf(V);B!==-1&&N.splice(B,1)}V.item=p,T&&(n===r.length-1&&this.$emit("scroll-end"),n===0&&this.$emit("scroll-start")),t===null?(V.position=h[n-1].accumulator,V.offset=0):(V.position=Math.floor(n/l)*t,V.offset=n%l*o)}return this.$_startIndex=_,this.$_endIndex=w,this.emitUpdate&&this.$emit("update",_,w,P,m),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:x}},getListenerTarget(){let a=ht(this.$el);return window.document&&(a===window.document.documentElement||a===window.document.body)&&(a=window),a},getScroll(){const{$el:a,direction:e}=this,t=e==="vertical";let l;if(this.pageMode){const o=a.getBoundingClientRect(),u=t?o.height:o.width;let d=-(t?o.top:o.left),b=t?window.innerHeight:window.innerWidth;d<0&&(b+=d,d=0),d+b>u&&(b=u-d),l={start:d,end:d+b}}else t?l={start:a.scrollTop,end:a.scrollTop+a.clientHeight}:l={start:a.scrollLeft,end:a.scrollLeft+a.clientWidth};return l},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Je?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(a){let e;const t=this.gridItems||1;this.itemSize===null?e=a>0?this.sizes[a-1].accumulator:0:e=Math.floor(a/t)*this.itemSize,this.scrollToPosition(e)},scrollToPosition(a){const e=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let t,l,o;if(this.pageMode){const u=ht(this.$el),d=u.tagName==="HTML"?0:u[e.scroll],b=u.getBoundingClientRect(),f=this.$el.getBoundingClientRect()[e.start]-b[e.start];t=u,l=e.scroll,o=a+d+f}else t=this.$el,l=e.scroll,o=a;t[l]=o},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((a,e)=>a.nr.index-e.nr.index)}}};const oa={key:0,ref:"before",class:"vue-recycle-scroller__slot"},ra={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function ua(a,e,t,l,o,u){const d=ee("ResizeObserver"),b=kt("observe-visibility");return $e((i(),c("div",{class:te(["vue-recycle-scroller",{ready:o.ready,"page-mode":t.pageMode,[`direction-${a.direction}`]:!0}]),onScrollPassive:e[0]||(e[0]=(...r)=>u.handleScroll&&u.handleScroll(...r))},[a.$slots.before?(i(),c("div",oa,[Te(a.$slots,"before")],512)):O("v-if",!0),(i(),Y(lt(t.listTag),{ref:"wrapper",style:ve({[a.direction==="vertical"?"minHeight":"minWidth"]:o.totalSize+"px"}),class:te(["vue-recycle-scroller__item-wrapper",t.listClass])},{default:L(()=>[(i(!0),c(X,null,se(o.pool,r=>(i(),Y(lt(t.itemTag),Qt({key:r.nr.id,style:o.ready?{transform:`translate${a.direction==="vertical"?"Y":"X"}(${r.position}px) translate${a.direction==="vertical"?"X":"Y"}(${r.offset}px)`,width:t.gridItems?`${a.direction==="vertical"&&t.itemSecondarySize||t.itemSize}px`:void 0,height:t.gridItems?`${a.direction==="horizontal"&&t.itemSecondarySize||t.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[t.itemClass,{hover:!t.skipHover&&o.hoverKey===r.nr.key}]]},Jt(t.skipHover?{}:{mouseenter:()=>{o.hoverKey=r.nr.key},mouseleave:()=>{o.hoverKey=null}})),{default:L(()=>[Te(a.$slots,"default",{item:r.item,index:r.nr.index,active:r.nr.used})]),_:2},1040,["style","class"]))),128)),Te(a.$slots,"empty")]),_:3},8,["style","class"])),a.$slots.after?(i(),c("div",ra,[Te(a.$slots,"after")],512)):O("v-if",!0),E(d,{onNotify:u.handleResize},null,8,["onNotify"])],34)),[[b,u.handleVisibilityChange]])}xe.render=ua;xe.__file="src/components/RecycleScroller.vue";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const bt=()=>{};function da(a,e){function t(...l){return new Promise((o,u)=>{Promise.resolve(a(()=>e.apply(this,l),{fn:e,thisArg:this,args:l})).then(o).catch(u)})}return t}function ca(a,e={}){let t,l,o=bt;const u=r=>{clearTimeout(r),o(),o=bt};let d;return r=>{const f=it(a),h=it(e.maxWait);return t&&u(t),f<=0||h!==void 0&&h<=0?(l&&(u(l),l=void 0),Promise.resolve(r())):new Promise((g,$)=>{o=e.rejectOnCancel?$:g,d=r,h&&!l&&(l=setTimeout(()=>{t&&u(t),l=void 0,g(d())},h)),t=setTimeout(()=>{l&&u(l),l=void 0,g(r())},f)})}}function Dt(a,e=200,t={}){return da(ca(e,t),a)}const pa={class:"trial-list-search"},fa=["value"],va=ie({__name:"TrialListSearch",props:{modelValue:{}},emits:["update:modelValue"],setup(a,{emit:e}){const t=e,l=K(),o=Dt(f=>{t("update:modelValue",f)},300);function u(f){const h=f.target.value;o(h)}function d(){var f;t("update:modelValue",""),(f=l.value)==null||f.focus()}function b(){var f,h;(f=l.value)==null||f.focus(),(h=l.value)==null||h.select()}function r(f){f.type==="focus-trial-search"&&b()}return fe(()=>{window.addEventListener("focus-trial-search",r)}),me(()=>{window.removeEventListener("focus-trial-search",r)}),(f,h)=>(i(),c("div",pa,[E(z(St),{class:"search-icon"}),s("input",{ref_key:"searchInput",ref:l,type:"text",class:"search-input",placeholder:"Filter trials...",value:f.modelValue,onInput:u,onKeydown:We(d,["escape"])},null,40,fa),f.modelValue?(i(),Y(z(Xt),{key:0,class:"clear-icon",onClick:d})):O("",!0)]))}}),ma=oe(va,[["__scopeId","data-v-3a032c2b"]]),ga={class:"item-content"},ha={class:"item-header"},ba=["title"],ya={key:0,class:"progress-bar"},_a={class:"item-metadata"},Ta={class:"meta-item"},$a={class:"meta-item"},Ca={key:0,class:"meta-separator"},ka={key:1,class:"meta-item cost"},Sa=ie({__name:"TrialListItem",props:{trial:{},selected:{type:Boolean}},emits:["click"],setup(a){const e=a,t=D(()=>{if(e.trial.progress.total===0)return 0;const d=e.trial.progress.completed+e.trial.progress.failed;return Math.round(d/e.trial.progress.total*100)}),l=D(()=>{const{completed:d,failed:b,total:r}=e.trial.progress;return e.trial.status==="draft"?`${r} tasks`:`${d+b}/${r} tasks`}),o=D(()=>{const d=e.trial.started||e.trial.created;if(!d)return"";const r=new Date().getTime()-d.getTime(),f=Math.floor(r/1e3),h=Math.floor(f/60),g=Math.floor(h/60),$=Math.floor(g/24);return f<60?"now":h<60?`${h}m`:g<24?`${g}h`:`${$}d`}),u=D(()=>{if(!e.trial.configurations||e.trial.configurations.length===0)return null;let d=0;return e.trial.configurations.forEach(b=>{var f,h;const r=b.modelSnapshot;if((f=r==null?void 0:r.capabilities)!=null&&f.inputCostPerToken&&((h=r==null?void 0:r.capabilities)!=null&&h.outputCostPerToken)){const g=500*r.capabilities.inputCostPerToken+500*r.capabilities.outputCostPerToken;d+=g*(e.trial.progress.total/e.trial.configurations.length)}}),d===0?null:d<.01?"<$0.01":d<1?`$${d.toFixed(2)}`:`$${d.toFixed(0)}`});return(d,b)=>(i(),c("div",{class:te(["trial-list-item",{selected:d.selected,"has-progress":d.trial.status==="running"}]),onClick:b[0]||(b[0]=r=>d.$emit("click"))},[s("div",{class:te(["status-indicator",`status-${d.trial.status}`])},null,2),s("div",ga,[s("div",ha,[s("span",{class:"trial-name",title:d.trial.name},C(d.trial.name),9,ba),s("span",{class:te(["status-tag",`status-${d.trial.status}`])},C(d.trial.status.toUpperCase()),3)]),d.trial.status==="running"?(i(),c("div",ya,[s("div",{class:"progress-fill",style:ve({width:`${t.value}%`})},null,4)])):O("",!0),s("div",_a,[s("span",Ta,C(l.value),1),b[1]||(b[1]=s("span",{class:"meta-separator"},"â€¢",-1)),s("span",$a,C(o.value),1),u.value?(i(),c("span",Ca,"â€¢")):O("",!0),u.value?(i(),c("span",ka,C(u.value),1)):O("",!0)])])],2))}}),yt=oe(Sa,[["__scopeId","data-v-f0ccace4"]]),wa={class:"section-title"},Ia=ie({__name:"TrialListSection",props:{title:{},background:{type:Boolean}},setup(a){return(e,t)=>(i(),c("div",{class:te(["trial-list-section",{"with-background":e.background}])},[s("span",wa,C(e.title),1)],2))}}),_t=oe(Ia,[["__scopeId","data-v-07a26c58"]]),Ra={class:"panel-header"},Ea={class:"header-title"},Va={key:0,class:"title-text"},Aa={class:"trial-count"},Oa={key:0,class:"header-actions"},Fa={class:"filter-count"},Pa={class:"filter-count"},La={class:"filter-count"},Ma={class:"filter-count"},Da={class:"filter-count"},xa={key:1,class:"status-tabs"},Ua={class:"tab-count"},Na={class:"tab-count"},za={class:"tab-count"},Ha={class:"trial-list-container"},Wa={key:1,class:"trial-list"},Ba={key:2,class:"collapsed-list"},ja=["onClick"],Ga={class:"collapsed-count"},qa={key:3,class:"empty-state"},Ka=ie({__name:"TrialListPanelV3",props:{trials:{},selectedTrialId:{},searchQuery:{},filterStatus:{}},emits:["select-trial","create-trial","update-search","update-filter","refresh"],setup(a,{emit:e}){const t=a,l=e,o=K(!1),u=K("all"),d=K(250),b=D(()=>d.value<50),r=D(()=>t.trials.filter(A=>A.status==="running"||A.status==="paused").length),f=D(()=>t.trials.filter(A=>A.status==="completed"||A.status==="failed").length),h=D(()=>{let A=t.trials;if(t.searchQuery){const n=t.searchQuery.toLowerCase();A=A.filter(R=>{var ae,S;const N=R.name.toLowerCase().includes(n),T=(S=(ae=R.templateConfig)==null?void 0:ae.template)==null?void 0:S.toLowerCase().includes(n),B=R.configurations.some(Z=>Z.modelId.toLowerCase().includes(n)||Z.provider.toLowerCase().includes(n));return N||T||B})}t.filterStatus!=="all"&&(A=A.filter(n=>n.status===t.filterStatus)),u.value==="active"?A=A.filter(n=>n.status==="running"||n.status==="paused"):u.value==="done"&&(A=A.filter(n=>n.status==="completed"||n.status==="failed"));const p=A.filter(n=>n.status==="running"),I=A.filter(n=>n.status!=="running"),U=[];return p.length>0&&(U.push({type:"section",title:"RUNNING",background:!0,id:"section-running"}),U.push(...p.sort((n,R)=>{var N,T;return(((N=R.started)==null?void 0:N.getTime())||0)-(((T=n.started)==null?void 0:T.getTime())||0)}))),I.length>0&&(p.length>0&&U.push({type:"section",title:"RECENT",background:!1,id:"section-recent"}),U.push(...I.sort((n,R)=>{var N,T;return(((N=R.created)==null?void 0:N.getTime())||0)-(((T=n.created)==null?void 0:T.getTime())||0)}))),U}),g=D(()=>h.value.map(A=>({...A,height:W(A)}))),$=D(()=>t.trials.filter(A=>u.value==="active"?A.status==="running"||A.status==="paused":u.value==="done"?A.status==="completed"||A.status==="failed":!0)),y=D(()=>t.searchQuery?"No trials found":t.filterStatus==="running"?"No trials are currently running":"No trials found"),k=D(()=>t.searchQuery?"No trials match your search":t.filterStatus!=="all"?`No ${t.filterStatus} trials`:"Create your first trial to get started"),_=D(()=>t.filterStatus==="all"&&!t.searchQuery);function w(A){return t.trials.filter(p=>p.status===A).length}function W(A){var U;if(A.type==="section")return 32;const p=A.status==="running",I=(U=A.configurations)==null?void 0:U.some(n=>n.repeatCount>1);return p||I?96:80}function P(A){const p=A.progress.completed+A.progress.failed;return A.status==="running"?`${Math.round(p/A.progress.total*100)}%`:p.toString()}async function m(){o.value=!0;try{await new Promise(A=>setTimeout(A,500)),l("refresh")}finally{o.value=!1}}function V({key:A}){l("update-filter",A)}function x(){const A=document.querySelector(".trial-list-panel");A&&(d.value=A.clientWidth)}return fe(()=>{x(),window.addEventListener("resize",x);const A=document.querySelector(".trial-list-panel");A&&new ResizeObserver(()=>x()).observe(A)}),me(()=>{window.removeEventListener("resize",x)}),(A,p)=>{const I=ee("a-button"),U=ee("a-menu-item"),n=ee("a-menu-divider"),R=ee("a-menu"),N=ee("a-dropdown");return i(),c("div",{class:te(["trial-list-panel",{collapsed:b.value}])},[s("div",Ra,[s("div",Ea,[E(z(Yt),{class:"title-icon"}),b.value?O("",!0):(i(),c("span",Va,"Trials")),s("span",Aa,C(A.trials.length),1)]),b.value?O("",!0):(i(),c("div",Oa,[E(I,{type:"primary",size:"small",onClick:p[0]||(p[0]=T=>A.$emit("create-trial"))},{default:L(()=>[E(z(Zt)),p[6]||(p[6]=H(" New Trial "))]),_:1,__:[6]}),E(I,{size:"small",onClick:m,loading:o.value},{default:L(()=>[E(z(at),{spin:o.value},null,8,["spin"])]),_:1},8,["loading"]),E(N,null,{overlay:L(()=>[E(R,{onClick:V},{default:L(()=>[E(U,{key:"all"},{default:L(()=>p[7]||(p[7]=[s("span",null,"All Trials",-1)])),_:1,__:[7]}),E(n),E(U,{key:"running"},{default:L(()=>[p[8]||(p[8]=s("span",null,"Running Only",-1)),s("span",Fa,C(w("running")),1)]),_:1,__:[8]}),E(U,{key:"completed"},{default:L(()=>[p[9]||(p[9]=s("span",null,"Completed Only",-1)),s("span",Pa,C(w("completed")),1)]),_:1,__:[9]}),E(U,{key:"failed"},{default:L(()=>[p[10]||(p[10]=s("span",null,"Failed Only",-1)),s("span",La,C(w("failed")),1)]),_:1,__:[10]}),E(U,{key:"paused"},{default:L(()=>[p[11]||(p[11]=s("span",null,"Paused Only",-1)),s("span",Ma,C(w("paused")),1)]),_:1,__:[11]}),E(U,{key:"draft"},{default:L(()=>[p[12]||(p[12]=s("span",null,"Draft Only",-1)),s("span",Da,C(w("draft")),1)]),_:1,__:[12]})]),_:1})]),default:L(()=>[E(I,{size:"small"},{default:L(()=>[E(z(cs))]),_:1})]),_:1})]))]),b.value?O("",!0):(i(),Y(ma,{key:0,"model-value":A.searchQuery,"onUpdate:modelValue":p[1]||(p[1]=T=>A.$emit("update-search",T))},null,8,["model-value"])),b.value?O("",!0):(i(),c("div",xa,[s("div",{class:te(["status-tab",{active:u.value==="all"}]),onClick:p[2]||(p[2]=T=>u.value="all")},[p[13]||(p[13]=s("span",{class:"tab-icon"},"ðŸ“Š",-1)),p[14]||(p[14]=s("span",{class:"tab-label"},"ALL",-1)),s("span",Ua,C(A.trials.length),1)],2),s("div",{class:te(["status-tab",{active:u.value==="active"}]),onClick:p[3]||(p[3]=T=>u.value="active")},[p[15]||(p[15]=s("span",{class:"tab-icon"},"ðŸŸ¢",-1)),p[16]||(p[16]=s("span",{class:"tab-label"},"Active",-1)),s("span",Na,C(r.value),1)],2),s("div",{class:te(["status-tab",{active:u.value==="done"}]),onClick:p[4]||(p[4]=T=>u.value="done")},[p[17]||(p[17]=s("span",{class:"tab-icon"},"âœ…",-1)),p[18]||(p[18]=s("span",{class:"tab-label"},"Done",-1)),s("span",za,C(f.value),1)],2)])),s("div",Ha,[!b.value&&h.value.length>100?(i(),Y(z(xe),{key:0,class:"trial-list virtual-list",items:g.value,"size-field":"height","key-field":"id",buffer:10},{default:L(({item:T})=>[T.type==="section"?(i(),Y(_t,{key:0,title:T.title,background:T.background},null,8,["title","background"])):(i(),Y(yt,{key:1,trial:T,selected:T.id===A.selectedTrialId,"data-trial-id":T.id,onClick:B=>A.$emit("select-trial",T.id)},null,8,["trial","selected","data-trial-id","onClick"]))]),_:1},8,["items"])):b.value?(i(),c("div",Ba,[(i(!0),c(X,null,se($.value,T=>(i(),c("div",{key:T.id,class:te(["collapsed-item",{selected:T.id===A.selectedTrialId}]),onClick:B=>A.$emit("select-trial",T.id)},[s("div",{class:te(["status-dot",`status-${T.status}`])},null,2),s("span",Ga,C(P(T)),1)],10,ja))),128))])):(i(),c("div",Wa,[(i(!0),c(X,null,se(h.value,(T,B)=>(i(),c(X,{key:T.id||`section-${B}`},[T.type==="section"?(i(),Y(_t,{key:0,title:T.title,background:T.background},null,8,["title","background"])):(i(),Y(yt,{key:1,trial:T,selected:T.id===A.selectedTrialId,"data-trial-id":T.id,onClick:ae=>A.$emit("select-trial",T.id)},null,8,["trial","selected","data-trial-id","onClick"]))],64))),128))])),h.value.length===0&&!b.value?(i(),c("div",qa,[E(z(ps),{class:"empty-icon"}),s("h3",null,C(y.value),1),s("p",null,C(k.value),1),_.value?(i(),Y(I,{key:0,type:"primary",size:"large",onClick:p[5]||(p[5]=T=>A.$emit("create-trial"))},{default:L(()=>p[19]||(p[19]=[H(" Create New Trial ")])),_:1,__:[19]})):O("",!0)])):O("",!0)])],2)}}}),Qa=oe(Ka,[["__scopeId","data-v-46871462"]]),Ja={class:"trial-header"},Xa={class:"header-main"},Ya={class:"header-title"},Za={class:"trial-name"},en={key:0,class:"progress-container"},tn={class:"progress-bar"},sn={class:"progress-text"},an={class:"header-stats"},nn={class:"stat-item"},ln={class:"stat-value"},on={key:0,class:"stat-item"},rn={class:"stat-value"},un={key:1,class:"stat-item"},dn={class:"stat-value"},cn={key:2,class:"stat-item"},pn={class:"stat-value"},fn=ie({__name:"TrialHeaderV3",props:{trial:{},progress:{},isExecuting:{type:Boolean}},setup(a){const e=a,t=D(()=>{let h=e.trial.name;return h=h.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}$/,""),h=h.replace(/\s*\(Copy\)(\s*\(Copy\))*/g,""),h.trim()}),l=D(()=>e.trial.status==="running"||e.trial.status==="paused"||e.trial.status==="completed"&&e.progress),o=D(()=>e.progress?e.progress.completed+e.progress.failed:0),u=D(()=>{if(!e.progress||e.progress.total===0)return 0;const h=e.progress.completed+e.progress.failed;return Math.round(h/e.progress.total*100)}),d=D(()=>{const h=e.trial.started||e.trial.created;if(!h)return"0m";const $=(e.trial.completed||new Date).getTime()-h.getTime(),y=Math.floor($/(1e3*60*60)),k=Math.floor($%(1e3*60*60)/(1e3*60));return y>0?`${y}h ${k}m`:`${k}m`}),b=D(()=>!e.progress||e.progress.completed===0?null:`${(3600/1e3).toFixed(1)}s`),r=D(()=>{var y;if(!e.trial.configurations||e.trial.configurations.length===0)return null;let h=0;const g=((y=e.progress)==null?void 0:y.total)||e.trial.progress.total,$=Math.ceil(g/e.trial.configurations.length);return e.trial.configurations.forEach(k=>{var w,W;const _=k.modelSnapshot;if((w=_==null?void 0:_.capabilities)!=null&&w.inputCostPerToken&&((W=_==null?void 0:_.capabilities)!=null&&W.outputCostPerToken)){const P=500*_.capabilities.inputCostPerToken+500*_.capabilities.outputCostPerToken;h+=P*$}}),h===0?null:(e.progress&&e.progress.completed>0&&(h=h*(e.progress.completed/g)),`$${h.toFixed(2)}`)}),f=D(()=>{var _;if(e.trial.status!=="running"||!e.progress||e.progress.completed===0)return null;const g=(Date.now()-(((_=e.trial.started)==null?void 0:_.getTime())||0))/e.progress.completed,$=e.progress.pending*g,y=Math.floor($/(1e3*60)),k=Math.floor($%(1e3*60)/1e3);if(y>60){const w=Math.floor(y/60),W=y%60;return`${w}h ${W}m`}return`${y}m ${k}s`});return(h,g)=>{var $;return i(),c("div",Ja,[s("div",Xa,[s("div",Ya,[s("h2",Za,C(t.value),1),s("span",{class:te(["status-tag",`status-${h.trial.status}`])},C(h.trial.status.toUpperCase()),3)]),l.value?(i(),c("div",en,[s("div",tn,[s("div",{class:"progress-fill",style:ve({width:`${u.value}%`})},null,4)]),s("span",sn,C(o.value)+"/"+C((($=h.progress)==null?void 0:$.total)||0)+" ("+C(u.value)+"%) ",1)])):O("",!0)]),s("div",an,[s("div",nn,[E(z(es),{class:"stat-icon"}),s("span",ln,C(d.value),1)]),b.value?(i(),c("div",on,[E(z(nt),{class:"stat-icon"}),s("span",rn,C(b.value),1)])):O("",!0),r.value?(i(),c("div",un,[E(z(et),{class:"stat-icon"}),s("span",dn,C(r.value),1)])):O("",!0),f.value?(i(),c("div",cn,[E(z(tt),{class:"stat-icon"}),s("span",pn,"~"+C(f.value),1)])):O("",!0)])])}}}),vn=oe(fn,[["__scopeId","data-v-36b15977"]]),mn={class:"trial-actions"},gn={class:"action-group execution-controls"},hn={class:"action-group data-actions"},bn={class:"action-group management-actions"},yn=ie({__name:"TrialActionsV3",props:{trial:{},isLeader:{type:Boolean},executionState:{}},emits:["start","pause","resume","cancel","duplicate","edit","delete","export-data","export-python","refresh"],setup(a,{emit:e}){const t=a,l=e,o=K(!1),u=K(!1);D(()=>{var m;return((m=t.executionState)==null?void 0:m.currentTrialId)===t.trial.id});const d=D(()=>["draft","failed","cancelled"].includes(t.trial.status)),b=D(()=>t.trial.status==="running"),r=D(()=>t.trial.status==="paused"),f=D(()=>["running","paused"].includes(t.trial.status));function h(){l("start")}function g(){l("pause")}async function $(){o.value=!0,l("resume"),setTimeout(()=>{o.value=!1},3e3)}function y(){rt.confirm({title:"Cancel trial?",content:"This will stop all pending API calls.",okText:"Cancel Trial",okType:"danger",onOk:()=>l("cancel")})}async function k(){u.value=!0,l("refresh"),setTimeout(()=>{u.value=!1},500)}function _({key:m}){m==="data"?l("export-data"):m==="python"&&l("export-python")}function w(){l("duplicate")}function W(){l("edit")}function P(){const m=t.trial.progress.total;rt.confirm({title:"Delete trial?",content:`Delete trial and all ${m} API calls?`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:()=>{l("delete")}})}return(m,V)=>{const x=ee("a-button"),A=ee("a-menu-item"),p=ee("a-menu"),I=ee("a-dropdown");return i(),c("div",mn,[s("div",gn,[d.value?(i(),Y(x,{key:0,type:"primary",size:"large",disabled:!m.isLeader,onClick:h},{default:L(()=>[E(z(ot)),V[0]||(V[0]=H(" Start Trial "))]),_:1,__:[0]},8,["disabled"])):O("",!0),b.value?(i(),Y(x,{key:1,size:"large",disabled:!m.isLeader,onClick:g},{default:L(()=>[E(z(st)),V[1]||(V[1]=H(" Pause "))]),_:1,__:[1]},8,["disabled"])):O("",!0),r.value?(i(),Y(x,{key:2,type:"primary",size:"large",disabled:!m.isLeader||o.value,loading:o.value,onClick:$},{default:L(()=>[o.value?(i(),Y(z(Be),{key:1,spin:""})):(i(),Y(z(ot),{key:0})),H(" "+C(o.value?"Resuming...":"Resume"),1)]),_:1},8,["disabled","loading"])):O("",!0),f.value?(i(),Y(x,{key:3,danger:"",size:"large",disabled:!m.isLeader,onClick:y},{default:L(()=>[E(z(fs)),V[2]||(V[2]=H(" Cancel "))]),_:1,__:[2]},8,["disabled"])):O("",!0)]),s("div",hn,[E(x,{size:"large",loading:u.value,onClick:k,title:"Refresh trial data from database"},{default:L(()=>[u.value?(i(),Y(z(Be),{key:1,spin:""})):(i(),Y(z(ts),{key:0})),H(" "+C(u.value?"Refreshing...":"Refresh"),1)]),_:1},8,["loading"]),E(I,null,{overlay:L(()=>[E(p,{onClick:_},{default:L(()=>[E(A,{key:"data"},{default:L(()=>[E(z(vs)),V[4]||(V[4]=H(" Export Data "))]),_:1,__:[4]}),E(A,{key:"python"},{default:L(()=>[E(z(ms)),V[5]||(V[5]=H(" Export Python Script "))]),_:1,__:[5]})]),_:1})]),default:L(()=>[E(x,{size:"large"},{default:L(()=>[V[3]||(V[3]=H(" Export ")),E(z(ss))]),_:1,__:[3]})]),_:1})]),s("div",bn,[E(x,{size:"large",disabled:!m.isLeader,onClick:w},{default:L(()=>[E(z(wt)),V[6]||(V[6]=H(" Duplicate "))]),_:1,__:[6]},8,["disabled"]),m.trial.status==="draft"?(i(),Y(x,{key:0,size:"large",disabled:!m.isLeader,onClick:W},{default:L(()=>[E(z(as)),V[7]||(V[7]=H(" Edit "))]),_:1,__:[7]},8,["disabled"])):O("",!0),E(x,{danger:"",size:"large",disabled:!m.isLeader,onClick:P},{default:L(()=>[E(z(ns)),V[8]||(V[8]=H(" Delete "))]),_:1,__:[8]},8,["disabled"])])])}}}),_n=oe(yn,[["__scopeId","data-v-7a269139"]]),Tn={class:"trial-detail-view"},$n={key:0,class:"detail-content"},Cn={class:"detail-section"},kn={class:"detail-grid"},Sn={class:"detail-item"},wn={key:0,class:"detail-item"},In={key:1,class:"detail-item"},Rn={class:"detail-item"},En={class:"detail-item"},Vn={class:"detail-section"},An={class:"detail-grid"},On={key:0,class:"detail-item full-width"},Fn={key:1,class:"detail-item full-width"},Pn={class:"detail-item"},Ln={class:"detail-item"},Mn={key:2,class:"detail-item"},Dn={key:0,class:"detail-section"},xn={class:"detail-grid"},Un={class:"detail-item"},Nn={class:"detail-item"},zn={class:"detail-item"},Hn={class:"detail-section"},Wn={class:"model-configs"},Bn={class:"config-header"},jn=["src","alt"],Gn={class:"provider-name"},qn={class:"config-details"},Kn={class:"config-item"},Qn={class:"config-params"},Jn={class:"param-list"},Xn={key:0,class:"config-item"},Yn={class:"cost"},Zn=ie({__name:"TrialDetailView",props:{trial:{},isCollapsed:{type:Boolean}},emits:["toggle-collapse"],setup(a){const e=a,t=D(()=>{const _=e.trial.started||e.trial.created,W=(e.trial.completed||new Date).getTime()-_.getTime(),P=Math.floor(W/(1e3*60*60)),m=Math.floor(W%(1e3*60*60)/(1e3*60));return P>0?`${P}h ${m}m`:`${m}m`}),l=D(()=>({draft:"Not started",pending:"Waiting to start",running:"Executing API calls",paused:"Execution paused",completed:"All calls completed",failed:"Execution failed",cancelled:"Execution cancelled"})[e.trial.status]||e.trial.status),o=D(()=>{var _;return e.trial.type==="template"&&((_=e.trial.templateConfig)!=null&&_.variables)?Object.keys(e.trial.templateConfig.variables).length:0}),u=D(()=>Math.round(e.trial.progress.total*750)),d=D(()=>"text"),b=D(()=>1),r=D(()=>e.trial.progress.total/b.value);function f(_){return _?new Date(_).toLocaleString():"N/A"}function h(){var _;return((_=e.trial.templateConfig)==null?void 0:_.template)||"Unknown Template"}function g(){var _;return((_=e.trial.spreadsheetConfig)==null?void 0:_.datasetId)||"Unknown Dataset"}function $(_){return{"openai-chat":"OpenAI","anthropic-messages":"Anthropic",openrouter:"OpenRouter","ollama-chat":"Ollama","ollama-generate":"Ollama"}[_]||_}function y(){return null}function k(_){var P;const w=_.modelSnapshot;return(P=w==null?void 0:w.capabilities)!=null&&P.inputCostPerToken?`$${((w.capabilities.inputCostPerToken+w.capabilities.outputCostPerToken)*1e3).toFixed(4)}/1k tokens`:null}return(_,w)=>(i(),c("div",Tn,[s("div",{class:"detail-header",onClick:w[0]||(w[0]=W=>_.$emit("toggle-collapse"))},[w[1]||(w[1]=s("h3",null,"Trial Details",-1)),E(z(ls),{class:te(["collapse-icon",{rotated:_.isCollapsed}])},null,8,["class"])]),_.isCollapsed?O("",!0):(i(),c("div",$n,[s("div",Cn,[w[7]||(w[7]=s("h4",null,"Basic Information",-1)),s("div",kn,[s("div",Sn,[w[2]||(w[2]=s("label",null,"Created:",-1)),s("span",null,C(f(_.trial.created)),1)]),_.trial.started?(i(),c("div",wn,[w[3]||(w[3]=s("label",null,"Started:",-1)),s("span",null,C(f(_.trial.started)),1)])):O("",!0),_.trial.completed?(i(),c("div",In,[w[4]||(w[4]=s("label",null,"Completed:",-1)),s("span",null,C(f(_.trial.completed)),1)])):O("",!0),s("div",Rn,[w[5]||(w[5]=s("label",null,"Duration:",-1)),s("span",null,C(t.value),1)]),s("div",En,[w[6]||(w[6]=s("label",null,"Status:",-1)),s("span",null,C(_.trial.status)+" - "+C(l.value),1)])])]),s("div",Vn,[w[13]||(w[13]=s("h4",null,"Configuration",-1)),s("div",An,[_.trial.type==="template"?(i(),c("div",On,[w[8]||(w[8]=s("label",null,"Template:",-1)),s("span",null,C(h()),1)])):O("",!0),_.trial.type==="spreadsheet"?(i(),c("div",Fn,[w[9]||(w[9]=s("label",null,"Dataset:",-1)),s("span",null,C(g()),1)])):O("",!0),s("div",Pn,[w[10]||(w[10]=s("label",null,"Variable Lists:",-1)),s("span",null,C(o.value)+" lists",1)]),s("div",Ln,[w[11]||(w[11]=s("label",null,"Token Estimate:",-1)),s("span",null,"~"+C(u.value)+" tokens",1)]),d.value?(i(),c("div",Mn,[w[12]||(w[12]=s("label",null,"Output Type:",-1)),s("span",{class:te(["output-type",`type-${d.value}`])},C(d.value),3)])):O("",!0)])]),b.value>1?(i(),c("div",Dn,[w[17]||(w[17]=s("h4",null,"Repeat Configuration",-1)),s("div",xn,[s("div",Un,[w[14]||(w[14]=s("label",null,"Times per prompt:",-1)),s("span",null,C(b.value),1)]),s("div",Nn,[w[15]||(w[15]=s("label",null,"Total combinations:",-1)),s("span",null,C(r.value),1)]),s("div",zn,[w[16]||(w[16]=s("label",null,"Total API calls:",-1)),s("span",null,C(_.trial.progress.total),1)])])])):O("",!0),s("div",Hn,[w[21]||(w[21]=s("h4",null,"Model Configurations",-1)),s("div",Wn,[(i(!0),c(X,null,se(_.trial.configurations,(W,P)=>(i(),c("div",{key:P,class:"model-config-card"},[s("div",Bn,[y(W.provider)?(i(),c("img",{key:0,src:y(W.provider),alt:W.provider,class:"provider-logo"},null,8,jn)):O("",!0),s("span",Gn,C($(W.provider)),1)]),s("div",qn,[s("div",Kn,[w[18]||(w[18]=s("label",null,"Model:",-1)),s("span",null,C(W.modelId),1)]),s("div",Qn,[w[19]||(w[19]=s("label",null,"Parameters:",-1)),s("div",Jn,[(i(!0),c(X,null,se(W.parameters,(m,V)=>(i(),c("span",{key:V,class:"param-tag"},C(V)+": "+C(m),1))),128))])]),k(W)?(i(),c("div",Xn,[w[20]||(w[20]=s("label",null,"Est. Cost:",-1)),s("span",Yn,C(k(W)),1)])):O("",!0)])]))),128))])])]))]))}}),el=oe(Zn,[["__scopeId","data-v-c60de8b4"]]),tl={class:"filter-bar"},sl={class:"search-container"},al=ie({__name:"TrialResultsFilterBar",props:{statusFilter:{},configFilter:{},searchQuery:{},visibleColumns:{},configurations:{},apiCalls:{},showRepeatColumn:{type:Boolean}},emits:["update:statusFilter","update:configFilter","update:searchQuery","update:visibleColumns"],setup(a,{emit:e}){const t=a,l=e,o=D(()=>{const f=[{key:"status",label:"Status"},{key:"configuration",label:"Configuration"},{key:"variables",label:"Variables"},{key:"response",label:"Response"},{key:"parsedResponse",label:"Parsed Response"},{key:"length",label:"Length"},{key:"latency",label:"Latency"}];return t.showRepeatColumn&&f.splice(2,0,{key:"repeat",label:"Repeat Index"}),f}),u=D(()=>{const f={total:t.apiCalls.length,completed:0,failed:0,running:0,pending:0};return t.apiCalls.forEach(h=>{h.status==="completed"?f.completed++:h.status==="failed"?f.failed++:h.status==="running"?f.running++:h.status==="pending"&&f.pending++}),f});function d(f){var h;return((h=f.modelSnapshot)==null?void 0:h.displayName)||`${f.provider} - ${f.modelId}`}const b=Dt(f=>{const h=f.target.value;l("update:searchQuery",h)},300);function r(f){const h=[...t.visibleColumns],g=h.indexOf(f);if(g>-1)h.splice(g,1);else{const $=o.value.map(_=>_.key),y=$.indexOf(f);let k=0;for(let _=0;_<y;_++)h.includes($[_])&&k++;h.splice(k,0,f)}l("update:visibleColumns",h)}return(f,h)=>{const g=ee("a-select-option"),$=ee("a-select"),y=ee("a-input"),k=ee("a-button"),_=ee("a-checkbox"),w=ee("a-menu-item"),W=ee("a-menu"),P=ee("a-dropdown");return i(),c("div",tl,[E($,{value:f.statusFilter,onChange:h[0]||(h[0]=m=>f.$emit("update:statusFilter",m)),placeholder:"Filter by status",style:{width:"150px"}},{default:L(()=>[E(g,{value:"all"},{default:L(()=>[H(" All ("+C(u.value.total)+") ",1)]),_:1}),E(g,{value:"completed"},{default:L(()=>[H(" Completed ("+C(u.value.completed)+") ",1)]),_:1}),E(g,{value:"failed"},{default:L(()=>[H(" Failed ("+C(u.value.failed)+") ",1)]),_:1}),E(g,{value:"running"},{default:L(()=>[H(" Running ("+C(u.value.running)+") ",1)]),_:1}),E(g,{value:"pending"},{default:L(()=>[H(" Pending ("+C(u.value.pending)+") ",1)]),_:1})]),_:1},8,["value"]),E($,{value:f.configFilter,onChange:h[1]||(h[1]=m=>f.$emit("update:configFilter",m)),mode:"multiple",placeholder:"Filter by configuration",style:{width:"250px"},"max-tag-count":2},{default:L(()=>[E(g,{value:""},{default:L(()=>h[2]||(h[2]=[H("All Configurations")])),_:1,__:[2]}),(i(!0),c(X,null,se(f.configurations,(m,V)=>(i(),Y(g,{key:V,value:V.toString()},{default:L(()=>[H(C(d(m,V)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),s("div",sl,[E(y,{value:f.searchQuery,onInput:z(b),placeholder:"Search in variables and responses...",style:{width:"400px"},"allow-clear":""},{prefix:L(()=>[E(z(St))]),_:1},8,["value","onInput"])]),E(P,null,{overlay:L(()=>[E(W,null,{default:L(()=>[(i(!0),c(X,null,se(o.value,m=>(i(),Y(w,{key:m.key},{default:L(()=>[E(_,{checked:f.visibleColumns.includes(m.key),disabled:m.key==="status",onChange:V=>r(m.key)},{default:L(()=>[H(C(m.label),1)]),_:2},1032,["checked","disabled","onChange"])]),_:2},1024))),128))]),_:1})]),default:L(()=>[E(k,null,{default:L(()=>[E(z(Ze)),h[3]||(h[3]=H(" Columns "))]),_:1,__:[3]})]),_:1})])}}}),nl=oe(al,[["__scopeId","data-v-b84791d2"]]),ll={class:"modal-content"},il={class:"section"},ol={class:"info-grid"},rl={class:"info-item"},ul={class:"monospace"},dl={class:"info-item"},cl={class:"info-item"},pl={key:0,class:"info-item"},fl={class:"info-item"},vl={key:1,class:"info-item"},ml={key:2,class:"info-item"},gl={key:3,class:"info-item"},hl={key:0,class:"info-row"},bl={class:"monospace"},yl={key:0,class:"section"},_l={class:"variables-list"},Tl={class:"variable-main"},$l={class:"variable-label"},Cl={class:"variable-value"},kl={key:0,class:"variable-attributes"},Sl={class:"attribute-label"},wl={class:"attribute-value"},Il={class:"section"},Rl={class:"content-box prompt-display"},El={key:1,class:"section"},Vl={key:0,class:"error-result"},Al={key:1,class:"success-result"},Ol={class:"content-box response-content"},Fl={key:0,class:"parsed-content-section"},Pl={class:"content-box parsed-content"},Ll={key:1,class:"refusal-warning"},Ml={key:2,class:"features-section"},Dl={class:"features-grid"},xl={class:"feature-value"},Ul={class:"extraction-config-section"},Nl={class:"config-grid"},zl={key:0,class:"config-item"},Hl={class:"config-value"},Wl={key:1,class:"config-item"},Bl={class:"config-value pattern"},jl={key:2,class:"config-item"},Gl={class:"config-value"},ql={key:3,class:"config-item"},Kl={class:"config-value"},Ql={key:4,class:"config-item no-extraction"},Jl={key:3,class:"usage-info"},Xl={class:"info-grid"},Yl={class:"info-item"},Zl={class:"info-item"},ei={class:"info-item"},ti={key:0,class:"info-item"},si={class:"raw-data-section"},ai={class:"raw-data"},ni={key:0},li={key:1,class:"raw-data"},ii={key:2},oi={key:3,class:"raw-data"},ri={class:"modal-footer"},ui=ie({__name:"APICallDetailModalV3",props:{visible:{type:Boolean},apiCall:{},trial:{}},emits:["update:visible"],setup(a,{emit:e}){const t=a,l=e,o=Xe(),u=D(()=>{if(!t.apiCall.completed||!t.apiCall.created)return null;const p=new Date(t.apiCall.created).getTime();return new Date(t.apiCall.completed).getTime()-p}),d=D(()=>{const p=t.trial.configurations[t.apiCall.configurationIndex];return p?`${p.provider} / ${p.modelId}`:null}),b=D(()=>{var R,N,T;if(!((R=t.apiCall.result)!=null&&R.usage))return null;const p=t.trial.configurations[t.apiCall.configurationIndex];if(!p)return null;const I=o.models.value.find(B=>B.provider===p.provider&&B.modelId===p.modelId);if(!((N=I==null?void 0:I.capabilities)!=null&&N.inputCostPerToken)&&!((T=I==null?void 0:I.capabilities)!=null&&T.outputCostPerToken))return null;const U=(t.apiCall.result.usage.prompt_tokens||0)*(I.capabilities.inputCostPerToken||0),n=(t.apiCall.result.usage.completion_tokens||0)*(I.capabilities.outputCostPerToken||0);return U+n}),r=D(()=>{if(!t.apiCall.request)return"No request data";const p=JSON.parse(JSON.stringify(t.apiCall.request));return p.headers&&Object.keys(p.headers).forEach(I=>{(I.toLowerCase().includes("authorization")||I.toLowerCase().includes("api-key")||I.toLowerCase().includes("x-api-key"))&&(p.headers[I]="[REDACTED]")}),p.body&&typeof p.body=="object"&&(p.body.api_key&&(p.body.api_key="[REDACTED]"),p.body.apiKey&&(p.body.apiKey="[REDACTED]")),JSON.stringify(p,null,2)}),f=D(()=>t.trial.type!=="template"||!t.trial.templateConfig?{}:{outputType:t.trial.templateConfig.outputType,extractPattern:t.trial.templateConfig.extractPattern,refusalWords:t.trial.templateConfig.refusalWords,rejectRefusalWords:t.trial.templateConfig.rejectRefusalWords}),h=D(()=>{const p=f.value;return!!(p.outputType||p.extractPattern||p.refusalWords&&p.refusalWords.length>0)}),g=D(()=>t.apiCall.response?JSON.stringify({status:t.apiCall.response.status,headers:t.apiCall.response.headers,body:t.apiCall.response.body,latencyMs:t.apiCall.response.latencyMs},null,2):"No response data available"),$=D(()=>t.apiCall.result?JSON.stringify(t.apiCall.result,null,2):"No processed result available");function y(p){return{completed:"success",failed:"error",running:"processing",pending:"warning"}[p]||"default"}function k(){var I;const p=t.trial.configurations[t.apiCall.configurationIndex];return((I=p==null?void 0:p.modelSnapshot)==null?void 0:I.displayName)||(p==null?void 0:p.modelId)||`Configuration ${t.apiCall.configurationIndex+1}`}function _(p){return(typeof p=="string"?new Date(p):p).toLocaleString()}function w(p){return p<1e3?`${p}ms`:p<6e4?`${(p/1e3).toFixed(1)}s`:`${Math.floor(p/6e4)}m ${(p%6e4/1e3).toFixed(0)}s`}function W(p){return p==null?"null":typeof p=="string"?p:typeof p=="number"||typeof p=="boolean"?String(p):JSON.stringify(p,null,2)}function P(p){return{network_error_no_response:"Network Error (No Response)",api_error_received:"API Error Response",parsing_error:"Response Parsing Error",timeout:"Request Timeout",rate_limit:"Rate Limit Exceeded"}[p]||p}function m(p){return p.replace(/_/g," ").replace(/\b\w/g,I=>I.toUpperCase())}function V(p){return p==null?"N/A":typeof p=="number"?p<1?p.toFixed(4):p.toFixed(2):typeof p=="object"?JSON.stringify(p):String(p)}function x(){l("update:visible",!1)}async function A(){const p={id:t.apiCall.id,status:t.apiCall.status,configuration:k(),provider:d.value,variables:t.apiCall.variables,variableAttributes:t.apiCall.variableAttributes,prompt:t.apiCall.prompt,fullApiResponse:t.apiCall.response,processedResult:t.apiCall.result,extractionConfig:f.value,created:t.apiCall.created,completed:t.apiCall.completed,duration:u.value?`${u.value}ms`:null,cost:b.value?`$${b.value.toFixed(4)}`:null},I=JSON.stringify(p,null,2);try{await navigator.clipboard.writeText(I),le.success("Details copied to clipboard!")}catch(U){v.error("Failed to copy to clipboard",U),le.error("Failed to copy to clipboard")}}return(p,I)=>{const U=ee("a-tag"),n=ee("a-alert"),R=ee("a-collapse-panel"),N=ee("a-collapse"),T=ee("a-button"),B=ee("a-modal");return i(),Y(B,{open:p.visible,onCancel:I[0]||(I[0]=ae=>l("update:visible",!1)),title:"API Call Details",width:1400,footer:null,"body-style":{padding:0,height:"85vh",display:"flex",flexDirection:"column"},centered:!0,"destroy-on-close":!0,class:"api-call-detail-modal"},{default:L(()=>{var ae;return[s("div",ll,[s("div",il,[I[10]||(I[10]=s("h3",null,"Overview",-1)),s("div",ol,[s("div",rl,[I[1]||(I[1]=s("label",null,"Call ID:",-1)),s("span",ul,C(p.apiCall.id),1)]),s("div",dl,[I[2]||(I[2]=s("label",null,"Status:",-1)),E(U,{color:y(p.apiCall.status)},{default:L(()=>[H(C(p.apiCall.status.toUpperCase()),1)]),_:1},8,["color"])]),s("div",cl,[I[3]||(I[3]=s("label",null,"Configuration:",-1)),s("span",null,C(k()),1)]),p.apiCall.repeatIndex!==void 0?(i(),c("div",pl,[I[4]||(I[4]=s("label",null,"Repeat:",-1)),s("span",null,"#"+C(p.apiCall.repeatIndex+1),1)])):O("",!0),s("div",fl,[I[5]||(I[5]=s("label",null,"Created:",-1)),s("span",null,C(_(p.apiCall.created)),1)]),p.apiCall.completed?(i(),c("div",vl,[I[6]||(I[6]=s("label",null,"Completed:",-1)),s("span",null,C(_(p.apiCall.completed)),1)])):O("",!0),u.value?(i(),c("div",ml,[I[7]||(I[7]=s("label",null,"Duration:",-1)),s("span",null,C(w(u.value)),1)])):O("",!0),(ae=p.apiCall.result)!=null&&ae.latency?(i(),c("div",gl,[I[8]||(I[8]=s("label",null,"API Latency:",-1)),s("span",null,C(p.apiCall.result.latency)+"ms",1)])):O("",!0)]),d.value?(i(),c("div",hl,[I[9]||(I[9]=s("label",null,"Provider/Model:",-1)),s("span",bl,C(d.value),1)])):O("",!0)]),p.apiCall.variables&&Object.keys(p.apiCall.variables).length>0?(i(),c("div",yl,[I[11]||(I[11]=s("h3",null,"Variables",-1)),s("div",_l,[(i(!0),c(X,null,se(p.apiCall.variables,(S,Z)=>(i(),c("div",{key:Z,class:"variable-group"},[s("div",Tl,[s("label",$l,C(Z)+":",1),s("span",Cl,C(S),1)]),p.apiCall.variableAttributes&&p.apiCall.variableAttributes[Z]?(i(),c("div",kl,[(i(!0),c(X,null,se(p.apiCall.variableAttributes[Z],(de,pe)=>(i(),c("div",{key:pe,class:"attribute-item"},[s("label",Sl,C(pe)+":",1),s("span",wl,C(de),1)]))),128))])):O("",!0)]))),128))])])):O("",!0),s("div",Il,[I[12]||(I[12]=s("h3",null,"Resolved Prompt",-1)),s("div",Rl,C(p.apiCall.prompt),1)]),p.apiCall.result?(i(),c("div",El,[I[26]||(I[26]=s("h3",null,"Response",-1)),p.apiCall.status==="failed"&&p.apiCall.result.error?(i(),c("div",Vl,[E(n,{type:"error",message:p.apiCall.result.error,description:p.apiCall.result.errorType?`Error Type: ${P(p.apiCall.result.errorType)}`:void 0,"show-icon":""},null,8,["message","description"])])):p.apiCall.result.content?(i(),c("div",Al,[s("div",Ol,C(p.apiCall.result.content),1),p.apiCall.result.parsedContent!==void 0?(i(),c("div",Fl,[I[13]||(I[13]=s("h4",null,"Extracted Value",-1)),s("div",Pl,C(W(p.apiCall.result.parsedContent)),1)])):O("",!0),p.apiCall.result.refused?(i(),c("div",Ll,[E(n,{type:"warning",message:"Response flagged as refusal",description:"This response matched configured refusal patterns","show-icon":""})])):O("",!0),p.apiCall.result.features&&Object.keys(p.apiCall.result.features).length>0?(i(),c("div",Ml,[I[14]||(I[14]=s("h4",null,"Response Features",-1)),s("div",Dl,[(i(!0),c(X,null,se(p.apiCall.result.features,(S,Z)=>(i(),c("div",{key:Z,class:"feature-item"},[s("label",null,C(m(Z))+":",1),s("span",xl,C(V(S)),1)]))),128))])])):O("",!0),s("div",Ul,[I[20]||(I[20]=s("h4",null,"Extraction Configuration",-1)),s("div",Nl,[f.value.outputType?(i(),c("div",zl,[I[15]||(I[15]=s("label",null,"Output Type:",-1)),s("span",Hl,C(f.value.outputType),1)])):O("",!0),f.value.extractPattern?(i(),c("div",Wl,[I[16]||(I[16]=s("label",null,"Extract Pattern:",-1)),s("span",Bl,C(f.value.extractPattern),1)])):O("",!0),f.value.refusalWords&&f.value.refusalWords.length>0?(i(),c("div",jl,[I[17]||(I[17]=s("label",null,"Refusal Words:",-1)),s("span",Gl,C(f.value.refusalWords.join(", ")),1)])):O("",!0),f.value.rejectRefusalWords!==void 0?(i(),c("div",ql,[I[18]||(I[18]=s("label",null,"Reject on Refusal:",-1)),s("span",Kl,C(f.value.rejectRefusalWords?"Yes":"No"),1)])):O("",!0),h.value?O("",!0):(i(),c("div",Ql,I[19]||(I[19]=[s("span",{class:"no-config-message"},"No extraction configuration set for this trial",-1)])))])]),p.apiCall.result.usage?(i(),c("div",Jl,[I[25]||(I[25]=s("h4",null,"Token Usage",-1)),s("div",Xl,[s("div",Yl,[I[21]||(I[21]=s("label",null,"Prompt Tokens:",-1)),s("span",null,C(p.apiCall.result.usage.prompt_tokens||0),1)]),s("div",Zl,[I[22]||(I[22]=s("label",null,"Completion Tokens:",-1)),s("span",null,C(p.apiCall.result.usage.completion_tokens||0),1)]),s("div",ei,[I[23]||(I[23]=s("label",null,"Total Tokens:",-1)),s("span",null,C(p.apiCall.result.usage.total_tokens||0),1)]),b.value?(i(),c("div",ti,[I[24]||(I[24]=s("label",null,"Cost:",-1)),s("span",null,"$"+C(b.value.toFixed(4)),1)])):O("",!0)])])):O("",!0)])):O("",!0)])):O("",!0),E(N,{ghost:""},{default:L(()=>[E(R,{key:"raw",header:"Raw Data"},{default:L(()=>[s("div",si,[I[27]||(I[27]=s("h4",null,"HTTP Request",-1)),s("pre",ai,C(r.value),1),p.apiCall.response?(i(),c("h4",ni,"Full API Response")):O("",!0),p.apiCall.response?(i(),c("pre",li,C(g.value),1)):O("",!0),p.apiCall.result?(i(),c("h4",ii,"Processed Result")):O("",!0),p.apiCall.result?(i(),c("pre",oi,C($.value),1)):O("",!0)])]),_:1})]),_:1})]),s("div",ri,[E(T,{onClick:x,size:"large"},{default:L(()=>I[28]||(I[28]=[H(" Close ")])),_:1,__:[28]}),E(T,{type:"primary",onClick:A,size:"large"},{default:L(()=>[E(z(wt)),I[29]||(I[29]=H(" Copy Details "))]),_:1,__:[29]})])]}),_:1},8,["open"])}}}),di=oe(ui,[["__scopeId","data-v-79804335"]]);class ci{constructor(){ce(this,"apiCalls",Ae([]));ce(this,"currentTrialId",Ae(null));ce(this,"executionProgress",Ae(null));ce(this,"isStreaming",Ae(!1));ce(this,"progress",D(()=>{var g,$;const e=performance.now(),t=this.apiCalls.value;if(t.length===0)return{trialId:this.currentTrialId.value||"",total:0,completed:0,failed:0,cancelled:0,pending:0,running:0,networkErrors:0,lastUpdated:new Date};let l=0,o=0,u=0,d=0,b=0,r=0;v.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Computing progress from ${t.length} calls in store`);for(const y of t)switch(y.status){case"completed":l++;break;case"failed":o++,($=(g=y.result)==null?void 0:g.error)!=null&&$.includes("network")&&r++;break;case"cancelled":u++;break;case"pending":d++;break;case"running":b++;break}const f=performance.now(),h={trialId:this.currentTrialId.value||"",total:t.length,completed:l,failed:o,cancelled:u,pending:d,running:b,networkErrors:r,lastUpdated:new Date};return v.info(`V4_STORE_PROGRESS: Computed in ${(f-e).toFixed(1)}ms - ${l}/${t.length} completed, ${b} running, ${d} pending`),v.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Final result - completed: ${l}, failed: ${o}, running: ${b}, pending: ${d}, total: ${t.length}`),h}));ce(this,"pivotData",D(()=>{const e=performance.now(),t=this.apiCalls.value,l={rows:[],columns:[],cells:new Map};if(t.length===0)return l;const o=new Set,u=new Set;for(const b of t){if(b.status!=="completed")continue;const r=`Config ${b.configurationIndex}`;o.add(r);const f=Object.keys(b.variables||{}),h=f.length>0?String(b.variables[f[0]]):"default";u.add(h),l.cells.has(r)||l.cells.set(r,new Map);const g=l.cells.get(r);g.has(h)||g.set(h,[]),g.get(h).push(b)}l.rows=Array.from(o).sort(),l.columns=Array.from(u).sort();const d=performance.now();return v.info(`V4_TRIAL_SWITCH: Store pivotData computed for ${t.length} calls in ${(d-e).toFixed(1)}ms`),l}));ce(this,"stats",D(()=>{var g;const e=performance.now(),t=this.apiCalls.value,l=t.length;if(l===0)return{total:0,completed:0,failed:0,pending:0,running:0,avgLatency:0,errorRate:0};let o=0,u=0,d=0,b=0,r=0,f=0;for(const $ of t)switch($.status){case"completed":o++,(g=$.response)!=null&&g.latencyMs&&(r+=$.response.latencyMs,f++);break;case"failed":u++;break;case"pending":d++;break;case"running":b++;break}const h=performance.now();return v.info(`V4_TRIAL_SWITCH: Store stats computed for ${t.length} calls in ${(h-e).toFixed(1)}ms`),{total:l,completed:o,failed:u,pending:d,running:b,avgLatency:f>0?r/f:0,errorRate:l>0?u/l*100:0}}))}updateApiCalls(e){performance.now();for(const t of e)switch(t.status){}this.apiCalls.value=Object.freeze(e),performance.now()}updateProgress(e){v.info("STORE_V4: Updating progress:",e.type),this.executionProgress.value=e}setStreaming(e){v.info(`STORE_V4: Set streaming: ${e}`),this.isStreaming.value=e}setCurrentTrial(e){v.info(`STORE_V4: Set current trial: ${e}`),this.currentTrialId.value=e,e||this.clear()}clear(){v.info("STORE_V4: Clearing store data"),this.apiCalls.value=[],this.executionProgress.value=null,this.isStreaming.value=!1}async refreshFromDatabase(e){v.info(`STORE_V4: Refreshing data from database for trial ${e}`);try{const t=await je.apiCalls.where("trialId").equals(e).toArray();v.info(`STORE_V4: Loaded ${t.length} calls from database`),t.sort((l,o)=>{const u=r=>{switch(r){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},d=u(l.status),b=u(o.status);return d!==b?d-b:l.order-o.order}),this.updateApiCalls(t),this.setCurrentTrial(e),v.info("STORE_V4: Refresh complete - store updated with fresh data")}catch(t){throw v.error("STORE_V4: Failed to refresh from database:",t),t}}}let Pe=null;function Ue(){return Pe||(Pe=new ci,v.info("STORE_V4: Created singleton store instance")),Pe}typeof window<"u"&&(window.__trialDataStoreV4=()=>Pe);const pi={class:"trial-results-table"},fi={class:"table-container"},vi={class:"results-table"},mi={key:0,class:"col-status"},gi={key:1,class:"col-configuration"},hi={key:2,class:"col-repeat"},bi={key:3,class:"col-variables"},yi={key:4,class:"col-response"},_i={key:5,class:"col-parsed"},Ti={key:6,class:"col-length"},$i={key:7,class:"col-latency"},Ci={class:"results-table"},ki=["onClick"],Si={key:0,class:"col-status"},wi={class:"status-cell"},Ii={class:"status-time"},Ri={key:1,class:"col-configuration"},Ei={key:2,class:"col-repeat"},Vi={key:3,class:"col-variables"},Ai={class:"variable-tags"},Oi={key:0,class:"var-item"},Fi={key:1,class:"var-item"},Pi={key:2},Li={key:3},Mi={key:4,class:"col-response"},Di={class:"response-content"},xi={key:5,class:"col-parsed"},Ui={key:6,class:"col-length"},Ni={key:7,class:"col-latency"},zi={key:1,class:"results-table"},Hi={key:0,class:"col-status"},Wi={key:1,class:"col-configuration"},Bi={key:2,class:"col-repeat"},ji={key:3,class:"col-variables"},Gi={key:4,class:"col-response"},qi={key:5,class:"col-parsed"},Ki={key:6,class:"col-length"},Qi={key:7,class:"col-latency"},Ji=["onClick"],Xi={key:0,class:"col-status"},Yi={class:"status-cell"},Zi={class:"status-time"},eo={key:1,class:"col-configuration"},to={key:2,class:"col-repeat"},so={key:3,class:"col-variables"},ao={class:"variable-tags"},no={key:0,class:"var-item"},lo={key:1,class:"var-item"},io={key:2},oo={key:3},ro={key:4,class:"col-response"},uo={class:"response-content"},co={key:5,class:"col-parsed"},po={key:6,class:"col-length"},fo={key:7,class:"col-latency"},vo={key:0},mo=["colspan"],go={key:0},ho={key:1},Tt="trial-results-visible-columns",bo=ie({__name:"TrialResultsTableV3",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(a){const e=a,t=K("all"),l=K([]),o=K(""),u=K(["status","configuration","variables","response","length","latency"]),d=K(null),b=Ue(),r=D(()=>{var n;return((n=b.apiCalls)==null?void 0:n.value)||[]}),f=D(()=>e.apiCalls||r.value);re(f,(n,R)=>{const N=performance.now();v.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 calls data changed from ${(R==null?void 0:R.length)||0} to ${n.length} calls`),setTimeout(()=>{const T=performance.now();v.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 reactive update completed in ${(T-N).toFixed(1)}ms`)},0)});const h=n=>{if(!o.value)return n;const R=o.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),N=new RegExp(`(${R})`,"gi");return n.replace(N,"<mark>$1</mark>")},g=D(()=>{const n=performance.now();let R=[...f.value];if(t.value!=="all"&&(R=R.filter(T=>T.status===t.value)),l.value.length>0&&(R=R.filter(T=>l.value.includes(String(T.configurationIndex)))),o.value){const T=o.value.toLowerCase();R=R.filter(B=>{var ae,S,Z,de,pe;return!!((ae=B.prompt)!=null&&ae.toLowerCase().includes(T)||(Z=(S=B.result)==null?void 0:S.content)!=null&&Z.toLowerCase().includes(T)||(pe=(de=B.result)==null?void 0:de.error)!=null&&pe.toLowerCase().includes(T))})}const N=performance.now();return v.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls computed ${R.length} calls in ${(N-n).toFixed(1)}ms`),R});re(g,(n,R)=>{const N=performance.now();v.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls changed from ${(R==null?void 0:R.length)||0} to ${n.length} items`),setTimeout(()=>{const T=performance.now();v.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls render completed in ${(T-N).toFixed(1)}ms`)},0)});const $=D(()=>f.value),y=D(()=>f.value.length),k=D(()=>e.trial.configurations.some(n=>n.repeatCount>1)),_=D(()=>60);function w(n){}function W(n){var N;const R=e.trial.configurations[n];return R?((N=R.modelSnapshot)==null?void 0:N.displayName)||`${R.modelId}`:`Config ${n+1}`}function P(n){var R,N,T,B,ae;return n.status==="pending"?"Waiting...":n.status==="running"?"Processing...":n.status==="failed"?((R=n.result)==null?void 0:R.errorType)==="refusal_detected"||((N=n.result)==null?void 0:N.error)==="REFUSED"?((T=n.result)==null?void 0:T.content)||"REFUSED":((B=n.result)==null?void 0:B.error)||"Error occurred":((ae=n.result)==null?void 0:ae.content)||""}function m(n){if(!n.result)return"";if(n.result.parsedContent!==void 0){const R=n.result.parsedContent;return R===null?"null":typeof R=="string"?R:typeof R=="number"||typeof R=="boolean"?String(R):JSON.stringify(R)}return""}function V(n){var T;const R=((T=n.result)==null?void 0:T.content)||"";if(!R)return"";const N=R.length;return N>1e3?`${(N/1e3).toFixed(1)}k chars`:`${N} chars`}function x(n){return n?n<1e3?`${n}ms`:`${(n/1e3).toFixed(1)}s`:""}function A(n){let R;switch(n.status){case"completed":case"failed":R=n.completed;break;case"running":R=n.started;break;case"pending":case"cancelled":R=n.created;break}if(!R)return"";const N=new Date(R),T=N.getHours().toString().padStart(2,"0"),B=N.getMinutes().toString().padStart(2,"0"),ae=N.getSeconds().toString().padStart(2,"0");return`Â Â ${T}:${B}:${ae}`}function p(n){return n?n<1e3?"latency-fast":n<5e3?"latency-medium":"latency-slow":""}function I(n){return h(n)}function U(n){d.value=n}return re(u,n=>{localStorage.setItem(Tt,JSON.stringify(n))},{deep:!0}),fe(()=>{const n=performance.now();v.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 MOUNTED with ${f.value.length} calls`);const R=localStorage.getItem(Tt);if(R)try{u.value=JSON.parse(R)}catch{}ye(()=>{const N=performance.now();v.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 DOM ready in ${(N-n).toFixed(1)}ms`),setTimeout(()=>{const T=performance.now();v.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 virtual scrolling ready in ${(T-n).toFixed(1)}ms`)},100)}),setTimeout(()=>{const N=performance.now();v.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 mount completed in ${(N-n).toFixed(1)}ms`)},0)}),Se(()=>{v.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 ACTIVATED (cache hit) with ${f.value.length} calls`)}),we(()=>{v.info("V4_TRIAL_SWITCH: TrialResultsTableV3 DEACTIVATED (cached)")}),me(()=>{v.info("V4_TRIAL_SWITCH: TrialResultsTableV3 UNMOUNTED (evicted)")}),(n,R)=>{const N=kt("dompurify-html");return i(),c("div",pi,[E(nl,{"status-filter":t.value,"onUpdate:statusFilter":R[0]||(R[0]=T=>t.value=T),"config-filter":l.value,"onUpdate:configFilter":R[1]||(R[1]=T=>l.value=T),"search-query":o.value,"onUpdate:searchQuery":R[2]||(R[2]=T=>o.value=T),"visible-columns":u.value,"onUpdate:visibleColumns":R[3]||(R[3]=T=>u.value=T),configurations:n.trial.configurations,"api-calls":$.value,"show-repeat-column":k.value},null,8,["status-filter","config-filter","search-query","visible-columns","configurations","api-calls","show-repeat-column"]),s("div",fi,[y.value>100?(i(),Y(z(xe),{key:0,class:"results-scroller",items:g.value,"item-size":_.value,"key-field":"id",buffer:10,onVisibleRange:w},{before:L(()=>[s("table",vi,[s("thead",null,[s("tr",null,[u.value.includes("status")?(i(),c("th",mi,"Status")):O("",!0),u.value.includes("configuration")?(i(),c("th",gi,"Configuration")):O("",!0),u.value.includes("repeat")&&k.value?(i(),c("th",hi,"Repeat")):O("",!0),u.value.includes("variables")?(i(),c("th",bi,"Variables")):O("",!0),u.value.includes("response")?(i(),c("th",yi,"Response")):O("",!0),u.value.includes("parsedResponse")?(i(),c("th",_i,"Parsed Response")):O("",!0),u.value.includes("length")?(i(),c("th",Ti,"Length")):O("",!0),u.value.includes("latency")?(i(),c("th",$i,"Latency")):O("",!0)])])])]),default:L(({item:T})=>{var B,ae;return[s("table",Ci,[s("tbody",null,[s("tr",{class:te(["result-row",`status-${T.status}`]),onClick:S=>U(T)},[u.value.includes("status")?(i(),c("td",Si,[s("div",wi,[s("span",{class:te(["status-tag",`status-${T.status}`])},C(T.status.toUpperCase()),3),s("span",Ii,C(A(T)),1)])])):O("",!0),u.value.includes("configuration")?(i(),c("td",Ri,C(W(T.configurationIndex)),1)):O("",!0),u.value.includes("repeat")&&k.value?(i(),c("td",Ei," #"+C((T.repeatIndex||0)+1),1)):O("",!0),u.value.includes("variables")?(i(),c("td",Vi,[s("div",Ai,[(i(!0),c(X,null,se(T.variables,(S,Z,de)=>(i(),c(X,{key:Z},[R[6]||(R[6]=s("span",{class:"var-bullet"},"â€¢ ",-1)),Object.keys(T.variables).length<=2?(i(),c("span",Oi,C(Z)+": "+C(S),1)):(i(),c("span",Fi,C(S),1)),Object.keys(T.variables).length===2&&de===0?(i(),c("span",Pi,R[5]||(R[5]=[s("br",null,null,-1)]))):de!==void 0&&de<Object.keys(T.variables).length-1?(i(),c("span",Li,C("Â Â "))):O("",!0)],64))),128))])])):O("",!0),u.value.includes("response")?(i(),c("td",Mi,[$e(s("div",Di,null,512),[[N,I(P(T)),"apiResponse"]])])):O("",!0),u.value.includes("parsedResponse")?(i(),c("td",xi,C(m(T)),1)):O("",!0),u.value.includes("length")?(i(),c("td",Ui,C(V(T)),1)):O("",!0),u.value.includes("latency")?(i(),c("td",Ni,[s("span",{class:te(p((B=T.response)==null?void 0:B.latencyMs))},C(x((ae=T.response)==null?void 0:ae.latencyMs)),3)])):O("",!0)],10,ki)])])]}),_:1},8,["items","item-size"])):(i(),c("table",zi,[s("thead",null,[s("tr",null,[u.value.includes("status")?(i(),c("th",Hi,"Status")):O("",!0),u.value.includes("configuration")?(i(),c("th",Wi,"Configuration")):O("",!0),u.value.includes("repeat")&&k.value?(i(),c("th",Bi,"Repeat")):O("",!0),u.value.includes("variables")?(i(),c("th",ji,"Variables")):O("",!0),u.value.includes("response")?(i(),c("th",Gi,"Response")):O("",!0),u.value.includes("parsedResponse")?(i(),c("th",qi,"Parsed Response")):O("",!0),u.value.includes("length")?(i(),c("th",Ki,"Length")):O("",!0),u.value.includes("latency")?(i(),c("th",Qi,"Latency")):O("",!0)])]),s("tbody",null,[(i(!0),c(X,null,se(g.value,T=>{var B,ae;return i(),c("tr",{key:T.id,class:te(["result-row",`status-${T.status}`]),onClick:S=>U(T)},[u.value.includes("status")?(i(),c("td",Xi,[s("div",Yi,[s("span",{class:te(["status-tag",`status-${T.status}`])},C(T.status.toUpperCase()),3),s("span",Zi,C(A(T)),1)])])):O("",!0),u.value.includes("configuration")?(i(),c("td",eo,C(W(T.configurationIndex)),1)):O("",!0),u.value.includes("repeat")&&k.value?(i(),c("td",to," #"+C((T.repeatIndex||0)+1),1)):O("",!0),u.value.includes("variables")?(i(),c("td",so,[s("div",ao,[(i(!0),c(X,null,se(T.variables,(S,Z,de)=>(i(),c(X,{key:Z},[R[8]||(R[8]=s("span",{class:"var-bullet"},"â€¢ ",-1)),Object.keys(T.variables).length<=2?(i(),c("span",no,C(Z)+": "+C(S),1)):(i(),c("span",lo,C(S),1)),Object.keys(T.variables).length===2&&de===0?(i(),c("span",io,R[7]||(R[7]=[s("br",null,null,-1)]))):de<Object.keys(T.variables).length-1?(i(),c("span",oo,C("Â Â "))):O("",!0)],64))),128))])])):O("",!0),u.value.includes("response")?(i(),c("td",ro,[$e(s("div",uo,null,512),[[N,I(P(T)),"apiResponse"]])])):O("",!0),u.value.includes("parsedResponse")?(i(),c("td",co,C(m(T)),1)):O("",!0),u.value.includes("length")?(i(),c("td",po,C(V(T)),1)):O("",!0),u.value.includes("latency")?(i(),c("td",fo,[s("span",{class:te(p((B=T.response)==null?void 0:B.latencyMs))},C(x((ae=T.response)==null?void 0:ae.latencyMs)),3)])):O("",!0)],10,Ji)}),128)),g.value.length===0?(i(),c("tr",vo,[s("td",{colspan:u.value.length,class:"empty-state"},[r.value.length===0?(i(),c("div",go," No API calls yet. Start the trial to begin execution. ")):(i(),c("div",ho," No results match your filters. "))],8,mo)])):O("",!0)])]))]),d.value?(i(),Y(di,{key:0,visible:!!d.value,"api-call":d.value,trial:n.trial,"onUpdate:visible":R[4]||(R[4]=T=>d.value=null)},null,8,["visible","api-call","trial"])):O("",!0)])}}}),yo=oe(bo,[["__scopeId","data-v-e8c70a25"]]),_o={class:"trial-analysis-view"},To=ie({__name:"TrialAnalysisView",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(a){const e=a;return fe(()=>{const t=performance.now();v.info(`V4_TRIAL_SWITCH: TrialAnalysisView MOUNTED for trial ${e.trial.id}`),ye(()=>{const l=performance.now();v.info(`V4_TRIAL_SWITCH: TrialAnalysisView DOM ready in ${(l-t).toFixed(1)}ms`)}),setTimeout(()=>{const l=performance.now();v.info(`V4_TRIAL_SWITCH: TrialAnalysisView mount completed in ${(l-t).toFixed(1)}ms`)},0)}),Se(()=>{v.info(`V4_TRIAL_SWITCH: TrialAnalysisView ACTIVATED (cache hit) for trial ${e.trial.id}`)}),we(()=>{v.info(`V4_TRIAL_SWITCH: TrialAnalysisView DEACTIVATED (cached) for trial ${e.trial.id}`)}),me(()=>{v.info(`V4_TRIAL_SWITCH: TrialAnalysisView UNMOUNTED (evicted) for trial ${e.trial.id}`)}),(t,l)=>(i(),c("div",_o,[E(yo,{trial:t.trial,progress:t.progress,"is-executing":t.isExecuting,"api-calls":t.apiCalls,"is-streaming":t.isStreaming,"is-loading":t.isLoading},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])]))}}),$o=oe(To,[["__scopeId","data-v-602f5d5a"]]);function Co(a,e){const t=new Set,l=new Set,o=new Set;a.forEach(h=>{h.variables&&Object.keys(h.variables).forEach(g=>t.add(g)),h.variableAttributes&&Object.values(h.variableAttributes).forEach(g=>{g&&Object.keys(g).forEach($=>l.add($))})});const u=Array.from(t).sort(),d=Array.from(l).sort(),b=Array.from(o).sort(),r=[],f=["success","refused","parsed_response",...r,...b];return{categorical:[...u,...d,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens",...r].sort(),extracted:f}}function ke(a,e,t){var l,o,u,d,b,r,f,h,g,$,y,k,_,w,W,P,m,V,x,A,p;switch(e){case"model":return t&&a.configurationIndex<t.configurations.length&&t.configurations[a.configurationIndex].modelId||"Unknown";case"status":return a.status;case"response_time":return((l=a.response)==null?void 0:l.latencyMs)||0;case"total_tokens":if((u=(o=a.response)==null?void 0:o.body)!=null&&u.usage){const I=a.response.body.usage;return I.total_tokens||I.prompt_tokens+I.completion_tokens||0}return 0;case"prompt_tokens":return((r=(b=(d=a.response)==null?void 0:d.body)==null?void 0:b.usage)==null?void 0:r.prompt_tokens)||((g=(h=(f=a.response)==null?void 0:f.body)==null?void 0:h.usage)==null?void 0:g.input_tokens)||0;case"completion_tokens":return((k=(y=($=a.response)==null?void 0:$.body)==null?void 0:y.usage)==null?void 0:k.completion_tokens)||((W=(w=(_=a.response)==null?void 0:_.body)==null?void 0:w.usage)==null?void 0:W.output_tokens)||0;case"error_type":return((P=a.result)==null?void 0:P.errorType)||(((m=a.result)==null?void 0:m.success)===!1?"api_error":"success");case"success":return(V=a.result)!=null&&V.success?1:0;case"refused":return(x=a.result)!=null&&x.refused?1:0;case"parsed_response":if(((A=a.result)==null?void 0:A.parsedContent)!==void 0){const I=a.result.parsedContent;return typeof I=="object"?JSON.stringify(I):I}return null}if(((p=a.variables)==null?void 0:p[e])!==void 0)return a.variables[e];if(a.variableAttributes)for(const I of Object.keys(a.variableAttributes)){const U=a.variableAttributes[I];if(U&&U[e]!==void 0)return U[e]}return null}const Ie={count:{label:"Count",calculate:a=>a.length,format:a=>a.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:a=>{const e=a.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?e.reduce((t,l)=>t+l,0):null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},mean:{label:"Mean",calculate:a=>{const e=a.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?e.reduce((t,l)=>t+l,0)/e.length:null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},median:{label:"Median",calculate:a=>{const e=a.map(o=>typeof o=="number"?o:null).filter(o=>o!==null);if(e.length===0)return null;const t=[...e].sort((o,u)=>o-u),l=Math.floor(t.length/2);return t.length%2===0?(t[l-1]+t[l])/2:t[l]},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},mode:{label:"Mode",calculate:a=>{if(a.length===0)return null;const e=new Map;a.forEach(o=>e.set(o,(e.get(o)||0)+1));let t=0,l=null;return e.forEach((o,u)=>{o>t&&(t=o,l=u)}),{value:l,count:t,total:a.length}},format:a=>a?`${a.value} (${a.count}/${a.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:a=>{const e=a.map(o=>typeof o=="number"?o:null).filter(o=>o!==null);if(e.length<=1)return null;const t=e.reduce((o,u)=>o+u,0)/e.length;return e.reduce((o,u)=>o+Math.pow(u-t,2),0)/(e.length-1)},format:a=>(a==null?void 0:a.toFixed(3))||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:a=>{const e=Ie.variance.calculate(a);return e!==null?Math.sqrt(e):null},format:a=>(a==null?void 0:a.toFixed(3))||"-",needsNumeric:!0},min:{label:"Min",calculate:a=>{const e=a.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?Math.min(...e):null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},max:{label:"Max",calculate:a=>{const e=a.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?Math.max(...e):null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(a,e)=>{const t=e.filter(l=>{var o;return(o=l.result)==null?void 0:o.success}).length;return e.length>0?t/e.length:0},format:a=>`${Math.round(a*100)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(a,e)=>{const t=e.filter(l=>{var o;return(o=l.result)==null?void 0:o.refused}).length;return e.length>0?t/e.length:0},format:a=>`${Math.round(a*100)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(a,e)=>{const t=e.filter(l=>{var o;return(o=l.response)==null?void 0:o.latencyMs}).map(l=>l.response.latencyMs);return t.length>0?t.reduce((l,o)=>l+o,0)/t.length:null},format:a=>a?`${Math.round(a)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function $t(a,e,t){const l=new Map,o=new Set,u=new Set;a.forEach(k=>{const _=String(ke(k,e.rowField,t)||"Unknown"),w=String(ke(k,e.columnField,t)||"Unknown");o.add(_),u.add(w),l.has(_)||l.set(_,new Map),l.get(_).has(w)||l.get(_).set(w,[]),l.get(_).get(w).push(k)});const d=k=>k.every(w=>!isNaN(Number(w))&&w.trim()!=="")?k.sort((w,W)=>Number(w)-Number(W)):k.sort(),b=(k,_)=>(t&&(t.type,t.type),d(k)),r=e.rowSort==="original"?b(Array.from(o),e.rowField):d(Array.from(o)),f=e.columnSort==="original"?b(Array.from(u),e.columnField):d(Array.from(u)),h=Ie[e.aggregation];function g(k){const _=k.map(m=>ke(m,e.valueField,t));if(!h||typeof h.calculate!="function")return v.error("Invalid aggregation function:",e.aggregation,h),{value:null,count:k.length,apiCalls:k,rawValues:_,error:"Invalid aggregation function"};const w={nonNumeric:0,nullUndefined:0};return h.needsNumeric&&(w.nonNumeric=_.filter(m=>typeof m!="number").length),w.nullUndefined=_.filter(m=>m==null).length,{value:h.usesApiCalls?h.calculate(_,k):h.calculate(_),count:k.length,apiCalls:k,rawValues:_,excludedCounts:w}}const $=r.map(k=>{const _=[],w=[];return f.forEach(W=>{var m;const P=((m=l.get(k))==null?void 0:m.get(W))||[];_.push(P.length>0?g(P):null),w.push(...P)}),{label:k,cells:_,total:g(w)}}),y=f.map(k=>{const _=[];return r.forEach(w=>{var P;const W=((P=l.get(w))==null?void 0:P.get(k))||[];_.push(...W)}),g(_)});return{rows:$,columns:f,totals:y,grandTotal:g(a)}}function he(a,e){return!a||a.value===null?"-":Ie[e].format(a.value)}function ko(a,e,t,l=K({}),o={}){const{debounceMs:u=100}=o,d=K({rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}),b=K({categorical:[],numeric:[],extracted:[]}),r=K(!1),f=K(0),h=D(()=>{const k=l.value;return Object.values(k).some(w=>w!=="")?a.value.filter(w=>{var W;if(k.model&&k.model!==""&&(!t.value||w.configurationIndex>=t.value.configurations.length||(t.value.configurations[w.configurationIndex].modelId||"Unknown")!==k.model)||k.status&&k.status!==""&&w.status!==k.status)return!1;for(const[P,m]of Object.entries(k))if(m&&m!==""&&P!=="model"&&P!=="status"&&((W=w.variables)==null?void 0:W[P])!==m)return!1;return!0}):a.value}),g=ze(()=>{if(h.value.length===0){d.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}r.value=!0;const k=performance.now();try{d.value=$t(h.value,e.value,t.value);const _=performance.now()-k;f.value=_,v.debug("Pivot data computed (config change)",{apiCallCount:h.value.length,computeTimeMs:_,rowCount:d.value.rows.length,columnCount:d.value.columns.length})}catch(_){v.error("Error computing pivot data",_)}finally{r.value=!1}},u),$=ze(()=>{if(h.value.length===0){d.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}r.value=!0;const k=performance.now();try{d.value=$t(h.value,e.value,t.value);const _=performance.now()-k;f.value=_,v.debug("Pivot data computed (stream update)",{apiCallCount:h.value.length,computeTimeMs:_,rowCount:d.value.rows.length,columnCount:d.value.columns.length})}catch(_){v.error("Error computing pivot data",_)}finally{r.value=!1}},1e3),y=ze(()=>{b.value=Co(a.value,t.value)},200);return re([e],()=>{$.cancel(),g()},{deep:!0}),re(()=>h.value,(k,_)=>{v.info(`PIVOT_DEBUG: filteredApiCalls changed from ${(_==null?void 0:_.length)||0} to ${k.length}`),$()},{immediate:!1}),re(()=>[a.value,t.value],()=>{v.info("PIVOT_DEBUG: apiCalls or trial changed, updating fields"),y(),$()},{immediate:!1}),y(),g(),{pivotData:D(()=>d.value),availableFields:D(()=>b.value),isComputing:D(()=>r.value),lastComputeTime:D(()=>f.value),formatCellValue:he,extractFieldValue:ke,aggregationFunctions:Ie}}const So={class:"pivot-config-v3"},wo={class:"config-row"},Io={class:"config-group"},Ro=["value","aria-label"],Eo={label:"Categorical"},Vo=["value"],Ao={class:"config-group sort-group"},Oo=["value","aria-label"],Fo={class:"config-group"},Po=["value","aria-label"],Lo={label:"Categorical"},Mo=["value"],Do={class:"config-group sort-group"},xo=["value","aria-label"],Uo={class:"config-group"},No=["value","aria-label"],zo={label:"Extracted Values"},Ho=["value"],Wo={label:"Numeric Fields"},Bo=["value"],jo={class:"config-group"},Go=["value","aria-label"],qo=ie({__name:"PivotConfigurationV3",props:{config:{},availableFields:{}},emits:["update-config"],setup(a,{emit:e}){const t=e;function l(u,d){t("update-config",u,d)}function o(u){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[u]||u.replace(/_/g," ").replace(/\b\w/g,b=>b.toUpperCase())}return(u,d)=>(i(),c("div",So,[s("div",wo,[s("div",Io,[d[6]||(d[6]=s("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),s("select",{id:"pivot-row-field",value:u.config.rowField,"aria-label":"Group rows by "+o(u.config.rowField),onChange:d[0]||(d[0]=b=>l("rowField",b.target.value))},[s("optgroup",Eo,[(i(!0),c(X,null,se(u.availableFields.categorical,b=>(i(),c("option",{key:b,value:b},C(o(b)),9,Vo))),128))])],40,Ro)]),s("div",Ao,[d[8]||(d[8]=s("label",{for:"pivot-row-sort"},"Sort Rows:",-1)),s("select",{id:"pivot-row-sort",value:u.config.rowSort||"original","aria-label":"Sort rows by "+(u.config.rowSort||"original")+" order",onChange:d[1]||(d[1]=b=>l("rowSort",b.target.value))},d[7]||(d[7]=[s("option",{value:"original"},"Original",-1),s("option",{value:"alpha"},"Alphabetical",-1)]),40,Oo)]),s("div",Fo,[d[9]||(d[9]=s("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),s("select",{id:"pivot-column-field",value:u.config.columnField,"aria-label":"Group columns by "+o(u.config.columnField),onChange:d[2]||(d[2]=b=>l("columnField",b.target.value))},[s("optgroup",Lo,[(i(!0),c(X,null,se(u.availableFields.categorical,b=>(i(),c("option",{key:b,value:b},C(o(b)),9,Mo))),128))])],40,Po)]),s("div",Do,[d[11]||(d[11]=s("label",{for:"pivot-column-sort"},"Sort Columns:",-1)),s("select",{id:"pivot-column-sort",value:u.config.columnSort||"original","aria-label":"Sort columns by "+(u.config.columnSort||"original")+" order",onChange:d[3]||(d[3]=b=>l("columnSort",b.target.value))},d[10]||(d[10]=[s("option",{value:"original"},"Original",-1),s("option",{value:"alpha"},"Alphabetical",-1)]),40,xo)]),s("div",Uo,[d[12]||(d[12]=s("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),s("select",{id:"pivot-value-field",value:u.config.valueField,"aria-label":"Aggregate "+u.config.valueField+" values",onChange:d[4]||(d[4]=b=>l("valueField",b.target.value))},[s("optgroup",zo,[(i(!0),c(X,null,se(u.availableFields.extracted,b=>(i(),c("option",{key:b,value:b},C(b),9,Ho))),128))]),s("optgroup",Wo,[(i(!0),c(X,null,se(u.availableFields.numeric,b=>(i(),c("option",{key:b,value:b},C(o(b)),9,Bo))),128))])],40,No)]),s("div",jo,[d[14]||(d[14]=s("label",{for:"pivot-aggregation"},"Aggregation:",-1)),s("select",{id:"pivot-aggregation",value:u.config.aggregation,"aria-label":"Aggregation method: "+u.config.aggregation,onChange:d[5]||(d[5]=b=>l("aggregation",b.target.value))},d[13]||(d[13]=[It('<optgroup label="Statistical" data-v-0d3a0d50><option value="mean" data-v-0d3a0d50>Mean</option><option value="median" data-v-0d3a0d50>Median</option><option value="variance" data-v-0d3a0d50>Variance</option><option value="std_dev" data-v-0d3a0d50>Std Dev</option><option value="min" data-v-0d3a0d50>Min</option><option value="max" data-v-0d3a0d50>Max</option><option value="sum" data-v-0d3a0d50>Sum</option></optgroup><optgroup label="Frequency" data-v-0d3a0d50><option value="count" data-v-0d3a0d50>Count</option><option value="mode" data-v-0d3a0d50>Mode</option></optgroup><optgroup label="Performance" data-v-0d3a0d50><option value="success_rate" data-v-0d3a0d50>Success Rate</option><option value="refusal_rate" data-v-0d3a0d50>Refusal Rate</option><option value="avg_time" data-v-0d3a0d50>Avg Time</option></optgroup>',3)]),40,Go)])])]))}}),Ko=oe(qo,[["__scopeId","data-v-0d3a0d50"]]),Qo={class:"heatmap-controls-v3"},Jo={class:"color-scale-selector"},Xo=["value","aria-label"],Yo={class:"gradient-mode-selector"},Zo={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},er=["aria-pressed"],tr=["aria-pressed"],sr=["aria-pressed"],ar=["title","aria-label"],nr=ie({__name:"PivotHeatmapV3",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(a,{emit:e}){const t=e;function l(u){const d=u.target.value;t("update-color-scale",d)}function o(u){t("update-gradient-mode",u)}return(u,d)=>(i(),c("div",Qo,[s("div",Jo,[d[5]||(d[5]=s("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),s("select",{id:"heatmap-color-scale",value:u.selectedColorScale,"aria-label":"Color scale: "+u.selectedColorScale,onChange:l},d[4]||(d[4]=[It('<option value="blue-subtle" data-v-dcb6369b>Blue (Subtle)</option><option value="green-red" data-v-dcb6369b>Green-Red (Success)</option><option value="blue-yellow" data-v-dcb6369b>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-dcb6369b>Purple-Orange (General)</option><option value="viridis" data-v-dcb6369b>Viridis</option><option value="inferno" data-v-dcb6369b>Inferno</option><option value="magma" data-v-dcb6369b>Magma</option><option value="plasma" data-v-dcb6369b>Plasma</option><option value="grayscale" data-v-dcb6369b>Grayscale</option>',9)]),40,Xo)]),s("div",Yo,[d[6]||(d[6]=s("label",null,"Gradient Mode:",-1)),s("div",Zo,[s("button",{type:"button",class:te(["toggle-btn",{active:u.gradientMode==="global"}]),"aria-pressed":u.gradientMode==="global",onClick:d[0]||(d[0]=b=>o("global"))}," Global ",10,er),s("button",{type:"button",class:te(["toggle-btn",{active:u.gradientMode==="column"}]),"aria-pressed":u.gradientMode==="column",onClick:d[1]||(d[1]=b=>o("column"))}," Per Column ",10,tr),s("button",{type:"button",class:te(["toggle-btn",{active:u.gradientMode==="row"}]),"aria-pressed":u.gradientMode==="row",onClick:d[2]||(d[2]=b=>o("row"))}," Per Row ",10,sr)])]),s("button",{type:"button",class:"fullscreen-btn",title:u.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":u.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:d[3]||(d[3]=b=>u.$emit("toggle-fullscreen"))},C(u.isFullscreen?"âŠŸ":"âŠž"),9,ar)]))}}),lr=oe(nr,[["__scopeId","data-v-dcb6369b"]]),ir={class:"pivot-filters-v3"},or={class:"filters-row"},rr={key:0,class:"filter-group"},ur=["value"],dr=["value"],cr=["for"],pr=["id","value","aria-label","onChange"],fr={value:""},vr=["value"],mr={key:1,class:"filter-group"},gr=["value"],hr=["value"],br=ie({__name:"PivotFiltersV3",props:{apiCalls:{},trial:{},activeFilters:{}},emits:["update-filters","clear-filters"],setup(a,{emit:e}){const t=a,l=e,o=K({});let u=0;const d=()=>{if(t.apiCalls.length===0){o.value={};return}const g={};t.apiCalls.forEach(y=>{if(t.trial&&y.configurationIndex<t.trial.configurations.length){const _=t.trial.configurations[y.configurationIndex].modelId||"Unknown";g.model||(g.model=new Set),g.model.add(_)}y.status&&(g.status||(g.status=new Set),g.status.add(y.status)),y.variables&&Object.entries(y.variables).forEach(([k,_])=>{_&&String(_).trim()&&(g[k]||(g[k]=new Set),g[k].add(String(_)))})});const $={};Object.entries(g).forEach(([y,k])=>{$[y]=Array.from(k).sort()}),o.value=$};re(()=>t.apiCalls.length,g=>{(g===0||u===0||g-u>=5)&&(d(),u=g)},{immediate:!0});const b=D(()=>{const{model:g,status:$,...y}=o.value;return y}),r=D(()=>Object.values(t.activeFilters).some(g=>g!==""));function f(g){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[g]||g.replace(/_/g," ").replace(/\b\w/g,y=>y.toUpperCase())}function h(g,$){const y={...t.activeFilters};$===""?delete y[g]:y[g]=$,l("update-filters",y)}return(g,$)=>(i(),c("div",ir,[s("div",or,[o.value.model&&o.value.model.length>1?(i(),c("div",rr,[$[4]||($[4]=s("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),s("select",{id:"filter-model",value:g.activeFilters.model||"",class:"filter-select","aria-label":"Filter by model",onChange:$[0]||($[0]=y=>h("model",y.target.value))},[$[3]||($[3]=s("option",{value:""},"All Models",-1)),(i(!0),c(X,null,se(o.value.model,y=>(i(),c("option",{key:y,value:y},C(y),9,dr))),128))],40,ur)])):O("",!0),(i(!0),c(X,null,se(b.value,(y,k)=>(i(),c("div",{key:k,class:"filter-group"},[s("label",{for:`filter-${k}`,class:"filter-label"},C(f(String(k)))+": ",9,cr),s("select",{id:`filter-${k}`,value:g.activeFilters[k]||"",class:"filter-select","aria-label":`Filter by ${f(String(k))}`,onChange:_=>h(k,_.target.value)},[s("option",fr,"All "+C(f(String(k))),1),(i(!0),c(X,null,se(y,_=>(i(),c("option",{key:_,value:_},C(_),9,vr))),128))],40,pr)]))),128)),o.value.status&&o.value.status.length>1?(i(),c("div",mr,[$[6]||($[6]=s("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),s("select",{id:"filter-status",value:g.activeFilters.status||"",class:"filter-select","aria-label":"Filter by status",onChange:$[1]||($[1]=y=>h("status",y.target.value))},[$[5]||($[5]=s("option",{value:""},"All Statuses",-1)),(i(!0),c(X,null,se(o.value.status,y=>(i(),c("option",{key:y,value:y},C(y),9,hr))),128))],40,gr)])):O("",!0),r.value?(i(),c("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:$[2]||($[2]=y=>g.$emit("clear-filters"))}," Clear Filters ")):O("",!0)])]))}}),yr=oe(br,[["__scopeId","data-v-7e1a1f6a"]]),_r={class:"collapse-icon"},Tr={class:"options-content"},$r={class:"controls-row"},Cr={key:0,class:"performance-info"},kr={class:"table-view"},Sr={key:0,class:"empty-state","data-testid":"empty-data-message"},wr={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},Ir={key:2,class:"loading-state","data-testid":"computing-state"},Rr={key:3,class:"pivot-table-container"},Er={class:"pivot-table-grid responsive-table",role:"table"},Vr={role:"row"},Ar={class:"corner-cell",role:"columnheader"},Or={key:0,class:"total-header",role:"columnheader"},Fr={class:"row-header",role:"rowheader"},Pr=["data-testid","title","aria-label","role","onClick","onKeydown"],Lr={key:0,class:"cell-content"},Mr=["title"],Dr={class:"cell-value"},xr={class:"error-message"},Ur={key:1},Nr=ie({__name:"PivotTableV3",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0},showPerformanceInfo:{type:Boolean,default:!1}},emits:["config-change","cell-click"],setup(a,{emit:e}){var S,Z,de,pe,Re,Ee;const t=a,l=e,o=K(!1),u=K("viridis"),d=K("global"),b=K(!1),r=K({rowField:((S=t.config)==null?void 0:S.rowField)||"",columnField:((Z=t.config)==null?void 0:Z.columnField)||"",valueField:((de=t.config)==null?void 0:de.valueField)||"",aggregation:((pe=t.config)==null?void 0:pe.aggregation)||"mean",rowSort:((Re=t.config)==null?void 0:Re.rowSort)||"original",columnSort:((Ee=t.config)==null?void 0:Ee.columnSort)||"original"});re(()=>t.config,j=>{j&&Object.assign(r.value,j)},{deep:!0});const f=K({}),h=Ue(),g=D(()=>h.apiCalls?h.apiCalls.value||[]:t.apiCalls||[]),$=g,y=D(()=>t.trial),{pivotData:k,availableFields:_,isComputing:w,lastComputeTime:W}=ko($,r,y,f,{debounceMs:750});re(k,(j,q)=>{var M,J;const G=performance.now(),Q=((M=j==null?void 0:j.rows)==null?void 0:M.length)||0,F=((J=j==null?void 0:j.columns)==null?void 0:J.length)||0;v.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData computed: ${Q}x${F} matrix`),setTimeout(()=>{const ne=performance.now();v.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData render completed in ${(ne-G).toFixed(1)}ms`)},0)}),re(w,j=>{j?v.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING STARTED with ${g.value.length} API calls`):v.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING FINISHED in ${W.value.toFixed(1)}ms`)}),re(g,(j,q)=>{const G=performance.now();v.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls changed from ${(q==null?void 0:q.length)||0} to ${j.length} calls`),setTimeout(()=>{const Q=performance.now();v.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls prop update completed in ${(Q-G).toFixed(1)}ms`)},0)});const P=D(()=>k.value.rows.slice(0,t.maxTableRows)),m=D(()=>Object.values(f.value).some(q=>q!=="")?g.value.filter(q=>{var G;if(f.value.model&&f.value.model!==""&&(!t.trial||q.configurationIndex>=t.trial.configurations.length||(t.trial.configurations[q.configurationIndex].modelId||"Unknown")!==f.value.model)||f.value.status&&f.value.status!==""&&q.status!==f.value.status)return!1;for(const[Q,F]of Object.entries(f.value))if(F&&F!==""&&Q!=="model"&&Q!=="status"&&((G=q.variables)==null?void 0:G[Q])!==F)return!1;return!0}).length:g.value.length),{getCellStyle:V,getSummaryStyle:x,styleKey:A}=ys(k,u,d);function p(j){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[j]||j.replace(/_/g," ").replace(/\b\w/g,G=>G.toUpperCase())}function I(j,q,G){if(!G)return`${j} Ã— ${q}: No data`;const Q=he(G,r.value.aggregation);let F=`${j} Ã— ${q}: ${Q} (${G.count} calls)`;if(G.excludedCounts){const M=[];G.excludedCounts.nonNumeric>0&&M.push(`${G.excludedCounts.nonNumeric} non-numeric responses excluded`),G.excludedCounts.nullUndefined>0&&M.push(`${G.excludedCounts.nullUndefined} null/empty responses`),M.length>0&&(F+=` | ${M.join(", ")}`)}return G.error&&(F+=` - ERROR: ${G.error}`),F}function U(j,q,G){if(!G)return`${j} by ${q}: No data`;const Q=he(G,r.value.aggregation);return G.error?`${j} by ${q}: ${Q} with data integrity error: ${G.error}`:`${j} by ${q}: ${Q} from ${G.count} API calls`}function n(j,q){(j==="rowField"||j==="columnField"||j==="valueField"||j==="aggregation"||j==="rowSort"||j==="columnSort")&&(r.value[j]=q),l("config-change",{...r.value})}function R(j){f.value={...j}}function N(){f.value={}}function T(j,q,G){G&&l("cell-click",{row:j,column:q,cell:G})}function B(){b.value=!b.value}function ae(){o.value=!o.value,o.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return fe(()=>{var q;const j=performance.now();v.info(`V4_TRIAL_SWITCH: PivotTableV3 MOUNTED for trial ${((q=t.trial)==null?void 0:q.id)||"unknown"} with ${g.value.length} calls`),ye(()=>{const G=performance.now();v.info(`V4_TRIAL_SWITCH: PivotTableV3 DOM ready in ${(G-j).toFixed(1)}ms`)}),setTimeout(()=>{const G=performance.now();v.info(`V4_TRIAL_SWITCH: PivotTableV3 mount completed in ${(G-j).toFixed(1)}ms`)},0)}),Se(()=>{var j;v.info(`V4_TRIAL_SWITCH: PivotTableV3 ACTIVATED (cache hit) for trial ${((j=t.trial)==null?void 0:j.id)||"unknown"} with ${g.value.length} calls`)}),we(()=>{var j;v.info(`V4_TRIAL_SWITCH: PivotTableV3 DEACTIVATED (cached) for trial ${((j=t.trial)==null?void 0:j.id)||"unknown"}`)}),me(()=>{var j;v.info(`V4_TRIAL_SWITCH: PivotTableV3 UNMOUNTED (evicted) for trial ${((j=t.trial)==null?void 0:j.id)||"unknown"}`),o.value&&(document.body.style.overflow="")}),re([_,g],([j])=>{if(g.value.length>0&&(!r.value.rowField||r.value.rowField==="")&&j.categorical.length>0){if(r.value.rowField=j.categorical.find(q=>q!=="model"&&q!=="status"&&q!=="error_type")||j.categorical[0]||"model",r.value.columnField=r.value.columnField||"model",r.value.valueField=r.value.valueField||"parsed_response",!r.value.aggregation||r.value.aggregation===""){const q=g.value.slice(0,3).map(Q=>ke(Q,r.value.valueField,t.trial)).filter(Q=>Q!=null),G=q.length>0&&q.every(Q=>typeof Q=="number");r.value.aggregation=G?"mean":"mode"}l("config-change",{...r.value})}},{immediate:!0}),(j,q)=>(i(),c("div",{class:te(["pivot-table-v3",{fullscreen:o.value}])},[s("div",{class:te(["pivot-options-container",{collapsed:b.value}])},[s("div",{class:"options-header",onClick:B},[q[3]||(q[3]=s("span",{class:"options-title"},"Pivot Table Options",-1)),s("span",_r,C(b.value?"â–¶":"â–¼"),1)]),$e(s("div",Tr,[is([z(_),r.value],()=>(i(),c("div",null,[E(Ko,{config:r.value,"available-fields":z(_),onUpdateConfig:n},null,8,["config","available-fields"])])),q,0),s("div",$r,[g.value.length>0?(i(),Y(yr,{key:0,"api-calls":g.value,trial:j.trial,"active-filters":f.value,onUpdateFilters:R,onClearFilters:N},null,8,["api-calls","trial","active-filters"])):O("",!0),E(lr,{"selected-color-scale":u.value,"gradient-mode":d.value,"is-fullscreen":o.value,onUpdateColorScale:q[1]||(q[1]=G=>u.value=G),onUpdateGradientMode:q[2]||(q[2]=G=>d.value=G),onToggleFullscreen:ae},null,8,["selected-color-scale","gradient-mode","is-fullscreen"])])],512),[[Rt,!b.value]])],2),j.showPerformanceInfo?(i(),c("div",Cr,[s("span",null,"Computing: "+C(z(w)?"Yes":"No"),1),s("span",null,"Last Compute: "+C(z(W).toFixed(1))+"ms",1),s("span",null,"API Calls: "+C(g.value.length),1),s("span",null,"Filtered: "+C(m.value),1)])):O("",!0),s("div",kr,[g.value.length===0?(i(),c("div",Sr,q[4]||(q[4]=[s("p",null,"No data available for pivot table analysis.",-1)]))):r.value.aggregation in z(Ie)?z(w)?(i(),c("div",Ir,q[6]||(q[6]=[s("p",null,"Computing pivot table...",-1)]))):(i(),c("div",Rr,[s("table",Er,[s("thead",null,[s("tr",Vr,[s("th",Ar,C(p(r.value.rowField)||"Items")+" / "+C(p(r.value.columnField)||"Aggregated"),1),(i(!0),c(X,null,se(z(k).columns,G=>(i(),c("th",{key:G,class:"column-header",role:"columnheader"},C(G),1))),128)),r.value.columnField&&j.showTotals?(i(),c("th",Or," Total ")):O("",!0)])]),s("tbody",null,[(i(!0),c(X,null,se(P.value,G=>(i(),c("tr",{key:`${G.label}-${z(A)}`,class:"data-row",role:"row"},[s("td",Fr,C(G.label),1),(i(!0),c(X,null,se(G.cells,(Q,F)=>(i(),c("td",{key:`${F}-${z(A)}`,class:te(["data-cell",{"error-cell":Q==null?void 0:Q.error}]),"data-testid":Q!=null&&Q.error?"pivot-cell-error":"pivot-cell",style:ve(z(V)(Q,G.label,F)),title:I(G.label,z(k).columns[F],Q),"aria-label":U(G.label,z(k).columns[F],Q),role:Q!=null&&Q.error?"alert":"cell",tabindex:"0",onClick:M=>T(G.label,z(k).columns[F],Q),onKeydown:[We(M=>T(G.label,z(k).columns[F],Q),["enter"]),We(Et(M=>T(G.label,z(k).columns[F],Q),["prevent"]),["space"])]},[Q!=null&&Q.error?(i(),c("div",Lr,[s("span",{class:"error-indicator",title:Q.error},"âš ï¸",8,Mr),s("span",Dr,C(Q?z(he)(Q,r.value.aggregation):"-"),1),s("div",xr,C(Q.error),1)])):(i(),c("span",Ur,C(Q?z(he)(Q,r.value.aggregation):"-"),1))],46,Pr))),128)),r.value.columnField&&j.showTotals?(i(),c("td",{key:0,class:"total-cell",style:ve(z(x)(G.total)),role:"cell"},C(z(he)(G.total,r.value.aggregation)),5)):O("",!0)]))),128)),r.value.rowField&&j.showTotals?(i(),c("tr",{key:`totals-${z(A)}`,class:"total-row",role:"row"},[q[7]||(q[7]=s("td",{class:"row-header",role:"rowheader"},"Total",-1)),(i(!0),c(X,null,se(z(k).totals,(G,Q)=>(i(),c("td",{key:`total-${Q}-${z(A)}`,class:"total-cell",style:ve(z(x)(G)),role:"cell"},C(z(he)(G,r.value.aggregation)),5))),128)),r.value.columnField?(i(),c("td",{key:0,class:"grand-total-cell",style:ve(z(x)(z(k).grandTotal)),role:"cell"},C(z(he)(z(k).grandTotal,r.value.aggregation)),5)):O("",!0)])):O("",!0)])])])):(i(),c("div",wr,[s("p",null,"Invalid aggregation function: "+C(r.value.aggregation),1),q[5]||(q[5]=s("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),zr=oe(Nr,[["__scopeId","data-v-a13bd12e"]]),Hr={class:"modal-content"},Wr={class:"modal-header"},Br={class:"modal-title"},jr={class:"summary-row"},Gr={key:0},qr={key:0,class:"filter-row"},Kr=["onUpdate:modelValue","aria-label"],Qr={value:""},Jr=["value"],Xr={class:"table-container"},Yr={class:"api-calls-table"},Zr=["title"],eu=["title"],tu=ie({__name:"PivotCellDetailV3",props:{visible:{type:Boolean},row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(a){const e=a,t=os({}),l=D(()=>{const m=new Set;return e.apiCalls.forEach(V=>{V.variables&&Object.keys(V.variables).forEach(x=>m.add(x)),V.attributedVariables&&Object.entries(V.attributedVariables).forEach(([x,A])=>{A&&typeof A=="object"&&Object.keys(A).forEach(p=>{m.add(`${x}.${p}`)})})}),Array.from(m).sort()}),o=D(()=>l.value.map(m=>({title:m,dataIndex:`var_${m}`,key:`var_${m}`,width:150}))),u=[{title:"Status",dataIndex:"status",key:"status",width:100},{title:"Model",dataIndex:"model",key:"model",width:150}],d=[{title:"Response",dataIndex:"response",key:"response",width:300},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150},{title:"Duration",dataIndex:"duration",key:"duration",width:100},{title:"Cost",dataIndex:"cost",key:"cost",width:100}],b=D(()=>[...u,...o.value,...d]),r=D(()=>`${e.row} Ã— ${e.column} - ${e.apiCalls.length} API Calls`),f=D(()=>e.apiCalls.map(m=>{var x,A;const V={id:m.id,status:m.status,model:m.model||"-",response:((x=m.result)==null?void 0:x.content)||((A=m.result)==null?void 0:A.error)||"-",extracted:m.extracted||"-",duration:m.duration?`${m.duration}ms`:"-",cost:m.cost||0};return l.value.forEach(p=>{var I,U,n;if(p.includes(".")){const[R,N]=p.split("."),T=(U=(I=m.attributedVariables)==null?void 0:I[R])==null?void 0:U[N];V[`var_${p}`]=T!==void 0?String(T):"-"}else V[`var_${p}`]=((n=m.variables)==null?void 0:n[p])||"-"}),V})),h=D(()=>Object.values(t).some(m=>m!==void 0&&m!=="")),g=D(()=>h.value?f.value.filter(m=>Object.entries(t).every(([V,x])=>x?m[V]===x:!0)):f.value),$=D(()=>{const m=e.apiCalls.filter(V=>V.status==="completed").length;return Math.round(m/e.apiCalls.length*100)}),y=D(()=>{const m=e.apiCalls.filter(V=>V.duration).map(V=>V.duration);return m.length===0?0:Math.round(m.reduce((V,x)=>V+x,0)/m.length)}),k=D(()=>e.apiCalls.filter(V=>V.cost).map(V=>V.cost).reduce((V,x)=>V+x,0));function _(m){switch(m){case"completed":return"status-success";case"failed":return"status-error";case"pending":return"status-warning";case"running":return"status-processing";default:return"status-default"}}function w(m,V){return m?m.length<=V?m:m.slice(0,V)+"...":""}function W(m){const V=new Set;return f.value.forEach(x=>{const A=x[m];A&&A!=="-"&&V.add(A)}),Array.from(V).sort()}function P(){Object.keys(t).forEach(m=>{delete t[m]})}return(m,V)=>(i(),c("div",{class:te(["pivot-cell-detail-modal-v3",{visible:m.visible}]),onClick:V[1]||(V[1]=Et(x=>m.$emit("close"),["self"]))},[s("div",Hr,[s("div",Wr,[s("h3",Br,C(r.value),1),s("button",{type:"button",class:"close-btn","aria-label":"Close modal",onClick:V[0]||(V[0]=x=>m.$emit("close"))}," Ã— ")]),s("div",jr,[s("span",null,[V[2]||(V[2]=s("b",null,"Total:",-1)),H(" "+C(m.apiCalls.length),1)]),s("span",null,[V[3]||(V[3]=s("b",null,"Success Rate:",-1)),H(" "+C($.value)+"%",1)]),s("span",null,[V[4]||(V[4]=s("b",null,"Avg Duration:",-1)),H(" "+C(y.value)+"ms",1)]),k.value>0?(i(),c("span",Gr,[V[5]||(V[5]=s("b",null,"Total Cost:",-1)),H(" $"+C(k.value),1)])):O("",!0)]),o.value.length>0?(i(),c("div",qr,[(i(!0),c(X,null,se(o.value,x=>(i(),c("div",{key:x.key,class:"variable-filter"},[$e(s("select",{"onUpdate:modelValue":A=>t[x.key]=A,"aria-label":`Filter ${x.title}`,class:"filter-select"},[s("option",Qr,"All "+C(x.title),1),(i(!0),c(X,null,se(W(x.key),A=>(i(),c("option",{key:A,value:A},C(A),9,Jr))),128))],8,Kr),[[rs,t[x.key]]])]))),128)),h.value?(i(),c("button",{key:0,type:"button",class:"clear-filters-btn",onClick:P}," Clear Filters ")):O("",!0)])):O("",!0),s("div",Xr,[s("table",Yr,[s("thead",null,[s("tr",null,[(i(!0),c(X,null,se(b.value,x=>(i(),c("th",{key:x.key,class:"table-header",style:ve({width:x.width?`${x.width}px`:"auto"})},C(x.title),5))),128))])]),s("tbody",null,[(i(!0),c(X,null,se(g.value,x=>(i(),c("tr",{key:x.id,class:"table-row"},[(i(!0),c(X,null,se(b.value,A=>(i(),c("td",{key:A.key,class:te(["table-cell",{"status-cell":A.key==="status"}])},[A.key==="status"?(i(),c("span",{key:0,class:te(["status-tag",_(x.status)])},C(x.status),3)):A.key==="response"?(i(),c("span",{key:1,class:"response-cell",title:x.response},C(w(x.response,100)),9,Zr)):A.key==="cost"?(i(),c(X,{key:2},[H(C(x.cost===0?"-":`$${x.cost.toFixed(4)}`),1)],64)):A.key.startsWith("var_")?(i(),c("span",{key:3,class:"variable-cell",title:x[A.key]},C(x[A.key]||"-"),9,eu)):(i(),c(X,{key:4},[H(C(x[A.key]||"-"),1)],64))],2))),128))]))),128))])])])])],2))}}),su=oe(tu,[["__scopeId","data-v-925c111e"]]),au={class:"trial-tab-content"},nu={class:"tab-pane-content"},lu={class:"tab-pane-content"},iu={key:0,class:"no-data-message"},ou={class:"tab-pane-content"},Ct="trial-details-active-tab",ru=ie({__name:"TrialTabContentV3",props:{trial:{},progress:{},isLeader:{type:Boolean},executionState:{}},setup(a){const e=a,t=Vt(),l=Ye(),o=Ue(),u=D(()=>{var P;return((P=o.apiCalls)==null?void 0:P.value)||[]}),d=D(()=>{var P;return((P=o.isStreaming)==null?void 0:P.value)||!1});re(u,(P,m)=>{const V=performance.now();v.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls changed from ${(m==null?void 0:m.length)||0} to ${P.length} calls`),setTimeout(()=>{const x=performance.now();v.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls reactive update completed in ${(x-V).toFixed(1)}ms`)},0)});const b=D(()=>!1),f=K((()=>{const P=t.query.tab;if(P==="status")return"details";if(P&&["details","tasks","pivot"].includes(P))return P;const m=localStorage.getItem("trial-details-active-tab");return m==="status"?"details":m&&["details","tasks","pivot"].includes(m)?m:"tasks"})()),h=K(!1),g=K(!1),$=K({row:"",column:"",apiCalls:[],value:null}),y=D(()=>e.executionState.status==="executing"&&e.executionState.currentTrialId===e.trial.id),k=D(()=>e.trial.progress.completed>0);function _(){localStorage.setItem(Ct,f.value);const P={...t.query};P.tab=f.value,t.query.tab!==f.value&&(l.replace({query:P}),v.info(`TAB_ROUTING: Updated URL tab parameter to '${f.value}'`))}function w(){const P=localStorage.getItem(Ct);P==="status"?f.value="details":P&&["details","tasks","pivot"].includes(P)&&(f.value=P)}function W(P){!P.cell||!P.cell.apiCalls.length||($.value={row:P.row,column:P.column,apiCalls:P.cell.apiCalls,value:P.cell.value},g.value=!0)}return re(f,()=>{_()}),re(()=>t.query.tab,P=>{if(P&&typeof P=="string"){let m=P==="status"?"details":P;["details","tasks","pivot"].includes(m)&&f.value!==m&&(f.value=m,v.info(`TAB_ROUTING: Synced tab to URL parameter '${m}'`))}}),fe(()=>{const P=performance.now();if(v.info(`V4_TRIAL_SWITCH: TrialTabContentV3 MOUNTED for trial ${e.trial.id}`),!t.query.tab){const m={...t.query};m.tab=f.value,l.replace({query:m}),v.info(`TAB_ROUTING: Set initial URL tab parameter to '${f.value}'`)}w(),setTimeout(()=>{const m=performance.now();v.info(`V4_TRIAL_SWITCH: TrialTabContentV3 mount completed in ${(m-P).toFixed(1)}ms`)},0)}),Se(()=>{v.info(`V4_TRIAL_SWITCH: TrialTabContentV3 ACTIVATED (cache hit) for trial ${e.trial.id}`)}),we(()=>{v.info(`V4_TRIAL_SWITCH: TrialTabContentV3 DEACTIVATED (cached) for trial ${e.trial.id}`)}),me(()=>{v.info(`V4_TRIAL_SWITCH: TrialTabContentV3 UNMOUNTED (evicted) for trial ${e.trial.id}`)}),(P,m)=>{const V=ee("a-tab-pane"),x=ee("a-tabs");return i(),c("div",au,[E(x,{activeKey:f.value,"onUpdate:activeKey":m[1]||(m[1]=A=>f.value=A),type:"card",class:"trial-tabs"},{default:L(()=>[E(V,{key:"tasks",tab:"Task View"},{default:L(()=>[s("div",nu,[(i(),Y(Ge,null,[E($o,{trial:P.trial,progress:P.progress,"is-executing":y.value,"api-calls":u.value,"is-streaming":d.value,"is-loading":b.value},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])],1024))])]),_:1}),E(V,{key:"pivot",tab:"Pivot Table"},{default:L(()=>[s("div",lu,[(i(),Y(Ge,null,[k.value&&u.value.length>0?(i(),Y(zr,{key:0,"api-calls":u.value,trial:P.trial,"show-performance-info":!1,onCellClick:W},null,8,["api-calls","trial"])):O("",!0)],1024)),k.value&&u.value.length>0?O("",!0):(i(),c("div",iu,m[3]||(m[3]=[s("p",null,"No completed API calls available for pivot analysis.",-1),s("p",null,"Run the trial to see pivot table data.",-1)])))])]),_:1}),E(V,{key:"details",tab:"Details"},{default:L(()=>[s("div",ou,[E(el,{trial:P.trial,"is-collapsed":h.value,onToggleCollapse:m[0]||(m[0]=A=>h.value=!h.value)},null,8,["trial","is-collapsed"])])]),_:1})]),_:1},8,["activeKey"]),g.value?(i(),Y(su,{key:0,visible:g.value,row:$.value.row,column:$.value.column,"api-calls":$.value.apiCalls,trial:P.trial,value:$.value.value,onClose:m[2]||(m[2]=A=>g.value=!1)},null,8,["visible","row","column","api-calls","trial","value"])):O("",!0)])}}}),uu=oe(ru,[["__scopeId","data-v-15a83d72"]]),du={class:"export-content"},cu={class:"section"},pu={class:"section"},fu={class:"field-actions"},vu={class:"field-groups"},mu={class:"field-group"},gu={class:"field-list"},hu={class:"field-group"},bu={class:"field-list"},yu={class:"field-group"},_u={class:"field-list"},Tu={class:"field-group"},$u={class:"field-list"},Cu={class:"field-group"},ku={class:"field-list"},Su={key:0,class:"field-group"},wu={class:"field-list"},Iu={key:1,class:"field-group"},Ru={class:"field-list"},Eu={class:"section"},Vu={class:"preview-info"},Au={class:"info-item"},Ou={class:"value"},Fu={class:"info-item"},Pu={class:"value"},Lu={class:"info-item"},Mu={class:"value"},Du={class:"export-actions"},xu=ie({__name:"ExportDataModalV3",props:{visible:{type:Boolean},trial:{}},emits:["update:visible"],setup(a,{emit:e}){const t=a,l=e,o=Xe(),u=K("csv"),d=K(["order","status","configuration","prompt","response","latency"]),b=K(!1),r=K({}),f=K([]),h=K([]),g=K([]),$=["order","status","configuration","prompt","response","latency"],y=K([]),k=["id","order","status","created","completed","configuration","provider","modelId","parameters","prompt","variables","response","parsedResponse","latency","promptTokens","completionTokens","totalTokens","cost","request","response_raw","error","repeatIndex"],_=D(()=>{var R,N;const U=((R=t.trial.progress)==null?void 0:R.completed)||0,n=((N=t.trial.progress)==null?void 0:N.failed)||0;return U+n}),w=D(()=>{const n=d.value.length*50*_.value;return n<1024?`${n} B`:n<1024*1024?`${(n/1024).toFixed(1)} KB`:`${(n/(1024*1024)).toFixed(1)} MB`});function W(){v.info("EXPORT_DEBUG: ExportModal initializeFieldSelection with allFields",y.value.length),y.value.forEach(R=>{r.value[R]=!1}),$.forEach(R=>{r.value[R]=!0});const U=h.value.map(R=>R.id),n=g.value.map(R=>R.id);U.forEach(R=>{r.value[R]=!0}),n.forEach(R=>{r.value[R]=!0}),v.info("EXPORT_DEBUG: ExportModal default selection includes",{standardDefaults:$.length,parameterDefaults:U.length,variableDefaults:n.length,totalDefaults:$.length+U.length+n.length}),P()}function P(){d.value=y.value.filter(U=>r.value[U])}function m(U,n){r.value[U]=n,P()}function V(){y.value.forEach(U=>{r.value[U]=!0}),P()}function x(){y.value.forEach(R=>{r.value[R]=!1}),$.forEach(R=>{r.value[R]=!0});const U=h.value.map(R=>R.id),n=g.value.map(R=>R.id);U.forEach(R=>{r.value[R]=!0}),n.forEach(R=>{r.value[R]=!0}),P()}function A(){y.value.forEach(U=>{r.value[U]=!1}),P()}function p(){l("update:visible",!1)}async function I(){if(d.value.length===0){le.warning("Please select at least one field to export");return}b.value=!0;try{const U={format:u.value,fields:d.value,includeHeaders:!0,addBOM:u.value==="excel"||u.value==="csv"},n=await o.dataExport.exportTrialData(t.trial.id,U);n.ok?(le.success("Export completed successfully"),l("update:visible",!1)):le.error(`Export failed: ${n.error.message}`)}catch(U){le.error("Export failed: "+U.message)}finally{b.value=!1}}return fe(async()=>{v.info("EXPORT_DEBUG: ExportModal discovering available fields for trial",t.trial.id);const U=await o.dataExport.getAvailableFields(t.trial.id);if(U.ok){f.value=U.value.standardFields,h.value=U.value.parameterFields,g.value=U.value.variableFields||[];const n=U.value.standardFields.map(T=>T.id).filter(T=>T!=="parameters"&&T!=="variables"),R=U.value.parameterFields.map(T=>T.id),N=(U.value.variableFields||[]).map(T=>T.id);y.value=[...n,...R,...N],v.info("EXPORT_DEBUG: ExportModal discovered fields",{standardFields:U.value.standardFields.length,parameterFields:U.value.parameterFields.length,variableFields:(U.value.variableFields||[]).length,totalFields:y.value.length,parameterFieldNames:U.value.parameterFields.map(T=>T.id),variableFieldNames:(U.value.variableFields||[]).map(T=>T.id),allFieldNames:y.value})}else v.info("EXPORT_DEBUG: ExportModal field discovery failed",U.error),y.value=[...k];W()}),(U,n)=>{const R=ee("a-radio-button"),N=ee("a-radio-group"),T=ee("a-button"),B=ee("a-checkbox"),ae=ee("a-modal");return i(),Y(ae,{visible:U.visible,"onUpdate:visible":n[45]||(n[45]=S=>U.$emit("update:visible",S)),title:"Export Trial Data",width:800,footer:null,"destroy-on-close":!0,class:"export-data-modal"},{default:L(()=>[s("div",du,[s("div",cu,[n[51]||(n[51]=s("h4",null,"Export Format",-1)),E(N,{value:u.value,"onUpdate:value":n[0]||(n[0]=S=>u.value=S),class:"format-options"},{default:L(()=>[E(R,{value:"csv"},{default:L(()=>n[46]||(n[46]=[H("CSV")])),_:1,__:[46]}),E(R,{value:"tsv"},{default:L(()=>n[47]||(n[47]=[H("TSV")])),_:1,__:[47]}),E(R,{value:"excel"},{default:L(()=>n[48]||(n[48]=[H("Excel")])),_:1,__:[48]}),E(R,{value:"json"},{default:L(()=>n[49]||(n[49]=[H("JSON")])),_:1,__:[49]}),E(R,{value:"jsonl"},{default:L(()=>n[50]||(n[50]=[H("JSONL")])),_:1,__:[50]})]),_:1},8,["value"])]),s("div",pu,[n[84]||(n[84]=s("h4",null,"Fields to Export",-1)),s("div",fu,[E(T,{size:"small",onClick:V},{default:L(()=>n[52]||(n[52]=[H("Select All")])),_:1,__:[52]}),E(T,{size:"small",onClick:x},{default:L(()=>n[53]||(n[53]=[H("Select Defaults")])),_:1,__:[53]}),E(T,{size:"small",onClick:A},{default:L(()=>n[54]||(n[54]=[H("Clear All")])),_:1,__:[54]})]),s("div",vu,[s("div",mu,[n[60]||(n[60]=s("h5",null,"Basic Information",-1)),s("div",gu,[E(B,{checked:r.value.id,"onUpdate:checked":n[1]||(n[1]=S=>r.value.id=S),onChange:n[2]||(n[2]=S=>m("id",S.target.checked))},{default:L(()=>n[55]||(n[55]=[H("Call ID")])),_:1,__:[55]},8,["checked"]),E(B,{checked:r.value.order,"onUpdate:checked":n[3]||(n[3]=S=>r.value.order=S),onChange:n[4]||(n[4]=S=>m("order",S.target.checked))},{default:L(()=>n[56]||(n[56]=[H("Order")])),_:1,__:[56]},8,["checked"]),E(B,{checked:r.value.status,"onUpdate:checked":n[5]||(n[5]=S=>r.value.status=S),onChange:n[6]||(n[6]=S=>m("status",S.target.checked))},{default:L(()=>n[57]||(n[57]=[H("Status")])),_:1,__:[57]},8,["checked"]),E(B,{checked:r.value.created,"onUpdate:checked":n[7]||(n[7]=S=>r.value.created=S),onChange:n[8]||(n[8]=S=>m("created",S.target.checked))},{default:L(()=>n[58]||(n[58]=[H("Created Time")])),_:1,__:[58]},8,["checked"]),E(B,{checked:r.value.completed,"onUpdate:checked":n[9]||(n[9]=S=>r.value.completed=S),onChange:n[10]||(n[10]=S=>m("completed",S.target.checked))},{default:L(()=>n[59]||(n[59]=[H("Completed Time")])),_:1,__:[59]},8,["checked"])])]),s("div",hu,[n[65]||(n[65]=s("h5",null,"Configuration",-1)),s("div",bu,[E(B,{checked:r.value.configuration,"onUpdate:checked":n[11]||(n[11]=S=>r.value.configuration=S),onChange:n[12]||(n[12]=S=>m("configuration",S.target.checked))},{default:L(()=>n[61]||(n[61]=[H("Configuration Name")])),_:1,__:[61]},8,["checked"]),E(B,{checked:r.value.provider,"onUpdate:checked":n[13]||(n[13]=S=>r.value.provider=S),onChange:n[14]||(n[14]=S=>m("provider",S.target.checked))},{default:L(()=>n[62]||(n[62]=[H("Provider")])),_:1,__:[62]},8,["checked"]),E(B,{checked:r.value.modelId,"onUpdate:checked":n[15]||(n[15]=S=>r.value.modelId=S),onChange:n[16]||(n[16]=S=>m("modelId",S.target.checked))},{default:L(()=>n[63]||(n[63]=[H("Model ID")])),_:1,__:[63]},8,["checked"]),E(B,{checked:r.value.parameters,"onUpdate:checked":n[17]||(n[17]=S=>r.value.parameters=S),onChange:n[18]||(n[18]=S=>m("parameters",S.target.checked))},{default:L(()=>n[64]||(n[64]=[H("Parameters")])),_:1,__:[64]},8,["checked"])])]),s("div",yu,[n[70]||(n[70]=s("h5",null,"Content",-1)),s("div",_u,[E(B,{checked:r.value.prompt,"onUpdate:checked":n[19]||(n[19]=S=>r.value.prompt=S),onChange:n[20]||(n[20]=S=>m("prompt",S.target.checked))},{default:L(()=>n[66]||(n[66]=[H("Prompt")])),_:1,__:[66]},8,["checked"]),E(B,{checked:r.value.variables,"onUpdate:checked":n[21]||(n[21]=S=>r.value.variables=S),onChange:n[22]||(n[22]=S=>m("variables",S.target.checked))},{default:L(()=>n[67]||(n[67]=[H("Variables")])),_:1,__:[67]},8,["checked"]),E(B,{checked:r.value.response,"onUpdate:checked":n[23]||(n[23]=S=>r.value.response=S),onChange:n[24]||(n[24]=S=>m("response",S.target.checked))},{default:L(()=>n[68]||(n[68]=[H("Response")])),_:1,__:[68]},8,["checked"]),E(B,{checked:r.value.parsedResponse,"onUpdate:checked":n[25]||(n[25]=S=>r.value.parsedResponse=S),onChange:n[26]||(n[26]=S=>m("parsedResponse",S.target.checked))},{default:L(()=>n[69]||(n[69]=[H("Parsed Response")])),_:1,__:[69]},8,["checked"])])]),s("div",Tu,[n[76]||(n[76]=s("h5",null,"Performance",-1)),s("div",$u,[E(B,{checked:r.value.latency,"onUpdate:checked":n[27]||(n[27]=S=>r.value.latency=S),onChange:n[28]||(n[28]=S=>m("latency",S.target.checked))},{default:L(()=>n[71]||(n[71]=[H("Latency (ms)")])),_:1,__:[71]},8,["checked"]),E(B,{checked:r.value.promptTokens,"onUpdate:checked":n[29]||(n[29]=S=>r.value.promptTokens=S),onChange:n[30]||(n[30]=S=>m("promptTokens",S.target.checked))},{default:L(()=>n[72]||(n[72]=[H("Prompt Tokens")])),_:1,__:[72]},8,["checked"]),E(B,{checked:r.value.completionTokens,"onUpdate:checked":n[31]||(n[31]=S=>r.value.completionTokens=S),onChange:n[32]||(n[32]=S=>m("completionTokens",S.target.checked))},{default:L(()=>n[73]||(n[73]=[H("Completion Tokens")])),_:1,__:[73]},8,["checked"]),E(B,{checked:r.value.totalTokens,"onUpdate:checked":n[33]||(n[33]=S=>r.value.totalTokens=S),onChange:n[34]||(n[34]=S=>m("totalTokens",S.target.checked))},{default:L(()=>n[74]||(n[74]=[H("Total Tokens")])),_:1,__:[74]},8,["checked"]),E(B,{checked:r.value.cost,"onUpdate:checked":n[35]||(n[35]=S=>r.value.cost=S),onChange:n[36]||(n[36]=S=>m("cost",S.target.checked))},{default:L(()=>n[75]||(n[75]=[H("Cost (USD)")])),_:1,__:[75]},8,["checked"])])]),s("div",Cu,[n[81]||(n[81]=s("h5",null,"Technical Details",-1)),s("div",ku,[E(B,{checked:r.value.request,"onUpdate:checked":n[37]||(n[37]=S=>r.value.request=S),onChange:n[38]||(n[38]=S=>m("request",S.target.checked))},{default:L(()=>n[77]||(n[77]=[H("Full Request")])),_:1,__:[77]},8,["checked"]),E(B,{checked:r.value.response_raw,"onUpdate:checked":n[39]||(n[39]=S=>r.value.response_raw=S),onChange:n[40]||(n[40]=S=>m("response_raw",S.target.checked))},{default:L(()=>n[78]||(n[78]=[H("Raw Response")])),_:1,__:[78]},8,["checked"]),E(B,{checked:r.value.error,"onUpdate:checked":n[41]||(n[41]=S=>r.value.error=S),onChange:n[42]||(n[42]=S=>m("error",S.target.checked))},{default:L(()=>n[79]||(n[79]=[H("Error Details")])),_:1,__:[79]},8,["checked"]),E(B,{checked:r.value.repeatIndex,"onUpdate:checked":n[43]||(n[43]=S=>r.value.repeatIndex=S),onChange:n[44]||(n[44]=S=>m("repeatIndex",S.target.checked))},{default:L(()=>n[80]||(n[80]=[H("Repeat Index")])),_:1,__:[80]},8,["checked"])])]),h.value.length>0?(i(),c("div",Su,[n[82]||(n[82]=s("h5",null,"Parameters (Individual Columns)",-1)),s("div",wu,[(i(!0),c(X,null,se(h.value,S=>(i(),Y(B,{key:S.id,checked:r.value[S.id],"onUpdate:checked":Z=>r.value[S.id]=Z,onChange:Z=>m(S.id,Z.target.checked)},{default:L(()=>[H(C(S.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):O("",!0),g.value.length>0?(i(),c("div",Iu,[n[83]||(n[83]=s("h5",null,"Attributes (Individual Columns)",-1)),s("div",Ru,[(i(!0),c(X,null,se(g.value,S=>(i(),Y(B,{key:S.id,checked:r.value[S.id],"onUpdate:checked":Z=>r.value[S.id]=Z,onChange:Z=>m(S.id,Z.target.checked)},{default:L(()=>[H(C(S.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):O("",!0)])]),s("div",Eu,[n[88]||(n[88]=s("h4",null,"Export Preview",-1)),s("div",Vu,[s("div",Au,[n[85]||(n[85]=s("span",{class:"label"},"Records:",-1)),s("span",Ou,C(_.value),1)]),s("div",Fu,[n[86]||(n[86]=s("span",{class:"label"},"Fields:",-1)),s("span",Pu,C(d.value.length),1)]),s("div",Lu,[n[87]||(n[87]=s("span",{class:"label"},"Estimated Size:",-1)),s("span",Mu,C(w.value),1)])])]),s("div",Du,[E(T,{onClick:p},{default:L(()=>n[89]||(n[89]=[H("Cancel")])),_:1,__:[89]}),E(T,{type:"primary",onClick:I,loading:b.value,disabled:d.value.length===0},{default:L(()=>[E(z(us)),n[90]||(n[90]=H(" Export "))]),_:1,__:[90]},8,["loading","disabled"])])])]),_:1},8,["visible"])}}}),Uu=oe(xu,[["__scopeId","data-v-d6076c55"]]);class Nu{constructor(){ce(this,"subscription",null);ce(this,"progressSubscription",null);ce(this,"store",Ue());ce(this,"v4Control",Ot());ce(this,"isActive",!1);ce(this,"currentTrialId",null)}async startStreaming(e){const t=performance.now();v.info(`V4_TRIAL_SWITCH: Stream manager starting for trial ${e}`),this.cleanupSubscriptions();const l=performance.now();v.info(`V4_TRIAL_SWITCH: Stream cleanup completed in ${(l-t).toFixed(1)}ms`),this.isActive=!0,v.info(`V4_TRIAL_SWITCH: Set isActive = true to pause reactive queries at ${(l-t).toFixed(1)}ms`),this.currentTrialId=e,this.store.setCurrentTrial(e),this.store.setStreaming(!0);const o=performance.now();v.info(`V4_TRIAL_SWITCH: Store updated in ${(o-l).toFixed(1)}ms`);const u=performance.now();v.info("V4_TRIAL_SWITCH: ALWAYS loading complete historical data first"),await this.loadHistoricalData(e);const d=performance.now();v.info(`V4_TRIAL_SWITCH: Historical data loading completed in ${(d-u).toFixed(1)}ms - store now has complete dataset`);const b=performance.now();v.info("V4_TRIAL_SWITCH: Checking for active streams to overlay updates");const r=this.v4Control.getActiveStreams(e),f=performance.now();if(v.info(`V4_TRIAL_SWITCH: Stream check completed in ${(f-b).toFixed(1)}ms, result: ${r?"FOUND":"NONE"}`),!r){v.info(`V4_TRIAL_SWITCH: No active streams for trial ${e}, using complete historical data only`);const h=await je.trials.get(e);if(h&&h.status==="running"){v.info(`V4_TRIAL_SWITCH: Running trial ${e}, setting up retry for potential streaming`);let g=0;const $=5,y=setInterval(()=>{g++,v.info(`V4_TRIAL_SWITCH: Retry ${g}/${$} checking for active streams`);const k=this.v4Control.getActiveStreams(e);k?(v.info(`V4_TRIAL_SWITCH: Found active streams after ${g} retries - starting live updates`),clearInterval(y),this.connectToTrialStream(e,k)):g>=$&&(v.info(`V4_TRIAL_SWITCH: No streams after ${$} retries - staying with historical data only`),clearInterval(y))},500)}else v.info(`V4_TRIAL_SWITCH: Non-running trial ${(h==null?void 0:h.status)||"NOT_FOUND"} - complete with historical data only`);return}this.connectToTrialStream(e,r)}connectToTrialStream(e,t){var o,u;v.info(`V4_STREAM_CONNECT: Connecting to streams for trial ${e} with historical foundation`),v.info(`V4_STREAM_CONNECT: Entry point - starting stream connection for trial ${e}`),this.isActive=!0;const l=t.callsSubject||t.sharedCalls$;v.info(`V4_STREAM_CONNECT: Subscribing to calls stream for updates, type: ${(o=l==null?void 0:l.constructor)==null?void 0:o.name}`),v.info(`V4_STREAM_CONNECT: Calls stream available: ${!!l}, type: ${(u=l==null?void 0:l.constructor)==null?void 0:u.name}`),this.subscription=l.subscribe({next:d=>{if(d&&d.length>0){v.info(`V4_STREAM_CONNECT: Merging ${d.length} streaming updates`);const b=[...this.store.apiCalls.value];d.forEach(r=>{const f=b.findIndex(h=>h.id===r.id);f>=0?b[f]=r:b.push(r)}),b.sort((r,f)=>{const h=y=>{switch(y){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},g=h(r.status),$=h(f.status);if(g!==$)return g-$;if(r.status==="completed"&&f.status==="completed"){const y=r.completed?new Date(r.completed).getTime():0;return(f.completed?new Date(f.completed).getTime():0)-y}if(r.status==="running"&&f.status==="running"){const y=r.started?new Date(r.started).getTime():0;return(f.started?new Date(f.started).getTime():0)-y}return r.order-f.order}),this.store.updateApiCalls(b)}},error:d=>{v.error("V4_STREAM_CONNECT: Stream error:",d),v.info("V4_STREAM_CONNECT: Calls stream ERROR:",d),this.store.setStreaming(!1),this.isActive=!1},complete:()=>{v.info(`V4_TRIAL_DEBUG_STREAMS_MGR: Stream completed for trial ${e}`),v.info(`V4_TRIAL_DEBUG_STREAMS: Calls stream COMPLETED for trial ${e}`),this.store.setStreaming(!1),this.isActive=!1,this.loadHistoricalData(e)}}),t.sharedProgress$&&(v.info("V4_STREAM_CONNECT: Subscribing to progress stream"),v.info(`V4_STREAM_CONNECT: Progress stream available: ${!!t.sharedProgress$}`),this.progressSubscription=t.sharedProgress$.subscribe({next:d=>{v.info("V4_STREAM_CONNECT: Received progress update:",d.type),v.info(`V4_STREAM_CONNECT: Progress update - ${d.type}`),v.info(`ðŸš¨ COMPLETION_DEBUG: Stream manager received progress event: ${d.type} at ${new Date().toISOString()}`),d.type==="completed"&&(v.info(`V4_TRIAL_DEBUG_STREAMS: Trial ${e} COMPLETED via progress stream`),v.info("ðŸš¨ COMPLETION_DEBUG: âœ… TRIAL COMPLETED EVENT RECEIVED BY STREAM MANAGER!"),v.info(`V4_TRIAL_COMPLETION: Loading final data from database for completed trial ${e}`),this.loadHistoricalData(e).then(()=>{v.info("V4_TRIAL_COMPLETION: Final data loaded - UI should now show accurate completion counts"),v.info("ðŸš¨ COMPLETION_DEBUG: âœ… UI SHOULD BE UPDATED NOW!")}).catch(b=>{v.error("V4_TRIAL_COMPLETION: Failed to load final data:",b)})),this.store.updateProgress(d)},error:d=>{v.error("V4_STREAM_CONNECT: Progress stream error:",d),v.info("V4_STREAM_CONNECT: Progress stream ERROR:",d)}})),v.info("V4_STREAM_CONNECT: Successfully connected to streams with historical foundation"),v.info(`V4_STREAM_CONNECT: Stream subscriptions complete for trial ${e}`)}cleanupSubscriptions(){v.info("STREAM_MGR_V4: Cleaning up existing subscriptions"),this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.progressSubscription&&(this.progressSubscription.unsubscribe(),this.progressSubscription=null),this.store.setStreaming(!1)}stopStreaming(){v.info("STREAM_MGR_V4: Stopping streaming"),v.info(`V4_TRIAL_DEBUG_STREAMS: stopStreaming() called for trial ${this.currentTrialId}`),v.info(`V4_TRIAL_DEBUG_STREAMS: Current isActive: ${this.isActive}`),this.cleanupSubscriptions(),this.isActive=!1,v.info("V4_TRIAL_DEBUG_STREAMS: Stopped streaming, isActive set to false")}async loadHistoricalData(e){const t=performance.now();v.info(`V4_TRIAL_SWITCH: loadHistoricalData() ENTRY for trial ${e}`);try{const l=performance.now();v.info(`V4_TRIAL_SWITCH: Checking database availability at ${(l-t).toFixed(1)}ms`);const o=performance.now();v.info(`V4_TRIAL_SWITCH: Preparing database query at ${(o-t).toFixed(1)}ms`);const u=performance.now();v.info(`V4_TRIAL_SWITCH: Starting IndexedDB query at ${(u-t).toFixed(1)}ms`);const d=await je.apiCalls.where("trialId").equals(e).toArray(),b=performance.now();v.info(`V4_TRIAL_SWITCH: IndexedDB query COMPLETED - loaded ${d.length} calls in ${(b-u).toFixed(1)}ms`),v.info(`V4_TRIAL_SWITCH: Total time to query completion: ${(b-t).toFixed(1)}ms`);const r=performance.now();d.sort((y,k)=>{const _=P=>{switch(P){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},w=_(y.status),W=_(k.status);if(w!==W)return w-W;if(y.status==="completed"&&k.status==="completed"){const P=y.completed?new Date(y.completed).getTime():0;return(k.completed?new Date(k.completed).getTime():0)-P}if(y.status==="running"&&k.status==="running"){const P=y.started?new Date(y.started).getTime():0;return(k.started?new Date(k.started).getTime():0)-P}return y.order-k.order});const f=performance.now();v.info(`V4_TRIAL_SWITCH: Sorting ${d.length} calls took ${(f-r).toFixed(1)}ms`);const h=performance.now();this.store.updateApiCalls(d),this.store.setStreaming(!1);const g=performance.now();v.info(`V4_TRIAL_SWITCH: Store update took ${(g-h).toFixed(1)}ms`),v.info(`V4_TRIAL_SWITCH: loadHistoricalData keeping isActive = ${this.isActive} to maintain reactive query pause`);const $=performance.now();v.info(`V4_TRIAL_SWITCH: loadHistoricalData TOTAL: ${($-t).toFixed(1)}ms`)}catch(l){v.error("STREAM_MGR_V4: Failed to load historical data:",l),this.store.clear()}}destroy(){v.info("STREAM_MGR_V4: Destroying stream manager"),this.stopStreaming(),this.currentTrialId=null,this.store.clear()}}let Le=null;function xt(){return Le||(Le=new Nu,v.info("STREAM_MGR_V4: Created singleton manager instance")),Le}typeof window<"u"&&(window.__trialStreamManagerV4=()=>Le);const zu={class:"trial-details-panel"},Hu={key:0,class:"loading-state"},Wu={key:1,class:"error-state"},Bu={class:"error-actions"},ju={key:0,class:"observer-banner"},Gu=ie({__name:"TrialDetailsPanelV3",props:{trial:{},isLeader:{type:Boolean},executionState:{},progress:{}},emits:["start-trial","pause-trial","resume-trial","cancel-trial","duplicate-trial","edit-trial","delete-trial","export-data","export-python"],setup(a){const e=a,t=Ye(),l=K(!1),o=K(null),u=K(!1),d=xt(),b=D(()=>{var $,y,k;return(($=e.executionState)==null?void 0:$.status)==="executing"&&((y=e.executionState)==null?void 0:y.currentTrialId)===((k=e.trial)==null?void 0:k.id)});function r(){o.value=null}function f(){t.push("/trials")}function h(){u.value=!0}async function g(){if(e.trial){v.info(`REFRESH: Manually refreshing trial ${e.trial.id} data from database`);try{d.isActive&&d.currentTrialId===e.trial.id&&(v.info("REFRESH: Temporarily stopping active stream to reload data"),d.stopStreaming()),await d.loadHistoricalData(e.trial.id),v.info(`REFRESH: Successfully refreshed trial ${e.trial.id} data`),(e.trial.status==="running"||e.trial.status==="paused")&&(v.info("REFRESH: Restarting streaming for active trial"),await d.startStreaming(e.trial.id))}catch($){v.error("REFRESH: Failed to refresh trial data:",$)}}}return re(()=>e.trial,($,y)=>{$&&$.id!==(y==null?void 0:y.id)&&(o.value=null,v.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 switching from ${y==null?void 0:y.id} to ${$.id}`))}),fe(()=>{var y;const $=(y=e.trial)==null?void 0:y.id;v.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 MOUNTED for trial ${$}`)}),Se(()=>{var y;const $=(y=e.trial)==null?void 0:y.id;v.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 ACTIVATED (cache hit) for trial ${$}`)}),we(()=>{var y;const $=(y=e.trial)==null?void 0:y.id;v.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 DEACTIVATED (cached) for trial ${$}`)}),me(()=>{var y;const $=(y=e.trial)==null?void 0:y.id;v.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 UNMOUNTED (evicted) for trial ${$}`)}),($,y)=>{const k=ee("a-button");return i(),c("div",zu,[l.value?(i(),c("div",Hu,[E(z(Be),{class:"loading-spinner",spin:""}),y[9]||(y[9]=s("span",null,"Loading trial details...",-1))])):o.value?(i(),c("div",Wu,[E(z(Me),{class:"error-icon"}),y[12]||(y[12]=s("h3",null,"Failed to load trial",-1)),s("p",null,C(o.value),1),s("div",Bu,[E(k,{onClick:r},{default:L(()=>y[10]||(y[10]=[H("Retry")])),_:1,__:[10]}),E(k,{type:"link",onClick:f},{default:L(()=>y[11]||(y[11]=[H("Go Back")])),_:1,__:[11]})])])):$.trial?(i(),c(X,{key:2},[$.isLeader?O("",!0):(i(),c("div",ju,[E(z(At),{class:"observer-icon"}),y[13]||(y[13]=s("div",{class:"observer-content"},[s("span",{class:"observer-title"},"Read-Only Mode"),s("span",{class:"observer-desc"},"All actions disabled. Close other tabs to regain control.")],-1))])),E(vn,{trial:$.trial,progress:$.progress,"is-executing":b.value},null,8,["trial","progress","is-executing"]),E(_n,{trial:$.trial,"is-leader":$.isLeader,"execution-state":$.executionState,onStart:y[0]||(y[0]=_=>$.$emit("start-trial")),onPause:y[1]||(y[1]=_=>$.$emit("pause-trial")),onResume:y[2]||(y[2]=_=>$.$emit("resume-trial")),onCancel:y[3]||(y[3]=_=>$.$emit("cancel-trial")),onDuplicate:y[4]||(y[4]=_=>$.$emit("duplicate-trial",$.trial.id)),onEdit:y[5]||(y[5]=_=>$.$emit("edit-trial",$.trial.id)),onDelete:y[6]||(y[6]=_=>$.$emit("delete-trial",$.trial.id)),onExportData:h,onExportPython:y[7]||(y[7]=_=>$.$emit("export-python",$.trial.id)),onRefresh:g},null,8,["trial","is-leader","execution-state"]),$.trial&&u.value?(i(),Y(Uu,{key:1,visible:u.value,trial:$.trial,"onUpdate:visible":y[8]||(y[8]=_=>u.value=!1)},null,8,["visible","trial"])):O("",!0),E(uu,{trial:$.trial,progress:$.progress,"is-leader":$.isLeader,"execution-state":$.executionState},null,8,["trial","progress","is-leader","execution-state"])],64)):O("",!0)])}}}),qu=oe(Gu,[["__scopeId","data-v-e11f0f77"]]),Ku={class:"trials-view-v3"},Qu={key:0,class:"provider-warning-banner"},Ju={class:"banner-content"},Xu={key:1,class:"observer-mode-banner"},Yu={class:"banner-content"},Zu={key:1,class:"loading-left-pane"},ed={key:0,class:"no-selection"},td={key:0,class:"observer-note"},sd=ie({__name:"TrialsViewV3",setup(a){const e=Ot(),{trials:t}=gs(),{duplicateTrial:l,deleteTrial:o}=hs(),u=xt(),d=Xe(),b=Vt(),r=Ye(),f=K(),h=K(!0),g=K(null),$=K(""),y=K("all"),k=K(-1),_=K(!1),w=d.hasConfiguredProviders,W=e.isLeader,P=e.execution,{trial:m}=bs(g),V=D(()=>{var M;const F=(M=m.value)==null?void 0:M.progress;return F?{trialId:g.value||"",...F,lastUpdated:new Date}:null}),x=D(()=>{let F=t.value;if($.value){const M=$.value.toLowerCase();F=F.filter(J=>{var be,Ve;const ne=J.name.toLowerCase().includes(M),ge=(Ve=(be=J.templateConfig)==null?void 0:be.template)==null?void 0:Ve.toLowerCase().includes(M),ue=J.configurations.some(Ce=>Ce.modelId.toLowerCase().includes(M)||Ce.provider.toLowerCase().includes(M));return ne||ge||ue})}return y.value!=="all"&&(F=F.filter(M=>M.status===y.value)),F});async function A(){var M;const F=b.query;if(F.duplicate){const J=F.duplicate,ne=await l(J);ne.ok?await r.push({path:"/trials/create",query:{duplicate:ne.value,edit:F.edit==="true"?"true":void 0}}):le.error(`Failed to duplicate trial: ${((M=ne.error)==null?void 0:M.message)||"Unknown error"}`),await r.replace({query:{}});return}if(F.designId||F.promptSource){await r.push({path:"/trials/create",query:F});return}if(b.query.trialId){const J=b.query.trialId;I(J)}}function p(){if(g.value)return;if(t.value.length===0){v.info("V4_TRIALS: No trials available for auto-selection");return}const F=t.value.find(M=>M.status==="running");if(F){I(F.id);return}I(t.value[0].id)}async function I(F){const M=performance.now();v.info(`V4_TRIAL_SWITCH: Starting trial selection: ${F}`),g.value=F;const J=performance.now();if(v.info(`V4_TRIAL_SWITCH: UI updated in ${(J-M).toFixed(1)}ms`),t.value.length>0){const ue=x.value.findIndex(be=>be.id===F);ue>=0&&(k.value=ue)}const ne=performance.now();if(v.info(`V4_TRIAL_SWITCH: Starting stream manager for trial ${F} at ${(ne-M).toFixed(1)}ms`),u.startStreaming(F).catch(ue=>{v.error(`V4_TRIAL_SWITCH: Failed to start streaming for trial ${F}`,ue)}),b.query.trialId!==F){const ue={...b.query};ue.trialId=F,ue.tab||(ue.tab="status"),r.push({path:"/trials",query:ue}),v.info(`V4_TRIAL_SWITCH: URL updated to preserve tab '${ue.tab}' at ${(performance.now()-M).toFixed(1)}ms`)}f.value&&f.value.closeMobileOverlay();const ge=performance.now();v.info(`V4_TRIAL_SWITCH: selectTrial() completed in ${(ge-M).toFixed(1)}ms`)}function U(F){$.value=F,k.value=-1}function n(F){y.value=F,k.value=-1}async function R(){le.info("Refreshing trial list...")}function N(F){const M=x.value;if(M.length!==0){if((F.metaKey||F.ctrlKey)&&F.key==="k"){F.preventDefault(),window.dispatchEvent(new CustomEvent("focus-trial-search"));return}(F.key==="j"||F.key==="ArrowDown")&&(F.preventDefault(),k.value=Math.min(k.value+1,M.length-1),k.value>=0&&(I(M[k.value].id),T(M[k.value].id))),(F.key==="k"||F.key==="ArrowUp")&&(F.preventDefault(),k.value=Math.max(k.value-1,0),I(M[k.value].id),T(M[k.value].id)),F.key==="Enter"&&g.value,F.key==="Escape"&&($.value="",g.value=null,k.value=-1)}}function T(F){ye(()=>{const M=document.querySelector(`[data-trial-id="${F}"]`);M&&M.scrollIntoView({behavior:"smooth",block:"nearest"})})}function B(F){v.debug("Trial list panel resized",{width:F})}function ae(F){v.debug("Mobile overlay changed",{visible:F})}async function S(){await r.push("/trials/create")}async function Z(){var F,M,J,ne;if(g.value){if(_.value){v.info("Start trial already in progress, ignoring duplicate request");return}_.value=!0,v.info("V4_EXECUTION:",(F=e.execution)==null?void 0:F.value),v.info("V4_STATUS:",(J=(M=e.execution)==null?void 0:M.value)==null?void 0:J.status);try{v.info("V4: Starting trial with streaming",g.value);const ge=await e.startTrialWithStreaming(g.value);if(!ge.ok){le.error(((ne=ge.error)==null?void 0:ne.message)||"Unknown error");return}v.info("V4_STREAMING: Restarting stream manager after trial start"),await u.startStreaming(g.value),v.info("V4: Trial started with streaming, stream manager connected");const ue={...b.query};ue.tab="tasks",r.replace({query:ue})}finally{_.value=!1}}}async function de(){var M;v.info(`V4_TRIAL_DEBUG_PAUSE: UI pauseTrial() called for trial: ${g.value}`),v.info(`V4_TRIAL_DEBUG_PAUSE: Current execution state: ${e.execution.value.status}`),v.info(`V4_TRIAL_DEBUG_PAUSE: Is leader: ${e.isLeader.value}`);const F=await e.pauseExecution();v.info("V4_TRIAL_DEBUG_PAUSE: UI pauseTrial result:",F),F.ok?v.info(`V4_TRIAL_DEBUG_PAUSE: Pause successful, execution state: ${e.execution.value.status}`):(v.info("V4_TRIAL_DEBUG_PAUSE: Pause failed from UI:",F.error.message),le.error(((M=F.error)==null?void 0:M.message)||"Unknown error"))}async function pe(){var M,J;if(!g.value)return;v.info(`V4_TRIAL_DEBUG_RESUME: UI resumeTrial() called for trial: ${g.value}`),v.info(`V4_TRIAL_DEBUG_RESUME: Current execution state: ${e.execution.value.status}`),v.info(`V4_TRIAL_DEBUG_RESUME: Is leader: ${e.isLeader.value}`);const F=((M=e.execution.value)==null?void 0:M.status)||"idle";if(v.info(`V4_TRIAL_DEBUG_RESUME: Current execution status: ${F}`),F==="paused"){v.info("V4_TRIAL_DEBUG_RESUME: Execution is paused, using resumeExecution()");const ne=await e.resumeExecution(g.value);v.info("V4_TRIAL_DEBUG_RESUME: resumeExecution result:",ne),ne.ok?(v.info("V4_TRIAL_DEBUG_RESUME: Resume successful - existing pipeline will continue automatically via pause$ = false"),v.info("V4_TRIAL_DEBUG_RESUME: Resume complete - existing V3 pipeline should continue processing pending calls")):(v.info("V4_TRIAL_DEBUG_RESUME: Resume failed:",ne.error.message),le.error(ne.error.message))}else{v.info("V4_TRIAL_DEBUG_RESUME: No paused execution found, using startTrialWithStreaming (fresh start)");const ne=await e.startTrialWithStreaming(g.value);v.info("V4_TRIAL_DEBUG_RESUME: startTrialWithStreaming result for fresh start:",ne),ne.ok?(v.info("V4_TRIAL_DEBUG_RESUME: Fresh start successful, starting stream manager"),await u.startStreaming(g.value),v.info("V4_TRIAL_DEBUG_RESUME: Stream manager started for fresh execution")):(v.info("V4_TRIAL_DEBUG_RESUME: Fresh start failed:",ne.error.message),le.error(((J=ne.error)==null?void 0:J.message)||"Unknown error"))}}async function Re(){var M;const F=await e.cancelExecution();F.ok||le.error(((M=F.error)==null?void 0:M.message)||"Unknown error")}async function Ee(F){var J;const M=await l(F);M.ok?(le.success("Trial duplicated"),M.value&&I(M.value)):le.error(((J=M.error)==null?void 0:J.message)||"Unknown error")}async function j(F){await r.push({path:"/trials/create",query:{duplicate:F,edit:"true"}})}async function q(F){var J;const M=await o(F);M.ok?(le.success("Trial deleted"),g.value===F&&(g.value=null)):le.error(((J=M.error)==null?void 0:J.message)||"Unknown error")}async function G(F,M){var ne;const J=await d.dataExport.exportTrialData(F,{format:M,fields:void 0,includeHeaders:!0,addBOM:M==="excel"});J.ok?le.success(`Exported ${J.value.recordCount} API calls to ${J.value.filename}`):le.error(((ne=J.error)==null?void 0:ne.message)||"Unknown error")}async function Q(F){var J;const M=await d.pythonGeneration.generatePythonScript(F,{template:"basic",includeAnalysis:!0,includeComments:!0});M.ok?le.success("Python script exported"):le.error(((J=M.error)==null?void 0:J.message)||"Unknown error")}return re(()=>b.query.trialId,F=>{F&&F!==g.value&&I(F)}),re(h,(F,M)=>{const J=performance.now();v.info(`V4_TRIAL_SWITCH: isLoadingInitial changed from ${M} to ${F} at ${J}`),F||v.info("V4_TRIAL_SWITCH: Both panes should now be VISIBLE (no longer loading initial)")},{immediate:!0}),re(t,(F,M)=>{const J=performance.now();v.info(`V4_TRIAL_SWITCH: trials array changed from ${(M==null?void 0:M.length)||0} to ${F.length} trials at ${J}`)},{immediate:!0}),fe(async()=>{const F=performance.now();v.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() ENTRY at ${F}`);const M=performance.now();v.info(`V4_TRIAL_SWITCH: Starting V4 execution system initialization at ${(M-F).toFixed(1)}ms`);try{await e.initialize();const Ne=performance.now();v.info(`V4_TRIAL_SWITCH: V4 execution system initialized in ${(Ne-M).toFixed(1)}ms`)}catch(Ne){const zt=performance.now();v.error(`V4_TRIAL_SWITCH: V4 initialization failed in ${(zt-M).toFixed(1)}ms:`,Ne)}const J=performance.now();window.addEventListener("keydown",N),v.info(`V4_TRIAL_SWITCH: Keyboard listener added in ${(J-F).toFixed(1)}ms`);const ne=performance.now();v.info(`V4_TRIAL_SWITCH: Starting nextTick wait at ${(ne-F).toFixed(1)}ms`),await ye();const ge=performance.now();v.info(`V4_TRIAL_SWITCH: nextTick completed in ${(ge-ne).toFixed(1)}ms`);const ue=performance.now();h.value=!1,v.info(`V4_TRIAL_SWITCH: isLoadingInitial set to false at ${(ue-F).toFixed(1)}ms`);const be=performance.now();v.info(`V4_TRIAL_SWITCH: Starting URL parameter processing at ${(be-F).toFixed(1)}ms`),await A();const Ve=performance.now();v.info(`V4_TRIAL_SWITCH: URL parameter processing completed in ${(Ve-be).toFixed(1)}ms`);const Ce=performance.now();v.info(`V4_TRIAL_SWITCH: Starting auto-selection at ${(Ce-F).toFixed(1)}ms`),p();const Ut=performance.now();v.info(`V4_TRIAL_SWITCH: Auto-selection completed in ${(Ut-Ce).toFixed(1)}ms`);const Nt=performance.now();v.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() TOTAL: ${(Nt-F).toFixed(1)}ms`)}),me(()=>{v.info("V4_SINGLETON_DEBUG: TrialsViewV3 onUnmounted() - NOT calling v4ExecutionControl.cleanup() to preserve singleton"),window.removeEventListener("keydown",N),u.destroy(),v.info("V4_SINGLETON_DEBUG: V4 execution system preserved, initialized flag should remain true")}),(F,M)=>{const J=ee("router-link"),ne=ee("a-button");return i(),c("div",Ku,[z(w)?O("",!0):(i(),c("div",Qu,[s("div",Ju,[E(z(Me),{class:"warning-icon"}),M[1]||(M[1]=s("span",null,"No LLM providers configured. Please add API keys in Settings to run trials.",-1)),E(J,{to:"/settings",class:"settings-link"},{default:L(()=>M[0]||(M[0]=[H("Go to Settings")])),_:1,__:[0]})]),M[2]||(M[2]=s("div",{class:"banner-note"},"Note: Ollama doesn't require API keys",-1))])),z(W)?O("",!0):(i(),c("div",Xu,[s("div",Yu,[E(z(At),{class:"observer-icon"}),M[3]||(M[3]=s("span",null,[s("strong",null,"Observer Mode"),H(" - This tab is read-only. Close other tabs to enable actions.")],-1)),M[4]||(M[4]=s("div",{class:"leader-hint"},"Only one tab can control Auditomatic at a time",-1))])])),E(Ms,{ref_key:"splitPanel",ref:f,"storage-key":"trial-list-width","default-width":250,"min-width":200,"max-width":600,onResize:B,onMobileOverlayChange:ae},{left:L(()=>[h.value?(i(),c("div",Zu," Loading trials... ")):(i(),Y(Qa,{key:0,trials:z(t),"selected-trial-id":g.value,"search-query":$.value,"filter-status":y.value,onSelectTrial:I,onCreateTrial:S,onUpdateSearch:U,onUpdateFilter:n,onRefresh:R},null,8,["trials","selected-trial-id","search-query","filter-status"]))]),right:L(()=>[(i(),Y(Ge,{max:5},[g.value?(i(),Y(qu,{key:g.value,trial:z(m),"is-leader":z(W),"execution-state":z(P),progress:V.value,onStartTrial:Z,onPauseTrial:de,onResumeTrial:pe,onCancelTrial:Re,onDuplicateTrial:Ee,onEditTrial:j,onDeleteTrial:q,onExportData:G,onExportPython:Q},null,8,["trial","is-leader","execution-state","progress"])):O("",!0)],1024)),!g.value||!z(m)?$e((i(),c("div",ed,[E(z(ds),{class:"empty-icon"}),M[6]||(M[6]=s("h3",null,"Select a trial to view details",-1)),M[7]||(M[7]=s("p",null,"Choose from the list or create a new one",-1)),E(ne,{type:"primary",size:"large",disabled:!z(W),onClick:S},{default:L(()=>M[5]||(M[5]=[H(" Create New Trial ")])),_:1,__:[5]},8,["disabled"]),z(W)?O("",!0):(i(),c("div",td," Close other tabs to enable trial creation "))],512)),[[Rt,!h.value]]):O("",!0)]),_:1},512)])}}}),ud=oe(sd,[["__scopeId","data-v-90be69b6"]]);export{ud as default};
