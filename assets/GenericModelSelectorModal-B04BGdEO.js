import{d as e,c as a,a6 as l,ab as t,F as o,a1 as s,_ as n,G as i,a0 as u,Y as d,f as r,r as c,w as p,V as m,W as v,Z as f,k,a8 as g,B as y}from"./vendor-DImCB_rW.js";import{u as h}from"./models-db-CQBNRyqi.js";import{a as b,i as x,_ as C,p as _}from"./index-Ccn6zvHO.js";import{a as T}from"./designs-db-CINPsE5K.js";import{a as $}from"./cost-formatting-Bv_drrqY.js";const w={key:0,class:"cost-group"},F={class:"cost-item"},U={class:"cost-value"},O={class:"cost-value"},z={key:1,class:"cost-group"},I={class:"enviro-group"},P={class:"enviro-item"},S={class:"enviro-item"},L={class:"enviro-item"},j={key:0,class:"cost-group"},E={class:"cost-item"},M={class:"cost-value"},W={class:"cost-value"},N={class:"enviro-group"},A={class:"enviro-item"},B={class:"enviro-item"},K={class:"enviro-item"},D={key:0,class:"cost-item financial"},G={key:0,class:"cost-value"},q={key:1,class:"cost-value"},V={class:"cost-item environmental"},Y={class:"enviro-item"},Z={class:"enviro-value"},H={class:"enviro-item"},J={class:"enviro-value"},Q={class:"enviro-item"},R={class:"enviro-value"},X={key:0,class:"cost-unit"},ee=C(e({__name:"ModelCostDisplay",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(e){const r=e,c=b(),p=a(()=>c.financialCostsEnabled);function m(){if(!r.model.capabilities)return"â€”";const e=r.model.capabilities.inputCostPerToken||0,a=r.model.capabilities.outputCostPerToken||0;if("per-thousand"===r.mode){return $(1e3*(e+a))}if("total"===r.mode){const l=e*r.inputTokens+a*r.outputTokens;return $(l)}return"â€”"}function v(e){if(0===e)return"0";if(e>=.01)return e.toFixed(2).replace(/\.?0+$/,"");const a=e.toFixed(10).match(/^0\.0*[1-9]/);if(a){const l=a[0].length-2;return e.toFixed(l)}return e.toFixed(4)}function f(){if(!r.model.capabilities)return"0";return v(1e3*(r.model.capabilities.inputCostPerToken||0))}function k(){if(!r.model.capabilities)return"0";return v(1e3*(r.model.capabilities.outputCostPerToken||0))}function g(){if(!r.model.capabilities)return"?";const e=r.model.capabilities.inputCostPerToken||0,a=r.model.capabilities.outputCostPerToken||0;return v(e*r.inputTokens+a*r.minOutputTokens)}function y(){if(!r.model.capabilities||!r.maxOutputTokens)return"?";const e=r.model.capabilities.inputCostPerToken||0,a=r.model.capabilities.outputCostPerToken||0;return v(e*r.inputTokens+a*r.maxOutputTokens)}function h(e){if(!c.environmentalCostsEnabled)return"??";if(!x.hasDataForModel(r.model.provider,r.model.modelId))return"-";const a="total"===r.mode?r.inputTokens+r.outputTokens:1e3,l=x.calculateEnvironmentalCostUnsafe(r.model.provider,r.model.modelId,a)[e];if(0===l)return"-";switch(e){case"carbon":return l<.001?"<1Î¼g":l<1?`${(1e3*l).toFixed(0)}Î¼g`:l<1e3?`${l.toFixed(1)}mg`:`${(l/1e3).toFixed(1)}g`;case"water":return l<.001?"<1nL":l<1?`${(1e3*l).toFixed(0)}nL`:l<1e3?`${l.toFixed(1)}Î¼L`:`${(l/1e3).toFixed(1)}mL`;case"energy":return l<.001?"<1Î¼Wh":l<1?`${(1e3*l).toFixed(0)}Î¼Wh`:l<1e3?`${l.toFixed(1)}mWh`:`${(l/1e3).toFixed(1)}Wh`;default:return"-"}}function C(e){if(!c.environmentalCostsEnabled)return"??";if(!x.hasDataForModel(r.model.provider,r.model.modelId))return"-";if(!r.maxOutputTokens)return"?";const a=r.inputTokens+r.minOutputTokens,l=r.inputTokens+r.maxOutputTokens,t=x.calculateEnvironmentalCostUnsafe(r.model.provider,r.model.modelId,a),o=x.calculateEnvironmentalCostUnsafe(r.model.provider,r.model.modelId,l),s=t[e],n=o[e];if(0===s&&0===n)return"-";const i=a=>{switch(e){case"carbon":return a<.001?"<1Î¼g":a<1?`${(1e3*a).toFixed(0)}Î¼g`:a<1e3?`${a.toFixed(0)}mg`:`${(a/1e3).toFixed(1)}g`;case"water":return a<.001?"<1nL":a<1?`${(1e3*a).toFixed(0)}nL`:a<1e3?`${a.toFixed(0)}Î¼L`:`${(a/1e3).toFixed(1)}mL`;case"energy":return a<.001?"<1Î¼Wh":a<1?`${(1e3*a).toFixed(0)}Î¼Wh`:a<1e3?`${a.toFixed(0)}mWh`:`${(a/1e3).toFixed(1)}Wh`;default:return"-"}};return`${i(s)}-${i(n)}`}return(e,a)=>(d(),l("div",{class:t(["model-cost-display",[`layout-${e.layout}`,`size-${e.size}`]])},["range"===e.mode?(d(),l(o,{key:0},[p.value&&e.maxOutputTokens?(d(),l("span",w,[n("span",F,[n("span",U,"$"+u(g()),1),a[0]||(a[0]=i(" - ")),n("span",O,"$"+u(y()),1)])])):p.value?(d(),l("span",z,a[1]||(a[1]=[n("span",{class:"cost-item"},[n("span",{class:"cost-value"},"Cost: ??")],-1)]))):s("",!0),a[4]||(a[4]=n("span",{class:"cost-tab"},null,-1)),n("span",I,[n("span",P,"COâ‚‚ "+u(C("carbon")),1),a[2]||(a[2]=n("span",{class:"cost-tab"},null,-1)),n("span",S,"ðŸ’§"+u(C("water")),1),a[3]||(a[3]=n("span",{class:"cost-tab"},null,-1)),n("span",L,"âš¡"+u(C("energy")),1)])],64)):"input-output"===e.mode?(d(),l(o,{key:1},[p.value?(d(),l("span",j,[n("span",E,[n("span",M,"$"+u(f()),1),a[5]||(a[5]=i("/1K input + ")),n("span",W,"$"+u(k()),1),a[6]||(a[6]=i("/1K output "))])])):s("",!0),a[9]||(a[9]=n("span",{class:"cost-tab"},null,-1)),n("span",N,[n("span",A,"COâ‚‚ "+u(h("carbon")),1),a[7]||(a[7]=n("span",{class:"cost-tab"},null,-1)),n("span",B,"ðŸ’§"+u(h("water")),1),a[8]||(a[8]=n("span",{class:"cost-tab"},null,-1)),n("span",K,"âš¡"+u(h("energy")),1)])],64)):(d(),l(o,{key:2},[p.value?(d(),l("div",D,["per-thousand"===e.mode?(d(),l("span",G,[i(u(m())+" ",1),a[10]||(a[10]=n("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):"total"===e.mode?(d(),l("span",q,u(m()),1)):s("",!0)])):s("",!0),n("div",V,[n("span",Y,[a[11]||(a[11]=n("span",{class:"enviro-icon"},"COâ‚‚",-1)),n("span",Z,u(h("carbon")),1)]),n("span",H,[a[12]||(a[12]=n("span",{class:"enviro-icon"},"ðŸ’§",-1)),n("span",J,u(h("water")),1)]),n("span",Q,[a[13]||(a[13]=n("span",{class:"enviro-icon"},"âš¡",-1)),n("span",R,u(h("energy")),1)]),"per-thousand"===e.mode?(d(),l("span",X,"/ 1,000")):s("",!0)])],64))],2))}}),[["__scopeId","data-v-d48a87be"]]),ae={class:"modal-header"},le={class:"modal-content"},te={class:"models-panel"},oe={class:"panel-header"},se={class:"models-list"},ne={class:"provider-header"},ie={class:"provider-name"},ue={class:"provider-model-count"},de={class:"provider-models"},re=["onClick"],ce={class:"model-name"},pe={class:"model-specs"},me={key:0,class:"config-panel"},ve={class:"config-header"},fe={class:"total-cost"},ke={key:0,class:"cost-info"},ge={key:0,class:"config-content"},ye={class:"param-description"},he={class:"param-description"},be={class:"config-footer"},xe=C(e({__name:"GenericModelSelectorModal",props:{open:{type:Boolean},mode:{},design:{},title:{},existingConfigurations:{}},emits:["close","add-configuration","select-model"],setup(e,{emit:b}){const x=e,C=b,$=h(),w=r(""),F=r([]),U=r(null),O=r(""),z=c({}),I=r(null),P=a(()=>{let e=$.enabledModels;if(w.value){const a=w.value.toLowerCase();e=e.filter(e=>e.displayName.toLowerCase().includes(a)||e.modelId.toLowerCase().includes(a))}const a={};for(const l of e)a[l.provider]||(a[l.provider]=[]),a[l.provider].push(l);for(const l in a)a[l].sort((e,a)=>e.displayName.localeCompare(a.displayName));return a}),S=a(()=>{if("trial"!==x.mode||!x.design)return 1;let e=1;for(const a of Object.values(x.design.variableBindings))"direct"===a.type&&(e*=a.values?.length||1);return e}),L=a(()=>U.value?_.getBasicParameters(U.value.provider,U.value.modelId):{}),j=a(()=>U.value?_.getAdvancedParameters(U.value.provider,U.value.modelId):{});function E(e){return e.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function M(){if(!U.value||!O.value)return;const e={},a=(e,a,l)=>{const t=a.split(".");let o=e;for(let s=0;s<t.length-1;s++)o[t[s]]||(o[t[s]]={}),o=o[t[s]];o[t[t.length-1]]=l};for(const[l,t]of Object.entries(z))(null!=t&&""!==t||!1===t)&&a(e,l,t);C("add-configuration",{name:O.value,provider:U.value.provider,modelId:U.value.modelId,parameters:e})}function W(){U.value&&(C("select-model",U.value),C("close"))}function N(e){return"trial"===x.mode&&x.design?x.design.tokenEstimate?.avgTokens||150:1e3}function A(e){if("trial"===x.mode){return T.getOutputTokenLimit(e.provider,e.modelId,z)||256}return 1e3}return p([U,z],async()=>{if(U.value&&"trial"===x.mode&&x.design)try{I.value=await T.calculateCostEstimate(x.design,U.value,z)}catch(e){console.error("Failed to calculate cost estimate:",e),I.value=null}else I.value=null}),(e,a)=>{const r=v("a-input-search"),c=v("a-button"),p=v("a-collapse-panel"),h=v("a-collapse"),b=v("a-input"),T=v("a-form-item"),$=v("a-input-number"),B=v("a-switch"),K=v("a-select-option"),D=v("a-select"),G=v("a-col"),q=v("a-row"),V=v("a-form"),Y=v("a-modal");return d(),m(Y,{open:e.open,onCancel:a[3]||(a[3]=a=>e.$emit("close")),width:"99%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:f(()=>[n("div",ae,[n("h2",null,u(e.title||"Select Model"),1)]),n("div",le,[n("div",te,[n("div",oe,[a[4]||(a[4]=n("h3",null,"Available Models",-1)),k(r,{value:w.value,"onUpdate:value":a[0]||(a[0]=e=>w.value=e),placeholder:"Search models...",size:"large","allow-clear":""},null,8,["value"])]),n("div",se,[k(h,{activeKey:F.value,"onUpdate:activeKey":a[1]||(a[1]=e=>F.value=e),bordered:!1},{default:f(()=>[(d(!0),l(o,null,g(P.value,(a,s)=>(d(),m(p,{key:s,class:"provider-panel"},{header:f(()=>[n("div",ne,[n("span",ie,u(s),1),n("span",ue,u(a.length)+" models",1)])]),extra:f(()=>[k(c,{size:"small",type:"text",onClick:y(e=>function(e){const a=F.value.indexOf(e);a>-1?F.value.splice(a,1):F.value.push(e)}(s),["stop"])},{default:f(()=>[i(u(F.value.includes(s)?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:f(()=>[n("div",de,[(d(!0),l(o,null,g(a,a=>(d(),l("div",{key:a.id,class:t(["model-row",{selected:U.value?.id===a.id}]),onClick:e=>function(e){if(U.value=e,"playground"===x.mode)return C("select-model",e),void C("close");if("trial"===x.mode){O.value=e.displayName,Object.keys(z).forEach(e=>delete z[e]);const a={..._.getBasicParameters(e.provider,e.modelId),..._.getAdvancedParameters(e.provider,e.modelId)};for(const[e,l]of Object.entries(a))void 0!==l.default&&(z[e]=l.default)}}(a)},[n("div",ce,u(a.displayName),1),n("div",pe,[k(ee,{model:a,mode:"trial"===e.mode?"range":"input-output","input-tokens":N(),"min-output-tokens":10,"max-output-tokens":A(a),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])])],10,re))),128))])]),_:2},1024))),128))]),_:1},8,["activeKey"])])]),U.value&&"trial"===e.mode?(d(),l("div",me,[n("div",ve,[n("h3",null,u("trial"===e.mode?"Configure":"Selected")+": "+u(U.value.displayName),1),n("div",fe,[k(ee,{model:U.value,mode:"trial"===e.mode?"total":"input-output","input-tokens":I.value?.inputTokens.avgTokens||N(U.value),"output-tokens":I.value?.outputTokens||A(U.value),layout:"inline",size:"large"},null,8,["model","mode","input-tokens","output-tokens"]),"trial"===e.mode&&S.value>1?(d(),l("span",ke,"("+u(S.value)+" calls)",1)):s("",!0)])]),"trial"===e.mode?(d(),l("div",ge,[k(V,{layout:"vertical"},{default:f(()=>[k(T,{label:"Configuration Name",required:""},{default:f(()=>[k(b,{value:O.value,"onUpdate:value":a[2]||(a[2]=e=>O.value=e),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1}),k(h,{"default-active-key":["basic"],ghost:""},{default:f(()=>[k(p,{key:"basic",header:"Basic Parameters"},{default:f(()=>[k(q,{gutter:16},{default:f(()=>[(d(!0),l(o,null,g(L.value,(e,a)=>(d(),m(G,{key:a,span:12},{default:f(()=>[k(T,{label:E(a)},{default:f(()=>["number"===e.type?(d(),m($,{key:0,value:z[a],"onUpdate:value":e=>z[a]=e,min:e.min,max:e.max,step:.1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"integer"===e.type?(d(),m($,{key:1,value:z[a],"onUpdate:value":e=>z[a]=e,min:e.min,max:e.max,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"boolean"===e.type?(d(),m(B,{key:2,checked:z[a],"onUpdate:checked":e=>z[a]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(d(),m(D,{key:3,value:z[a],"onUpdate:value":e=>z[a]=e,placeholder:String(e.default),size:"large",style:{width:"100%"},allowClear:""},{default:f(()=>[(d(!0),l(o,null,g(e.enum,e=>(d(),m(K,{key:e,value:e},{default:f(()=>[i(u(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(d(),m(b,{key:4,value:z[a],"onUpdate:value":e=>z[a]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),n("div",ye,u(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1}),Object.keys(j.value).length>0?(d(),m(p,{key:"advanced",header:"Advanced Parameters"},{default:f(()=>[k(q,{gutter:16},{default:f(()=>[(d(!0),l(o,null,g(j.value,(e,a)=>(d(),m(G,{key:a,span:12},{default:f(()=>[k(T,{label:E(a)},{default:f(()=>["number"===e.type||"integer"===e.type?(d(),m($,{key:0,value:z[a],"onUpdate:value":e=>z[a]=e,min:e.min,max:e.max,step:"number"===e.type?.1:1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","step","placeholder"])):"boolean"===e.type?(d(),m(B,{key:1,checked:z[a],"onUpdate:checked":e=>z[a]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(d(),m(D,{key:2,value:z[a],"onUpdate:value":e=>z[a]=e,placeholder:String(e.default),size:"large",style:{width:"100%"},allowClear:""},{default:f(()=>[(d(!0),l(o,null,g(e.enum,e=>(d(),m(K,{key:e,value:e},{default:f(()=>[i(u(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(d(),m(b,{key:3,value:z[a],"onUpdate:value":e=>z[a]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),n("div",he,u(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1})):s("",!0)]),_:1})]),_:1})])):s("",!0),n("div",be,["trial"===e.mode?(d(),m(c,{key:0,type:"primary",size:"large",onClick:M,disabled:!O.value||!U.value},{default:f(()=>a[5]||(a[5]=[i(" Add Configuration ")])),_:1,__:[5]},8,["disabled"])):(d(),m(c,{key:1,type:"primary",size:"large",onClick:W,disabled:!U.value},{default:f(()=>a[6]||(a[6]=[i(" Select Model ")])),_:1,__:[6]},8,["disabled"]))])])):s("",!0)])]),_:1},8,["open"])}}}),[["__scopeId","data-v-7f88a729"]]);export{xe as G,ee as M};
