const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PivotTableCore-V0QEtLzB.js","./index-CiDH-VjL.js","./vendor-BARfHmiz.js","./db-CL8uhZCz.js","./index-WKWW6WoI.css","./designs-db-DzGNAug3.js","./defaultData-Bk-Mi7PC.js","./variable.service-BaxgHvBg.js","./variables-db-BZ-Wb_AM.js","./models-db-4pNwwfI8.js","./EnvironmentalCostSummary-tKL0Opfv.js","./EnvironmentalCostSummary-BKiZ-OJU.css","./cost-formatting-Bv_drrqY.js","./GenericModelSelectorModal-Cjao-z3K.js","./feature-flags-DaxAZY-J.js","./GenericModelSelectorModal-DA6kRAYO.css","./BaseModal.vue_vue_type_style_index_0_lang-DgBaQZ0f.js","./BaseModal-DbTyIa7L.css","./PivotTableCore-CE1y9fx0.css"])))=>i.map(i=>d[i]);
import{I as e,u as a,n as t,o as l,l as s,M as i,_ as r,f as n,a as o,m as c}from"./index-CiDH-VjL.js";import{k as u,d,f as p,c as v,w as m,o as f,b as g,a6 as y,Y as b,_ as k,V as h,a1 as _,G as w,a0 as C,Z as x,W as T,ad as P,u as S,q as I,ai as E,ag as $,F as j,a8 as z,aa as F,l as O,B as D,X as M,$ as A,a9 as L}from"./vendor-BARfHmiz.js";import{P as U,A as R,T as V,_ as N,a as K}from"./PivotTableCore-V0QEtLzB.js";import{l as B}from"./db-CL8uhZCz.js";import{u as q}from"./useResponsiveTable-Dxe1iu1D.js";import"./designs-db-DzGNAug3.js";import"./defaultData-Bk-Mi7PC.js";import"./variable.service-BaxgHvBg.js";import"./variables-db-BZ-Wb_AM.js";import"./models-db-4pNwwfI8.js";import"./EnvironmentalCostSummary-tKL0Opfv.js";import"./cost-formatting-Bv_drrqY.js";import"./GenericModelSelectorModal-Cjao-z3K.js";import"./feature-flags-DaxAZY-J.js";import"./BaseModal.vue_vue_type_style_index_0_lang-DgBaQZ0f.js";var Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"};function G(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?Object(arguments[a]):{},l=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),l.forEach(function(a){H(e,a,t[a])})}return e}function H(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var W=function(a,t){var l=G({},a,t.attrs);return u(e,G({},l,{icon:Y}),null)};W.displayName="PauseOutlined",W.inheritAttrs=!1;var X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};function Z(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?Object(arguments[a]):{},l=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),l.forEach(function(a){J(e,a,t[a])})}return e}function J(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var Q=function(a,t){var l=Z({},a,t.attrs);return u(e,Z({},l,{icon:X}),null)};Q.displayName="StopOutlined",Q.inheritAttrs=!1;const ee={class:"execution-monitor","data-testid":"execution-monitor"},ae={class:"monitor-header"},te={class:"header-left"},le={key:0,class:"progress-summary"},se={class:"progress-bar"},ie={class:"progress-text"},re={key:0,class:"time-estimate"},ne={key:1,class:"network-errors"},oe={key:0,class:"header-right"},ce={class:"header-stats"},ue={class:"stat"},de={class:"stat pending"},pe={class:"stat running"},ve={class:"stat completed"},me={class:"stat failed"},fe={key:0,class:"execution-controls"},ge={key:0,class:"monitor-tabs"},ye={class:"monitor-filters"},be={class:"monitor-content"},ke={key:0,class:"empty-state"},he={class:"placeholder-content"},_e={key:1,class:"results-table"},we={class:"table-body"},Ce=["onClick"],xe={class:"col-status"},Te={class:"col-config"},Pe={class:"config-info"},Se={class:"model-name"},Ie={class:"provider-name"},Ee={class:"col-repeat"},$e={key:0,class:"repeat-info"},je={key:1,class:"repeat-placeholder"},ze={class:"col-variables"},Fe={class:"variables-list"},Oe={class:"var-key"},De={class:"var-value"},Me={key:0,class:"separator"},Ae={class:"col-response"},Le={key:0,class:"response-placeholder"},Ue={key:1,class:"response-placeholder"},Re={key:2,class:"response-error"},Ve={key:3,class:"response-content"},Ne={key:4,class:"response-placeholder"},Ke={class:"col-time"},Be={key:0,class:"time-info"},qe={class:"duration"},Ye={key:0,class:"latency"},Ge={key:1,class:"time-placeholder"},He={class:"pivot-container"},We={key:1,class:"empty-state"},Xe={key:1,class:"monitor-content"},Ze=r(d({__name:"ExecutionMonitor",props:{trialId:{}},setup(e){const r=e,n=p(null),o=p([]),c=p("all"),d=p(""),D=p(null),M=p(100),A=p(null),L=p(!1),V=p("list"),N=p({rowField:"",columnField:"model",valueField:"success",aggregation:"mean"}),K=p(null),q=p([]),Y=p(!1),G=a();let H=null,X=null,Z=null;const J=v(()=>{const e={total:0,pending:0,running:0,completed:0,failed:0};return o.value.forEach(a=>{e.total++,"completed"===a.status?e.completed++:"failed"===a.status?(e.failed++,e.completed++):e[a.status]++}),e}),Ze=v(()=>n.value&&0!==n.value.progress.total?n.value.progress.completed/n.value.progress.total*100:0),Je=v(()=>{if(!n.value||"running"!==n.value.status||!K.value)return null;const e=n.value.progress.completed,a=n.value.progress.total-e;if(0===e||a<=0)return null;const t=q.value.slice(-10);if(t.length<2){return na((Date.now()-K.value.getTime())/e*a)}let l=0,s=0;for(let i=1;i<t.length;i++){const e=t[i].time.getTime()-t[i-1].time.getTime(),a=t[i].completed-t[i-1].completed;if(a>0){const r=e/a,n=i/t.length;l+=r*n,s+=n}}if(0===s)return null;return na(1.1*(l/s*a))}),Qe=v(()=>{let e=o.value;if("all"!==c.value&&(e=e.filter(e=>e.status===c.value)),d.value.trim()){const a=d.value.toLowerCase();e=e.filter(e=>Object.values(e.variables).some(e=>e.toLowerCase().includes(a))||e.result?.content&&String(e.result.content).toLowerCase().includes(a)||e.result?.error&&e.result.error.toLowerCase().includes(a))}return e.sort((e,a)=>a.created.getTime()-e.created.getTime())}),ea=v(()=>Qe.value.slice(0,M.value)),aa=v(()=>n.value&&["running","paused","pending"].includes(n.value.status));function ta(e){if(!n.value||!n.value.configurationSnapshots[e])return"Unknown Model";return n.value.configurationSnapshots[e].modelId||"Unknown Model"}function la(e){if(!n.value||!n.value.configurationSnapshots[e])return"Unknown Provider";return n.value.configurationSnapshots[e].provider||"Unknown Provider"}function sa(e,a){return e.length<=a?e:e.slice(0,a)+"..."}let ia=null;function ra(){ia&&ia.disconnect(),ia=new IntersectionObserver(e=>{const[a]=e;a.isIntersecting&&!L.value&&Qe.value.length>M.value&&(L.value||(L.value=!0,setTimeout(()=>{const e=Math.min(50,Math.max(10,Math.floor(.1*Qe.value.length)));M.value+=e,L.value=!1},100)))},{rootMargin:"100px",threshold:.1}),A.value&&ia.observe(A.value)}function na(e){const a=Math.floor(e/1e3),t=Math.floor(a/60),l=Math.floor(t/60);if(l>0){return`${l}h ${t%60}m`}if(t>0){return`${t}m ${a%60}s`}return`${a}s`}async function oa(){if(n.value){Y.value=!0;try{await G.pauseTrial(n.value.id),s.info("Trial paused",{trialId:n.value.id})}catch(e){s.error("Failed to pause trial",e),i.error({title:"Failed to pause trial",content:e instanceof Error?e.message:"Unknown error"})}finally{Y.value=!1}}}async function ca(){if(n.value){Y.value=!0;try{await G.executeTrial(n.value.id),s.info("Trial resumed",{trialId:n.value.id})}catch(e){s.error("Failed to resume trial",e),i.error({title:"Failed to resume trial",content:e instanceof Error?e.message:"Unknown error"})}finally{Y.value=!1}}}function ua(){n.value&&i.confirm({title:"Cancel Trial Execution?",content:"This will permanently cancel the trial. You will not be able to resume it.",okText:"Yes, Cancel",okType:"danger",cancelText:"No, Keep Running",onOk:da})}async function da(){if(n.value){Y.value=!0;try{await G.cancelTrial(n.value.id),s.info("Trial cancelled",{trialId:n.value.id})}catch(e){s.error("Failed to cancel trial",e),i.error({title:"Failed to cancel trial",content:e instanceof Error?e.message:"Unknown error"})}finally{Y.value=!1}}}function pa(e){N.value=e}function va(e){if(!e.cell)return;const a=e.cell.apiCalls||[];0!==a.length&&i.info({title:`${e.row} Ã— ${e.column}`,width:"80%",class:"pivot-cell-details-modal",content:()=>O("div",{class:"pivot-cell-details"},[O("div",{class:"cell-summary"},[O("span",{class:"count"},`${a.length} calls`),O("span",{class:"separator"},"â€¢"),O("span",{class:"aggregate"},`${"average"===N.value.aggregation?"Avg":"Total"}: ${e.cell?.value?"number"==typeof e.cell.value?e.cell.value.toFixed(2):e.cell.value:"0"}`)]),O("div",{class:"calls-list"},a.map((e,a)=>O("div",{key:e.id,class:"call-row"},[O("span",{class:"call-index"},`${a+1}.`),O("span",{class:"model"},e.model),O("span",{class:`status ${e.status}`},e.status),e.variables&&Object.entries(e.variables).length>0&&O("span",{class:"variables"},Object.entries(e.variables).map(([e,a])=>`${e}: ${a}`).join(", ")),e.extracted&&O("span",{class:"extracted"},`â†’ ${e.extracted}`),O("span",{class:"metrics"},[e.cost&&`$${e.cost.toFixed(3)}`,e.cost&&e.duration&&" â€¢ ",e.duration&&`${e.duration}ms`].filter(Boolean).join(""))])))])})}async function ma(){if(n.value&&K.value&&"running"===n.value.status)try{await l.trialExecutionStates.put({trialId:n.value.id,startedAt:K.value,lastActivityAt:new Date,progressHistory:q.value.map(e=>({time:e.time,completed:e.completed}))}),s.debug("Saved execution state",{trialId:n.value.id})}catch(e){s.error("Failed to save execution state",e)}}function fa(){H&&(clearInterval(H),H=null)}function ga(){X&&X.unsubscribe(),Z&&Z.unsubscribe(),X=B(()=>l.trials.get(r.trialId)).subscribe({next:async e=>{const a=n.value;if(n.value=e||null,e&&("running"===e.status&&"running"!==a?.status&&(await async function(e){try{const a=await l.trialExecutionStates.get(e);a&&(K.value=a.startedAt,q.value=a.progressHistory,s.info("Restored execution state",{trialId:e,historyLength:a.progressHistory.length}))}catch(a){s.error("Failed to restore execution state",a)}}(e.id),K.value||(K.value=new Date,q.value=[{time:new Date,completed:e.progress.completed}]),fa(),H=window.setInterval(()=>{ma()},5e3)),"running"===e.status&&a&&e.progress.completed>a.progress.completed&&(q.value.push({time:new Date,completed:e.progress.completed}),q.value.length>20&&(q.value=q.value.slice(-20)),await ma()),"running"!==e.status&&"running"===a?.status)){fa();try{await l.trialExecutionStates.delete(e.id)}catch(t){s.warn("Failed to clean up execution state",{error:t})}K.value=null,q.value=[]}},error:e=>{s.error("Trial subscription error",e)}}),Z=B(()=>l.apiCalls.where("trialId").equals(r.trialId).toArray()).subscribe({next:e=>{o.value=e},error:e=>{s.error("API calls subscription error",e)}})}return m(()=>r.trialId,e=>{e&&ga()},{immediate:!0}),m([c,d],()=>{M.value=100,L.value=!1,setTimeout(ra,100)}),m(A,e=>{e&&setTimeout(ra,100)}),f(()=>{ga(),setTimeout(ra,100)}),g(()=>{ia&&(ia.disconnect(),ia=null),fa(),ma(),X&&X.unsubscribe(),Z&&Z.unsubscribe()}),(e,a)=>{const l=T("a-tag"),s=T("a-button"),i=T("a-tab-pane"),r=T("a-tabs");return b(),y("div",ee,[k("div",ae,[k("div",te,[k("h3",null,[w(C(n.value?.name||"Select a trial to monitor")+" ",1),n.value?.repeatConfig?.callsPerPrompt&&n.value.repeatConfig.callsPerPrompt>1?(b(),h(l,{key:0,size:"small",color:"purple",style:{"margin-left":"8px"}},{default:x(()=>[w(C(n.value.repeatConfig.callsPerPrompt)+"Ã— repeat ",1)]),_:1})):_("",!0)]),n.value?(b(),y("div",le,[k("div",se,[k("div",{class:"progress-fill",style:P({width:Ze.value+"%"})},null,4)]),k("span",ie,[w(C(n.value.progress.completed)+" / "+C(n.value.progress.total)+" completed ",1),Je.value&&"running"===n.value.status?(b(),y("span",re," â€¢ "+C(Je.value)+" remaining ",1)):_("",!0),n.value.progress.networkErrors>0?(b(),y("span",ne,"("+C(n.value.progress.networkErrors)+" network errors)",1)):_("",!0)])])):_("",!0)]),n.value?(b(),y("div",oe,[k("div",ce,[k("span",ue,C(J.value.total)+" total",1),k("span",de,C(J.value.pending)+" pending",1),k("span",pe,C(J.value.running)+" running",1),k("span",ve,C(J.value.completed)+" completed",1),k("span",me,C(J.value.failed)+" failed",1)]),aa.value?(b(),y("div",fe,["running"===n.value.status?(b(),h(s,{key:0,size:"small",onClick:oa,loading:Y.value,"data-testid":"btn-pause-trial"},{icon:x(()=>[u(S(W))]),default:x(()=>[a[4]||(a[4]=w(" Pause "))]),_:1,__:[4]},8,["loading"])):"paused"===n.value.status?(b(),h(s,{key:1,type:"primary",size:"small",onClick:ca,loading:Y.value,"data-testid":"btn-resume-trial"},{icon:x(()=>[u(S(t))]),default:x(()=>[a[5]||(a[5]=w(" Resume "))]),_:1,__:[5]},8,["loading"])):_("",!0),"running"===n.value.status||"paused"===n.value.status?(b(),h(s,{key:2,danger:"",size:"small",onClick:ua,loading:Y.value,"data-testid":"btn-cancel-trial"},{icon:x(()=>[u(S(Q))]),default:x(()=>[a[6]||(a[6]=w(" Cancel "))]),_:1,__:[6]},8,["loading"])):_("",!0)])):_("",!0)])):_("",!0)]),n.value?(b(),y("div",ge,[u(r,{activeKey:V.value,"onUpdate:activeKey":a[2]||(a[2]=e=>V.value=e),type:"card"},{default:x(()=>[u(i,{key:"list",tab:"List View"},{default:x(()=>[k("div",ye,[I(k("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>c.value=e),class:"filter-select","data-testid":"filter-status","aria-label":"Filter by task status"},a[7]||(a[7]=[k("option",{value:"all"},"All Statuses",-1),k("option",{value:"pending"},"Pending",-1),k("option",{value:"running"},"Running",-1),k("option",{value:"completed"},"Completed",-1),k("option",{value:"failed"},"Failed",-1)]),512),[[E,c.value]]),I(k("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>d.value=e),type:"text",placeholder:"Search variables or response...",class:"search-input","data-testid":"input-search-tasks","aria-label":"Search tasks by variables or response content"},null,512),[[$,d.value]])]),k("div",be,[0===Qe.value.length?(b(),y("div",ke,[k("div",he,[a[8]||(a[8]=k("h4",null,"No API Calls",-1)),k("p",null,C(0===J.value.total?"Start the trial to see API calls here.":"No API calls match the current filters."),1)])])):(b(),y("div",_e,[a[10]||(a[10]=k("div",{class:"table-header"},[k("div",{class:"col-status"},"Status"),k("div",{class:"col-config"},"Config"),k("div",{class:"col-repeat"},"Repeat"),k("div",{class:"col-variables"},"Variables"),k("div",{class:"col-response"},"Response"),k("div",{class:"col-time"},"Time")],-1)),k("div",we,[(b(!0),y(j,null,z(ea.value,e=>{return b(),y("div",{key:e.id,class:F(["table-row",[e.status]]),onClick:a=>function(e){D.value=e}(e)},[k("div",xe,[k("span",{class:F(["status-badge",e.status])},C(e.status),3)]),k("div",Te,[k("div",Pe,[k("div",Se,C(ta(e.configurationIndex)),1),k("div",Ie,C(la(e.configurationIndex)),1)])]),k("div",Ee,[void 0!==e.repeatIndex?(b(),y("span",$e,C(e.repeatIndex+1)+"/"+C(n.value?.repeatConfig?.callsPerPrompt||1),1)):(b(),y("span",je,"â€”"))]),k("div",ze,[k("div",Fe,[(b(!0),y(j,null,z(Object.entries(e.variables),([a,t],l)=>(b(),y("span",{key:a,class:"variable-pair"},[k("span",Oe,C(a)+":",1),k("span",De,C(sa(t,30)),1),l<Object.entries(e.variables).length-1?(b(),y("span",Me,"â€¢")):_("",!0)]))),128))])]),k("div",Ae,["pending"===e.status?(b(),y("div",Le," Waiting... ")):"running"===e.status?(b(),y("div",Ue," Processing... ")):"failed"===e.status?(b(),y("div",Re,C(e.result?.error||"API call failed"),1)):e.result?.content?(b(),y("div",Ve,C(sa(String(e.result.content),100)),1)):(b(),y("div",Ne," No content "))]),k("div",Ke,[e.completed?(b(),y("div",Be,[k("div",qe,C((a=e.completed.getTime()-e.created.getTime(),a<1e3?`${a}ms`:`${(a/1e3).toFixed(1)}s`)),1),e.response?(b(),y("div",Ye,C(e.response.latencyMs)+"ms",1)):_("",!0)])):(b(),y("div",Ge,"â€”"))])],10,Ce);var a}),128))]),Qe.value.length>M.value?(b(),y("div",{key:0,ref_key:"scrollSentinel",ref:A,class:"scroll-sentinel"},a[9]||(a[9]=[k("div",{class:"loading-indicator"},[k("div",{class:"spinner"}),k("span",null,"Loading more results...")],-1)]),512)):_("",!0)]))])]),_:1}),u(i,{key:"pivot",tab:"Pivot Table"},{default:x(()=>[k("div",He,[o.value.length>0?(b(),h(U,{key:0,"api-calls":Qe.value,trial:n.value,config:N.value,"show-totals":!0,onConfigChange:pa,onCellClick:va},null,8,["api-calls","trial","config"])):(b(),y("div",We,a[11]||(a[11]=[k("div",{class:"placeholder-content"},[k("h4",null,"No Data Available"),k("p",null,"Start the trial to see pivot table analysis.")],-1)])))])]),_:1})]),_:1},8,["activeKey"])])):(b(),y("div",Xe,a[12]||(a[12]=[k("div",{class:"empty-state"},[k("div",{class:"placeholder-content"},[k("h4",null,"No Trial Selected"),k("p",null,"Click on a trial card to monitor its execution progress and view results.")])],-1)]))),D.value?(b(),h(R,{key:2,"api-call":D.value,trial:n.value,onClose:a[3]||(a[3]=e=>D.value=null)},null,8,["api-call","trial"])):_("",!0)])}}}),[["__scopeId","data-v-a6475ced"]]),Je={class:"trials-table-container full-width scientific-table-wrapper","data-testid":"trials-table-container"},Qe={key:0,class:"trial-name-cell"},ea={class:"trial-header"},aa={class:"trial-name"},ta={class:"trial-design"},la={class:"text-secondary"},sa={key:1,class:"progress-cell"},ia={class:"progress-text text-xs"},ra={key:0,class:"network-errors"},na={key:4,class:"api-calls-cell"},oa={class:"total-calls"},ca={class:"calls-calculation text-secondary"},ua={key:0},da={key:1,class:"text-secondary"},pa={class:"date-cell"},va={class:"date-value"},ma={class:"time-value text-secondary"},fa={key:7,class:"trial-actions-4"},ga=r(d({__name:"TrialsTable",props:{trials:{},isLoading:{type:Boolean,default:!1}},emits:["trial-selected","trial-started","trial-paused","trial-resumed","trial-cancelled","trial-exported","trial-duplicated","trial-deleted","trial-viewed","trial-export-data","trial-export-python","trial-edited","trial-retried","status-filter-changed"],setup(e,{emit:a}){const t=e,l=a,i=p("all"),r=[{key:"all",label:"All"},{key:"draft",label:"Draft"},{key:"pending",label:"Pending"},{key:"running",label:"Running"},{key:"paused",label:"Paused"},{key:"completed",label:"Completed"},{key:"failed",label:"Failed"},{key:"cancelled",label:"Cancelled"}],{createTrialColumns:o,getVisibleColumns:c}=q(),d=c(o()),m=v(()=>"all"===i.value?t.trials:t.trials.filter(e=>e.status===i.value));function f(e){i.value=e,l("status-filter-changed",e)}function g(e){return{onClick:a=>{const t=a.target;t.closest(".ant-btn")||t.closest(".ant-dropdown-trigger")||(s.debug("Row clicked",{name:e.name,id:e.id}),l("trial-selected",e))}}}function P(e){return"all"===e?t.trials.length:t.trials.filter(a=>a.status===e).length}function I(e){return"failed"===e.status?"exception":"completed"===e.status?"success":e.progress.networkErrors>0?"exception":"normal"}function E(e){const a=[];return"running"===e.status&&a.push("status-running"),"failed"===e.status&&a.push("status-failed"),"completed"===e.status&&a.push("status-completed"),a.join(" ")}function $(e){const a=(new Date).getTime()-e.getTime(),t=Math.floor(a/864e5);return 0===t?"Today":1===t?"Yesterday":t<7?`${t} days ago`:t<30?`${Math.floor(t/7)} weeks ago`:e.toLocaleDateString()}function O(e){const a=Math.abs(e);if(0===a)return"";if(a<.01){const e=a.toFixed(10).match(/0\.0*([1-9])/);if(e){const t=e[0].length-1;return`$${a.toFixed(Math.max(2,t))}`}}return`$${a.toFixed(2)}`}function M(e){l("trial-viewed",e)}function A(e){l("trial-duplicated",e)}return(e,a)=>{const t=T("a-tab-pane"),s=T("a-tabs"),o=T("a-tag"),c=T("a-progress"),p=T("a-tooltip"),v=T("a-button"),L=T("a-menu-item"),U=T("a-menu"),R=T("a-dropdown"),V=T("a-table");return b(),y("div",Je,[u(s,{activeKey:i.value,"onUpdate:activeKey":a[0]||(a[0]=e=>i.value=e),size:"small",class:"status-tabs","data-testid":"trials-status-tabs",onChange:f},{default:x(()=>[(b(),y(j,null,z(r,e=>u(t,{key:e.key,tab:`${e.label} (${P(e.key)})`},null,8,["tab"])),64))]),_:1},8,["activeKey"]),u(V,{columns:S(d),"data-source":m.value,pagination:!1,size:"small",scroll:{y:"calc(100vh - 200px)"},"row-key":"id","row-class-name":E,class:"scientific-table clickable-rows","custom-row":g,"data-testid":"table-trials",role:"table","aria-label":"Trials data table"},{bodyCell:x(({column:e,record:t})=>{return["name"===e.key?(b(),y("div",Qe,[k("div",ea,[k("strong",aa,C(t.name),1),u(o,{color:(i=t.status,{draft:"default",pending:"processing",running:"processing",paused:"warning",completed:"success",failed:"error",cancelled:"default"}[i]||"default"),size:"small",class:"trial-status-tag"},{default:x(()=>[w(C(t.status.toUpperCase()),1)]),_:2},1032,["color"])]),k("div",ta,[k("small",la," Design: "+C(t.designSnapshot?.originalName||"Unknown Design"),1)]),a[2]||(a[2]=k("div",{class:"click-hint"},[k("small",{class:"text-secondary"},"Click to view live progress")],-1))])):_("",!0),"progress"===e.key?(b(),y("div",sa,[u(c,{percent:(s=t,0===s.progress.total?0:Math.round(s.progress.completed/s.progress.total*100)),size:"small",status:I(t),"show-info":!1,class:"progress-bar"},null,8,["percent","status"]),k("div",ia,[w(C(t.progress.completed)+" / "+C(t.progress.total)+" ",1),t.progress.networkErrors>0?(b(),y("span",ra," ("+C(t.progress.networkErrors)+" errors) ",1)):_("",!0)])])):_("",!0),"configurations"===e.key?(b(),y(j,{key:2},[u(p,{title:`${t.configurationSnapshots?.length||0} model configurations`},{default:x(()=>[u(o,{size:"small",color:"blue"},{default:x(()=>[w(C(t.configurationSnapshots?.length||0)+" configs ",1)]),_:2},1024)]),_:2},1032,["title"]),t.repeatConfig?.callsPerPrompt&&t.repeatConfig.callsPerPrompt>1?(b(),h(o,{key:0,size:"small",color:"purple",style:{"margin-left":"4px"}},{default:x(()=>[w(C(t.repeatConfig.callsPerPrompt)+"Ã— repeat ",1)]),_:2},1024)):_("",!0)],64)):_("",!0),"variables"===e.key?(b(),h(p,{key:3,title:`${t.totalCombinations} variable combinations`},{default:x(()=>[u(o,{size:"small",color:"green"},{default:x(()=>[w(C(t.totalCombinations)+" combos ",1)]),_:2},1024)]),_:2},1032,["title"])):_("",!0),"api_calls"===e.key?(b(),y("div",na,[k("span",oa,C(t.progress.total),1),k("small",ca,[w(C(t.configurationSnapshots?.length||0)+" Ã— "+C(t.totalCombinations),1),t.repeatConfig?.callsPerPrompt&&t.repeatConfig.callsPerPrompt>1?(b(),y("span",ua," Ã— "+C(t.repeatConfig.callsPerPrompt),1)):_("",!0)])])):_("",!0),"cost"===e.key?(b(),y("span",{key:5,class:F(["cost-cell",{negative:t.estimatedCost<0}])},[O(t.estimatedCost)?(b(),y(j,{key:0},[w(C(O(t.estimatedCost)),1)],64)):(b(),y("span",da,"-"))],2)):_("",!0),"created"===e.key?(b(),h(p,{key:6,title:t.created.toLocaleString()},{default:x(()=>{return[k("div",pa,[k("span",va,C($(t.created)),1),k("small",ma,C((e=t.created,e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))),1)])];var e}),_:2},1032,["title"])):_("",!0),"actions"===e.key?(b(),y("div",fa,["draft"===t.status||"pending"===t.status?(b(),h(v,{key:0,size:"small",type:"primary",onClick:D(e=>function(e){l("trial-started",e)}(t),["stop"]),"data-testid":"trial-start-btn","data-trial-id":t.id,"aria-label":`Start trial ${t.name}`},{default:x(()=>a[3]||(a[3]=[w(" Start ")])),_:2,__:[3]},1032,["onClick","data-trial-id","aria-label"])):"running"===t.status?(b(),h(v,{key:1,size:"small",type:"primary",onClick:D(e=>M(t),["stop"]),"data-testid":"trial-view-live-btn","data-trial-id":t.id,"aria-label":`View live progress for ${t.name}`},{default:x(()=>a[4]||(a[4]=[w(" View Live ")])),_:2,__:[4]},1032,["onClick","data-trial-id","aria-label"])):"completed"===t.status?(b(),h(v,{key:2,size:"small",type:"primary",onClick:D(e=>M(t),["stop"]),"data-testid":"trial-results-btn","data-trial-id":t.id,"aria-label":`View results for ${t.name}`},{default:x(()=>a[5]||(a[5]=[w(" Results ")])),_:2,__:[5]},1032,["onClick","data-trial-id","aria-label"])):"failed"===t.status?(b(),h(v,{key:3,size:"small",type:"primary",onClick:D(e=>M(t),["stop"])},{default:x(()=>a[6]||(a[6]=[w(" Details ")])),_:2,__:[6]},1032,["onClick"])):"paused"===t.status?(b(),h(v,{key:4,size:"small",type:"primary",onClick:D(e=>function(e){l("trial-resumed",e)}(t),["stop"])},{default:x(()=>a[7]||(a[7]=[w(" Resume ")])),_:2,__:[7]},1032,["onClick"])):_("",!0),"draft"===t.status?(b(),h(v,{key:5,size:"small",onClick:D(e=>function(e){l("trial-edited",e)}(t),["stop"])},{default:x(()=>a[8]||(a[8]=[w(" Edit ")])),_:2,__:[8]},1032,["onClick"])):"running"===t.status?(b(),h(v,{key:6,size:"small",class:"btn-warning",onClick:D(e=>function(e){l("trial-paused",e)}(t),["stop"])},{default:x(()=>a[9]||(a[9]=[w(" Pause ")])),_:2,__:[9]},1032,["onClick"])):"completed"===t.status?(b(),h(v,{key:7,size:"small",onClick:D(e=>A(t),["stop"])},{default:x(()=>a[10]||(a[10]=[w(" Duplicate ")])),_:2,__:[10]},1032,["onClick"])):"failed"===t.status?(b(),h(v,{key:8,size:"small",class:"btn-warning",onClick:D(e=>function(e){l("trial-retried",e)}(t),["stop"])},{default:x(()=>a[11]||(a[11]=[w(" Retry ")])),_:2,__:[11]},1032,["onClick"])):"paused"===t.status?(b(),h(v,{key:9,size:"small",onClick:D(e=>M(t),["stop"])},{default:x(()=>a[12]||(a[12]=[w(" Progress ")])),_:2,__:[12]},1032,["onClick"])):(b(),h(v,{key:10,size:"small",onClick:D(e=>A(t),["stop"])},{default:x(()=>a[13]||(a[13]=[w(" Duplicate ")])),_:2,__:[13]},1032,["onClick"])),u(R,{trigger:"click"},{overlay:x(()=>[u(U,null,{default:x(()=>[u(L,{onClick:e=>function(e){l("trial-export-data",e)}(t)},{default:x(()=>a[15]||(a[15]=[w(" Export Data ")])),_:2,__:[15]},1032,["onClick"]),u(L,{onClick:e=>function(e){l("trial-export-python",e)}(t)},{default:x(()=>a[16]||(a[16]=[w(" Export Python ")])),_:2,__:[16]},1032,["onClick"])]),_:2},1024)]),default:x(()=>[u(v,{size:"small",class:"btn-success",onClick:a[1]||(a[1]=D(()=>{},["stop"]))},{default:x(()=>[a[14]||(a[14]=w(" Export ")),u(S(n))]),_:1,__:[14]})]),_:2},1024),"running"===t.status?(b(),h(v,{key:11,size:"small",danger:"",onClick:D(e=>function(e){l("trial-cancelled",e)}(t),["stop"])},{default:x(()=>a[17]||(a[17]=[w(" Cancel ")])),_:2,__:[17]},1032,["onClick"])):(b(),h(v,{key:12,size:"small",danger:"",onClick:D(e=>function(e){l("trial-deleted",e)}(t),["stop"])},{default:x(()=>a[18]||(a[18]=[w(" Delete ")])),_:2,__:[18]},1032,["onClick"]))])):_("",!0)];var s,i}),_:1},8,["columns","data-source"])])}}}),[["__scopeId","data-v-eadb10a6"]]),ya={class:"trials-view full-width","data-testid":"page-trials"},ba={class:"page-header"},ka={class:"header-actions"},ha={class:"main-content"},_a={key:0,class:"loading-state"},wa={key:1,class:"empty-state"},Ca={key:2,class:"trials-table-wrapper"},xa={key:0,class:"monitoring-content"},Ta={key:1,class:"monitoring-placeholder"},Pa=r(d({__name:"TrialsView",setup(e){const t=a(),l=o(),i=M(),r=L(),n=p(!1),d=p(null),m=p(null),g=p(!1),C=p(!1),P=p(null),I=p(null),E=p(!1),$=p(),j=v(()=>t.isLoading),z=v(()=>[...t.trials]),F=v(()=>l.hasAnyApiKeys||l.isProviderEnabled("ollama-chat")||l.isProviderEnabled("ollama-generate"));function O(e){s.info("Trial selected in TrialsView",{trialName:e.name,trialId:e.id}),m.value=e,g.value=!0}function D(e){s.info("Status filter changed",{status:e})}function U(e){"running"===e.status||"pending"===e.status?O(e):"completed"===e.status?r.push({name:"results",query:{trialId:e.id}}):d.value=e}function R(){n.value=!0}async function B(e){try{await t.executeTrial(e.id),s.info("Trial started",{trialId:e.id}),O(e)}catch(a){s.error("Failed to start trial",a),alert("Failed to start trial: "+(a instanceof Error?a.message:"Unknown error"))}}async function q(e){try{await t.pauseTrial(e.id),s.info("Pausing trial",{trialId:e.id})}catch(a){s.error("Failed to pause trial",a),alert("Failed to pause trial")}}async function Y(e){try{await t.executeTrial(e.id),s.info("Resuming trial",{trialId:e.id})}catch(a){s.error("Failed to resume trial",a),alert("Failed to resume trial")}}async function G(e){try{await t.cancelTrial(e.id),s.info("Cancelling trial",{trialId:e.id})}catch(a){s.error("Failed to cancel trial",a),alert("Failed to cancel trial")}}async function H(e){await X(e)}async function W(e){alert("Data export functionality coming soon")}async function X(e){try{const{PythonExportService:a}=await c(async()=>{const{PythonExportService:e}=await import("./PivotTableCore-V0QEtLzB.js").then(e=>e.p);return{PythonExportService:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]),import.meta.url),t=a.validateTrialForExport(e);if(!t.valid)return void alert(`Cannot export trial:\n${t.errors.join("\n")}`);P.value=e,C.value=!0}catch(a){s.error("Python export failed",a),alert(`Export failed: ${a instanceof Error?a.message:String(a)}`)}}function Z(e){s.info("Python script exported",{filename:e})}function J(e){I.value=e,E.value=!1,n.value=!0}function Q(e){I.value=e,E.value=!0,n.value=!0}async function ee(e){if(confirm(`Are you sure you want to delete "${e.name}"? This action cannot be undone.`))try{await t.deleteTrial(e.id)}catch(a){s.error("Failed to delete trial",a),alert("Failed to delete trial")}}function ae(e){s.info("Trial created",{trialId:e})}async function te(e){s.info("Trial created and started",{trialId:e}),await new Promise(e=>setTimeout(e,100));let a=z.value.find(a=>a.id===e),t=0;for(;!a&&t<5;)await new Promise(e=>setTimeout(e,200)),a=z.value.find(a=>a.id===e),t++;a?(m.value=a,g.value=!0):s.warn("Could not find trial for monitoring",{trialId:e})}function le(e){s.info("Opening export for trial",{trialId:e.id}),P.value=e,C.value=!0}function se(){}return f(async()=>{await t.initialize();const e=i.query.designId;e&&($.value=e,n.value=!0)}),(e,a)=>{const t=T("a-button"),l=T("a-alert"),s=T("a-spin"),i=T("a-empty"),r=T("a-modal");return b(),y("div",ya,[k("div",ba,[a[6]||(a[6]=k("div",{class:"header-content"},[k("h1",null,"Trials"),k("p",{class:"description"}," Systematic testing of LLM models with complete reproducibility ")],-1)),k("div",ka,[u(t,{type:"primary",size:"default",disabled:!F.value,onClick:R,"data-testid":"btn-create-trial","aria-label":"Create new trial"},{default:x(()=>a[5]||(a[5]=[w(" Create Trial ")])),_:1,__:[5]},8,["disabled"])])]),F.value?_("",!0):(b(),h(l,{key:0,type:"warning",message:"No LLM providers configured",description:"Add keys for external APIs (local Ollama does not need keys) or enable Ollama provider.","show-icon":"",class:"warning-banner",action:""},{action:x(()=>[u(S(A),{to:"/settings"},{default:x(()=>[u(t,{size:"small",type:"primary"},{default:x(()=>a[7]||(a[7]=[w(" Go to Settings ")])),_:1,__:[7]})]),_:1})]),_:1})),k("div",ha,[j.value?(b(),y("div",_a,[u(s,{size:"large"},{tip:x(()=>a[8]||(a[8]=[w("Loading trials...")])),_:1})])):0===z.value.length?(b(),y("div",wa,[u(i,{description:F.value?"No trials yet":"Configure LLM providers to start creating trials"},{image:x(()=>a[9]||(a[9]=[k("div",{style:{color:"#bfbfbf","font-size":"48px"}},"ðŸ§ª",-1)])),default:x(()=>[F.value?(b(),h(t,{key:0,type:"primary",onClick:a[0]||(a[0]=e=>n.value=!0)},{default:x(()=>a[10]||(a[10]=[w(" Create Your First Trial ")])),_:1,__:[10]})):_("",!0)]),_:1},8,["description"])])):(b(),y("div",Ca,[u(ga,{trials:z.value,"is-loading":j.value,onTrialSelected:O,onTrialStarted:B,onTrialPaused:q,onTrialResumed:Y,onTrialCancelled:G,onTrialExported:H,onTrialDuplicated:J,onTrialEdited:Q,onTrialDeleted:ee,onTrialViewed:U,onTrialExportData:W,onTrialExportPython:X,onStatusFilterChanged:D},null,8,["trials","is-loading"])]))]),u(r,{open:g.value,"onUpdate:open":a[1]||(a[1]=e=>g.value=e),title:`Live Progress: ${m.value?.name||"Trial"}`,width:"95vw",footer:null,"body-style":{padding:0,height:"90vh",overflow:"auto"},"destroy-on-close":!0,centered:!0},{default:x(()=>[m.value?(b(),y("div",xa,[u(Ze,{"trial-id":m.value.id},null,8,["trial-id"])])):(b(),y("div",Ta,[u(i,{description:"No trial selected for monitoring"})]))]),_:1},8,["open","title"]),n.value?(b(),h(V,{key:1,initialDesignId:$.value,trialToDuplicate:I.value,isEditMode:E.value,onClose:a[2]||(a[2]=e=>{n.value=!1,$.value=void 0,I.value=null,E.value=!1}),onCreated:ae,onCreatedAndStarted:te,onExportTrial:le},null,8,["initialDesignId","trialToDuplicate","isEditMode"])):_("",!0),d.value?(b(),h(N,{key:2,trial:d.value,onClose:a[3]||(a[3]=e=>d.value=null),onUpdated:se},null,8,["trial"])):_("",!0),C.value&&P.value?(b(),h(K,{key:3,trial:P.value,onClose:a[4]||(a[4]=e=>{C.value=!1,P.value=null}),onExported:Z},null,8,["trial"])):_("",!0)])}}}),[["__scopeId","data-v-aee0291b"]]);export{Pa as default};
