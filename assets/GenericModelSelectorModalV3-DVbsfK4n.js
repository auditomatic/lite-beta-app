import{u as ge}from"./useV4Models-CpNVp1kv.js";import{u as de}from"./useV4ProviderParameters-BMbBHKk2.js";import{i as Z,c as z,j as b,m as s,k as a,b as D,v as U,_ as W,u as _e,a9 as re,F as x,y as $,x as O,z as C,r as j,q as h,t as v,A as K,ag as he,D as H,aj as Ce,a3 as ue,w as X,n as ce,ak as be,a as A,al as ke}from"./index-BHXEDjmJ.js";const Me={class:"model-search-filters"},ye={class:"panel-header"},Pe={class:"search-container"},$e=Z({__name:"ModelSearchFiltersV3",props:{modelValue:{}},emits:["update:modelValue"],setup(R,{emit:m}){const l=R,q=m,k=z({get:()=>l.modelValue,set:B=>q("update:modelValue",B)});return(B,T)=>{const I=U("a-input-search");return s(),b("div",Me,[a("div",ye,[T[2]||(T[2]=a("h3",null,"Available Models",-1)),a("div",Pe,[T[1]||(T[1]=a("span",{class:"search-label"},"Search:",-1)),D(I,{value:k.value,"onUpdate:value":T[0]||(T[0]=p=>k.value=p),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])])])}}}),Te=W($e,[["__scopeId","data-v-56bdd915"]]),we={key:0,class:"cost-group"},Ae={class:"cost-item"},Ue={class:"cost-value"},qe={class:"cost-value"},Ee={key:1,class:"cost-group"},De={class:"enviro-group"},Oe={class:"enviro-item"},Fe={class:"enviro-item"},Be={class:"enviro-item"},Ie={key:0,class:"cost-group"},Ve={class:"cost-item"},Ge={class:"cost-value"},Se={class:"cost-value"},ze={class:"enviro-group"},xe={class:"enviro-item"},Re={class:"enviro-item"},Ne={class:"enviro-item"},Ke={key:0,class:"cost-item financial"},je={key:0,class:"cost-value"},Le={key:1,class:"cost-value"},Je={class:"cost-item environmental"},Qe={class:"enviro-item"},He={class:"enviro-value"},Ze={class:"enviro-item"},We={class:"enviro-value"},Xe={class:"enviro-item"},Ye={class:"enviro-value"},et={key:0,class:"cost-unit"},tt=Z({__name:"ModelCostDisplayV3",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(R){const m=R,l=_e();z(()=>l.settings.core.preferences.value);const q=z(()=>!0);function k(){if(!m.model.capabilities)return"â€”";const u=m.model.capabilities.inputCostPerToken||0,d=m.model.capabilities.outputCostPerToken||0;if(m.mode==="per-thousand"){const P=(u+d)*1e3;return B(P)}else if(m.mode==="total"){const P=u*m.inputTokens+d*m.outputTokens;return B(P)}return"â€”"}function B(u){return u===0?"0.00":u<.01?"<0.01":u<1?u.toFixed(2):u<10?u.toFixed(1):Math.round(u).toString()}function T(u){if(u===0)return"0";if(u>=.01)return u.toFixed(2).replace(/\.?0+$/,"");const P=u.toFixed(10).match(/^0\.0*[1-9]/);if(P){const S=P[0].length-2;return u.toFixed(S)}return u.toFixed(4)}function I(){if(!m.model.capabilities)return"0";const u=(m.model.capabilities.inputCostPerToken||0)*1e3;return T(u)}function p(){if(!m.model.capabilities)return"0";const u=(m.model.capabilities.outputCostPerToken||0)*1e3;return T(u)}function g(){if(!m.model.capabilities)return"?";const u=m.model.capabilities.inputCostPerToken||0,d=m.model.capabilities.outputCostPerToken||0,P=u*m.inputTokens+d*m.minOutputTokens;return T(P)}function E(){if(!m.model.capabilities||!m.maxOutputTokens)return"?";const u=m.model.capabilities.inputCostPerToken||0,d=m.model.capabilities.outputCostPerToken||0,P=u*m.inputTokens+d*m.maxOutputTokens;return T(P)}function M(u){return"??"}function y(u){return"??"}return(u,d)=>(s(),b("div",{class:re(["model-cost-display",[`layout-${u.layout}`,`size-${u.size}`]])},[u.mode==="range"?(s(),b(x,{key:0},[q.value&&u.maxOutputTokens?(s(),b("span",we,[a("span",Ae,[a("span",Ue,"$"+C(g()),1),d[0]||(d[0]=O(" - ")),a("span",qe,"$"+C(E()),1)])])):q.value?(s(),b("span",Ee,d[1]||(d[1]=[a("span",{class:"cost-item"},[a("span",{class:"cost-value"},"Cost: ??")],-1)]))):$("",!0),d[4]||(d[4]=a("span",{class:"cost-tab"},null,-1)),a("span",De,[a("span",Oe,"COâ‚‚ "+C(y()),1),d[2]||(d[2]=a("span",{class:"cost-tab"},null,-1)),a("span",Fe,"ðŸ’§"+C(y()),1),d[3]||(d[3]=a("span",{class:"cost-tab"},null,-1)),a("span",Be,"âš¡"+C(y()),1)])],64)):u.mode==="input-output"?(s(),b(x,{key:1},[q.value?(s(),b("span",Ie,[a("span",Ve,[a("span",Ge,"$"+C(I()),1),d[5]||(d[5]=O("/1K input + ")),a("span",Se,"$"+C(p()),1),d[6]||(d[6]=O("/1K output "))])])):$("",!0),d[9]||(d[9]=a("span",{class:"cost-tab"},null,-1)),a("span",ze,[a("span",xe,"COâ‚‚ "+C(M()),1),d[7]||(d[7]=a("span",{class:"cost-tab"},null,-1)),a("span",Re,"ðŸ’§"+C(M()),1),d[8]||(d[8]=a("span",{class:"cost-tab"},null,-1)),a("span",Ne,"âš¡"+C(M()),1)])],64)):(s(),b(x,{key:2},[q.value?(s(),b("div",Ke,[u.mode==="per-thousand"?(s(),b("span",je,[O(C(k())+" ",1),d[10]||(d[10]=a("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):u.mode==="total"?(s(),b("span",Le,C(k()),1)):$("",!0)])):$("",!0),a("div",Je,[a("span",Qe,[d[11]||(d[11]=a("span",{class:"enviro-icon"},"COâ‚‚",-1)),a("span",He,C(M()),1)]),a("span",Ze,[d[12]||(d[12]=a("span",{class:"enviro-icon"},"ðŸ’§",-1)),a("span",We,C(M()),1)]),a("span",Xe,[d[13]||(d[13]=a("span",{class:"enviro-icon"},"âš¡",-1)),a("span",Ye,C(M()),1)]),u.mode==="per-thousand"?(s(),b("span",et,"/ 1,000")):$("",!0)])],64))],2))}}),pe=W(tt,[["__scopeId","data-v-9917b0aa"]]),ot={class:"provider-header"},lt={class:"provider-name"},st={class:"provider-model-count"},nt={key:0,class:"api-key-warning"},at={class:"provider-models"},it=["onClick"],ut={class:"model-name"},dt={key:0,class:"model-specs"},rt=Z({__name:"ModelProviderGroupV3",props:{groupedModels:{},selectedModelId:{},mode:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function},hasConfigPanel:{type:Boolean},requiresApiKey:{type:Function},getProviderGroup:{type:Function},hasApiKey:{type:Function}},emits:["select-model"],setup(R){const m=j(void 0);function l(k){return k}function q(k){m.value===k?m.value=void 0:m.value=k}return(k,B)=>{const T=U("a-button"),I=U("a-collapse-panel"),p=U("a-collapse");return s(),h(p,{activeKey:m.value,"onUpdate:activeKey":B[0]||(B[0]=g=>m.value=g),bordered:!1,accordion:""},{default:v(()=>[(s(!0),b(x,null,K(k.groupedModels,(g,E)=>(s(),h(I,{key:E,class:"provider-panel","data-provider":E},{header:v(()=>[a("div",ot,[a("span",lt,C(E),1),a("span",st,C(g.length)+" models",1),k.requiresApiKey(E)&&!k.hasApiKey(k.getProviderGroup(E))?(s(),b("div",nt,[D(H(Ce)),B[1]||(B[1]=a("span",null,"API Key Missing",-1))])):$("",!0)])]),extra:v(()=>[D(T,{size:"small",type:"text",onClick:he(M=>q(E),["stop"])},{default:v(()=>[O(C(m.value===E?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:v(()=>[a("div",at,[(s(!0),b(x,null,K(g,M=>(s(),b("div",{key:M.id,class:re(["model-row",{selected:k.selectedModelId===M.id}]),onClick:y=>k.$emit("select-model",M)},[a("div",ut,C(M.displayName),1),k.hasConfigPanel?$("",!0):(s(),b("div",dt,[D(pe,{model:M,mode:k.mode==="trial"?"range":"input-output","input-tokens":k.getInputTokensForModel(M),"min-output-tokens":10,"max-output-tokens":k.getOutputTokensForModel(M),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])]))],10,it))),128))])]),_:2},1032,["data-provider"]))),128))]),_:1},8,["activeKey"])}}}),ct=W(rt,[["__scopeId","data-v-984223df"]]),pt={class:"config-panel"},ft={class:"config-header"},mt={class:"config-header-title"},vt={key:0,class:"total-cost"},gt={key:0,class:"cost-info"},_t={class:"config-content"},ht={class:"param-description"},Ct={class:"param-description"},bt={key:0,class:"config-footer"},kt={key:0,class:"duplicate-error"},Mt=Z({__name:"ModelConfigurationPanelV3",props:{selectedModel:{},mode:{},totalCalls:{default:1},costEstimate:{},getInputTokensForModel:{},getOutputTokensForModel:{},existingConfigurations:{},showCloseButton:{type:Boolean,default:!0},initialParameters:{}},emits:["close","add-configuration","confirm-selection","parameters-changed"],setup(R,{emit:m}){const l=R,q=m,{getBasicParameters:k,getAdvancedParameters:B,getParametersForModel:T}=de(),I=j(""),p=ue({}),g=ue({}),E=j(""),M=z(()=>l.selectedModel?k(l.selectedModel.provider,l.selectedModel.modelId):{}),y=z(()=>l.selectedModel?B(l.selectedModel.provider,l.selectedModel.modelId):{});function u(t){if(!t)return;A.debug("PARAMDEBUG: setModelDefaults called for",t.provider,t.modelId,"mode:",l.mode),l.mode==="trial"&&(I.value=t.displayName),Object.keys(p).forEach(o=>delete p[o]),Object.keys(g).forEach(o=>delete g[o]);const e=T(t.provider,t.modelId);if(l.initialParameters&&Object.keys(l.initialParameters).length>0){A.debug("PARAMDEBUG: using initial parameters:",l.initialParameters),Object.assign(p,l.initialParameters);for(const[o,i]of Object.entries(l.initialParameters)){const _=e[o];i===(_==null?void 0:_.default)?g[o]={mode:"default"}:g[o]={mode:"custom",value:i}}}else{A.debug("PARAMDEBUG: allParams found:",Object.keys(e));for(const[o,i]of Object.entries(e))i.required?i.default!==void 0?(g[o]={mode:"default"},p[o]=i.default,A.debug("PARAMDEBUG: setting required param",o,"to default =",i.default)):(g[o]={mode:"custom",value:null},p[o]=null,A.debug("PARAMDEBUG: required param",o,"needs user input")):i.default!==void 0?(g[o]={mode:"default"},p[o]=i.default,A.debug("PARAMDEBUG: setting optional param",o,"to default =",i.default)):(g[o]={mode:"unset"},p[o]=null,A.debug("PARAMDEBUG: optional param",o,"starts unset"));A.debug("PARAMDEBUG: final parameters:",{...p}),A.debug("PARAMDEBUG: parameter states:",{...g})}}X(()=>l.selectedModel,t=>{u(t),E.value=""},{immediate:!0}),X(p,()=>{E.value=""},{deep:!0}),ce(()=>{l.selectedModel&&u(l.selectedModel)});function d(t,e){const o=g[t],i=p[t];return A.debug("PLACEHOLDER DEBUG:",t,"state:",o==null?void 0:o.mode,"value:",i,"param.default:",e.default),!e.required&&(i==null||i==="")||(o==null?void 0:o.mode)==="unset"?"Not set (parameter will be omitted)":e.default!==void 0?(o==null?void 0:o.mode)==="default"?`Using default: ${e.default}`:`Default: ${e.default} (enter to override)`:e.required?"Required - enter value":"Enter value (optional)"}function P(t){const e=g[t],o=l.selectedModel?T(l.selectedModel.provider,l.selectedModel.modelId)[t]:void 0;if(o!=null&&o.required&&(e==null?void 0:e.mode)==="unset"||o!=null&&o.required&&(e==null?void 0:e.mode)==="custom"&&!e.value)return"error";if((e==null?void 0:e.mode)==="default")return"warning"}function S(t){return t.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function G(t,e,o){A.debug("PARAMDEBUG: handleParameterChange",t,"new value:",e,"param.required:",o.required),e==null||e===""?o!=null&&o.required?o.default!==void 0&&(p[t]=o.default,g[t]={mode:"default"},A.debug("PARAMDEBUG: Required param",t,"cleared, reverting to default:",o.default)):(p[t]=null,g[t]={mode:"unset"},A.debug("PARAMDEBUG: Optional param",t,"cleared, setting to unset")):(p[t]=e,e===(o==null?void 0:o.default)?g[t]={mode:"default"}:g[t]={mode:"custom",value:e}),(l.mode==="playground"||l.mode==="standalone")&&q("parameters-changed",{...p})}function Y(){const t=[],e=l.selectedModel?T(l.selectedModel.provider,l.selectedModel.modelId):{};for(const[o,i]of Object.entries(g)){const _=e[o];_!=null&&_.required&&(i.mode==="unset"?t.push(`${S(o)} is required`):i.mode==="custom"&&(i.value===null||i.value===void 0||i.value==="")&&t.push(`${S(o)} needs a value`)),i.mode==="custom"&&i.value!==void 0&&i.value!==null&&((_==null?void 0:_.min)!==void 0&&i.value<_.min&&t.push(`${S(o)} must be >= ${_.min}`),(_==null?void 0:_.max)!==void 0&&i.value>_.max&&t.push(`${S(o)} must be <= ${_.max}`))}return{valid:t.length===0,errors:t}}function ee(){if(!l.selectedModel||l.mode==="trial"&&!I.value)return null;const t={},e=T(l.selectedModel.provider,l.selectedModel.modelId),o=(i,_,F)=>{const w=_.split(".");let N=i;for(let V=0;V<w.length-1;V++)N[w[V]]||(N[w[V]]={}),N=N[w[V]];N[w[w.length-1]]=F};for(const[i,_]of Object.entries(g)){const F=e[i];let w;switch(_.mode){case"default":w=F==null?void 0:F.default,A.debug("PARAMDEBUG: Using default for",i,"=",w);break;case"custom":w=_.value,A.debug("PARAMDEBUG: Using custom value for",i,"=",w);break;case"unset":A.debug("PARAMDEBUG: Skipping unset param",i);continue}w!=null&&w!==""?o(t,i,w):w===!1?o(t,i,!1):F!=null&&F.required&&console.error(`Required parameter ${i} has no valid value`)}return{name:l.mode==="trial"?I.value:l.selectedModel.displayName,provider:l.selectedModel.provider,modelId:l.selectedModel.modelId,parameters:t}}function L(){E.value="";const t=Y();if(!t.valid){E.value=`Invalid configuration: ${t.errors.join(", ")}`;return}const e=ee();if(e){if(l.existingConfigurations&&l.existingConfigurations.some(i=>i.provider===e.provider&&i.modelId===e.modelId&&JSON.stringify(i.parameters)===JSON.stringify(e.parameters))){E.value=`${e.provider}:${e.modelId} with these parameters is already added. Please modify the parameters or select a different model.`;return}q("add-configuration",e)}}function J(t){var e;return((e=l.getInputTokensForModel)==null?void 0:e.call(l,t))||1e3}function f(t){var e;return((e=l.getOutputTokensForModel)==null?void 0:e.call(l,t))||1e3}return(t,e)=>{var ne,ae,ie;const o=U("a-button"),i=U("a-input"),_=U("a-form-item"),F=U("a-tag"),w=U("a-input-number"),N=U("a-switch"),V=U("a-select-option"),te=U("a-select"),oe=U("a-col"),le=U("a-row"),se=U("a-collapse-panel"),fe=U("a-collapse"),me=U("a-form"),ve=U("a-alert");return s(),b("div",pt,[a("div",ft,[a("div",mt,[a("h3",null,C(t.mode==="trial"?"Configure":"Model Parameters")+": "+C(t.selectedModel.displayName),1),t.showCloseButton?(s(),h(o,{key:0,type:"text",onClick:e[0]||(e[0]=n=>t.$emit("close")),class:"config-close-btn","aria-label":"Close configuration panel"},{default:v(()=>[D(H(be))]),_:1})):$("",!0)]),t.mode==="trial"?(s(),b("div",vt,[D(pe,{model:t.selectedModel,mode:"total","input-tokens":((ae=(ne=t.costEstimate)==null?void 0:ne.inputTokens)==null?void 0:ae.avgTokens)||J(t.selectedModel),"output-tokens":((ie=t.costEstimate)==null?void 0:ie.outputTokens)||f(t.selectedModel),layout:"inline",size:"large"},null,8,["model","input-tokens","output-tokens"]),t.totalCalls>1?(s(),b("span",gt,"("+C(t.totalCalls)+" calls)",1)):$("",!0)])):$("",!0)]),a("div",_t,[D(me,{layout:"vertical"},{default:v(()=>[t.mode==="trial"?(s(),h(_,{key:0,label:"Configuration Name",required:""},{default:v(()=>[D(i,{value:I.value,"onUpdate:value":e[1]||(e[1]=n=>I.value=n),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1})):$("",!0),D(fe,{"default-active-key":["basic"],ghost:""},{default:v(()=>[D(se,{key:"basic",header:"Basic Parameters"},{default:v(()=>[D(le,{gutter:16},{default:v(()=>[(s(!0),b(x,null,K(M.value,(n,r)=>(s(),h(oe,{key:r,span:t.mode==="playground"?24:12},{default:v(()=>[D(_,null,{label:v(()=>{var c,Q;return[a("span",null,C(S(r)),1),n.required?(s(),h(F,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[2]||(e[2]=[O("Required")])),_:1,__:[2]})):((c=g[r])==null?void 0:c.mode)==="default"?(s(),h(F,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[3]||(e[3]=[O("Default")])),_:1,__:[3]})):((Q=g[r])==null?void 0:Q.mode)==="unset"?(s(),h(F,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[4]||(e[4]=[O("Not Set")])),_:1,__:[4]})):$("",!0)]}),default:v(()=>[n.type==="number"?(s(),h(w,{key:0,value:p[r],"onUpdate:value":c=>p[r]=c,min:n.min,max:n.max,step:.1,placeholder:d(r,n),"allow-clear":!n.required,status:P(r),style:{width:"100%"},size:"large",onChange:c=>G(r,c,n)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):n.type==="integer"?(s(),h(w,{key:1,value:p[r],"onUpdate:value":c=>p[r]=c,min:n.min,max:n.max,placeholder:d(r,n),"allow-clear":!n.required,status:P(r),style:{width:"100%"},size:"large",onChange:c=>G(r,c,n)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):n.type==="boolean"?(s(),h(N,{key:2,checked:p[r],"onUpdate:checked":c=>p[r]=c,"checked-children":"true","un-checked-children":"false",onChange:G},null,8,["checked","onUpdate:checked"])):n.type==="string"&&n.enum?(s(),h(te,{key:3,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:n.default?`Default: ${n.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!n.required,status:P(r),onChange:G},{default:v(()=>[n.default?(s(),h(V,{key:0,value:n.default},{default:v(()=>[O(C(n.default)+" (default) ",1)]),_:2},1032,["value"])):$("",!0),n.required?$("",!0):(s(),h(V,{key:1,value:void 0},{default:v(()=>e[5]||(e[5]=[a("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[5]})),(s(!0),b(x,null,K(n.enum.filter(c=>c!==n.default),c=>(s(),h(V,{key:c,value:c},{default:v(()=>[O(C(c),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(s(),h(i,{key:4,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:d(r,n),"allow-clear":!n.required,status:P(r),size:"large",onChange:G},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),a("div",ht,C(n.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1}),Object.keys(y.value).length>0?(s(),h(se,{key:"advanced",header:"Advanced Parameters"},{default:v(()=>[D(le,{gutter:16},{default:v(()=>[(s(!0),b(x,null,K(y.value,(n,r)=>(s(),h(oe,{key:r,span:t.mode==="playground"?24:12},{default:v(()=>[D(_,null,{label:v(()=>{var c,Q;return[a("span",null,C(S(r)),1),n.required?(s(),h(F,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[6]||(e[6]=[O("Required")])),_:1,__:[6]})):((c=g[r])==null?void 0:c.mode)==="default"?(s(),h(F,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[7]||(e[7]=[O("Default")])),_:1,__:[7]})):((Q=g[r])==null?void 0:Q.mode)==="unset"?(s(),h(F,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:v(()=>e[8]||(e[8]=[O("Not Set")])),_:1,__:[8]})):$("",!0)]}),default:v(()=>[n.type==="number"||n.type==="integer"?(s(),h(w,{key:0,value:p[r],"onUpdate:value":c=>p[r]=c,min:n.min,max:n.max,step:n.type==="number"?.1:1,placeholder:d(r,n),"allow-clear":!n.required,status:P(r),style:{width:"100%"},size:"large",onChange:c=>G(r,c,n)},null,8,["value","onUpdate:value","min","max","step","placeholder","allow-clear","status","onChange"])):n.type==="boolean"?(s(),h(N,{key:1,checked:p[r],"onUpdate:checked":c=>p[r]=c,"checked-children":"true","un-checked-children":"false",onChange:G},null,8,["checked","onUpdate:checked"])):n.type==="string"&&n.enum?(s(),h(te,{key:2,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:n.default?`Default: ${n.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!n.required,status:P(r),onChange:G},{default:v(()=>[n.default?(s(),h(V,{key:0,value:n.default},{default:v(()=>[O(C(n.default)+" (default) ",1)]),_:2},1032,["value"])):$("",!0),n.required?$("",!0):(s(),h(V,{key:1,value:void 0},{default:v(()=>e[9]||(e[9]=[a("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[9]})),(s(!0),b(x,null,K(n.enum.filter(c=>c!==n.default),c=>(s(),h(V,{key:c,value:c},{default:v(()=>[O(C(c),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(s(),h(i,{key:3,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:d(r,n),"allow-clear":!n.required,status:P(r),size:"large",onChange:G},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),a("div",Ct,C(n.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1})):$("",!0)]),_:1})]),_:1})]),t.mode==="trial"?(s(),b("div",bt,[E.value?(s(),b("div",kt,[D(ve,{message:E.value,type:"error",showIcon:"",style:{marginBottom:"10px"}},null,8,["message"])])):$("",!0),D(o,{type:"primary",size:"large",onClick:L,disabled:!I.value||!t.selectedModel},{default:v(()=>e[10]||(e[10]=[O(" Add Model Configuration to Trial ")])),_:1,__:[10]},8,["disabled"])])):$("",!0)])}}}),yt=W(Mt,[["__scopeId","data-v-e7d687ef"]]),Pt={class:"modal-content-wrapper"},$t={key:0,class:"loading-container"},Tt={key:1,class:"modal-content"},wt={class:"models-panel"},At={class:"models-list"},Ut=Z({__name:"GenericModelSelectorModalV3",props:{visible:{type:Boolean},mode:{default:"single"},trialContext:{},design:{},title:{},existingConfigurations:{},showConfigPanel:{type:Boolean,default:!0}},emits:["update:visible","add-configuration","select-model","confirm"],setup(R,{emit:m}){const l=R,q=m,{enabledModels:k,loading:B}=ge(),{requiresApiKey:T,getProviderGroup:I}=de(),{hasApiKey:p}=ke(),g=z(()=>k.value||[]),E=z(()=>{const f=g.value.length>0;return B.value&&!f}),M=j(""),y=j(null),u=j(null),d=z(()=>{if(!g.value)return{};let f=g.value;if(M.value){const e=M.value.toLowerCase();f=f.filter(o=>o.displayName.toLowerCase().includes(e)||o.modelId.toLowerCase().includes(e))}const t={};for(const e of f)t[e.provider]||(t[e.provider]=[]),t[e.provider].push(e);for(const e in t)t[e].sort((o,i)=>o.displayName.localeCompare(i.displayName));return t}),P=z(()=>{var f;if(l.mode!=="trial")return 1;if(l.trialContext)return l.trialContext.totalCombinations;if(l.design){let t=1;for(const e of Object.values(l.design.variableBindings))e.type==="direct"&&(t*=((f=e.values)==null?void 0:f.length)||1);return t}return 1});X([y],async()=>{if(!y.value||l.mode!=="trial"){u.value=null;return}if(!l.trialContext&&!l.design){u.value=null;return}try{const f=L(y.value),t=J(y.value),e=y.value.capabilities;if(e!=null&&e.inputCostPerToken&&(e!=null&&e.outputCostPerToken)){const o=f*e.inputCostPerToken/1e3,i=t*e.outputCostPerToken/1e3,_=(o+i)*P.value;u.value={inputTokens:{avgTokens:f},outputTokens:t,totalCost:_,inputCost:o,outputCost:i}}else u.value=null}catch(f){A.error("Failed to calculate cost estimate:",f),u.value=null}});function S(f){if(y.value=f,l.mode==="playground"){q("select-model",f),q("update:visible",!1);return}}function G(f){A.info("ðŸŽ¯ GenericModelSelectorModalV3: Emitting add-configuration",{config:f,mode:l.mode}),l.mode==="single"?(q("confirm",{model:y.value,configuration:f}),q("update:visible",!1)):q("add-configuration",f)}function Y(f){q("select-model",f),q("update:visible",!1)}function ee(){y.value=null}function L(f){var t;if(l.mode==="trial"){if(l.trialContext)return l.trialContext.avgTokens;if(l.design)return((t=l.design.tokenEstimate)==null?void 0:t.avgTokens)||150}return 1e3}function J(f){var t;return l.mode==="trial"?((t=f.capabilities)==null?void 0:t.maxTokens)||256:1e3}return X(()=>l.visible,f=>{f&&(y.value=null,M.value="",A.debug("GenericModelSelectorModalV3 opened - reset selection"))}),ce(()=>{A.debug("GenericModelSelectorModalV3 mounted",{mode:l.mode,open:l.open})}),(f,t)=>{const e=U("a-spin"),o=U("a-modal");return s(),h(o,{open:f.visible,onCancel:t[1]||(t[1]=i=>f.$emit("update:visible",!1)),title:f.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:v(()=>{var i;return[a("div",Pt,[E.value?(s(),b("div",$t,[D(e,{size:"large",tip:"Loading models..."})])):(s(),b("div",Tt,[a("div",wt,[D(Te,{modelValue:M.value,"onUpdate:modelValue":t[0]||(t[0]=_=>M.value=_)},null,8,["modelValue"]),a("div",At,[D(ct,{"grouped-models":d.value,"selected-model-id":(i=y.value)==null?void 0:i.id,mode:f.mode,"get-input-tokens-for-model":L,"get-output-tokens-for-model":J,"has-config-panel":!!y.value,"requires-api-key":H(T),"get-provider-group":H(I),"has-api-key":H(p),onSelectModel:S},null,8,["grouped-models","selected-model-id","mode","has-config-panel","requires-api-key","get-provider-group","has-api-key"])])]),y.value&&f.mode==="trial"?(s(),h(yt,{key:0,"selected-model":y.value,mode:f.mode,"total-calls":P.value,"cost-estimate":u.value,"get-input-tokens-for-model":L,"get-output-tokens-for-model":J,"existing-configurations":f.existingConfigurations,onClose:ee,onAddConfiguration:G,onConfirmSelection:Y},null,8,["selected-model","mode","total-calls","cost-estimate","existing-configurations"])):$("",!0)]))])]}),_:1},8,["open","title"])}}}),Ot=W(Ut,[["__scopeId","data-v-6455ba79"]]);export{Ot as G,pe as M};
