import{_ as e,p as l,T as t,d as a,l as o}from"./index-C6frMIbt.js";import{t as d}from"./token-calculation.service-CRZmWNbv.js";import{d as n,c as s,aa as i,Z as u,a0 as r,k as c,Y as p,f as m,X as v,_ as f,ab as g,F as k,a3 as y,a2 as h,B as _,G as C,r as M,w as b,$ as x,u as U}from"./vendor-B8IWC-3k.js";import{M as w}from"./ModelCostDisplay-BBgVSnoX.js";const I={class:"model-search-filters"},S={class:"panel-header"},T={class:"search-container"},F=e(n({__name:"ModelSearchFilters",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:l}){const t=e,a=l,o=s({get:()=>t.modelValue,set:e=>a("update:modelValue",e)});return(e,l)=>{const t=p("a-input-search");return u(),i("div",I,[r("div",S,[l[2]||(l[2]=r("h3",null,"Available Models",-1)),r("div",T,[l[1]||(l[1]=r("span",{class:"search-label"},"Search:",-1)),c(t,{value:o.value,"onUpdate:value":l[0]||(l[0]=e=>o.value=e),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])])])}}}),[["__scopeId","data-v-b69ac8fd"]]),z={class:"provider-header"},O={class:"provider-name"},P={class:"provider-model-count"},j={class:"provider-models"},E=["onClick"],A={class:"model-name"},B={class:"model-specs"},N=e(n({__name:"ModelProviderGroup",props:{groupedModels:{},selectedModelId:{},mode:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function},hasConfigPanel:{type:Boolean}},emits:["select-model"],setup(e){const l=m([]);return(e,t)=>{const a=p("a-button"),o=p("a-collapse-panel"),d=p("a-collapse");return u(),v(d,{activeKey:l.value,"onUpdate:activeKey":t[0]||(t[0]=e=>l.value=e),bordered:!1},{default:f(()=>[(u(!0),i(k,null,g(e.groupedModels,(t,d)=>(u(),v(o,{key:d,class:"provider-panel"},{header:f(()=>[r("div",z,[r("span",O,h(d),1),r("span",P,h(t.length)+" models",1)])]),extra:f(()=>[c(a,{size:"small",type:"text",onClick:_(e=>function(e){const t=l.value.indexOf(e);t>-1?l.value.splice(t,1):l.value.push(e)}(d),["stop"])},{default:f(()=>[C(h(l.value.includes(d)?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:f(()=>[r("div",j,[(u(!0),i(k,null,g(t,l=>(u(),i("div",{key:l.id,class:y(["model-row",{selected:e.selectedModelId===l.id}]),onClick:t=>e.$emit("select-model",l)},[r("div",A,h(l.displayName),1),r("div",B,[c(w,{model:l,mode:"trial"===e.mode?"range":"input-output","input-tokens":e.getInputTokensForModel(l),"min-output-tokens":10,"max-output-tokens":e.getOutputTokensForModel(l),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])])],10,E))),128))])]),_:2},1024))),128))]),_:1},8,["activeKey"])}}}),[["__scopeId","data-v-d7f63954"]]),V={class:"config-panel"},G={class:"config-header"},$={class:"config-header-title"},L={class:"total-cost"},K={key:0,class:"cost-info"},D={key:0,class:"config-content"},q={class:"param-description"},Q={class:"param-description"},X={class:"config-footer"},Y=e(n({__name:"ModelConfigurationPanel",props:{selectedModel:{},mode:{},totalCalls:{},costEstimate:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function}},emits:["close","add-configuration","confirm-selection"],setup(e){const a=e,o=m(""),d=M({}),n=s(()=>a.selectedModel?l.getBasicParameters(a.selectedModel.provider,a.selectedModel.modelId):{}),y=s(()=>a.selectedModel?l.getAdvancedParameters(a.selectedModel.provider,a.selectedModel.modelId):{});function _(e){return e.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}return b(()=>a.selectedModel,e=>{if(!e)return;o.value=e.displayName,Object.keys(d).forEach(e=>delete d[e]);const t={...l.getBasicParameters(e.provider,e.modelId),...l.getAdvancedParameters(e.provider,e.modelId)};for(const[l,a]of Object.entries(t))void 0!==a.default&&(d[l]=a.default)},{immediate:!0}),(e,l)=>{const s=p("a-button"),m=p("a-input"),M=p("a-form-item"),b=p("a-input-number"),I=p("a-switch"),S=p("a-select-option"),T=p("a-select"),F=p("a-col"),z=p("a-row"),O=p("a-collapse-panel"),P=p("a-collapse"),j=p("a-form");return u(),i("div",V,[r("div",G,[r("div",$,[r("h3",null,h("trial"===e.mode?"Configure":"Selected")+": "+h(e.selectedModel.displayName),1),c(s,{type:"text",onClick:l[0]||(l[0]=l=>e.$emit("close")),class:"config-close-btn","aria-label":"Close configuration panel"},{default:f(()=>[c(U(t))]),_:1})]),r("div",L,[c(w,{model:e.selectedModel,mode:"trial"===e.mode?"total":"input-output","input-tokens":e.costEstimate?.inputTokens.avgTokens||e.getInputTokensForModel(e.selectedModel),"output-tokens":e.costEstimate?.outputTokens||e.getOutputTokensForModel(e.selectedModel),layout:"inline",size:"large"},null,8,["model","mode","input-tokens","output-tokens"]),"trial"===e.mode&&e.totalCalls>1?(u(),i("span",K,"("+h(e.totalCalls)+" calls)",1)):x("",!0)])]),"trial"===e.mode?(u(),i("div",D,[c(j,{layout:"vertical"},{default:f(()=>[c(M,{label:"Configuration Name",required:""},{default:f(()=>[c(m,{value:o.value,"onUpdate:value":l[1]||(l[1]=e=>o.value=e),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1}),c(P,{"default-active-key":["basic"],ghost:""},{default:f(()=>[c(O,{key:"basic",header:"Basic Parameters"},{default:f(()=>[c(z,{gutter:16},{default:f(()=>[(u(!0),i(k,null,g(n.value,(e,t)=>(u(),v(F,{key:t,span:12},{default:f(()=>[c(M,{label:_(t)},{default:f(()=>["number"===e.type?(u(),v(b,{key:0,value:d[t],"onUpdate:value":e=>d[t]=e,min:e.min,max:e.max,step:.1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"integer"===e.type?(u(),v(b,{key:1,value:d[t],"onUpdate:value":e=>d[t]=e,min:e.min,max:e.max,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"boolean"===e.type?(u(),v(I,{key:2,checked:d[t],"onUpdate:checked":e=>d[t]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(u(),v(T,{key:3,value:d[t],"onUpdate:value":e=>d[t]=e,placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:f(()=>[c(S,{value:void 0},{default:f(()=>l[4]||(l[4]=[r("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[4]}),(u(!0),i(k,null,g(e.enum,e=>(u(),v(S,{key:e,value:e},{default:f(()=>[C(h(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(u(),v(m,{key:4,value:d[t],"onUpdate:value":e=>d[t]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),r("div",q,h(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1}),Object.keys(y.value).length>0?(u(),v(O,{key:"advanced",header:"Advanced Parameters"},{default:f(()=>[c(z,{gutter:16},{default:f(()=>[(u(!0),i(k,null,g(y.value,(e,t)=>(u(),v(F,{key:t,span:12},{default:f(()=>[c(M,{label:_(t)},{default:f(()=>["number"===e.type||"integer"===e.type?(u(),v(b,{key:0,value:d[t],"onUpdate:value":e=>d[t]=e,min:e.min,max:e.max,step:"number"===e.type?.1:1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","step","placeholder"])):"boolean"===e.type?(u(),v(I,{key:1,checked:d[t],"onUpdate:checked":e=>d[t]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(u(),v(T,{key:2,value:d[t],"onUpdate:value":e=>d[t]=e,placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:f(()=>[c(S,{value:void 0},{default:f(()=>l[5]||(l[5]=[r("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[5]}),(u(!0),i(k,null,g(e.enum,e=>(u(),v(S,{key:e,value:e},{default:f(()=>[C(h(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(u(),v(m,{key:3,value:d[t],"onUpdate:value":e=>d[t]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),r("div",Q,h(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1})):x("",!0)]),_:1})]),_:1})])):x("",!0),r("div",X,["trial"===e.mode?(u(),v(s,{key:0,type:"primary",size:"large",onClick:l[2]||(l[2]=l=>e.$emit("add-configuration",function(){if(!a.selectedModel||!o.value)return null;const e={},l=(e,l,t)=>{const a=l.split(".");let o=e;for(let d=0;d<a.length-1;d++)o[a[d]]||(o[a[d]]={}),o=o[a[d]];o[a[a.length-1]]=t};for(const[t,a]of Object.entries(d))(null!=a&&""!==a||!1===a)&&l(e,t,a);return{name:o.value,provider:a.selectedModel.provider,modelId:a.selectedModel.modelId,parameters:e}}())),disabled:!o.value||!e.selectedModel},{default:f(()=>l[6]||(l[6]=[C(" Add Configuration ")])),_:1,__:[6]},8,["disabled"])):(u(),v(s,{key:1,type:"primary",size:"large",onClick:l[3]||(l[3]=l=>e.$emit("confirm-selection",e.selectedModel)),disabled:!e.selectedModel},{default:f(()=>l[7]||(l[7]=[C(" Select Model ")])),_:1,__:[7]},8,["disabled"]))])])}}}),[["__scopeId","data-v-57e055eb"]]),Z={class:"modal-content-wrapper"},H={class:"modal-content"},J={class:"models-panel"},R={class:"models-list"},W=e(n({__name:"GenericModelSelectorModal",props:{open:{type:Boolean},mode:{},trialContext:{},design:{},title:{},existingConfigurations:{}},emits:["close","add-configuration","select-model"],setup(e,{emit:l}){const t=e,n=l,i=a(),g=m(""),k=m(null),y=m(null),h=s(()=>{let e=i.enabledModels;if(g.value){const l=g.value.toLowerCase();e=e.filter(e=>e.displayName.toLowerCase().includes(l)||e.modelId.toLowerCase().includes(l))}const l={};for(const t of e)l[t.provider]||(l[t.provider]=[]),l[t.provider].push(t);for(const t in l)l[t].sort((e,l)=>e.displayName.localeCompare(l.displayName));return l}),_=s(()=>{if("trial"!==t.mode)return 1;if(t.trialContext)return t.trialContext.totalCombinations;if(t.design){let e=1;for(const l of Object.values(t.design.variableBindings))"direct"===l.type&&(e*=l.values?.length||1);return e}return 1});function C(e){if(k.value=e,"playground"===t.mode)return n("select-model",e),void n("close")}function M(e){n("add-configuration",e)}function U(e){n("select-model",e),n("close")}function w(){k.value=null}function I(e){if("trial"===t.mode){if(t.trialContext)return t.trialContext.avgTokens;if(t.design)return t.design.tokenEstimate?.avgTokens||150}return 1e3}function S(e){if("trial"===t.mode){return d.getOutputTokenLimit(e.provider,e.modelId,{})||256}return 1e3}return b([k],async()=>{if(k.value&&"trial"===t.mode)if(t.trialContext||t.design)try{t.trialContext?y.value=await d.calculateCostEstimateFromContext(t.trialContext.totalCombinations,t.trialContext.avgTokens,k.value,{}):t.design&&(y.value=await d.calculateCostEstimate(t.design,k.value,{}))}catch(e){o.error("Failed to calculate cost estimate:",e),y.value=null}else y.value=null;else y.value=null}),(e,l)=>{const t=p("a-modal");return u(),v(t,{open:e.open,onCancel:l[1]||(l[1]=l=>e.$emit("close")),title:e.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:f(()=>[r("div",Z,[r("div",H,[r("div",J,[c(F,{modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=e=>g.value=e)},null,8,["modelValue"]),r("div",R,[c(N,{"grouped-models":h.value,"selected-model-id":k.value?.id,mode:e.mode,"get-input-tokens-for-model":I,"get-output-tokens-for-model":S,"has-config-panel":!!k.value,onSelectModel:C},null,8,["grouped-models","selected-model-id","mode","has-config-panel"])])]),k.value&&"trial"===e.mode?(u(),v(Y,{key:0,"selected-model":k.value,mode:e.mode,"total-calls":_.value,"cost-estimate":y.value,"get-input-tokens-for-model":I,"get-output-tokens-for-model":S,onClose:w,onAddConfiguration:M,onConfirmSelection:U},null,8,["selected-model","mode","total-calls","cost-estimate"])):x("",!0)])])]),_:1},8,["open","title"])}}}),[["__scopeId","data-v-f085f906"]]);export{W as G};
