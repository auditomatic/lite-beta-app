import{d as e,c as a,a9 as t,ac as l,F as o,$ as s,a0 as n,G as i,a2 as u,Z as d,f as r,r as c,w as p,X as m,Y as v,_ as f,k,aa as g,B as y}from"./vendor-B9vlzAYn.js";import{d as h,l as b,n as C,_ as x,c as T,p as _,y as $}from"./index-mBQkrP6K.js";import{a as w}from"./cost-formatting-Bv_drrqY.js";const F={key:0,class:"cost-group"},O={class:"cost-item"},U={class:"cost-value"},P={class:"cost-value"},z={key:1,class:"cost-group"},I={class:"enviro-group"},S={class:"enviro-item"},M={class:"enviro-item"},L={class:"enviro-item"},E={key:0,class:"cost-group"},N={class:"cost-item"},j={class:"cost-value"},W={class:"cost-value"},A={class:"enviro-group"},B={class:"enviro-item"},D={class:"enviro-item"},K={class:"enviro-item"},G={key:0,class:"cost-item financial"},R={key:0,class:"cost-value"},q={key:1,class:"cost-value"},X={class:"cost-item environmental"},Y={class:"enviro-item"},Z={class:"enviro-value"},H={class:"enviro-item"},J={class:"enviro-value"},Q={class:"enviro-item"},V={class:"enviro-value"},ee={key:0,class:"cost-unit"},ae=x(e({__name:"ModelCostDisplay",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(e){const r=e,c=h(),p=a(()=>{const e=c.financialCostsEnabled;return b.debug("ModelCostDisplay showFinancial check",{financialCostsEnabled:e,settingsStoreReady:!c.isLoading,mode:r.mode,model:r.model?.displayName}),e});function m(){if(!r.model.capabilities)return"â€”";const e=r.model.capabilities.inputCostPerToken||0,a=r.model.capabilities.outputCostPerToken||0;if("per-thousand"===r.mode){return w(1e3*(e+a))}if("total"===r.mode){const t=e*r.inputTokens+a*r.outputTokens;return w(t)}return"â€”"}function v(e){if(0===e)return"0";if(e>=.01)return e.toFixed(2).replace(/\.?0+$/,"");const a=e.toFixed(10).match(/^0\.0*[1-9]/);if(a){const t=a[0].length-2;return e.toFixed(t)}return e.toFixed(4)}function f(){if(!r.model.capabilities)return"0";return v(1e3*(r.model.capabilities.inputCostPerToken||0))}function k(){if(!r.model.capabilities)return"0";return v(1e3*(r.model.capabilities.outputCostPerToken||0))}function g(){if(!r.model.capabilities)return"?";const e=r.model.capabilities.inputCostPerToken||0,a=r.model.capabilities.outputCostPerToken||0,t=e*r.inputTokens+a*r.minOutputTokens;return b.debug("formatRangeMin",{inputTokens:r.inputTokens,minOutputTokens:r.minOutputTokens,inputCost:e,outputCost:a,minCost:t}),v(t)}function y(){if(!r.model.capabilities||!r.maxOutputTokens)return"?";const e=r.model.capabilities.inputCostPerToken||0,a=r.model.capabilities.outputCostPerToken||0,t=e*r.inputTokens+a*r.maxOutputTokens;return b.debug("formatRangeMax",{inputTokens:r.inputTokens,maxOutputTokens:r.maxOutputTokens,inputCost:e,outputCost:a,maxCost:t}),v(t)}function x(e){if(!c.environmentalCostsEnabled)return"??";if(!C.hasDataForModel(r.model.provider,r.model.modelId))return"-";const a="total"===r.mode?r.inputTokens+r.outputTokens:1e3,t=C.calculateEnvironmentalCostUnsafe(r.model.provider,r.model.modelId,a)[e];if(0===t)return"-";switch(e){case"carbon":return t<.001?"<1Î¼g":t<1?`${(1e3*t).toFixed(0)}Î¼g`:t<1e3?`${t.toFixed(1)}mg`:`${(t/1e3).toFixed(1)}g`;case"water":return t<.001?"<1nL":t<1?`${(1e3*t).toFixed(0)}nL`:t<1e3?`${t.toFixed(1)}Î¼L`:`${(t/1e3).toFixed(1)}mL`;case"energy":return t<.001?"<1Î¼Wh":t<1?`${(1e3*t).toFixed(0)}Î¼Wh`:t<1e3?`${t.toFixed(1)}mWh`:`${(t/1e3).toFixed(1)}Wh`;default:return"-"}}function T(e){if(!c.environmentalCostsEnabled)return"??";if(!C.hasDataForModel(r.model.provider,r.model.modelId))return"-";if(!r.maxOutputTokens)return"?";const a=r.inputTokens+r.minOutputTokens,t=r.inputTokens+r.maxOutputTokens,l=C.calculateEnvironmentalCostUnsafe(r.model.provider,r.model.modelId,a),o=C.calculateEnvironmentalCostUnsafe(r.model.provider,r.model.modelId,t),s=l[e],n=o[e];if(0===s&&0===n)return"-";const i=a=>{switch(e){case"carbon":return a<.001?"<1Î¼g":a<1?`${(1e3*a).toFixed(0)}Î¼g`:a<1e3?`${a.toFixed(0)}mg`:`${(a/1e3).toFixed(1)}g`;case"water":return a<.001?"<1nL":a<1?`${(1e3*a).toFixed(0)}nL`:a<1e3?`${a.toFixed(0)}Î¼L`:`${(a/1e3).toFixed(1)}mL`;case"energy":return a<.001?"<1Î¼Wh":a<1?`${(1e3*a).toFixed(0)}Î¼Wh`:a<1e3?`${a.toFixed(0)}mWh`:`${(a/1e3).toFixed(1)}Wh`;default:return"-"}};return`${i(s)}-${i(n)}`}return b.debug("ModelCostDisplay props received",{model:r.model?.displayName,mode:r.mode,inputTokens:r.inputTokens,outputTokens:r.outputTokens,minOutputTokens:r.minOutputTokens,maxOutputTokens:r.maxOutputTokens,modelCapabilities:!!r.model?.capabilities,inputCostPerToken:r.model?.capabilities?.inputCostPerToken,outputCostPerToken:r.model?.capabilities?.outputCostPerToken}),(e,a)=>(d(),t("div",{class:l(["model-cost-display",[`layout-${e.layout}`,`size-${e.size}`]])},["range"===e.mode?(d(),t(o,{key:0},[p.value&&e.maxOutputTokens?(d(),t("span",F,[n("span",O,[n("span",U,"$"+u(g()),1),a[0]||(a[0]=i(" - ")),n("span",P,"$"+u(y()),1)])])):p.value?(d(),t("span",z,a[1]||(a[1]=[n("span",{class:"cost-item"},[n("span",{class:"cost-value"},"Cost: ??")],-1)]))):s("",!0),a[4]||(a[4]=n("span",{class:"cost-tab"},null,-1)),n("span",I,[n("span",S,"COâ‚‚ "+u(T("carbon")),1),a[2]||(a[2]=n("span",{class:"cost-tab"},null,-1)),n("span",M,"ðŸ’§"+u(T("water")),1),a[3]||(a[3]=n("span",{class:"cost-tab"},null,-1)),n("span",L,"âš¡"+u(T("energy")),1)])],64)):"input-output"===e.mode?(d(),t(o,{key:1},[p.value?(d(),t("span",E,[n("span",N,[n("span",j,"$"+u(f()),1),a[5]||(a[5]=i("/1K input + ")),n("span",W,"$"+u(k()),1),a[6]||(a[6]=i("/1K output "))])])):s("",!0),a[9]||(a[9]=n("span",{class:"cost-tab"},null,-1)),n("span",A,[n("span",B,"COâ‚‚ "+u(x("carbon")),1),a[7]||(a[7]=n("span",{class:"cost-tab"},null,-1)),n("span",D,"ðŸ’§"+u(x("water")),1),a[8]||(a[8]=n("span",{class:"cost-tab"},null,-1)),n("span",K,"âš¡"+u(x("energy")),1)])],64)):(d(),t(o,{key:2},[p.value?(d(),t("div",G,["per-thousand"===e.mode?(d(),t("span",R,[i(u(m())+" ",1),a[10]||(a[10]=n("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):"total"===e.mode?(d(),t("span",q,u(m()),1)):s("",!0)])):s("",!0),n("div",X,[n("span",Y,[a[11]||(a[11]=n("span",{class:"enviro-icon"},"COâ‚‚",-1)),n("span",Z,u(x("carbon")),1)]),n("span",H,[a[12]||(a[12]=n("span",{class:"enviro-icon"},"ðŸ’§",-1)),n("span",J,u(x("water")),1)]),n("span",Q,[a[13]||(a[13]=n("span",{class:"enviro-icon"},"âš¡",-1)),n("span",V,u(x("energy")),1)]),"per-thousand"===e.mode?(d(),t("span",ee,"/ 1,000")):s("",!0)])],64))],2))}}),[["__scopeId","data-v-0e44d7ba"]]),te={class:"modal-content-wrapper"},le={class:"modal-content"},oe={class:"models-panel"},se={class:"panel-header"},ne={class:"search-container"},ie={class:"models-list"},ue={class:"provider-header"},de={class:"provider-name"},re={class:"provider-model-count"},ce={class:"provider-models"},pe=["onClick"],me={class:"model-name"},ve={class:"model-specs"},fe={key:0,class:"config-panel"},ke={class:"config-header"},ge={class:"total-cost"},ye={key:0,class:"cost-info"},he={key:0,class:"config-content"},be={class:"param-description"},Ce={class:"param-description"},xe={class:"config-footer"},Te=x(e({__name:"GenericModelSelectorModal",props:{open:{type:Boolean},mode:{},design:{},title:{},existingConfigurations:{}},emits:["close","add-configuration","select-model"],setup(e,{emit:h}){const b=e,C=h,x=T(),w=r(""),F=r([]),O=r(null),U=r(""),P=c({}),z=r(null),I=a(()=>{let e=x.enabledModels;if(w.value){const a=w.value.toLowerCase();e=e.filter(e=>e.displayName.toLowerCase().includes(a)||e.modelId.toLowerCase().includes(a))}const a={};for(const t of e)a[t.provider]||(a[t.provider]=[]),a[t.provider].push(t);for(const t in a)a[t].sort((e,a)=>e.displayName.localeCompare(a.displayName));return a}),S=a(()=>{if("trial"!==b.mode||!b.design)return 1;let e=1;for(const a of Object.values(b.design.variableBindings))"direct"===a.type&&(e*=a.values?.length||1);return e}),M=a(()=>O.value?_.getBasicParameters(O.value.provider,O.value.modelId):{}),L=a(()=>O.value?_.getAdvancedParameters(O.value.provider,O.value.modelId):{});function E(e){return e.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function N(){if(!O.value||!U.value)return;const e={},a=(e,a,t)=>{const l=a.split(".");let o=e;for(let s=0;s<l.length-1;s++)o[l[s]]||(o[l[s]]={}),o=o[l[s]];o[l[l.length-1]]=t};for(const[t,l]of Object.entries(P))(null!=l&&""!==l||!1===l)&&a(e,t,l);C("add-configuration",{name:U.value,provider:O.value.provider,modelId:O.value.modelId,parameters:e})}function j(){O.value&&(C("select-model",O.value),C("close"))}function W(e){return"trial"===b.mode&&b.design?b.design.tokenEstimate?.avgTokens||150:1e3}function A(e){if("trial"===b.mode){return $.getOutputTokenLimit(e.provider,e.modelId,P)||256}return 1e3}return p([O,P],async()=>{if(O.value&&"trial"===b.mode&&b.design)try{z.value=await $.calculateCostEstimate(b.design,O.value,P)}catch(e){console.error("Failed to calculate cost estimate:",e),z.value=null}else z.value=null}),(e,a)=>{const r=v("a-input-search"),c=v("a-button"),p=v("a-collapse-panel"),h=v("a-collapse"),x=v("a-input"),T=v("a-form-item"),$=v("a-input-number"),B=v("a-switch"),D=v("a-select-option"),K=v("a-select"),G=v("a-col"),R=v("a-row"),q=v("a-form"),X=v("a-modal");return d(),m(X,{open:e.open,onCancel:a[3]||(a[3]=a=>e.$emit("close")),title:e.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:f(()=>[n("div",te,[n("div",le,[n("div",oe,[n("div",se,[a[5]||(a[5]=n("h3",null,"Available Models",-1)),n("div",ne,[a[4]||(a[4]=n("span",{class:"search-label"},"Search:",-1)),k(r,{value:w.value,"onUpdate:value":a[0]||(a[0]=e=>w.value=e),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])]),n("div",ie,[k(h,{activeKey:F.value,"onUpdate:activeKey":a[1]||(a[1]=e=>F.value=e),bordered:!1},{default:f(()=>[(d(!0),t(o,null,g(I.value,(a,s)=>(d(),m(p,{key:s,class:"provider-panel"},{header:f(()=>[n("div",ue,[n("span",de,u(s),1),n("span",re,u(a.length)+" models",1)])]),extra:f(()=>[k(c,{size:"small",type:"text",onClick:y(e=>function(e){const a=F.value.indexOf(e);a>-1?F.value.splice(a,1):F.value.push(e)}(s),["stop"])},{default:f(()=>[i(u(F.value.includes(s)?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:f(()=>[n("div",ce,[(d(!0),t(o,null,g(a,a=>(d(),t("div",{key:a.id,class:l(["model-row",{selected:O.value?.id===a.id}]),onClick:e=>function(e){if(O.value=e,"playground"===b.mode)return C("select-model",e),void C("close");if("trial"===b.mode){U.value=e.displayName,Object.keys(P).forEach(e=>delete P[e]);const a={..._.getBasicParameters(e.provider,e.modelId),..._.getAdvancedParameters(e.provider,e.modelId)};for(const[e,t]of Object.entries(a))void 0!==t.default&&(P[e]=t.default)}}(a)},[n("div",me,u(a.displayName),1),n("div",ve,[k(ae,{model:a,mode:"trial"===e.mode?"range":"input-output","input-tokens":W(),"min-output-tokens":10,"max-output-tokens":A(a),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])])],10,pe))),128))])]),_:2},1024))),128))]),_:1},8,["activeKey"])])]),O.value&&"trial"===e.mode?(d(),t("div",fe,[n("div",ke,[n("h3",null,u("trial"===e.mode?"Configure":"Selected")+": "+u(O.value.displayName),1),n("div",ge,[k(ae,{model:O.value,mode:"trial"===e.mode?"total":"input-output","input-tokens":z.value?.inputTokens.avgTokens||W(O.value),"output-tokens":z.value?.outputTokens||A(O.value),layout:"inline",size:"large"},null,8,["model","mode","input-tokens","output-tokens"]),"trial"===e.mode&&S.value>1?(d(),t("span",ye,"("+u(S.value)+" calls)",1)):s("",!0)])]),"trial"===e.mode?(d(),t("div",he,[k(q,{layout:"vertical"},{default:f(()=>[k(T,{label:"Configuration Name",required:""},{default:f(()=>[k(x,{value:U.value,"onUpdate:value":a[2]||(a[2]=e=>U.value=e),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1}),k(h,{"default-active-key":["basic"],ghost:""},{default:f(()=>[k(p,{key:"basic",header:"Basic Parameters"},{default:f(()=>[k(R,{gutter:16},{default:f(()=>[(d(!0),t(o,null,g(M.value,(e,l)=>(d(),m(G,{key:l,span:12},{default:f(()=>[k(T,{label:E(l)},{default:f(()=>["number"===e.type?(d(),m($,{key:0,value:P[l],"onUpdate:value":e=>P[l]=e,min:e.min,max:e.max,step:.1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"integer"===e.type?(d(),m($,{key:1,value:P[l],"onUpdate:value":e=>P[l]=e,min:e.min,max:e.max,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"boolean"===e.type?(d(),m(B,{key:2,checked:P[l],"onUpdate:checked":e=>P[l]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(d(),m(K,{key:3,value:P[l],"onUpdate:value":e=>P[l]=e,placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:f(()=>[k(D,{value:void 0},{default:f(()=>a[6]||(a[6]=[n("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[6]}),(d(!0),t(o,null,g(e.enum,e=>(d(),m(D,{key:e,value:e},{default:f(()=>[i(u(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(d(),m(x,{key:4,value:P[l],"onUpdate:value":e=>P[l]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),n("div",be,u(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1}),Object.keys(L.value).length>0?(d(),m(p,{key:"advanced",header:"Advanced Parameters"},{default:f(()=>[k(R,{gutter:16},{default:f(()=>[(d(!0),t(o,null,g(L.value,(e,l)=>(d(),m(G,{key:l,span:12},{default:f(()=>[k(T,{label:E(l)},{default:f(()=>["number"===e.type||"integer"===e.type?(d(),m($,{key:0,value:P[l],"onUpdate:value":e=>P[l]=e,min:e.min,max:e.max,step:"number"===e.type?.1:1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","step","placeholder"])):"boolean"===e.type?(d(),m(B,{key:1,checked:P[l],"onUpdate:checked":e=>P[l]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(d(),m(K,{key:2,value:P[l],"onUpdate:value":e=>P[l]=e,placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:f(()=>[k(D,{value:void 0},{default:f(()=>a[7]||(a[7]=[n("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[7]}),(d(!0),t(o,null,g(e.enum,e=>(d(),m(D,{key:e,value:e},{default:f(()=>[i(u(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(d(),m(x,{key:3,value:P[l],"onUpdate:value":e=>P[l]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),n("div",Ce,u(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1})):s("",!0)]),_:1})]),_:1})])):s("",!0),n("div",xe,["trial"===e.mode?(d(),m(c,{key:0,type:"primary",size:"large",onClick:N,disabled:!U.value||!O.value},{default:f(()=>a[8]||(a[8]=[i(" Add Configuration ")])),_:1,__:[8]},8,["disabled"])):(d(),m(c,{key:1,type:"primary",size:"large",onClick:j,disabled:!O.value},{default:f(()=>a[9]||(a[9]=[i(" Select Model ")])),_:1,__:[9]},8,["disabled"]))])])):s("",!0)])])]),_:1},8,["open","title"])}}}),[["__scopeId","data-v-e65e1cf5"]]);export{Te as G,ae as M};
