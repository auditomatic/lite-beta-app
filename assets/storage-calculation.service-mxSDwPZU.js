const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BMmW_fIo.js","./vendor-CdfxntmD.js","./db-CL8uhZCz.js","./index-C3dOhsog.css"])))=>i.map(i=>d[i]);
import{l as e,J as t}from"./index-BMmW_fIo.js";const a=new class{async getStorageInfo(){const t=await this.calculateStorageBreakdown(),a=await this.getDetailedIndexedDBBreakdown(),r=t.localStorage+t.indexedDB+t.sessionStorage;let s=0,i=0;if("storage"in navigator&&"estimate"in navigator.storage)try{const e=await navigator.storage.estimate();s=e.quota||0,i=s-(e.usage||r)}catch(l){e.warn("Could not get storage estimate",{error:l})}0===s&&(s=this.estimateQuota(),i=s-r);const{value:o,unit:n}=this.formatBytes(r);return{total:s,used:r,available:Math.max(0,i),unit:n,formatted:`${o} ${n}`,breakdown:t,detailedBreakdown:a}}async calculateStorageBreakdown(){const e=this.calculateLocalStorageSize(),t=this.calculateSessionStorageSize();return{localStorage:e,indexedDB:await this.calculateIndexedDBSize(),sessionStorage:t}}calculateLocalStorageSize(){let t=0;try{for(let e in localStorage)localStorage.hasOwnProperty(e)&&(t+=localStorage[e].length+e.length)}catch(a){e.warn("Could not calculate localStorage size",{error:a})}return 2*t}calculateSessionStorageSize(){let t=0;try{for(let e in sessionStorage)sessionStorage.hasOwnProperty(e)&&(t+=sessionStorage[e].length+e.length)}catch(a){e.warn("Could not calculate sessionStorage size",{error:a})}return 2*t}async calculateIndexedDBSize(){if("storage"in navigator&&"estimate"in navigator.storage)try{const e=await navigator.storage.estimate();if(e.usageDetails&&e.usageDetails.indexedDB)return e.usageDetails.indexedDB}catch(t){e.warn("Could not get IndexedDB size from storage API",{error:t})}return await this.estimateIndexedDBSize()}async estimateIndexedDBSize(){const e=await this.getDetailedIndexedDBBreakdown();return e?Object.values(e).reduce((e,t)=>e+t,0):0}async getDetailedIndexedDBBreakdown(){try{const{db:e}=await t(async()=>{const{db:e}=await import("./index-BMmW_fIo.js").then(e=>e.ai);return{db:e}},__vite__mapDeps([0,1,2,3]),import.meta.url),[a,r,s,i,o]=await Promise.all([e.designs.toArray(),e.variableLists.toArray(),e.trials.toArray(),e.apiCalls.toArray(),e.settings.toArray()]);return{designs:this.calculateObjectSize(a),variableLists:this.calculateObjectSize(r),trials:this.calculateObjectSize(s),apiCalls:this.calculateObjectSize(i),settings:this.calculateObjectSize(o)}}catch(a){return e.warn("Could not get detailed IndexedDB breakdown",{error:a}),{designs:0,variableLists:0,trials:0,apiCalls:0,settings:0}}}calculateObjectSize(t){try{return 2*JSON.stringify(t).length}catch(a){return e.warn("Could not calculate object size",{error:a}),0}}estimateQuota(){const e=navigator.userAgent.toLowerCase();return e.includes("chrome")||e.includes("edge")?1073741824:e.includes("firefox")?536870912:(e.includes("safari"),268435456)}formatBytes(e){if(0===e)return{value:"0",unit:"B"};const t=Math.floor(Math.log(e)/Math.log(1024));return{value:(e/Math.pow(1024,t)).toFixed(0===t?0:1),unit:["B","KB","MB","GB"][t]||"GB"}}async getStoragePercentage(){const e=await this.getStorageInfo();return 0===e.total?0:Math.round(e.used/e.total*100)}};export{a as s};
