import{k as e,d as a,c as l,ab as t,_ as s,a1 as o,Z as n,$ as i,G as r,a0 as d,F as u,ac as c,a3 as m,u as v,Y as p,a4 as g,B as f,f as y,w as h,l as b,o as k,s as z,h as w,b as _,a7 as C}from"./vendor-CdfxntmD.js";import{u as x}from"./useLiveData-gB4mnUxo.js";import{I as M,_ as T,C as S,c as O,U as B,o as $,e as P,f as j,R as F,g as G,h as L,j as I,k as U,m as A,n as D,q as H,P as E,r as Q,l as R,d as V,s as q,p as N,t as W}from"./index-qi1cGAr3.js";import{_ as K}from"./BaseModal.vue_vue_type_style_index_0_lang-DY82666A.js";import{F as J}from"./FilterOutlined-B5HSmG1b.js";import{f as Y}from"./cost-formatting-DSpbVMtV.js";import"./db-CL8uhZCz.js";var Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zM464 544H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H212V612h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200z"}}]},name:"appstore",theme:"outlined"};function X(e){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?Object(arguments[a]):{},t=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(l).filter(function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable}))),t.forEach(function(a){ee(e,a,l[a])})}return e}function ee(e,a,l){return a in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}var ae=function(a,l){var t=X({},a,l.attrs);return e(M,X({},t,{icon:Z}),null)};ae.displayName="AppstoreOutlined",ae.inheritAttrs=!1;var le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};function te(e){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?Object(arguments[a]):{},t=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(l).filter(function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable}))),t.forEach(function(a){se(e,a,l[a])})}return e}function se(e,a,l){return a in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}var oe=function(a,l){var t=te({},a,l.attrs);return e(M,te({},t,{icon:le}),null)};oe.displayName="StarOutlined",oe.inheritAttrs=!1;var ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};function ie(e){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?Object(arguments[a]):{},t=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(l).filter(function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable}))),t.forEach(function(a){re(e,a,l[a])})}return e}function re(e,a,l){return a in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}var de=function(a,l){var t=ie({},a,l.attrs);return e(M,ie({},t,{icon:ne}),null)};de.displayName="UnorderedListOutlined",de.inheritAttrs=!1;const ue={class:"search-section"},ce={class:"search-controls"},me={class:"size-filter"},ve={class:"size-controls"},pe={class:"size-presets"},ge={key:0,class:"size-filter-indicator"},fe={class:"quantized-filter"},ye={class:"filter-description"},he={class:"category-filters"},be=T(a({__name:"OllamaSearchFilters",props:{searchQuery:{},sortBy:{},selectedCategories:{},maxSizeGB:{},showQuantized:{type:Boolean},categories:{}},emits:["update:searchQuery","update:sortBy","update:maxSizeGB","update:showQuantized","toggle-category"],setup(a,{emit:g}){const f=a,y=g,h=l({get:()=>f.searchQuery,set:e=>y("update:searchQuery",e)}),b=l({get:()=>f.sortBy,set:e=>y("update:sortBy",e)}),k=l({get:()=>f.maxSizeGB,set:e=>y("update:maxSizeGB",e)}),z=l({get:()=>f.showQuantized,set:e=>y("update:showQuantized",e)}),w=[{label:"1GB",value:1},{label:"2GB",value:2},{label:"4GB",value:4},{label:"8GB",value:8},{label:"16GB",value:16},{label:"None",value:999}];return(a,l)=>{const g=n("a-input-search"),f=n("a-select-option"),y=n("a-select"),_=n("a-input-number"),C=n("a-button"),x=n("a-tag");return s(),t("div",ue,[o("div",ce,[e(g,{value:h.value,"onUpdate:value":l[0]||(l[0]=e=>h.value=e),placeholder:"Search models by name or description...","allow-clear":"",size:"large",class:"search-input"},null,8,["value"]),e(y,{value:b.value,"onUpdate:value":l[1]||(l[1]=e=>b.value=e),placeholder:"Sort by",style:{width:"150px"},size:"large"},{default:i(()=>[e(f,{value:"popularity"},{default:i(()=>l[4]||(l[4]=[r("Popularity")])),_:1,__:[4]}),e(f,{value:"name"},{default:i(()=>l[5]||(l[5]=[r("Name")])),_:1,__:[5]}),e(f,{value:"tagCount"},{default:i(()=>l[6]||(l[6]=[r("Tag Count")])),_:1,__:[6]})]),_:1},8,["value"])]),o("div",me,[o("div",ve,[l[7]||(l[7]=o("span",{class:"filter-label"},"Filter to models smaller than:",-1)),e(_,{value:k.value,"onUpdate:value":l[2]||(l[2]=e=>k.value=e),min:1,max:999,step:1,size:"small",class:"size-input","addon-after":"GB"},null,8,["value"]),o("div",pe,[(s(),t(u,null,c(w,a=>e(C,{key:a.value,size:"small",type:k.value===a.value?"primary":"default",onClick:e=>k.value=a.value,class:"preset-button"},{default:i(()=>[r(m(a.label),1)]),_:2},1032,["type","onClick"])),64))])]),k.value<999?(s(),t("span",ge," â‰¤"+m(k.value)+"GB filter active ",1)):d("",!0)]),o("div",fe,[e(C,{type:z.value?"default":"primary",size:"small",onClick:l[3]||(l[3]=e=>z.value=!z.value)},{icon:i(()=>[e(v(J))]),default:i(()=>[r(" "+m(z.value?"Hide":"Show")+" Quantized Versions ",1)]),_:1},8,["type"]),o("span",ye,m(z.value?"Showing all versions":"Hiding q2_K, q3_K, q4_0, q5_1, q6_K, q8_0, fp16..."),1)]),o("div",he,[(s(!0),t(u,null,c(a.categories,e=>(s(),p(x,{key:e,color:a.selectedCategories.includes(e)?"blue":"default",checkable:!0,checked:a.selectedCategories.includes(e),onClick:l=>a.$emit("toggle-category",e),class:"category-tag"},{default:i(()=>[r(m(e),1)]),_:2},1032,["color","checked","onClick"]))),128))])])}}}),[["__scopeId","data-v-e9cbf7bd"]]),ke={key:0,class:"downloads-section"},ze={class:"download-items"},we={class:"download-info"},_e={class:"download-tag"},Ce={class:"download-status"},xe=T(a({__name:"OllamaDownloadProgress",props:{pullProgress:{}},setup:a=>(a,l)=>{const i=n("a-progress");return Object.keys(a.pullProgress).length>0?(s(),t("div",ke,[l[0]||(l[0]=o("h4",null,"Active Downloads",-1)),o("div",ze,[(s(!0),t(u,null,c(a.pullProgress,(a,l)=>(s(),t("div",{key:l,class:"download-item"},[o("div",we,[o("code",_e,m(l),1),o("span",Ce,m(a.message),1)]),e(i,{percent:a.percent,status:"success"===a.status?"success":"active",size:"small",class:"download-progress"},null,8,["percent","status"])]))),128))])])):d("",!0)}}),[["__scopeId","data-v-ed1d7f09"]]),Me={class:"model-info"},Te={class:"model-name"},Se={key:0},Oe={class:"model-description"},Be={class:"model-actions"},$e={key:0,class:"button-size-info"},Pe={key:0,class:"tags-preview"},je={class:"preview-tags"},Fe=["onClick","title"],Ge={key:1,class:"tag-actual"},Le={class:"tag-size"},Ie={key:0,class:"more-tags"},Ue={key:1,class:"tags-expanded"},Ae={key:0,class:"tag-name"},De={key:2},He={key:1,class:"text-secondary"},Ee=T(a({__name:"OllamaModelCard",props:{model:{},expanded:{type:Boolean},pullingModels:{},pullProgress:{},installedModels:{},maxSizeGB:{},showQuantized:{type:Boolean},isQuantizedTag:{type:Function},parseSizeToGB:{type:Function},getSizeClass:{type:Function},getLatestTagInfo:{type:Function}},emits:["toggle-expand","pull-model"],setup(a){const y=a,h=[{title:"Tag",key:"name",width:200},{title:"Size",key:"size",width:100,align:"right"},{title:"Context",key:"context",width:100,align:"center"},{title:"Status",key:"status",width:80,align:"center"},{title:"Action",key:"actions",width:80,align:"center"}],b=l(()=>y.installedModels.some(e=>e.startsWith(y.model.name))),k=l(()=>y.installedModels.filter(e=>e.startsWith(y.model.name+":")).length),z=l(()=>P(`${y.model.name}:latest`)||P(y.model.name)),w=l(()=>y.pullingModels.has(`${y.model.name}:latest`)),_=l(()=>y.pullProgress[`${y.model.name}:latest`]),C=l(()=>y.getLatestTagInfo(y.model)),x=l(()=>y.maxSizeGB<999||!y.showQuantized),M=l(()=>y.model.tags?Object.entries(y.model.tags).map(([e,a])=>({...a,name:e})).filter(e=>{if(y.maxSizeGB<999){if(y.parseSizeToGB(e.size||"0GB")>y.maxSizeGB)return!1}return!(!y.showQuantized&&y.isQuantizedTag(e.name))}).sort((e,a)=>e.name.localeCompare(a.name)):[]),T=l(()=>M.value.length),$=l(()=>M.value.sort((e,a)=>{const l=["latest","instruct","8b","7b","3b","1b"],t=l.indexOf(e.name),s=l.indexOf(a.name);return-1!==t&&-1!==s?t-s:-1!==t?-1:-1!==s?1:e.name.localeCompare(a.name)}).slice(0,5));function P(e){return y.installedModels.includes(e)}function j(e){return y.pullProgress[e]}const F=l(()=>{const e=C.value;return e?{actualTag:e.actualTag||"",size:e.size||""}:null});return(a,l)=>{const C=n("a-tag"),G=n("a-button"),L=n("a-table");return s(),t("div",{class:g(["model-item",{expanded:a.expanded}])},[o("div",{class:"model-header",onClick:l[2]||(l[2]=e=>a.$emit("toggle-expand"))},[o("div",Me,[o("div",Te,[o("h4",null,m(a.model.name),1),e(C,{size:"small",color:"blue"},{default:i(()=>[r(m(a.model.pullCount||"0")+" pulls",1)]),_:1}),e(C,{size:"small",color:"green"},{default:i(()=>[r(m(T.value)+" ",1),x.value?(s(),t("span",Se,"/"+m(a.model.tagCount||0),1)):d("",!0),l[3]||(l[3]=r(" versions "))]),_:1,__:[3]}),b.value?(s(),p(C,{key:0,size:"small",color:"success",class:"installed-tag"},{icon:i(()=>[e(v(S))]),default:i(()=>[r(" "+m(k.value)+" installed ",1)]),_:1})):d("",!0)]),o("p",Oe,m(a.model.description||"No description available"),1)]),o("div",Be,[e(G,{type:z.value?"default":"primary",size:"small",onClick:l[0]||(l[0]=f(e=>a.$emit("pull-model",a.model.name,"latest"),["stop"])),loading:w.value,disabled:z.value},{default:i(()=>[_.value?(s(),t(u,{key:0},[r(m(Math.round(_.value.percent))+"% ",1)],64)):z.value?(s(),t(u,{key:1},[e(v(S)),l[4]||(l[4]=r(" Installed "))],64)):(s(),t(u,{key:2},[l[5]||(l[5]=r(" Pull Latest ")),F.value?(s(),t("span",$e," ("+m(F.value.actualTag?F.value.actualTag+", ":"")+m(F.value.size)+") ",1)):d("",!0)],64))]),_:1},8,["type","loading","disabled"]),e(G,{type:"text",size:"small",onClick:l[1]||(l[1]=f(e=>a.$emit("toggle-expand"),["stop"]))},{icon:i(()=>[a.expanded?(s(),p(v(B),{key:1})):(s(),p(v(O),{key:0}))]),default:i(()=>[r(" "+m(a.expanded?"Hide versions":"See all versions"),1)]),_:1})])]),a.expanded?d("",!0):(s(),t("div",Pe,[o("div",je,[(s(!0),t(u,null,c($.value,e=>(s(),t("span",{key:e.name,class:g(["tag-chip",[a.getSizeClass(e.size),{installed:P(e.fullTag)}]]),onClick:l=>P(e.fullTag)?null:a.$emit("pull-model",a.model.name,e.name),title:`${e.fullTag} - ${e.size}${P(e.fullTag)?" (Installed)":""}`},[P(e.fullTag)?(s(),p(v(S),{key:0,class:"installed-icon"})):d("",!0),r(" "+m(e.name)+" ",1),"latest"===e.name&&F.value?(s(),t("span",Ge," ("+m(F.value.actualTag)+") ",1)):d("",!0),o("span",Le,m(e.size),1)],10,Fe))),128)),T.value>5?(s(),t("span",Ie," +"+m(T.value-5)+" more versions ",1)):d("",!0)])])),a.expanded?(s(),t("div",Ue,[e(L,{columns:h,"data-source":M.value,pagination:!1,size:"small",scroll:{y:300},class:"tags-table"},{bodyCell:i(({column:o,record:n})=>{return["name"===o.key?(s(),t("code",Ae,m(n.name),1)):d("",!0),"size"===o.key?(s(),t("span",{key:1,class:g(["tag-size",a.getSizeClass(n.size)])},m(n.size),3)):d("",!0),"context"===o.key?(s(),t("span",De,m(n.contextWindow),1)):d("",!0),"status"===o.key?(s(),t(u,{key:3},[P(n.fullTag)?(s(),p(C,{key:0,size:"small",color:"success"},{default:i(()=>[e(v(S)),l[6]||(l[6]=r(" Installed "))]),_:1,__:[6]})):(s(),t("span",He,"-"))],64)):d("",!0),"actions"===o.key?(s(),p(G,{key:4,type:P(n.fullTag)?"default":"primary",size:"small",onClick:e=>a.$emit("pull-model",a.model.name,n.name),loading:(c=n.fullTag,y.pullingModels.has(c)),disabled:P(n.fullTag)},{default:i(()=>[j(n.fullTag)?(s(),t(u,{key:0},[r(m(Math.round(j(n.fullTag).percent))+"% ",1)],64)):P(n.fullTag)?(s(),t(u,{key:1},[e(v(S)),l[7]||(l[7]=r(" Installed "))],64)):(s(),t(u,{key:2},[r(" Pull ")],64))]),_:2},1032,["type","onClick","loading","disabled"])):d("",!0)];var c}),_:1},8,["data-source"])])):d("",!0)],2)}}}),[["__scopeId","data-v-e36c4030"]]),Qe={class:"list-view"},Re={class:"expanded-tags-container"},Ve={class:"expanded-tags-grid"},qe={class:"tag-name"},Ne={key:0,class:"tag-actual"},We={class:"tag-size"},Ke={class:"tag-context"},Je={key:0,class:"model-name-cell"},Ye={key:1,class:"description-cell"},Ze={key:2,class:"stats-cell"},Xe={class:"stat-item"},ea={class:"stat-item"},aa={key:0},la={key:3,class:"size-range"},ta=T(a({__name:"OllamaModelList",props:{models:{},expandedModels:{},pullingModels:{},pullProgress:{},installedModels:{},maxSizeGB:{},showQuantized:{type:Boolean},isQuantizedTag:{type:Function},parseSizeToGB:{type:Function},getSizeClass:{type:Function},getLatestTagInfo:{type:Function},getModelSizeRange:{type:Function}},emits:["toggle-model","pull-model","expand"],setup(a){const l=a,f=[{title:"Model",key:"name",width:200,fixed:"left"},{title:"Description",key:"description",ellipsis:!0},{title:"Stats",key:"stats",width:200},{title:"Size Range",key:"sizeRange",width:120,align:"center"},{title:"Actions",key:"actions",width:220,align:"center",fixed:"right"}];function y(e){return l.installedModels.includes(e)}function h(e){return l.installedModels.filter(a=>a.startsWith(e+":"))}return(a,b)=>{const k=n("a-tag"),z=n("a-button"),w=n("a-space"),_=n("a-table");return s(),t("div",Qe,[e(_,{"data-source":a.models,columns:f,pagination:!1,"row-key":e=>e.name,size:"small",scroll:{y:"calc(100% - 48px)"},"expanded-row-keys":a.expandedModels,"expand-row-by-click":!1,onExpand:b[0]||(b[0]=(e,l)=>a.$emit("expand",e,l)),class:"models-list-table"},{expandedRowRender:i(({record:n})=>{return[o("div",Re,[o("div",Ve,[(s(!0),t(u,null,c((f=n,f.tags?Object.entries(f.tags).map(([e,a])=>({...a,name:e})).filter(e=>!(l.maxSizeGB<999&&l.parseSizeToGB(e.size||"0GB")>l.maxSizeGB)&&!(!l.showQuantized&&l.isQuantizedTag(e.name))).sort((e,a)=>e.name.localeCompare(a.name)):[]),l=>(s(),t("div",{key:l.fullTag,class:g(["expanded-tag-item",a.getSizeClass(l.size)])},[o("span",qe,m(l.name),1),"latest"===l.name&&a.getLatestTagInfo(n)?(s(),t("span",Ne," ("+m(a.getLatestTagInfo(n)?.actualTag)+") ",1)):d("",!0),o("span",We,m(l.size),1),o("span",Ke,m(l.contextWindow||"-"),1),y(l.fullTag)?(s(),p(k,{key:1,size:"small",color:"success"},{default:i(()=>[e(v(S)),b[1]||(b[1]=r(" Installed "))]),_:1,__:[1]})):(s(),p(z,{key:2,type:"primary",size:"small",loading:a.pullingModels.has(l.fullTag),onClick:e=>a.$emit("pull-model",n.name,l.name)},{default:i(()=>[a.pullProgress[l.fullTag]?(s(),t(u,{key:0},[r(m(Math.round(a.pullProgress[l.fullTag].percent))+"% ",1)],64)):(s(),t(u,{key:1},[r(" Pull ")],64))]),_:2},1032,["loading","onClick"]))],2))),128))])])];var f}),bodyCell:i(({column:n,record:c})=>{return["name"===n.key?(s(),t("div",Je,[o("code",null,m(c.name),1),(f=c.name,l.installedModels.some(e=>e.startsWith(f))?(s(),p(k,{key:0,size:"small",color:"success"},{default:i(()=>[e(v(S)),r(" "+m(h(c.name).length)+" installed ",1)]),_:2},1024)):d("",!0))])):d("",!0),"description"===n.key?(s(),t("span",Ye,m(c.description||"No description"),1)):d("",!0),"stats"===n.key?(s(),t("div",Ze,[o("span",Xe,m(c.pullCount||"0")+" pulls",1),b[3]||(b[3]=o("span",{class:"stat-divider"},"â€¢",-1)),o("span",ea,[r(m((g=c,g.tags?Object.entries(g.tags).filter(([e,a])=>!(l.maxSizeGB<999&&l.parseSizeToGB(a.size||"0GB")>l.maxSizeGB)&&!(!l.showQuantized&&l.isQuantizedTag(e))).length:0))+" ",1),a.maxSizeGB<999||!a.showQuantized?(s(),t("span",aa,"/"+m(c.tagCount||0),1)):d("",!0),b[2]||(b[2]=r(" versions "))])])):d("",!0),"sizeRange"===n.key?(s(),t("span",la,m(a.getModelSizeRange(c)),1)):d("",!0),"actions"===n.key?(s(),p(w,{key:4,size:"small"},{default:i(()=>[e(z,{type:"text",size:"small",onClick:e=>a.$emit("toggle-model",c.name)},{icon:i(()=>[a.expandedModels.includes(c.name)?(s(),p(v(B),{key:1})):(s(),p(v(O),{key:0}))]),default:i(()=>[r(" "+m(a.expandedModels.includes(c.name)?"Hide":"See")+" Versions ",1)]),_:2},1032,["onClick"]),e(z,{type:y(`${c.name}:latest`)||y(c.name)?"default":"primary",size:"small",onClick:e=>a.$emit("pull-model",c.name,"latest"),loading:a.pullingModels.has(`${c.name}:latest`),disabled:y(`${c.name}:latest`)||y(c.name)},{default:i(()=>[a.pullProgress[`${c.name}:latest`]?(s(),t(u,{key:0},[r(m(Math.round(a.pullProgress[`${c.name}:latest`].percent))+"% ",1)],64)):y(`${c.name}:latest`)||y(c.name)?(s(),p(v(S),{key:1})):(s(),t(u,{key:2},[r(" Pull Latest ")],64))]),_:2},1032,["type","onClick","loading","disabled"])]),_:2},1024)):d("",!0)];var g,f}),_:1},8,["data-source","row-key","expanded-row-keys"])])}}}),[["__scopeId","data-v-f29019c2"]]);const sa={class:"modal-content"},oa={class:"stats-bar"},na={class:"view-controls"},ia={key:0,class:"loading-text"},ra={class:"models-container"},da=T(a({__name:"OllamaModelLibraryModalRefactored",props:{modelValue:{type:Boolean}},emits:["update:modelValue","models-updated"],setup(a,{emit:r}){const g=a,f=r,{modelsData:k,loading:z,error:w,pullingModels:_,pullProgress:C,installedModels:x,fetchModels:M,pullModel:T,parseSizeToGB:S,isQuantizedTag:O,getSizeClass:B,getModelSizeRange:j,getLatestTagInfo:F}=function(){const e=y(null),a=y(!1),l=y(""),t=y(new Set),s=y({}),o=y([]);async function n(){try{const e=await $("/api/tags");if(e.ok){const a=await e.json();o.value=(a.models||[]).map(e=>e.name)}}catch(e){const a=e;"cors"===a.type&&a.isHttps,o.value=[]}}function i(e){const a=parseFloat(e.replace(/[^\d.]/g,""))||0,l=e.replace(/[\d.]/g,"").trim().toUpperCase();return l.includes("MB")?a/1e3:l.includes("TB")?1e3*a:(l.includes("GB"),a)}function r(e){return e<1?`${Math.round(1e3*e)}MB`:`${e.toFixed(1)}GB`}return{modelsData:e,loading:a,error:l,pullingModels:t,pullProgress:s,installedModels:o,fetchModels:async function(){a.value=!0,l.value="";try{const a=await fetch("https://ollama.models.auditomatic.org/models.json");if(!a.ok)throw new Error(`Failed to fetch models: ${a.statusText}`);e.value=await a.json(),await n()}catch(t){l.value=`Failed to load model library: ${t instanceof Error?t.message:"Unknown error"}`}finally{a.value=!1}},fetchInstalledModels:n,pullModel:async function(e,a,l){const o="latest"===a?e:`${e}:${a}`;if(!t.value.has(o)){t.value.add(o),s.value[o]={percent:0,status:"active",message:"Starting download..."};try{const e=await $("/api/pull",{method:"POST",body:JSON.stringify({name:o,stream:!0})});if(!e.ok)throw new Error(`Failed to pull model: ${e.statusText}`);const a=e.body?.getReader();if(!a)throw new Error("Unable to read response stream");let t=0,i=0;for(;;){const{done:e,value:r}=await a.read();if(e)break;const d=(new TextDecoder).decode(r).split("\n").filter(e=>e.trim());for(const a of d)try{const e=JSON.parse(a);e.total&&(t=e.total),e.completed&&(i=e.completed);const r=t>0?Math.round(i/t*100):0;if(s.value[o]={status:"success"===e.status?"success":"active",percent:r,message:e.status||"Downloading..."},"success"===e.status)return P.success(`Successfully pulled ${o}`),await n(),l?.(),void setTimeout(()=>{delete s.value[o]},3e3)}catch{}}}catch(i){const e=i;let a=i instanceof Error?i.message:"Unknown error";"cors"===e.type&&e.isHttps&&(a="Cannot access Ollama from HTTPS site. Please use the desktop app or run locally."),P.error(`Failed to pull ${o}: ${a}`),s.value[o]={status:"exception",percent:0,message:"Download failed"},setTimeout(()=>{delete s.value[o]},5e3)}finally{t.value.delete(o)}}},parseSizeToGB:i,isQuantizedTag:function(e){return/-q\d{1,2}_|-fp\d+/.test(e)},isModelInstalled:function(e){return o.value.some(a=>a.startsWith(e))},isTagInstalled:function(e){return o.value.includes(e)},getInstalledTagsForModel:function(e){return o.value.filter(a=>a.startsWith(e+":"))},formatSizeGB:r,getSizeClass:function(e){const a=i(e);return a<5?"size-small":a<20?"size-medium":"size-large"},getModelSizeRange:function(e){if(!e.tags)return"N/A";const a=Object.values(e.tags).map(e=>i(e.size||"0GB")).filter(e=>e>0);if(0===a.length)return"N/A";const l=Math.min(...a),t=Math.max(...a);return l===t?r(l):`${r(l)} - ${r(t)}`},getLatestTagInfo:function(e){if(!e.tags||!e.tags.latest)return null;const a=e.tags.latest,l=Object.entries(e.tags).find(([e,l])=>"latest"!==e&&l.modelHash===a.modelHash);return l?{actualTag:l[0],size:l[1].size||a.size}:{actualTag:"",size:a.size}}}}(),G=l({get:()=>g.modelValue,set:e=>f("update:modelValue",e)}),L=y(""),I=y("popularity"),U=y([]),A=y(8),D=y(!1),H=y("card"),E=y(new Set),Q=l(()=>k.value?.totalModels||0),R=l(()=>k.value?.categories||[]),V=l(()=>{if(!k.value)return[];let e=Object.entries(k.value.models).map(([e,a])=>({...a,name:e}));if(L.value){const a=L.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(a)||e.description.toLowerCase().includes(a))}switch(U.value.length>0&&(e=e.filter(e=>U.value.some(a=>(e.categories||[]).includes(a)))),A.value<999&&(e=e.filter(e=>!e.tags||Object.values(e.tags).some(e=>S(e.size||"0GB")<=A.value))),I.value){case"popularity":e.sort((e,a)=>{const l=e.pullCount||"0",t=a.pullCount||"0",s=parseFloat(l.replace(/[^\d.]/g,""))||0,o=parseFloat(t.replace(/[^\d.]/g,""))||0,n=l.includes("M")?1e6:l.includes("K")?1e3:1;return o*(t.includes("M")?1e6:t.includes("K")?1e3:1)-s*n});break;case"name":e.sort((e,a)=>e.name.localeCompare(a.name));break;case"tagCount":e.sort((e,a)=>(a.tagCount||0)-(e.tagCount||0))}return e});function q(e){const a=U.value.indexOf(e);-1===a?U.value.push(e):U.value.splice(a,1)}function N(e){E.value.has(e)?E.value.delete(e):E.value.add(e)}function W(e,a){e?E.value.add(a.name):E.value.delete(a.name)}async function J(e,a){await T(e,a,()=>f("models-updated"))}return h(G,e=>{e&&!k.value&&M(),e||(E.value.clear(),L.value="",U.value=[],A.value=8,D.value=!1,w.value="")}),(a,l)=>{const r=n("a-button"),g=n("a-button-group"),f=n("a-spin"),y=n("a-alert");return s(),p(K,{modelValue:G.value,"onUpdate:modelValue":l[7]||(l[7]=e=>G.value=e),title:"Ollama Model Library",size:"full",class:"ollama-library-modal"},{default:i(()=>[o("div",sa,[e(be,{"search-query":L.value,"onUpdate:searchQuery":l[0]||(l[0]=e=>L.value=e),"sort-by":I.value,"onUpdate:sortBy":l[1]||(l[1]=e=>I.value=e),"max-size-g-b":A.value,"onUpdate:maxSizeGB":l[2]||(l[2]=e=>A.value=e),"show-quantized":D.value,"onUpdate:showQuantized":l[3]||(l[3]=e=>D.value=e),"selected-categories":U.value,categories:R.value,onToggleCategory:q},null,8,["search-query","sort-by","max-size-g-b","show-quantized","selected-categories","categories"]),o("div",oa,[o("span",null,"Showing "+m(V.value.length)+" of "+m(Q.value)+" models",1),o("div",na,[e(g,{size:"small"},{default:i(()=>[e(r,{type:"card"===H.value?"primary":"default",onClick:l[4]||(l[4]=e=>H.value="card"),icon:b(v(ae)),title:"Card View"},null,8,["type","icon"]),e(r,{type:"list"===H.value?"primary":"default",onClick:l[5]||(l[5]=e=>H.value="list"),icon:b(v(de)),title:"List View"},null,8,["type","icon"])]),_:1}),v(z)?(s(),t("span",ia,"Loading...")):d("",!0)])]),e(xe,{"pull-progress":v(C)},null,8,["pull-progress"]),o("div",ra,[e(f,{spinning:v(z),size:"large"},{default:i(()=>["card"===H.value?(s(!0),t(u,{key:0},c(V.value,e=>(s(),p(Ee,{key:e.name,model:e,expanded:E.value.has(e.name),"pulling-models":v(_),"pull-progress":v(C),"installed-models":v(x),"max-size-g-b":A.value,"show-quantized":D.value,"is-quantized-tag":v(O),"parse-size-to-g-b":v(S),"get-size-class":v(B),"get-latest-tag-info":v(F),onToggleExpand:a=>N(e.name),onPullModel:J},null,8,["model","expanded","pulling-models","pull-progress","installed-models","max-size-g-b","show-quantized","is-quantized-tag","parse-size-to-g-b","get-size-class","get-latest-tag-info","onToggleExpand"]))),128)):d("",!0),"list"===H.value?(s(),p(ta,{key:1,models:V.value,"expanded-models":Array.from(E.value),"pulling-models":v(_),"pull-progress":v(C),"installed-models":v(x),"max-size-g-b":A.value,"show-quantized":D.value,"is-quantized-tag":v(O),"parse-size-to-g-b":v(S),"get-size-class":v(B),"get-latest-tag-info":v(F),"get-model-size-range":v(j),onToggleModel:N,onPullModel:J,onExpand:W},null,8,["models","expanded-models","pulling-models","pull-progress","installed-models","max-size-g-b","show-quantized","is-quantized-tag","parse-size-to-g-b","get-size-class","get-latest-tag-info","get-model-size-range"])):d("",!0)]),_:1},8,["spinning"])]),v(w)?(s(),p(y,{key:0,type:"error",message:v(w),closable:"",onClose:l[6]||(l[6]=e=>w.value=""),class:"error-alert"},null,8,["message"])):d("",!0)])]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-02a0381c"]]),ua={class:"ollama-model-manager"},ca={class:"action-bar"},ma={class:"models-section"},va={key:0,class:"model-name"},pa={key:1,class:"model-size"},ga={key:2,class:"model-date"},fa=T(a({__name:"OllamaModelManager",setup(a){const l=y([]),u=y(!1),c=y(new Set),g=y(""),f=y(!1),h=[{title:"Model Name",key:"name",width:"40%"},{title:"Size",key:"size",width:"20%",align:"right"},{title:"Modified",key:"modified",width:"25%"},{title:"Actions",key:"actions",width:"15%",align:"center"}];async function b(){u.value=!0,await async function(){try{const e=await U();l.value=e.models||[]}catch(e){const a=e;"cors"===a.type&&a.isHttps?g.value=a.details||"Cannot access Ollama from HTTPS site":g.value=`Failed to fetch models: ${e instanceof Error?e.message:"Unknown error"}`,l.value=[]}}(),u.value=!1}function z(e){if(!e)return"0 B";const a=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,a)).toFixed(1)} ${["B","KB","MB","GB","TB"][a]}`}function w(e){try{return new Date(e).toLocaleDateString()}catch{return"Unknown"}}return k(async()=>{await async function(){const e=await L();return!e.available&&e.error&&("cors"===e.error.type&&e.error.isHttps?g.value=e.error.details||"Cannot connect to Ollama from HTTPS site":g.value=e.error.message),e.available}()?await b():g.value="Cannot connect to Ollama. Make sure Ollama is running on localhost:11434"}),(a,y)=>{const k=n("a-button"),_=n("a-tag"),C=n("a-popconfirm"),x=n("a-table"),M=n("a-empty"),T=n("a-alert");return s(),t("div",ua,[o("div",ca,[e(k,{type:"primary",onClick:y[0]||(y[0]=e=>f.value=!0)},{icon:i(()=>[e(v(j))]),default:i(()=>[y[3]||(y[3]=r(" Download Ollama Models "))]),_:1,__:[3]}),e(k,{onClick:b,loading:u.value},{icon:i(()=>[e(v(F))]),default:i(()=>[y[4]||(y[4]=r(" Refresh "))]),_:1,__:[4]},8,["loading"])]),o("div",ma,[y[7]||(y[7]=o("h4",{class:"section-title"},"Installed Models",-1)),e(x,{columns:h,"data-source":l.value,pagination:!1,size:"small",loading:u.value,"row-key":"name",class:"models-table"},{bodyCell:i(({column:a,record:l})=>["name"===a.key?(s(),t("div",va,[o("code",null,m(l.name),1),l.details?.family?(s(),p(_,{key:0,size:"small",color:"blue"},{default:i(()=>[r(m(l.details.family),1)]),_:2},1024)):d("",!0)])):d("",!0),"size"===a.key?(s(),t("span",pa,m(z(l.size)),1)):d("",!0),"modified"===a.key?(s(),t("span",ga,m(w(l.modified_at)),1)):d("",!0),"actions"===a.key?(s(),p(C,{key:3,title:"Are you sure you want to delete this model?",description:`This will permanently remove ${l.name} from your system.`,"ok-text":"Delete","cancel-text":"Cancel",onConfirm:e=>async function(e){c.value.add(e),g.value="";try{await I(e),P.success(`Successfully removed ${e}`),await b()}catch(a){const e=a;"cors"===e.type&&e.isHttps?g.value=e.details||"Cannot access Ollama from HTTPS site":g.value=`Failed to remove model: ${a instanceof Error?a.message:"Unknown error"}`}finally{c.value.delete(e)}}(l.name)},{default:i(()=>[e(k,{type:"text",danger:"",size:"small",loading:c.value.has(l.name)},{icon:i(()=>[e(v(G))]),default:i(()=>[y[5]||(y[5]=r(" Remove "))]),_:2,__:[5]},1032,["loading"])]),_:2},1032,["description","onConfirm"])):d("",!0)]),_:1},8,["data-source","loading"]),u.value||0!==l.value.length?d("",!0):(s(),p(M,{key:0,description:"No Ollama models installed",class:"empty-state"},{image:i(()=>y[6]||(y[6]=[o("div",{class:"empty-icon"},"ðŸ“¦",-1)])),_:1}))]),g.value?(s(),p(T,{key:0,type:"error",message:g.value,closable:"",onClose:y[1]||(y[1]=e=>g.value=""),class:"error-alert"},null,8,["message"])):d("",!0),e(da,{modelValue:f.value,"onUpdate:modelValue":y[2]||(y[2]=e=>f.value=e),onModelsUpdated:b},null,8,["modelValue"])])}}}),[["__scopeId","data-v-d52b283a"]]),ya={class:"model-list"},ha={class:"model-header"},ba={class:"model-table"},ka=["onClick"],za={class:"model-name"},wa={class:"model-source"},_a={class:"model-context"},Ca={key:0},xa={key:1,class:"text-secondary"},Ma={key:0,class:"model-cost-in"},Ta={key:0,class:"cost-value"},Sa={key:1,class:"text-secondary"},Oa={key:1,class:"model-cost-out"},Ba={key:0,class:"cost-value"},$a={key:1,class:"text-secondary"},Pa={class:"model-enviro-carbon"},ja={key:0,class:"enviro-value"},Fa={key:1,class:"enviro-unknown"},Ga={class:"model-enviro-water"},La={key:0,class:"enviro-value"},Ia={key:1,class:"enviro-unknown"},Ua={class:"model-enviro-energy"},Aa={key:0,class:"enviro-value"},Da={key:1,class:"enviro-unknown"},Ha=T(a({__name:"ModelList",props:{models:{},providerId:{}},emits:["toggle-model"],setup(a){const h=a,b=A(),k=y("name"),z=y("asc"),w=l(()=>b.financialCostsEnabled),_=l(()=>b.environmentalCostsEnabled),C=l(()=>[...h.models].sort((e,a)=>{let l=0;switch(k.value){case"enabled":l=(e.enabled?1:0)-(a.enabled?1:0);break;case"name":l=e.displayName.localeCompare(a.displayName);break;case"source":l=(e.source||"").localeCompare(a.source||"");break;case"context":l=(e.capabilities?.contextWindow||0)-(a.capabilities?.contextWindow||0);break;case"inputCost":l=(e.capabilities?.inputCostPerToken||0)-(a.capabilities?.inputCostPerToken||0);break;case"outputCost":l=(e.capabilities?.outputCostPerToken||0)-(a.capabilities?.outputCostPerToken||0)}return"asc"===z.value?l:-l}));function x(e){k.value===e?z.value="asc"===z.value?"desc":"asc":(k.value=e,z.value="asc")}function M(e,a){if(!_.value)return"??";if(!D.hasDataForModel(e.provider,e.modelId))return"-";const l=D.calculateEnvironmentalCostUnsafe(e.provider,e.modelId,1e6)[a];if(0===l)return"-";switch(a){case"carbon":return l<1?`${(1e3*l).toFixed(0)}mg`:`${l.toFixed(1)}g`;case"water":return l<1?`${(1e3*l).toFixed(0)}Î¼L`:`${l.toFixed(1)}mL`;case"energy":return l<1?`${(1e3*l).toFixed(0)}mWh`:`${l.toFixed(1)}Wh`;default:return"-"}}const T=Y;return(a,l)=>{const y=n("a-switch"),h=n("a-tag");return s(),t("div",ya,[o("div",ha,[o("div",{class:"header-switch sortable",onClick:l[0]||(l[0]=e=>x("enabled"))},[l[7]||(l[7]=o("span",null,"Enabled",-1)),o("span",{class:g(["sort-indicator",{active:"enabled"===k.value}])},m("enabled"===k.value&&"asc"===z.value?"â–²":"â–¼"),3)]),o("div",{class:"header-name sortable",onClick:l[1]||(l[1]=e=>x("name"))},[l[8]||(l[8]=o("span",null,"Model",-1)),o("span",{class:g(["sort-indicator",{active:"name"===k.value}])},m("name"===k.value&&"asc"===z.value?"â–²":"â–¼"),3)]),o("div",{class:"header-source sortable",onClick:l[2]||(l[2]=e=>x("source"))},[l[9]||(l[9]=o("span",null,"Source",-1)),o("span",{class:g(["sort-indicator",{active:"source"===k.value}])},m("source"===k.value&&"asc"===z.value?"â–²":"â–¼"),3)]),o("div",{class:"header-context sortable",onClick:l[3]||(l[3]=e=>x("context"))},[l[10]||(l[10]=o("span",null,"Context",-1)),o("span",{class:g(["sort-indicator",{active:"context"===k.value}])},m("context"===k.value&&"asc"===z.value?"â–²":"â–¼"),3)]),w.value?(s(),t("div",{key:0,class:"header-cost-in sortable",onClick:l[4]||(l[4]=e=>x("inputCost"))},[l[11]||(l[11]=o("span",null,"Input $/1M",-1)),o("span",{class:g(["sort-indicator",{active:"inputCost"===k.value}])},m("inputCost"===k.value&&"asc"===z.value?"â–²":"â–¼"),3)])):d("",!0),w.value?(s(),t("div",{key:1,class:"header-cost-out sortable",onClick:l[5]||(l[5]=e=>x("outputCost"))},[l[12]||(l[12]=o("span",null,"Output $/1M",-1)),o("span",{class:g(["sort-indicator",{active:"outputCost"===k.value}])},m("outputCost"===k.value&&"asc"===z.value?"â–²":"â–¼"),3)])):d("",!0),l[13]||(l[13]=o("div",{class:"header-enviro-carbon"},[o("span",null,"COâ‚‚")],-1)),l[14]||(l[14]=o("div",{class:"header-enviro-water"},[o("span",null,"ðŸ’§")],-1)),l[15]||(l[15]=o("div",{class:"header-enviro-energy"},[o("span",null,"âš¡")],-1))]),o("div",ba,[(s(!0),t(u,null,c(C.value,n=>{return s(),t("div",{key:n.id,class:"model-row",onClick:e=>a.$emit("toggle-model",n.id,!n.enabled)},[o("div",{class:"model-switch",onClick:l[6]||(l[6]=f(()=>{},["stop"]))},[e(y,{checked:n.enabled,size:"small",onChange:e=>a.$emit("toggle-model",n.id,e),"data-testid":"model-toggle","data-provider":n.provider,"data-model":n.modelId,"aria-label":`${n.enabled?"Disable":"Enable"} model ${n.modelId}`},null,8,["checked","onChange","data-provider","data-model","aria-label"])]),o("div",za,[o("code",null,m(n.modelId),1)]),o("div",wa,[n.source?(s(),p(h,{key:0,size:"small",color:"cyan"},{default:i(()=>[r(m(n.source),1)]),_:2},1024)):d("",!0)]),o("div",_a,[n.capabilities?.contextWindow?(s(),t("span",Ca,m((u=n.capabilities.contextWindow,u>=1e6?(u/1e6).toFixed(1)+"M":u>=1e3?(u/1e3).toFixed(0)+"K":u.toString())),1)):(s(),t("span",xa,"-"))]),w.value?(s(),t("div",Ma,[n.capabilities?.inputCostPerToken?(s(),t("span",Ta," $"+m(v(T)(n.capabilities.inputCostPerToken)),1)):(s(),t("span",Sa,"-"))])):d("",!0),w.value?(s(),t("div",Oa,[n.capabilities?.outputCostPerToken?(s(),t("span",Ba," $"+m(v(T)(n.capabilities.outputCostPerToken)),1)):(s(),t("span",$a,"-"))])):d("",!0),o("div",Pa,[_.value?(s(),t("span",ja,m(M(n,"carbon")),1)):(s(),t("span",Fa,"??"))]),o("div",Ga,[_.value?(s(),t("span",La,m(M(n,"water")),1)):(s(),t("span",Ia,"??"))]),o("div",Ua,[_.value?(s(),t("span",Aa,m(M(n,"energy")),1)):(s(),t("span",Da,"??"))])],8,ka);var u}),128))])])}}}),[["__scopeId","data-v-7c06f73d"]]),Ea={class:"models-view","data-testid":"page-models"},Qa={class:"page-header"},Ra={key:2,class:"discovery-status-bar"},Va={class:"source-name"},qa=["onClick","data-testid","aria-label"],Na={class:"search-filter-bar"},Wa={class:"control-bar"},Ka={class:"left-controls"},Ja={class:"stats"},Ya={class:"provider-header"},Za={class:"provider-info"},Xa={key:0,class:"provider-summary"},el=T(a({__name:"ModelsView",setup(a){const g=H(),{data:h,refresh:b}=x(()=>V.models.toArray(),{debounce:100}),M=y(""),T=y(""),O=y("all"),B=y(!1),$=y(!1),P=y(!1),j=y(""),L=y([]),I=y(null),U=y([]),A=y([]);let D=null;const K=l(()=>{const e={};for(const a of h.value)e[a.provider]||(e[a.provider]=[]),e[a.provider].push(a);return e}),J=l(()=>{const e={};for(const[a,l]of Object.entries(K.value))e[a]=l.filter(e=>e.enabled).length;return e}),Y=l(()=>{const e=T.value.toLowerCase(),a={};for(const[l,t]of Object.entries(K.value)){let s=t;e&&(s=s.filter(a=>a.displayName.toLowerCase().includes(e)||a.modelId.toLowerCase().includes(e)||l.toLowerCase().includes(e))),"enabled"===O.value?s=s.filter(e=>e.enabled):"disabled"===O.value&&(s=s.filter(e=>!e.enabled)),s.length>0&&(a[l]=s)}return a}),Z=l(()=>h.value.length),X=l(()=>h.value.filter(e=>e.enabled)),ee=l(()=>X.value.length),ae=l(()=>M.value?`No models found matching "${M.value}"`:"all"!==O.value?`No ${O.value} models found`:'No models available. Click "Refresh Models" to discover models.'),le=l(()=>{if(!j.value)return!1;const e=j.value.toLowerCase();return e.includes("ollama")&&(e.includes("failed to fetch")||e.includes("networkerror when attempting to fetch"))&&!e.includes("litellm")&&!e.includes("openrouter")}),te=l(()=>{const e=K.value["ollama-chat"]?.length>0||K.value["ollama-generate"]?.length>0,a=A.value.some(e=>"ollama"===e.id);return e||a||le.value}),se=l(()=>!!K.value.openrouter),ne=l(()=>{const e=Object.keys(g.modelsByProvider).length;return L.value.length===e&&e>0}),ie=z(E),re=z(Q);function de(e){const a=N.getProvider(e);return a?.name||e}function ue(e){return{litellm:"LiteLLM (Anthropic & OpenAI models & prices)",openrouter:"OpenRouter",ollama:"Ollama"}[e]||e}function ce(e){const a=function(e){return J.value[e]||0}(e),l=(g.modelsByProvider[e]||[]).length;return 0===a?"default":a===l?"success":"warning"}function me(e){const a=Y.value[e]||[];return a.length>0&&a.every(e=>e.enabled)}function ve(e){const a=Y.value[e]||[];return a.length>0&&a.every(e=>!e.enabled)}function pe(){ne.value?L.value=[]:L.value=Object.keys(g.modelsByProvider)}async function ge(e,a){await V.models.update(e,{enabled:a,modifiedAt:new Date})}async function fe(e,a){P.value=!0;try{const l=(Y.value[e]||[]).map(e=>({key:e.id,changes:{enabled:a,modifiedAt:new Date}}));await V.models.bulkUpdate(l)}finally{P.value=!1}}async function ye(){P.value=!0;try{const e=[];for(const a of Object.values(Y.value))for(const l of a)l.enabled||e.push(l.id);if(e.length>0){const a=e.map(e=>({key:e,changes:{enabled:!0,modifiedAt:new Date}}));await V.models.bulkUpdate(a)}}finally{P.value=!1}}async function he(){P.value=!0;try{const e=[];for(const a of Object.values(Y.value))for(const l of a)l.enabled&&e.push(l.id);if(e.length>0){const a=e.map(e=>({key:e,changes:{enabled:!1,modifiedAt:new Date}}));await V.models.bulkUpdate(a)}}finally{P.value=!1}}async function be(){try{await g.enableOpenRouterFavorites(),L.value.includes("openrouter")||(L.value=[...L.value,"openrouter"])}catch(e){R.error("Failed to enable OpenRouter favorites",e),alert("Failed to enable OpenRouter favorites: "+(e instanceof Error?e.message:"Unknown error"))}}async function ke(){B.value=!0,j.value="";try{const e=await g.discoverModels(!0);A.value=e.sources,e.errors.length>0&&(j.value=`Some sources failed: ${e.errors.join("; ")}`),await b()}catch(e){R.error("Failed to refresh models",e),j.value="Failed to refresh models. Please check your connection and try again."}finally{B.value=!1}}async function ze(){try{await g.refreshSource("ollama"),A.value=W.getSourceStatus()}catch(e){R.error("Failed to refresh Ollama models after update",e)}}async function we(){if(confirm("This will remove all models and re-discover them from scratch. Any custom model configurations will be lost. Continue?")){$.value=!0,j.value="";try{await V.models.clear();const e=await g.discoverModels(!0);A.value=e.sources,e.errors.length>0&&(j.value=`Some sources failed: ${e.errors.join("; ")}`),await b()}catch(e){R.error("Failed to clear and refresh models",e),j.value="Failed to clear and refresh models. Please check your connection and try again."}finally{$.value=!1}}}return w(()=>{var e;e=M.value,D&&clearTimeout(D),D=setTimeout(()=>{T.value=e},300)}),k(async()=>{A.value=g.discoveryStatus,0===h.value.length&&ke(),L.value=[]}),_(()=>{M.value="",L.value=[],j.value=""}),(a,l)=>{const y=n("a-button"),h=n("a-space"),b=n("a-alert"),k=n("a-tag"),z=n("a-input-search"),w=n("a-radio-button"),_=n("a-radio-group"),x=n("a-divider"),D=n("a-collapse-panel"),H=n("a-collapse"),E=n("a-empty");return s(),t("div",Ea,[o("div",Qa,[l[8]||(l[8]=o("div",{class:"header-content"},[o("h1",null,"Model Management"),o("p",{class:"description"},"Configure and enable LLM models for testing")],-1)),e(h,null,{default:i(()=>[e(y,{type:"primary",onClick:ke,loading:B.value,"data-testid":"btn-refresh-models","aria-label":"Refresh available models"},{icon:i(()=>[e(v(F))]),default:i(()=>[l[6]||(l[6]=r(" Refresh Models "))]),_:1,__:[6]},8,["loading"]),e(y,{danger:"",onClick:we,loading:$.value,"data-testid":"btn-clear-refresh-models","aria-label":"Clear all models and refresh"},{icon:i(()=>[e(v(G))]),default:i(()=>[l[7]||(l[7]=r(" Clear and Refresh Models "))]),_:1,__:[7]},8,["loading"])]),_:1})]),j.value&&!le.value?(s(),p(b,{key:0,type:"error",message:j.value,closable:"",onClose:l[0]||(l[0]=e=>j.value=""),class:"error-alert"},null,8,["message"])):d("",!0),le.value?(s(),p(b,{key:1,type:"info",closable:"",onClose:l[1]||(l[1]=e=>j.value=""),class:"ollama-info-alert"},{message:i(()=>l[9]||(l[9]=[o("div",{class:"ollama-message"},[r(" Ollama is not running on this computer. To audit local LLMs, install "),o("a",{href:"https://ollama.com",target:"_blank",rel:"noopener noreferrer"},"Ollama"),r(". ")],-1)])),_:1})):d("",!0),A.value.length>0?(s(),t("div",Ra,[l[10]||(l[10]=o("span",{class:"status-label"},"Sources:",-1)),(s(!0),t(u,null,c(A.value,a=>{return s(),t("div",{key:a.id,class:"source-status-compact"},[o("span",Va,m(ue(a.id)),1),e(k,{color:(l=a.status,{idle:"default",loading:"processing",success:"success",error:"error"}[l]||"default"),size:"small"},{default:i(()=>["success"===a.status&&a.modelCount?(s(),t(u,{key:0},[r(m(a.modelCount),1)],64)):"error"===a.status?(s(),t("span",{key:1,onClick:e=>async function(e){I.value=e,j.value="";try{await g.refreshSource(e),A.value=W.getSourceStatus()}catch(a){R.error("Failed to retry source",a,{sourceId:e}),j.value=`Failed to refresh ${ue(e)}: ${a instanceof Error?a.message:"Unknown error"}`}finally{I.value=null}}(a.id),style:{cursor:"pointer"},"data-testid":`retry-source-${a.id}`,"aria-label":`Retry loading models from ${ue(a.id)}`},"âŸ³ retry",8,qa)):(s(),t(u,{key:2},[r(m(a.status),1)],64))]),_:2},1032,["color"])]);var l}),128))])):d("",!0),o("div",Na,[e(z,{value:M.value,"onUpdate:value":l[2]||(l[2]=e=>M.value=e),placeholder:"Search models by name, provider, or ID...","allow-clear":"",size:"large",class:"search-input","data-testid":"input-model-search","aria-label":"Search models",loading:M.value!==T.value},null,8,["value","loading"]),e(_,{value:O.value,"onUpdate:value":l[3]||(l[3]=e=>O.value=e),"button-style":"solid",size:"large"},{default:i(()=>[e(w,{value:"all"},{default:i(()=>l[11]||(l[11]=[r("All")])),_:1,__:[11]}),e(w,{value:"enabled"},{default:i(()=>l[12]||(l[12]=[r("Enabled")])),_:1,__:[12]}),e(w,{value:"disabled"},{default:i(()=>l[13]||(l[13]=[r("Disabled")])),_:1,__:[13]})]),_:1},8,["value"])]),o("div",Wa,[o("div",Ka,[e(y,{type:"text",size:"small",onClick:pe},{icon:i(()=>[(s(),p(C(ne.value?re.value:ie.value)))]),default:i(()=>[r(" "+m(ne.value?"Collapse All":"Expand All"),1)]),_:1}),e(x,{type:"vertical"}),e(y,{type:"text",size:"small",onClick:ye,loading:P.value,disabled:P.value},{icon:i(()=>[e(v(S))]),default:i(()=>[l[14]||(l[14]=r(" Enable All "))]),_:1,__:[14]},8,["loading","disabled"]),e(y,{type:"text",size:"small",onClick:he,loading:P.value,disabled:P.value},{icon:i(()=>[e(v(q))]),default:i(()=>[l[15]||(l[15]=r(" Disable All "))]),_:1,__:[15]},8,["loading","disabled"]),se.value?(s(),p(y,{key:0,type:"text",size:"small",onClick:be,loading:P.value,disabled:P.value},{icon:i(()=>[e(v(oe))]),default:i(()=>[l[16]||(l[16]=r(" OpenRouter Favorites "))]),_:1,__:[16]},8,["loading","disabled"])):d("",!0)]),o("div",Ja,[o("span",null,m(ee.value)+" of "+m(Z.value)+" models enabled",1)])]),e(H,{activeKey:L.value,"onUpdate:activeKey":l[4]||(l[4]=e=>L.value=e),bordered:!1,class:"provider-collapse"},{default:i(()=>[(s(!0),t(u,null,c(Y.value,(a,n)=>(s(),p(D,{key:n},{header:i(()=>[o("div",Ya,[o("div",Za,[o("strong",null,m(de(n)),1),L.value.includes(n)?(s(),t(u,{key:1},[e(k,{size:"small",color:"blue"},{default:i(()=>[r(m(a.length)+" models",1)]),_:2},1024),e(k,{size:"small",color:ce(n)},{default:i(()=>[r(m(J.value[n]||0)+" enabled ",1)]),_:2},1032,["color"])],64)):(s(),t("span",Xa,m(J.value[n]||0)+" / "+m((v(g).modelsByProvider[n]||[]).length)+" enabled ",1))]),e(h,{size:"small"},{default:i(()=>[e(y,{type:"text",size:"small",onClick:f(e=>fe(n,!0),["stop"]),disabled:me(n)||P.value,loading:P.value},{icon:i(()=>[e(v(S))]),default:i(()=>[l[17]||(l[17]=r(" Enable All "))]),_:2,__:[17]},1032,["onClick","disabled","loading"]),e(y,{type:"text",size:"small",onClick:f(e=>fe(n,!1),["stop"]),disabled:ve(n)||P.value,loading:P.value},{icon:i(()=>[e(v(q))]),default:i(()=>[l[18]||(l[18]=r(" Disable All "))]),_:2,__:[18]},1032,["onClick","disabled","loading"])]),_:2},1024)])]),default:i(()=>[e(Ha,{models:a,"provider-id":n,onToggleModel:ge},null,8,["models","provider-id"])]),_:2},1024))),128))]),_:1},8,["activeKey"]),0===Object.keys(Y.value).length?(s(),p(E,{key:3,description:ae.value,class:"empty-state"},null,8,["description"])):d("",!0),te.value?(s(),p(H,{key:4,activeKey:U.value,"onUpdate:activeKey":l[5]||(l[5]=e=>U.value=e),bordered:!1,class:"ollama-manager-collapse"},{default:i(()=>[e(D,{key:"ollama"},{header:i(()=>l[19]||(l[19]=[o("div",{class:"ollama-header"},[o("strong",null,"Ollama Model Management"),o("span",{class:"ollama-description"},"Download and manage local Ollama models")],-1)])),default:i(()=>[e(fa,{onModelsUpdated:ze})]),_:1})]),_:1},8,["activeKey"])):d("",!0)])}}}),[["__scopeId","data-v-b4366395"]]);export{el as default};
