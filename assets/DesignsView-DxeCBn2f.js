const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./default-data.service-H81p3CVO.js","./index-B_4MOQZM.js","./vendor-AtAbR8ZE.js","./db-CL8uhZCz.js","./index-WKWW6WoI.css","./defaultData-Bk-Mi7PC.js"])))=>i.map(i=>d[i]);
import{r as e,f as a,c as t,w as l,d as s,a6 as i,Y as r,_ as n,a1 as o,k as d,a0 as u,F as c,a8 as v,ac as p,Z as m,G as f,q as b,V as g,ad as y,ae as h,B as k,b as _,W as w,u as x,aa as C,o as L,X as V,a9 as R}from"./vendor-AtAbR8ZE.js";import{u as T}from"./useResponsiveTable-D21Makc9.js";import{u as S,t as I,p as D,a as E}from"./designs-db-gRa2_N1v.js";import{u as j}from"./variables-db-gP8BqpR8.js";import{_ as W,l as P,i as z,j as $,k as U,a as B,m as A,n as N,e as F,f as O,o as M}from"./index-B_4MOQZM.js";import{d as K,a as q}from"./defaultData-Bk-Mi7PC.js";import{u as H}from"./models-db-D9qjKDGq.js";import{_ as J}from"./BaseModal.vue_vue_type_style_index_0_lang-Dt0u-Isl.js";import{_ as Y}from"./BaseButton.vue_vue_type_style_index_0_lang-DquyhzkW.js";import{a as G}from"./cost-formatting-Bv_drrqY.js";import{i as X}from"./feature-flags-DaxAZY-J.js";import{E as Z}from"./EnvironmentalCostSummary-DFefRIuX.js";import{T as Q}from"./TemplateEditor-Cu7ttrTR.js";import"./db-CL8uhZCz.js";import"./variable.service-C9ycYxPX.js";const ee={class:"variable-chip-input"},ae={key:0,class:"attributed-list-display"},te={class:"list-header"},le={class:"source-name"},se={key:0,class:"attribute-breakdown"},ie={key:0,class:"separator"},re={class:"total-conditions"},ne={class:"attributed-chips-container"},oe={class:"item-name"},de={key:0,class:"attributes-wrapper"},ue={key:1,class:"direct-values"},ce={key:0,class:"simple-list-display"},ve={class:"list-header"},pe={class:"source-name"},me={class:"tag-input-wrapper"},fe={class:"custom-tag-input"},be={class:"tag-container tag-container-readonly"},ge=["title"],ye={key:0,class:"readonly-hint"},he={key:0,class:"helper-text"},ke={key:1,class:"tag-input-wrapper"},_e={class:"custom-tag-input"},we={class:"tag-container"},xe={class:"floating-actions"},Ce=["title"],Le=["onClick","data-testid","aria-label"],Ve=["placeholder","aria-label","onKeydown"],Re={key:0,class:"helper-text"},Te=W(s({__name:"VariableChipInput",props:{values:{},listRef:{},listName:{},source:{},placeholder:{},attributedSamples:{},attributeBreakdown:{},attributeKeys:{},previewValues:{},totalCount:{}},emits:["update:values","clear-source","clear-list","select-list"],setup(e,{emit:t}){const l=e,s=t,_=a(""),w=a();function x(e){s("update:values",e),l.source&&s("clear-source")}function C(){const e=_.value.trim();e&&(l.values.includes(e)||x([...l.values,e]),_.value="")}function L(e){e.preventDefault();const a=(e.clipboardData?.getData("text")||"").split(/\r?\n/).map(e=>e.trim()).filter(e=>e.length>0);if(a.length>0){const e=new Set(l.values),t=a.filter(a=>!e.has(a));t.length>0&&x([...l.values,...t]),_.value=""}}function V(){if(""===_.value&&l.values.length>0){const e=[...l.values];e.pop(),x(e)}}function R(){x([]),l.source&&s("clear-source")}return(e,a)=>(r(),i("div",ee,[e.listRef&&e.attributedSamples?(r(),i("div",ae,[n("div",te,[a[6]||(a[6]=n("span",{class:"source-label"},"From list:",-1)),n("span",le,u(e.listName||"Unknown List"),1),e.attributeBreakdown&&e.attributeBreakdown.parts.length>0?(r(),i("div",se,[(r(!0),i(c,null,v(e.attributeBreakdown.parts,(a,t)=>(r(),i(c,{key:t},[n("span",{class:"attribute-part",style:p({backgroundColor:[{bg:"#d1fae5",text:"#166534"},{bg:"#e9d5ff",text:"#7c2d12"},{bg:"#fed7aa",text:"#c2410c"},{bg:"#fce7f3",text:"#be185d"},{bg:"#fef3c7",text:"#92400e"}][a.colorIndex].bg,color:[{bg:"#d1fae5",text:"#166534"},{bg:"#e9d5ff",text:"#7c2d12"},{bg:"#fed7aa",text:"#c2410c"},{bg:"#fce7f3",text:"#be185d"},{bg:"#fef3c7",text:"#92400e"}][a.colorIndex].text})},u(a.text),5),t<e.attributeBreakdown.parts.length-1?(r(),i("span",ie," Ã— ")):o("",!0)],64))),128)),a[4]||(a[4]=n("span",{class:"arrow"}," â†’ ",-1)),n("span",re,u(e.attributeBreakdown.totalItems)+" conditions",1)])):o("",!0),d(Y,{variant:"danger",size:"small",onClick:a[0]||(a[0]=a=>e.$emit("clear-list")),"data-testid":"btn-remove-list","aria-label":"Remove linked variable list"},{default:m(()=>a[5]||(a[5]=[f(" Remove List ")])),_:1,__:[5]})]),n("div",ne,[a[9]||(a[9]=n("span",{class:"sample-hint"},"Sample values:",-1)),(r(!0),i(c,null,v(e.attributedSamples,e=>{return r(),i("div",{key:e.value,class:"attributed-item-chip"},[n("span",oe,u(e.value),1),e.attributes?(r(),i("span",de,[a[7]||(a[7]=f(" (")),(r(!0),i(c,null,v((t=e.attributes,l.attributeKeys?Object.entries(t).map(([e,a])=>({value:a,colorIndex:l.attributeKeys.indexOf(e)%5})):[]),(e,a)=>(r(),i("span",{key:a,class:"attribute-value",style:p({backgroundColor:[{bg:"#d1fae5",text:"#166534"},{bg:"#e9d5ff",text:"#7c2d12"},{bg:"#fed7aa",text:"#c2410c"},{bg:"#fce7f3",text:"#be185d"},{bg:"#fef3c7",text:"#92400e"}][e.colorIndex].bg,color:[{bg:"#d1fae5",text:"#166534"},{bg:"#e9d5ff",text:"#7c2d12"},{bg:"#fed7aa",text:"#c2410c"},{bg:"#fce7f3",text:"#be185d"},{bg:"#fef3c7",text:"#92400e"}][e.colorIndex].text})},u(e.value),5))),128)),a[8]||(a[8]=f(") "))])):o("",!0)]);var t}),128))])])):(r(),i("div",ue,[e.source?(r(),i("div",ce,[n("div",ve,[a[12]||(a[12]=n("span",{class:"source-label"},"From list:",-1)),n("span",pe,u(e.source.listName),1),a[13]||(a[13]=n("span",{class:"edit-hint"},"(Unlink list to edit)",-1)),d(Y,{variant:"primary",size:"small",onClick:a[1]||(a[1]=a=>e.$emit("clear-source")),"data-testid":"btn-unlink-list","aria-label":"Unlink list and edit values directly"},{default:m(()=>a[10]||(a[10]=[f(" Unlink List and Edit Directly ")])),_:1,__:[10]}),d(Y,{variant:"danger",size:"small",onClick:R,"data-testid":"btn-clear-values","aria-label":"Remove all values from list"},{default:m(()=>a[11]||(a[11]=[f(" Remove List ")])),_:1,__:[11]})]),n("div",me,[n("div",fe,[n("div",be,[(r(!0),i(c,null,v(e.values,(e,a)=>(r(),i("div",{key:`${e}-${a}`,class:"tag tag-readonly"},[n("span",{class:"tag-text",title:e.length>100?e:""},u(e.length>100?e.substring(0,100)+"...":e),9,ge)]))),128)),0===e.values.length?(r(),i("span",ye," Values from linked list will appear here ")):o("",!0)]),e.values.length>0?(r(),i("div",he,u(e.values.length)+" values ",1)):o("",!0)])])])):o("",!0),e.source?o("",!0):(r(),i("div",ke,[n("div",_e,[n("div",we,[n("div",xe,[e.values.length>0?(r(),g(Y,{key:0,variant:"danger",size:"small",onClick:R,"data-testid":"btn-clear-all","aria-label":"Clear all values"},{default:m(()=>a[14]||(a[14]=[f(" Clear ")])),_:1,__:[14]})):o("",!0),d(Y,{variant:"secondary",size:"small",onClick:a[2]||(a[2]=a=>e.$emit("select-list")),"data-testid":"btn-select-list","aria-label":"Replace values with a variable list"},{default:m(()=>a[15]||(a[15]=[f(" Replace with List ")])),_:1,__:[15]})]),(r(!0),i(c,null,v(e.values,(e,a)=>(r(),i("div",{key:`${e}-${a}`,class:"tag"},[n("span",{class:"tag-text",title:e.length>100?e:""},u(e.length>100?e.substring(0,100)+"...":e),9,Ce),n("button",{type:"button",class:"tag-remove",onClick:e=>function(e){const a=[...l.values];a.splice(e,1),x(a)}(a),"data-testid":`btn-remove-tag-${a}`,"aria-label":`Remove value ${e}`}," Ã— ",8,Le)]))),128)),b(n("input",{ref_key:"inputField",ref:w,"onUpdate:modelValue":a[3]||(a[3]=e=>_.value=e),placeholder:e.placeholder,class:"tag-input-field","data-testid":"input-variable-value","aria-label":e.placeholder||"Enter variable value",onKeydown:[h(k(C,["prevent"]),["enter"]),h(V,["backspace"])],onPaste:L},null,40,Ve),[[y,_.value]])]),e.values.length>0?(r(),i("div",Re,u(e.values.length)+" values ",1)):o("",!0)])]))]))]))}}),[["__scopeId","data-v-fd23a61c"]]),Se={class:"variable-preview-cycler"},Ie={class:"preview-controls"},De={key:0,class:"cycle-info","data-testid":"cycle-info",role:"status","aria-live":"polite"},Ee=["aria-label"],je={key:0,class:"preview-content"},We={key:0,class:"no-variables"},Pe={key:1,class:"single-preview","data-testid":"single-preview"},ze=["innerHTML"],$e={key:2,class:"cycling-preview","data-testid":"cycling-preview"},Ue=["innerHTML"],Be={class:"variable-legend"},Ae=["data-testid"],Ne={class:"variable-value"},Fe=W(s({__name:"VariablePreviewCycler",props:{template:{},variableBindings:{},variables:{},variableListRefs:{}},emits:["toggle-preview"],setup(e,{emit:s}){const p=e,b=s,y=j(),h=a(!1),k=a(0);let L=null;const V=["variable-highlight-blue","variable-highlight-green","variable-highlight-purple","variable-highlight-orange","variable-highlight-pink","variable-highlight-teal"],R=t(()=>{let e=[];if(p.variableBindings?e=Object.keys(p.variableBindings):p.variables&&(e=Object.keys(p.variables)),p.variableListRefs){const a=Object.keys(p.variableListRefs);e=[...new Set([...e,...a])]}return P.debug("VariablePreviewCycler - Variable names",{names:e}),P.debug("VariablePreviewCycler - Variables",{variables:p.variables}),P.debug("VariablePreviewCycler - Variable list refs",{variableListRefs:p.variableListRefs}),e}),T=t(()=>{if(0===R.value.length)return[];const e=[];for(const t of R.value){let a=[];if(p.variableBindings){const e=p.variableBindings[t];if("direct"===e.type&&e.values)a=[...e.values];else if("list"===e.type&&e.listId){const t=y.lists.find(a=>a.id===e.listId);t&&("simple"===t.category&&t.values?a=[...t.values]:"attributed"===t.category&&t.items&&(a=t.items.map(e=>e.value)))}}else if(p.variables&&p.variables[t]&&p.variables[t].length>0)a=[...p.variables[t]];else if(p.variableListRefs&&p.variableListRefs[t]){const e=p.variableListRefs[t];P.debug("Looking for list for variable",{listId:e,varName:t});const l=y.lists.find(a=>a.id===e);P.debug("Found list",{list:l}),l?"simple"===l.category&&l.values?(a=[...l.values],P.debug("Using simple list values for variable",{varName:t,values:a})):"attributed"===l.category&&l.items&&(a=l.items.map(e=>e.value),P.debug("Using attributed list values for variable",{varName:t,values:a})):P.debug("No list found for variable",{varName:t,listId:e})}a.length>0&&e.push({name:t,values:a})}if(0===e.length)return[];const a=e.map(e=>e.values);return a.reduce((e,a)=>e.flatMap(e=>a.map(a=>[...e,a])),[[]]).map(a=>{const t={};return e.forEach((e,l)=>{t[e.name]=a[l]}),t})});function S(){h.value=!h.value,b("toggle-preview",h.value),h.value&&T.value.length>1?(I(),L=setInterval(()=>{k.value=(k.value+1)%T.value.length},1e3)):I()}function I(){L&&(clearInterval(L),L=null)}function D(e){return V[e%V.length]}function E(e){let a=p.template;return R.value.forEach((t,l)=>{if(void 0!==e[t]){const s=new RegExp(`\\{\\{\\s*${t}\\s*\\}\\}`,"g"),i=`<span class="${D(l)}">${W(String(e[t]))}</span>`;a=a.replace(s,i)}}),W(a).replace(/&lt;span class="([^"]*)"&gt;/g,'<span class="$1">').replace(/&lt;\/span&gt;/g,"</span>")}function W(e){const a=document.createElement("div");return a.textContent=e,a.innerHTML}return l(()=>p.template,()=>{k.value=0}),_(()=>{I()}),(e,a)=>{const t=w("a-button");return r(),i("div",Se,[n("div",Ie,[d(t,{type:h.value?"default":"primary",ghost:!h.value,onClick:S,class:"toggle-button","data-testid":"btn-toggle-preview-mode","aria-label":h.value?"Return to editor mode":"Preview filled-in prompts","aria-pressed":h.value},{default:m(()=>[h.value?(r(),g(x($),{key:1})):(r(),g(x(z),{key:0})),f(" "+u(h.value?"Return to Editor Mode":"Preview Filled-In Prompts"),1)]),_:1},8,["type","ghost","aria-label","aria-pressed"]),h.value&&T.value.length>1?(r(),i("div",De,[n("span",{class:"cycle-counter","data-testid":"cycle-counter","aria-label":`Showing combination ${k.value+1} of ${T.value.length}`},u(k.value+1)+" / "+u(T.value.length),9,Ee),a[0]||(a[0]=n("span",{class:"cycle-hint"},"Auto-cycling every second",-1))])):o("",!0)]),h.value?(r(),i("div",je,[0===T.value.length?(r(),i("div",We,[d(x(U)),a[1]||(a[1]=n("span",null,"No variables detected in template",-1))])):1===T.value.length?(r(),i("div",Pe,[n("div",{class:"preview-template",innerHTML:E(T.value[0]),"data-testid":"preview-template",role:"region","aria-label":"Preview of filled-in prompt"},null,8,ze)])):(r(),i("div",$e,[n("div",{class:"preview-template",innerHTML:E(T.value[k.value]),"data-testid":"preview-template-cycling",role:"region","aria-label":"Preview of filled-in prompt with cycling variables"},null,8,Ue),n("div",Be,[(r(!0),i(c,null,v(R.value,(e,a)=>(r(),i("div",{key:e,class:"legend-item","data-testid":`legend-item-${e}`},[n("span",{class:C(D(a))},u(e),3),n("span",Ne,u(T.value[k.value][e]),1)],8,Ae))),128))])]))])):o("",!0)])}}}),[["__scopeId","data-v-509d8450"]]),Oe={class:"list-selector"},Me={class:"list-grid"},Ke=["onClick"],qe={class:"list-header"},He={class:"item-count"},Je={key:0,class:"list-description"},Ye={class:"list-preview"},Ge={key:0,class:"preview-more"},Xe={key:1,class:"attributed-badge"},Ze={key:0,class:"empty-state"},Qe=W(s({__name:"ListSelector",props:{modelValue:{type:Boolean},listType:{}},emits:["update:modelValue","select"],setup(e,{emit:a}){const l=e,s=a,p=j(),b=t(()=>"all"===l.listType?p.lists:"simple"===l.listType?p.simpleLists:"refusal"===l.listType?p.refusalLists:[]),y=e=>"attributed"===e.category&&e.items?e.items.slice(0,5).map(e=>e.value):e.values?.slice(0,5)??[];return(e,a)=>(r(),g(J,{"model-value":e.modelValue,title:"Select List",size:"medium","onUpdate:modelValue":a[1]||(a[1]=a=>e.$emit("update:modelValue",a))},{footer:m(()=>[d(Y,{variant:"ghost",onClick:a[0]||(a[0]=a=>e.$emit("update:modelValue",!1))},{default:m(()=>a[2]||(a[2]=[f(" Cancel ")])),_:1,__:[2]})]),default:m(()=>[n("div",Oe,[n("div",Me,[(r(!0),i(c,null,v(b.value,e=>(r(),i("div",{key:e.id,class:"list-option",onClick:a=>(e=>{s("select",e),s("update:modelValue",!1)})(e)},[n("div",qe,[n("h4",null,u(e.name),1),n("span",He,u(e.itemCount)+" items",1)]),e.description?(r(),i("p",Je,u(e.description),1)):o("",!0),n("div",Ye,[(r(!0),i(c,null,v(y(e),(e,a)=>(r(),i("span",{key:a,class:"preview-value"},u(e),1))),128)),e.itemCount>5?(r(),i("span",Ge," +"+u(e.itemCount-5)+" more ",1)):o("",!0)]),"attributed"===e.category?(r(),i("div",Xe," Attributed List ")):o("",!0)],8,Ke))),128))]),0===b.value.length?(r(),i("div",Ze," No "+u(e.listType)+" lists available ",1)):o("",!0)])]),_:1},8,["model-value"]))}}),[["__scopeId","data-v-b6e2244c"]]),ea={class:"model-selection-table"},aa={class:"table-header"},ta={class:"provider-header"},la={class:"provider-name"},sa={class:"provider-count"},ia={class:"provider-models"},ra={class:"model-info"},na={class:"model-name"},oa={class:"model-cost"},da={key:0,class:"cost-primary"},ua=W(s({__name:"ModelSelectionTable",props:{models:{},totalCalls:{},design:{},modelParams:{}},setup(e){const l=e,s=B(),p=a([]),f=a(X()),b=t(()=>s.financialCostsEnabled),y=t(()=>{const e=l.models,a={};for(const t of e)a[t.provider]||(a[t.provider]=[]),a[t.provider].push(t);for(const t in a)a[t].sort((e,a)=>e.displayName.localeCompare(a.displayName));return a});function h(e){if(!e.capabilities)return 0;const a=l.design.tokenEstimate?.avgTokens||150,t=l.modelParams?.max_tokens||l.modelParams?.max_completion_tokens||256;return((e.capabilities.inputCostPerToken||0)*a+(e.capabilities.outputCostPerToken||0)*t)*l.totalCalls}return(e,a)=>{const t=w("a-collapse-panel"),l=w("a-collapse");return r(),i("div",ea,[n("div",aa,[n("h4",null,"Cost Estimation for "+u(e.totalCalls)+" API calls",1)]),d(l,{activeKey:p.value,"onUpdate:activeKey":a[0]||(a[0]=e=>p.value=e),ghost:""},{default:m(()=>[(r(!0),i(c,null,v(y.value,(a,l)=>(r(),g(t,{key:l},{header:m(()=>[n("div",ta,[n("span",la,u(l),1),n("span",sa,"("+u(a.length)+" models)",1)])]),default:m(()=>[n("div",ia,[(r(!0),i(c,null,v(a,a=>(r(),i("div",{key:`${a.provider}:${a.modelId}`,class:"model-row"},[n("div",ra,[n("div",na,u(a.displayName),1)]),n("div",oa,[b.value?(r(),i("div",da,u(x(G)(h(a))),1)):o("",!0),f.value?(r(),g(Z,{key:1,model:a,design:e.design,layout:"compact",class:"environmental-costs-inline"},null,8,["model","design"])):o("",!0)])]))),128))])]),_:2},1024))),128))]),_:1},8,["activeKey"])])}}}),[["__scopeId","data-v-0cf8516b"]]),ca={class:"design-form-container"},va={class:"name-desc-row"},pa={key:0,class:"variable-hint"},ma={key:0,class:"variables-container"},fa={class:"variable-label"},ba={class:"variable-content"},ga={class:"output-row"},ya={class:"refusal-row"},ha={class:"refusal-content"},ka={class:"modal-footer"},_a={class:"stats"},wa={class:"actions"},xa={class:"pricing-content"},Ca={key:0,class:"token-stats"},La={class:"stats-grid"},Va=W(s({__name:"DesignEditor",props:{modelValue:{type:Boolean},designId:{}},emits:["update:modelValue","saved"],setup(s,{emit:b}){const y=s,h=b,k=function(s){const i=S(),r=j(),n=e({name:"",description:"",promptTemplate:"",outputType:"text",extractPattern:"",refusalWords:[],refusalWordsListRef:"",refusalWordsSource:null,rejectRefusalWords:!1}),o=a({}),d=a({}),u=a({}),c=a(!1),v=a(!1),p=a([]),m=t(()=>I.extractVariables(n.promptTemplate)),f=t(()=>I.validateTemplate(n.promptTemplate)),b=t(()=>{const e=[];n.name.trim()||e.push("Name is required"),n.promptTemplate.trim()||e.push("Template is required"),f.value.isValid||e.push(...f.value.errors);const a=m.value.filter(e=>{const a=(o.value[e]?.length??0)>0,t=!!d.value[e];return!a&&!t});return a.length&&e.push(`Missing values for variables: ${a.join(", ")}`),{isValid:0===e.length,errors:e}}),g=t(()=>{const e={};for(const a of m.value)if(d.value[a]){const t=r.lists.find(e=>e.id===d.value[a]);e[a]=t?.itemCount??0}else e[a]=o.value[a]?.length??0;return e}),y=t(()=>D.getPermutationInfo(g.value));return l(()=>n.promptTemplate,()=>{const e=m.value;for(const a in o.value)e.includes(a)||(delete o.value[a],delete d.value[a],delete u.value[a]);for(const a of e)a in o.value||a in d.value||(o.value[a]=[])}),l(b,e=>{p.value=e.errors}),s&&async function(){if(s){v.value=!0;try{const e=await i.getDesign(s);if(!e)return;if(n.name=e.name,n.description=e.description||"",n.promptTemplate=e.promptTemplate,n.outputType=e.outputType,n.extractPattern="string"==typeof e.extractPattern?e.extractPattern:"",n.rejectRefusalWords=e.rejectRefusalWords??!1,n.refusalWords=e.refusalWords||[],n.refusalWordsListRef=e.refusalWordsListRef||"",n.refusalWordsSource=e.refusalWordsSource||null,e.variableBindings)for(const[a,t]of Object.entries(e.variableBindings))"list"===t.type&&t.listId?d.value[a]=t.listId:"direct"===t.type&&t.values&&(o.value[a]=[...t.values],t.source&&(u.value[a]=t.source))}finally{v.value=!1}}}(),{form:n,variableArrays:o,variableListRefs:d,variableListSources:u,detectedVariables:m,templateValidation:f,validation:b,errors:p,variableCounts:g,permutationInfo:y,isSaving:c,isLoading:v,saveDesign:async function(e){if(b.value.isValid){c.value=!0;try{const a={};for(const e of m.value)if(d.value[e]){const t=r.lists.find(a=>a.id===d.value[e]);a[e]={type:"list",listId:d.value[e],listName:t?.name}}else o.value[e]?.length>0&&(a[e]={type:"direct",values:[...o.value[e]],source:u.value[e]&&null!==u.value[e]?{listId:u.value[e].listId,listName:u.value[e].listName}:void 0});const t={name:n.name,description:n.description,promptTemplate:n.promptTemplate,outputType:n.outputType,extractPattern:n.extractPattern,variableBindings:JSON.parse(JSON.stringify(a)),refusalWords:[...n.refusalWords],refusalWordsListRef:n.refusalWordsListRef||void 0,refusalWordsSource:n.refusalWordsSource?{...n.refusalWordsSource}:void 0,rejectRefusalWords:n.rejectRefusalWords};return e&&(t.tokenEstimate=e),s?(await i.updateDesign(s,t),s):await i.createDesign(t)}finally{c.value=!1}}}}}(y.designId),_=j(),C=H(),V=a(!1),R=a(!1),T=a("all"),W=a(""),z=a(!1),$=a(""),B=a(null),N=t(()=>C.enabledModels),F=[{bg:"#E8D5F2",text:"#6B21A8"},{bg:"#D5F2E8",text:"#047857"},{bg:"#FFE4D6",text:"#C2410C"},{bg:"#D6E4FF",text:"#1E40AF"},{bg:"#F3E8D5",text:"#92400E"}];function O(e){const a=k.detectedVariables.value.indexOf(e);return F[a%F.length]}function M(e){return`{{${e}}}`}function K(e){P.debug("Preview mode toggled",{isPreviewMode:e})}const q=t(()=>{const e={};return k.detectedVariables.value.forEach((a,t)=>{e[a]=F[t%F.length]}),e});function Y(e){const a=k.variableListRefs.value[e];if(!a)return;const t=_.lists.find(e=>e.id===a);return t?.name}function G(e){const a=k.variableListRefs.value[e];if(!a)return;const t=_.lists.find(e=>e.id===a);return t?.itemCount}function X(e){const a=k.variableListRefs.value[e];if(!a)return;const t=_.lists.find(e=>e.id===a);return t&&"attributed"===t.category&&t.items?t.items.slice(0,10):void 0}function Z(e){const a=k.variableListRefs.value[e];if(!a)return;const t=_.lists.find(e=>e.id===a);if(!t||"attributed"!==t.category)return;const l=[];return t.attributeKeys&&l.push(...t.attributeKeys.map((e,a)=>({text:e,colorIndex:a%5}))),{parts:l,totalItems:t.itemCount||0}}function ee(e){const a=k.variableListRefs.value[e];if(!a)return;const t=_.lists.find(e=>e.id===a);return t?.attributeKeys}function ae(e){const a=k.variableListRefs.value[e];if(!a)return;const t=_.lists.find(e=>e.id===a);return t&&"simple"===t.category?t.values?.slice(0,10):void 0}function te(e){W.value&&("simple"===e.category?(k.variableArrays.value[W.value]=e.values||[],k.variableListRefs.value[W.value]="",k.variableListSources.value[W.value]={listId:e.id,listName:e.name}):(k.variableListRefs.value[W.value]=e.id,k.variableArrays.value[W.value]=[],k.variableListSources.value[W.value]=null)),V.value=!1}function le(){if(!k.form.refusalWordsListRef)return;const e=_.lists.find(e=>e.id===k.form.refusalWordsListRef);return e?.name}function se(e){k.form.refusalWordsListRef=e.id,k.form.refusalWords=[],k.form.refusalWordsSource=null,R.value=!1}function ie(){k.form.extractPattern=$.value}l(()=>k.form.extractPattern,e=>{const a=A.find(a=>a.value===e);$.value=a?a.value:""});const re=t(()=>{const e={};for(const a of k.detectedVariables.value)if(k.variableListRefs.value[a]){const t=_.lists.find(e=>e.id===k.variableListRefs.value[a]);e[a]={type:"list",listId:k.variableListRefs.value[a],listName:t?.name}}else k.variableArrays.value[a]?.length>0&&(e[a]={type:"direct",values:[...k.variableArrays.value[a]]});return{id:y.designId||"temp",name:k.form.name,description:k.form.description,promptTemplate:k.form.promptTemplate,variableBindings:e,tokenEstimate:B.value||void 0,outputType:k.form.outputType,extractPattern:k.form.extractPattern,refusalWords:k.form.refusalWords,refusalWordsListRef:k.form.refusalWordsListRef,rejectRefusalWords:k.form.rejectRefusalWords,created:new Date,updated:new Date}});async function ne(){const e=await k.saveDesign(B.value||void 0);e&&(h("saved",e),h("update:modelValue",!1))}return l(z,async e=>{e&&!B.value&&(B.value=await E.calculateDesignTokens(re.value))}),L(async()=>{await _.initialize()}),(e,a)=>{const t=w("a-input"),l=w("a-form-item"),s=w("a-select-option"),b=w("a-select"),y=w("a-checkbox"),h=w("a-alert"),_=w("a-form"),C=w("a-button"),L=w("a-modal");return r(),i(c,null,[d(J,{"model-value":e.modelValue,title:e.designId?"Edit Design":"Create Design",size:"full","data-testid":"modal-design-editor","onUpdate:modelValue":a[13]||(a[13]=a=>e.$emit("update:modelValue",a))},{footer:m(()=>[n("div",ka,[n("div",_a,u(x(k).detectedVariables.value.length)+" variables â€¢ "+u(x(k).permutationInfo.value.formatted)+" combinations ",1),n("div",wa,[d(C,{size:"large",onClick:a[11]||(a[11]=e=>z.value=!0),"data-testid":"btn-calculate-pricing","aria-label":"Calculate pricing for this design"},{default:m(()=>a[31]||(a[31]=[f(" Calculate Pricing ")])),_:1,__:[31]}),d(C,{size:"large",onClick:a[12]||(a[12]=a=>e.$emit("update:modelValue",!1)),"data-testid":"btn-cancel-design","aria-label":"Cancel and close design editor"},{default:m(()=>a[32]||(a[32]=[f(" Cancel ")])),_:1,__:[32]}),d(C,{size:"large",type:"primary",onClick:ne,"data-testid":"btn-save-design","aria-label":"Save design and close editor"},{default:m(()=>a[33]||(a[33]=[f(" Save ")])),_:1,__:[33]})])])]),default:m(()=>[n("div",ca,[d(_,{model:x(k).form,layout:"vertical",onFinish:ne},{default:m(()=>[n("div",va,[a[18]||(a[18]=n("label",{class:"inline-field-label"},"Name",-1)),d(l,{name:"name",rules:[{required:!0,message:"Required"}],class:"name-field"},{default:m(()=>[d(t,{value:x(k).form.name,"onUpdate:value":a[0]||(a[0]=e=>x(k).form.name=e),placeholder:"Enter design name",size:"large","data-testid":"input-design-name","aria-label":"Design name"},null,8,["value"])]),_:1}),a[19]||(a[19]=n("label",{class:"inline-field-label"},"Description",-1)),d(l,{name:"description",class:"desc-field"},{default:m(()=>[d(t,{value:x(k).form.description,"onUpdate:value":a[1]||(a[1]=e=>x(k).form.description=e),placeholder:"Optional description",size:"large","data-testid":"input-design-description","aria-label":"Design description"},null,8,["value"])]),_:1})]),d(l,{label:"Template",name:"promptTemplate",rules:[{required:!0,message:"Required"}],class:"template-form-item"},{default:m(()=>[0===x(k).detectedVariables.value.length?(r(),i("div",pa,[d(x(U)),a[20]||(a[20]=n("span",null,[f("Type a prompt and use double curly braces to add a variable with conditions to vary, like "),n("code",null,"{{name}}"),f(" or "),n("code",null,"{{system_prompt}}"),f(". Variable names cannot contain spaces or punctuation except underscores (_).")],-1))])):o("",!0),d(Q,{modelValue:x(k).form.promptTemplate,"onUpdate:modelValue":a[2]||(a[2]=e=>x(k).form.promptTemplate=e),placeholder:"Enter your prompt template... Use {{variable}} for variables",rows:10,variables:x(k).detectedVariables.value,"variable-colors":q.value,"data-testid":"template-editor","aria-label":"Prompt template editor"},null,8,["modelValue","variables","variable-colors"]),x(k).detectedVariables.value.length>0&&x(k).form.promptTemplate?(r(),g(Fe,{key:1,template:x(k).form.promptTemplate,variables:x(k).variableArrays.value,"variable-list-refs":x(k).variableListRefs.value,onTogglePreview:K},null,8,["template","variables","variable-list-refs"])):o("",!0)]),_:1}),x(k).detectedVariables.value.length>0?(r(),i("div",ma,[(r(!0),i(c,null,v(x(k).detectedVariables.value,e=>(r(),i("div",{key:e,class:"variable-row"},[n("div",fa,[a[21]||(a[21]=n("span",{class:"variable-text"},"Variable:",-1)),n("span",{style:p({backgroundColor:O(e).bg,color:O(e).text}),class:"variable-badge"},u(M(e)),5)]),n("div",ba,[d(Te,{values:x(k).variableArrays.value[e]||[],"list-ref":x(k).variableListRefs.value[e],"list-name":Y(e),source:x(k).variableListSources.value[e]||null,placeholder:`Enter a value for {{${e}}} and hit enter`,"attributed-samples":X(e),"attribute-breakdown":Z(e),"attribute-keys":ee(e),"preview-values":ae(e),"total-count":G(e),"onUpdate:values":a=>function(e,a){k.variableArrays.value[e]=a}(e,a),onClearSource:a=>function(e){k.variableListSources.value[e]=null}(e),onClearList:a=>function(e){k.variableListRefs.value[e]="",k.variableArrays.value[e]=[]}(e),onSelectList:a=>function(e){W.value=e,T.value="all",V.value=!0}(e)},null,8,["values","list-ref","list-name","source","placeholder","attributed-samples","attribute-breakdown","attribute-keys","preview-values","total-count","onUpdate:values","onClearSource","onClearList","onSelectList"])])]))),128))])):o("",!0),n("div",ga,[a[26]||(a[26]=n("label",{class:"row-label"},"Output Format",-1)),d(b,{value:x(k).form.outputType,"onUpdate:value":a[3]||(a[3]=e=>x(k).form.outputType=e),size:"large",style:{width:"120px"},"data-testid":"select-output-format","aria-label":"Select output format type"},{default:m(()=>[d(s,{value:"text"},{default:m(()=>a[22]||(a[22]=[f("Text")])),_:1,__:[22]}),d(s,{value:"number"},{default:m(()=>a[23]||(a[23]=[f("Number")])),_:1,__:[23]}),d(s,{value:"boolean"},{default:m(()=>a[24]||(a[24]=[f("Boolean")])),_:1,__:[24]})]),_:1},8,["value"]),a[27]||(a[27]=n("label",{class:"inline-label"},"Parse Preset",-1)),d(b,{value:$.value,"onUpdate:value":a[4]||(a[4]=e=>$.value=e),size:"large",style:{flex:"1"},onChange:ie,"data-testid":"select-parse-preset","aria-label":"Select parsing preset"},{default:m(()=>[d(s,{value:""},{default:m(()=>a[25]||(a[25]=[f("Full Response (default)")])),_:1,__:[25]}),(r(!0),i(c,null,v(x(A),e=>(r(),g(s,{key:e.value,value:e.value},{default:m(()=>[f(u(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),a[28]||(a[28]=n("label",{class:"inline-label"},"Regex Extract",-1)),d(t,{value:x(k).form.extractPattern,"onUpdate:value":a[5]||(a[5]=e=>x(k).form.extractPattern=e),placeholder:"Leave blank for full response",size:"large",style:{flex:"1"},"data-testid":"input-regex-extract","aria-label":"Regular expression extraction pattern"},null,8,["value"])]),n("div",ya,[a[30]||(a[30]=n("label",{class:"row-label"},"Parse Refusals",-1)),n("div",ha,[d(Te,{values:x(k).form.refusalWords,"list-ref":x(k).form.refusalWordsListRef,"list-name":le(),source:x(k).form.refusalWordsSource||null,placeholder:"Enter a refusal word and hit enter (e.g., cannot, unable, refuse)","onUpdate:values":a[6]||(a[6]=e=>x(k).form.refusalWords=e),onClearSource:a[7]||(a[7]=e=>x(k).form.refusalWordsSource=null),onClearList:a[8]||(a[8]=e=>(k.form.refusalWordsListRef="",void(k.form.refusalWords=[]))),onSelectList:a[9]||(a[9]=e=>R.value=!0)},null,8,["values","list-ref","list-name","source"])]),d(y,{checked:x(k).form.rejectRefusalWords,"onUpdate:checked":a[10]||(a[10]=e=>x(k).form.rejectRefusalWords=e),class:"reject-checkbox","data-testid":"checkbox-reject-refusals","aria-label":"Reject responses containing refusal words"},{default:m(()=>a[29]||(a[29]=[f(" Reject on match ")])),_:1,__:[29]},8,["checked"])]),x(k).errors.value.length>0?(r(),g(h,{key:1,type:"error","show-icon":"",class:"error-alert"},{message:m(()=>[f(u(x(k).errors.value.join(", ")),1)]),_:1})):o("",!0)]),_:1},8,["model"])])]),_:1},8,["model-value","title"]),d(Qe,{modelValue:V.value,"onUpdate:modelValue":a[14]||(a[14]=e=>V.value=e),"list-type":T.value,onSelect:te},null,8,["modelValue","list-type"]),d(Qe,{modelValue:R.value,"onUpdate:modelValue":a[15]||(a[15]=e=>R.value=e),"list-type":"refusal",onSelect:se},null,8,["modelValue"]),d(L,{open:z.value,"onUpdate:open":a[17]||(a[17]=e=>z.value=e),title:"Cost Estimation",width:"90vw",style:{maxWidth:"1000px"}},{footer:m(()=>[d(C,{onClick:a[16]||(a[16]=e=>z.value=!1)},{default:m(()=>a[35]||(a[35]=[f("Close")])),_:1,__:[35]})]),default:m(()=>[n("div",xa,[B.value?(r(),i("div",Ca,[a[34]||(a[34]=n("h4",null,"Token Analysis",-1)),n("div",La,[n("div",null,"Min: "+u(B.value.minTokens),1),n("div",null,"Max: "+u(B.value.maxTokens),1),n("div",null,"Avg: "+u(B.value.avgTokens),1),n("div",null,"Sample: "+u(B.value.sampleSize),1)])])):o("",!0),d(ua,{models:N.value,"total-calls":x(k).permutationInfo.value.total,design:re.value,"model-params":{}},null,8,["models","total-calls","design"])])]),_:1},8,["open"])],64)}}}),[["__scopeId","data-v-257ec0ab"]]),Ra={class:"import-defaults-content"},Ta={class:"section-header"},Sa={class:"item-content"},Ia={class:"item-header"},Da={class:"item-description"},Ea={class:"item-meta"},ja={class:"section-header"},Wa={class:"item-content"},Pa={class:"item-header"},za={class:"item-description"},$a={class:"item-meta"},Ua={class:"modal-footer"},Ba=W(s({__name:"ImportDefaultsModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","imported"],setup(e,{emit:s}){const p=e,b=s,y=S(),h=j(),k=t({get:()=>p.modelValue,set:e=>b("update:modelValue",e)}),_=a("designs"),x=a(!1),C=a(!1),V=a(new Set),R=a(new Set),T=a({}),I=a({}),D=a(!1),E=a(!1),W=t(()=>K),z=t(()=>q),$=t(()=>{const e=Object.values(T.value).some(e=>e),a=Object.values(I.value).some(e=>e);return e||a});async function U(){x.value=!0;try{const e=await y.getAllDesigns(),a=await h.getAllLists();V.value=new Set(e.map(e=>e.name)),R.value=new Set(a.map(e=>e.name)),T.value={},I.value={},K.forEach(e=>{T.value[e.name]=!1}),q.forEach(e=>{I.value[e.name]=!1})}finally{x.value=!1}}function B(){K.forEach(e=>{V.value.has(e.name)||(T.value[e.name]=D.value)})}function A(){q.forEach(e=>{R.value.has(e.name)||(I.value[e.name]=E.value)})}async function O(){C.value=!0;try{const{DefaultDataService:e}=await N(async()=>{const{DefaultDataService:e}=await import("./default-data.service-H81p3CVO.js");return{DefaultDataService:e}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url),a=Object.entries(T.value).filter(([e,a])=>a).map(([e])=>e),t=Object.entries(I.value).filter(([e,a])=>a).map(([e])=>e),l=await e.importDefaults(a.length>0?a:null,t.length>0?t:null),s=[];l.designs>0&&s.push(`${l.designs} designs`),l.lists>0&&s.push(`${l.lists} variable lists`),s.length>0?F.success(`Successfully imported ${s.join(" and ")}`):F.info("No new items were imported (may already exist)"),b("imported"),M()}catch(e){P.error("Import failed",e),F.error("Failed to import selected items")}finally{C.value=!1}}function M(){k.value=!1}function H(e){switch(e){case"attributed":return"blue";case"refusal":return"red";default:return"green"}}return L(async()=>{await U()}),l(()=>p.modelValue,e=>{e&&U()}),(e,a)=>{const t=w("a-alert"),l=w("a-checkbox"),s=w("a-tag"),p=w("a-list-item"),b=w("a-list"),y=w("a-tab-pane"),h=w("a-tabs"),L=w("a-button"),S=w("a-modal");return r(),g(S,{open:k.value,"onUpdate:open":a[3]||(a[3]=e=>k.value=e),title:"Import Default Designs & Variables",width:"95vw",footer:null,onCancel:M,centered:!0,"body-style":{height:"90vh",overflow:"auto"},"data-testid":"modal-import-defaults"},{default:m(()=>[n("div",Ra,[d(t,{type:"info",message:"Import pre-configured designs and variable lists",description:"Select which default designs and variable lists you want to import. These are carefully crafted templates for common LLM bias testing scenarios.","show-icon":!0,style:{marginBottom:"var(--spacing-xl)"}}),d(h,{activeKey:_.value,"onUpdate:activeKey":a[2]||(a[2]=e=>_.value=e)},{default:m(()=>[d(y,{key:"designs",tab:"Designs"},{default:m(()=>[n("div",Ta,[a[5]||(a[5]=n("h4",null,"Available Designs",-1)),d(l,{checked:D.value,"onUpdate:checked":a[0]||(a[0]=e=>D.value=e),onChange:B,"data-testid":"checkbox-select-all-designs","aria-label":"Select all designs for import"},{default:m(()=>a[4]||(a[4]=[f(" Select All ")])),_:1,__:[4]},8,["checked"])]),d(b,{"data-source":W.value,loading:x.value,size:"small",class:"import-list"},{renderItem:m(({item:e})=>[d(p,null,{default:m(()=>[d(l,{checked:T.value[e.name],"onUpdate:checked":a=>T.value[e.name]=a,disabled:V.value.has(e.name)},{default:m(()=>[n("div",Sa,[n("div",Ia,[n("strong",null,u(e.name),1),V.value.has(e.name)?(r(),g(s,{key:0,size:"small",color:"orange"},{default:m(()=>a[6]||(a[6]=[f(" Already Exists ")])),_:1,__:[6]})):o("",!0)]),n("div",Da,u(e.description),1),n("div",Ea,[(r(!0),i(c,null,v(Object.keys(e.variableBindings),e=>(r(),g(s,{key:e,size:"small"},{default:m(()=>[f(u(e),1)]),_:2},1024))),128))])])]),_:2},1032,["checked","onUpdate:checked","disabled"])]),_:2},1024)]),_:1},8,["data-source","loading"])]),_:1}),d(y,{key:"variables",tab:"Variable Lists"},{default:m(()=>[n("div",ja,[a[8]||(a[8]=n("h4",null,"Available Variable Lists",-1)),d(l,{checked:E.value,"onUpdate:checked":a[1]||(a[1]=e=>E.value=e),onChange:A,"data-testid":"checkbox-select-all-variables","aria-label":"Select all variable lists for import"},{default:m(()=>a[7]||(a[7]=[f(" Select All ")])),_:1,__:[7]},8,["checked"])]),d(b,{"data-source":z.value,loading:x.value,size:"small",class:"import-list"},{renderItem:m(({item:e})=>[d(p,null,{default:m(()=>[d(l,{checked:I.value[e.name],"onUpdate:checked":a=>I.value[e.name]=a,disabled:R.value.has(e.name)},{default:m(()=>[n("div",Wa,[n("div",Pa,[n("strong",null,u(e.name),1),d(s,{size:"small",color:H(e.category)},{default:m(()=>[f(u(e.category),1)]),_:2},1032,["color"]),R.value.has(e.name)?(r(),g(s,{key:0,size:"small",color:"orange"},{default:m(()=>a[9]||(a[9]=[f(" Already Exists ")])),_:1,__:[9]})):o("",!0)]),n("div",za,u(e.description),1),n("div",$a,u(e.itemCount)+" items ",1)])]),_:2},1032,["checked","onUpdate:checked","disabled"])]),_:2},1024)]),_:1},8,["data-source","loading"])]),_:1})]),_:1},8,["activeKey"]),n("div",Ua,[d(L,{onClick:M,size:"large",class:"footer-button","data-testid":"btn-cancel-import-defaults","aria-label":"Cancel import"},{default:m(()=>a[10]||(a[10]=[f(" Cancel ")])),_:1,__:[10]}),d(L,{type:"primary",onClick:O,loading:C.value,disabled:!$.value,size:"large",class:"footer-button footer-button-primary","data-testid":"btn-confirm-import-defaults","aria-label":"Import selected designs and variables"},{default:m(()=>a[11]||(a[11]=[f(" Import Selected ")])),_:1,__:[11]},8,["loading","disabled"])])])]),_:1},8,["open"])}}}),[["__scopeId","data-v-96b945d1"]]),Aa={class:"designs-view","data-testid":"page-designs"},Na={class:"page-header"},Fa={key:3,class:"scientific-table-container"},Oa={class:"scientific-table-wrapper"},Ma={key:0,class:"table-info-cell"},Ka={class:"table-info-title"},qa={class:"table-info-subtitle"},Ha={key:1,class:"variables-cell"},Ja={key:0},Ya={class:"variables-calculation"},Ga={class:"variable-item"},Xa={key:0,class:"multiply-symbol"},Za={class:"equals-result"},Qa={key:1,class:"text-secondary"},et={key:0,class:"token-info"},at={class:"token-line"},tt={key:0,class:"token-line"},lt={key:1,class:"text-secondary"},st={key:3,class:"usage-cell"},it={key:4,class:"date-cell"},rt={key:5,class:"table-actions-grid"},nt=W(s({__name:"DesignsView",setup(e){const l=S(),s=j(),p=R(),b=V(),{getVisibleColumns:y,formatDateTime:h,createDesignColumns:k}=T(),_=a(!1),C=a(),E=a(!1),W=y(k()),z=t(()=>({y:"calc(100vh - 180px)"}));function $(e){C.value=e,_.value=!0}function U(){C.value=void 0,_.value=!1}function B(){E.value=!1}function A(e){if(!e.promptTemplate||!e.variableBindings)return[];const a=I.extractVariables(e.promptTemplate),t=[];for(const l of a){const a=e.variableBindings[l];if(!a)continue;let i=0;if("list"===a.type&&a.listId){const e=s.lists.find(e=>e.id===a.listId);e&&("simple"===e.category?i=e.values?.length||0:"attributed"===e.category&&(i=e.items?.length||0))}else"direct"===a.type&&(i=a.values?.length||0);i>0&&t.push({name:`{{${l}}}`,count:i})}return t}function N(e){if(!e.variableBindings)return 1;const a={};for(const[t,l]of Object.entries(e.variableBindings)){const e=l;if("list"===e.type&&e.listId){const l=s.lists.find(a=>a.id===e.listId);l&&("simple"===l.category?a[t]=l.values?.length||0:"attributed"===l.category&&(a[t]=l.items?.length||0))}else"direct"===e.type&&(a[t]=e.values?.length||0)}return D.calculateTotalPermutations(a)}function F(e){return e>999999?`${(e/1e6).toFixed(1)}M`:e>9999?`${(e/1e3).toFixed(0)}k`:e.toLocaleString()}return L(async()=>{await l.initialize(),await s.initialize(),"true"===b.query.create&&(_.value=!0,p.replace({name:"designs"}))}),(e,a)=>{const t=w("a-button"),s=w("a-space"),b=w("a-spin"),y=w("a-alert"),k=w("a-empty"),L=w("a-table");return r(),i("div",Aa,[n("div",Na,[a[8]||(a[8]=n("div",{class:"header-content"},[n("h1",null,"Prompt Designs"),n("p",{class:"description"},"Create and manage prompt templates for systematic testing")],-1)),d(s,null,{default:m(()=>[d(t,{onClick:a[0]||(a[0]=e=>E.value=!0),"data-testid":"btn-import-defaults","aria-label":"Import default prompt designs"},{icon:m(()=>[d(x(O))]),default:m(()=>[a[6]||(a[6]=f(" Import Defaults "))]),_:1,__:[6]}),d(t,{type:"primary",onClick:a[1]||(a[1]=e=>_.value=!0),"data-testid":"btn-create-design","aria-label":"Create new design"},{icon:m(()=>[d(x(M))]),default:m(()=>[a[7]||(a[7]=f(" Create Design "))]),_:1,__:[7]})]),_:1})]),x(l).isLoading?(r(),g(b,{key:0,size:"large",tip:"Loading designs..."},{default:m(()=>a[9]||(a[9]=[n("div",{style:{"min-height":"200px"}},null,-1)])),_:1,__:[9]})):x(l).error?(r(),g(y,{key:1,type:"error",message:x(l).error,class:"error-alert"},null,8,["message"])):0===x(l).designs.length?(r(),g(k,{key:2,description:"No designs yet. Create your first prompt design to start testing."},{image:m(()=>a[10]||(a[10]=[n("div",{style:{color:"#bfbfbf","font-size":"48px"}},"ðŸ“",-1)])),default:m(()=>[d(t,{type:"primary",onClick:a[2]||(a[2]=e=>_.value=!0),"data-testid":"btn-create-first-design","aria-label":"Create your first prompt design"},{default:m(()=>a[11]||(a[11]=[f(" Create Your First Design ")])),_:1,__:[11]})]),_:1})):(r(),i("div",Fa,[n("div",Oa,[d(L,{columns:x(W),"data-source":x(l).designsWithStats,pagination:!1,size:"small",scroll:z.value,"row-key":"id",class:"scientific-table","data-testid":"table-designs",role:"table","aria-label":"Prompt designs table"},{bodyCell:m(({column:e,record:s})=>{return["name"===e.key?(r(),i("div",Ma,[n("span",Ka,u(s.name),1),n("span",qa,u(s.description||"No description"),1)])):o("",!0),"variables"===e.key?(r(),i("div",Ha,[A(s).length>0?(r(),i("div",Ja,[n("div",Ya,[(r(!0),i(c,null,v(A(s),(e,a)=>(r(),i("span",{key:e.name},[n("span",Ga,u(e.name)+" ("+u(e.count)+")",1),a<A(s).length-1?(r(),i("span",Xa," Ã— ")):o("",!0)]))),128)),n("span",Za," = "+u(F(N(s)))+" cases",1)])])):(r(),i("span",Qa,"None"))])):o("",!0),"tokens"===e.key?(r(),i(c,{key:2},[s.tokenEstimate?(r(),i("div",et,[n("div",at," Per-prompt: ~"+u(s.tokenEstimate.avgTokens),1),N(s)>1?(r(),i("div",tt," Ã— "+u(N(s))+" = ~"+u(F(N(s)*s.tokenEstimate.avgTokens)),1)):o("",!0)])):(r(),i("span",lt,"-"))],64)):o("",!0),"stats"===e.key?(r(),i("div",st,[n("div",null,u(s.usedInTrials||0)+" trials",1),n("div",null,u(s.totalApiCalls||0)+" calls",1)])):o("",!0),"created"===e.key?(r(),i("div",it,u((b=s.created,h(b))),1)):o("",!0),"actions"===e.key?(r(),i("div",rt,[d(t,{size:"small",type:"primary",onClick:e=>$(s.id),"data-testid":"btn-edit-design","data-design-id":s.id,"aria-label":`Edit design ${s.name}`},{default:m(()=>a[12]||(a[12]=[f(" Edit ")])),_:2,__:[12]},1032,["onClick","data-design-id","aria-label"]),d(t,{size:"small",type:"primary",onClick:e=>{return a=s.id,void p.push({path:"/trials",query:{designId:a}});var a},"data-testid":"btn-new-trial-from-design","data-design-id":s.id,"aria-label":`Create new trial from design ${s.name}`},{default:m(()=>a[13]||(a[13]=[f(" New Trial ")])),_:2,__:[13]},1032,["onClick","data-design-id","aria-label"]),d(t,{size:"small",onClick:e=>async function(e){try{$(await l.duplicateDesign(e))}catch(a){P.error("Failed to duplicate design",a)}}(s.id),"data-testid":"btn-duplicate-design","data-design-id":s.id,"aria-label":`Duplicate design ${s.name}`},{default:m(()=>a[14]||(a[14]=[f(" Copy ")])),_:2,__:[14]},1032,["onClick","data-design-id","aria-label"]),d(t,{size:"small",danger:"",onClick:e=>async function(e){if(confirm("Are you sure you want to delete this design?"))try{await l.deleteDesign(e)}catch(a){P.error("Failed to delete design",a),alert(a instanceof Error?a.message:"Failed to delete design")}}(s.id),"data-testid":"btn-delete-design","data-design-id":s.id,"aria-label":`Delete design ${s.name}`},{default:m(()=>a[15]||(a[15]=[f(" Delete ")])),_:2,__:[15]},1032,["onClick","data-design-id","aria-label"])])):o("",!0)];var b}),_:1},8,["columns","data-source","scroll"])])])),_.value?(r(),g(Va,{key:4,modelValue:_.value,"onUpdate:modelValue":[a[3]||(a[3]=e=>_.value=e),a[4]||(a[4]=e=>{e||(C.value=void 0)})],"design-id":C.value,onSaved:U},null,8,["modelValue","design-id"])):o("",!0),d(Ba,{modelValue:E.value,"onUpdate:modelValue":a[5]||(a[5]=e=>E.value=e),onImported:B},null,8,["modelValue"])])}}}),[["__scopeId","data-v-0962ab69"]]);export{nt as default};
