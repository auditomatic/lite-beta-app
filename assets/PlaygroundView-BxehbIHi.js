import{u as e}from"./models-db-CVyHXAEz.js";import{u as a,a as t}from"./designs-db-C4vK0sNp.js";import{p as s,O as l,l as o,_ as n,a as r,i,n as d}from"./index-Cf8VAT7l.js";import{f as u,r as p,d as c,c as m,w as v,a6 as g,_ as h,k as f,W as y,Z as b,Y as k,a1 as x,V as _,F as w,a8 as C,G as E,a0 as $,a7 as L,ad as F,o as M,b as P,ab as I,u as j}from"./vendor-DImCB_rW.js";import{T as O}from"./TemplateEditor-DaDfiEPv.js";import{M as R,G as A}from"./GenericModelSelectorModal-BAEUZU5O.js";import"./db-CL8uhZCz.js";import"./defaultData-BR5V2V3r.js";import"./variable.service-AqPvPCqv.js";import"./cost-formatting-Bv_drrqY.js";function z(e){if(!e||"object"!=typeof e)return e;const a=Array.isArray(e)?[...e]:{...e};if(a.Authorization){const e=a.Authorization;if(e.startsWith("Bearer ")){const t=e.substring(7);a.Authorization=`Bearer ${t.substring(0,8)}...${t.substring(t.length-4)}`}else a.Authorization="[REDACTED]"}return Object.keys(a).forEach(e=>{"object"==typeof a[e]&&null!==a[e]&&(a[e]=z(a[e]))}),a}const S={class:"parameter-panel"},T={class:"panel-content"},D={key:0,class:"params-section"},V={key:0,class:"reasoning-warning"},W={key:5,class:"param-description"},N={key:4,class:"param-description"},U={key:2,class:"params-section"},q={class:"logprobs-controls"},B={class:"panel-actions"},Y=n(c({__name:"ParameterPanel",props:{model:{},modelValue:{}},emits:["update:modelValue","change"],setup(e,{emit:a}){const t=e,l=a,o=p({}),n=u(!1),r=u(3),i=m(()=>{if(!t.model)return{};const e=s.getParametersForModel(t.model.provider,t.model.modelId),a={},l=(e,t="")=>{Object.entries(e).forEach(([e,s])=>{const o=t?`${t}.${e}`:e;"object"===s.type&&s.properties?l(s.properties,o):a[o]=s})};l(e);const o={};for(const[t,s]of Object.entries(a))s.basic&&(o[t]=s);const n={},r=o.temperature?"temperature":o["options.temperature"]?"options.temperature":null;r&&(n[r]=o[r]);for(const[t,s]of Object.entries(o))t!==r&&(n[t]=s);return n}),d=m(()=>{if(!t.model)return{};const e=s.getParametersForModel(t.model.provider,t.model.modelId),a={},l=(e,t="")=>{Object.entries(e).forEach(([e,s])=>{const o=t?`${t}.${e}`:e;"object"===s.type&&s.properties?l(s.properties,o):a[o]=s})};l(e);const o={};for(const[t,s]of Object.entries(a))s.basic||(o[t]=s);return o}),c=m(()=>!!t.model&&(("openai-chat"===t.model.provider||"openai-responses"===t.model.provider)&&t.model.modelId.match(/^o[0-9]/))),L=m(()=>!!t.model&&s.supportsLogprobs(t.model.provider,t.model.modelId)),F=m(()=>t.model?s.getLogprobsParameters(t.model.provider,t.model.modelId):{}),M=m(()=>!!F.value.topLogprobs);function P(e,a){o[e]=a,l("update:modelValue",{...o}),l("change",{...o})}function I(e){return e.replace(/\./g," › ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function j(e){n.value=e,R()}function O(e){r.value=e||3,R()}function R(){const e=F.value;if(Object.keys(o).forEach(e=>{(e.includes("logprobs")||"include"===e)&&delete o[e]}),n.value){if(e.enableParams)for(const a of e.enableParams)if("boolean"===a.type)if(a.name.includes(".")){const e=a.name.split(".");let t=o;for(let a=0;a<e.length-1;a++)t[e[a]]||(t[e[a]]={}),t=t[e[a]];t[e[e.length-1]]=a.value}else o[a.name]=a.value;else"array"===a.type&&(o[a.name]||(o[a.name]=[]),o[a.name].includes(a.value)||o[a.name].push(a.value));if(e.topLogprobs)if(e.topLogprobs.includes(".")){const a=e.topLogprobs.split(".");let t=o;for(let e=0;e<a.length-1;e++)t[a[e]]||(t[a[e]]={}),t=t[a[e]];t[a[a.length-1]]=r.value}else o[e.topLogprobs]=r.value}else if(e.enableParams)for(const a of e.enableParams)"array"===a.type&&o[a.name]&&(o[a.name]=o[a.name].filter(e=>e!==a.value),0===o[a.name].length&&delete o[a.name]);l("update:modelValue",{...o}),l("change",{...o})}function A(){if(!t.model)return;Object.keys(o).forEach(e=>delete o[e]);const e=s.supportsLogprobs(t.model.provider,t.model.modelId);n.value=e,r.value=3;const a=(e,t="")=>{Object.entries(e).forEach(([e,s])=>{const l=t?`${t}.${e}`:e;"object"===s.type&&s.properties?a(s.properties,l):void 0!==s.default&&(o[l]=s.default)})},i=s.getParametersForModel(t.model.provider,t.model.modelId);a(i),e&&R(),l("update:modelValue",{...o}),l("change",{...o})}return v(()=>t.model,e=>{if(e){const a=s.supportsLogprobs(e.provider,e.modelId);n.value=a,r.value=3,A(),a&&R()}},{immediate:!0}),v(()=>t.modelValue,e=>{Object.assign(o,e)},{immediate:!0,deep:!0}),(e,a)=>{const t=y("a-alert"),s=y("a-input-number"),l=y("a-switch"),u=y("a-select-option"),p=y("a-select"),m=y("a-input"),v=y("a-form-item"),F=y("a-collapse-panel"),R=y("a-collapse"),z=y("a-button"),Y=y("a-form");return k(),g("div",S,[a[4]||(a[4]=h("div",{class:"panel-header"},[h("h3",null,"Parameters")],-1)),h("div",T,[f(Y,{layout:"vertical"},{default:b(()=>[Object.keys(i.value).length>0?(k(),g("div",D,[a[0]||(a[0]=h("h4",null,"Basic Parameters",-1)),c.value?(k(),g("div",V,[f(t,{message:"O* reasoning models do not support temperature",type:"info",size:"small","show-icon":"",closable:!1})])):x("",!0),(k(!0),g(w,null,C(i.value,(e,a)=>(k(),_(v,{key:a,label:I(a)},{default:b(()=>["number"===e.type?(k(),_(s,{key:0,value:o[a],onChange:e=>P(a,e),min:e.min,max:e.max,step:e.step||.1,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):"integer"===e.type?(k(),_(s,{key:1,value:o[a],onChange:e=>P(a,e),min:e.min,max:e.max,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","placeholder"])):"boolean"===e.type?(k(),_(l,{key:2,checked:o[a],onChange:e=>P(a,e),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):"string"===e.type&&e.enum?(k(),_(p,{key:3,value:o[a],onChange:e=>P(a,e),placeholder:String(e.default),size:"large",style:{width:"100%"},allowClear:""},{default:b(()=>[(k(!0),g(w,null,C(e.enum,e=>(k(),_(u,{key:e,value:e},{default:b(()=>[E($(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(k(),_(m,{key:4,value:o[a],onChange:e=>P(a,e.target.value),placeholder:String(e.default),size:"large"},null,8,["value","onChange","placeholder"])),e.description?(k(),g("div",W,$(e.description),1)):x("",!0)]),_:2},1032,["label"]))),128))])):x("",!0),Object.keys(d.value).length>0?(k(),_(R,{key:1,ghost:""},{default:b(()=>[f(F,{key:"advanced",header:"Advanced Parameters"},{default:b(()=>[(k(!0),g(w,null,C(d.value,(e,a)=>(k(),_(v,{key:a,label:I(a)},{default:b(()=>["number"===e.type||"integer"===e.type?(k(),_(s,{key:0,value:o[a],onChange:e=>P(a,e),min:e.min,max:e.max,step:"number"===e.type?e.step||.1:1,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):"boolean"===e.type?(k(),_(l,{key:1,checked:o[a],onChange:e=>P(a,e),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):"string"===e.type&&e.enum?(k(),_(p,{key:2,value:o[a],onChange:e=>P(a,e),placeholder:String(e.default),size:"large",style:{width:"100%"},allowClear:""},{default:b(()=>[(k(!0),g(w,null,C(e.enum,e=>(k(),_(u,{key:e,value:e},{default:b(()=>[E($(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(k(),_(m,{key:3,value:o[a],onChange:e=>P(a,e.target.value),placeholder:String(e.default),size:"large"},null,8,["value","onChange","placeholder"])),e.description?(k(),g("div",N,$(e.description),1)):x("",!0)]),_:2},1032,["label"]))),128))]),_:1})]),_:1})):x("",!0),L.value?(k(),g("div",U,[a[2]||(a[2]=h("h4",null,"Log Probabilities",-1)),h("div",q,[f(v,{label:"Enable Logprobs"},{default:b(()=>[f(l,{checked:n.value,onChange:j,"checked-children":"On","un-checked-children":"Off"},null,8,["checked"])]),_:1}),n.value&&M.value?(k(),_(v,{key:0,label:"Top Alternatives"},{default:b(()=>[f(s,{value:r.value,onChange:O,min:0,max:20,size:"large",style:{width:"100%"},placeholder:"3"},null,8,["value"]),a[1]||(a[1]=h("div",{class:"param-description"}," Number of alternative tokens to show (0-20) ",-1))]),_:1,__:[1]})):x("",!0)])])):x("",!0),h("div",B,[f(z,{onClick:A,size:"small"},{default:b(()=>a[3]||(a[3]=[E(" Reset to Defaults ")])),_:1,__:[3]})])]),_:1})])])}}}),[["__scopeId","data-v-8a496cc0"]]),G={class:"logprobs-display"},H={key:0,class:"color-legend"},J={key:1,class:"tokens-container"},K=["onMouseenter"],X={key:2,class:"regular-text"},Q={class:"tooltip-header"},Z={class:"token-text"},ee={class:"token-probability"},ae={key:0,class:"alternatives"},te={class:"alt-text"},se={class:"alt-probability"},le={class:"logprob-raw"},oe=n(c({__name:"LogprobsDisplay",props:{text:{},logprobsData:{}},setup(e){const a=e,t=u({visible:!1,token:{text:"",logprob:0},style:{}}),s=m(()=>a.logprobsData?a.logprobsData.map(e=>({text:e.token,logprob:e.logprob,bytes:e.bytes,topLogprobs:e.top_logprobs})):[]),l=["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#abd9e9","#74add1","#4575b4","#313695"];function o(e){const a=100*Math.exp(e.logprob),t=Math.min(Math.floor(a/(100/(l.length-1))),l.length-1);return{color:l[t],cursor:"pointer",transition:"all 0.2s ease"}}function n(e){return(100*Math.exp(e)).toFixed(2)}function r(){t.value.visible=!1}return(e,a)=>(k(),g("div",G,[s.value.length>0?(k(),g("div",H,a[1]||(a[1]=[L('<span class="legend-label" data-v-a0458886>Token Confidence:</span><div class="legend-gradient" data-v-a0458886><span class="legend-low" data-v-a0458886>Low</span><div class="gradient-bar" data-v-a0458886></div><span class="legend-high" data-v-a0458886>High</span></div>',2)]))):x("",!0),s.value.length>0?(k(),g("div",J,[(k(!0),g(w,null,C(s.value,(e,s)=>(k(),g("span",{key:s,class:"token",style:F(o(e)),onMouseenter:a=>function(e,a,s){t.value={visible:!0,token:e,style:{position:"fixed",left:`${s.clientX+10}px`,top:s.clientY-10+"px",zIndex:"1000"}}}(e,0,a),onMouseleave:r,onMousemove:a[0]||(a[0]=e=>{return a=e,void(t.value.visible&&(t.value.style={...t.value.style,left:`${a.clientX+10}px`,top:a.clientY-10+"px"}));var a})},$(e.text),45,K))),128))])):(k(),g("div",X,$(e.text),1)),t.value.visible?(k(),g("div",{key:3,class:"token-tooltip",style:F(t.value.style)},[h("div",Q,[h("span",Z,'"'+$(t.value.token.text)+'"',1),h("span",ee,$(n(t.value.token.logprob))+"%",1)]),t.value.token.topLogprobs&&t.value.token.topLogprobs.length>0?(k(),g("div",ae,[a[2]||(a[2]=h("div",{class:"alternatives-header"},"Alternative tokens:",-1)),(k(!0),g(w,null,C(t.value.token.topLogprobs?.slice(0,5),(e,a)=>(k(),g("div",{key:a,class:"alternative-token"},[h("span",te,'"'+$(e.token)+'"',1),h("span",se,$(n(e.logprob))+"%",1)]))),128))])):x("",!0),h("div",le," Raw logprob: "+$(t.value.token.logprob.toFixed(6)),1)],4)):x("",!0)]))}}),[["__scopeId","data-v-a0458886"]]),ne={class:"response-display"},re={key:0,class:"loading-state"},ie={key:1,class:"error-state"},de={class:"error-details"},ue={key:2,class:"response-content"},pe={class:"metadata-content"},ce={class:"metadata-grid"},me={class:"metadata-item"},ve={class:"value"},ge={key:0,class:"metadata-item"},he={class:"value"},fe={key:1,class:"metadata-item"},ye={class:"value"},be={class:"cost-amount"},ke={class:"cost-amount"},xe={class:"cost-amount"},_e={class:"metadata-item"},we={class:"value env-costs"},Ce={class:"env-item"},Ee={class:"env-item"},$e={class:"env-item"},Le={class:"raw-response"},Fe={class:"raw-response"},Me={key:3,class:"empty-state"},Pe=n(c({__name:"ResponseDisplay",props:{response:{},isLoading:{type:Boolean},error:{}},setup(e){const a=e,t=r(),s=u(300),l=u(!1),o=u(600);function n(e){l.value=!0;const a=e.clientY,t=s.value;function n(e){const l=e.clientY-a,n=t+l,r=o.value-100-10;s.value=Math.max(100,Math.min(n,r))}document.addEventListener("mousemove",n),document.addEventListener("mouseup",function e(){l.value=!1,document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",e)})}function d(){const e=document.querySelector(".response-content");e&&(o.value=e.clientHeight,s.value=Math.min(300,.6*o.value))}function p(e){return e<1e-4?e.toFixed(6):e<.01?e.toFixed(4):e.toFixed(3)}function c(e){if(!e)return"No raw response data";try{return JSON.stringify(e,null,2)}catch{return String(e)}}function m(e){if(!e)return"No error details available";try{return JSON.stringify(e,null,2)}catch{return String(e)}}function v(e,s){if(!t.environmentalCostsEnabled)return"??";if(!a.response?.model)return"-";if(!i.hasDataForModel(a.response.model.provider,a.response.model.modelId))return"-";const l=s||0;if(0===l)return"-";const o=i.calculateEnvironmentalCostUnsafe(a.response.model.provider,a.response.model.modelId,l)[e];if(0===o)return"-";switch(e){case"carbon":return o<.001?"<1μg":o<1?`${(1e3*o).toFixed(0)}μg`:o<1e3?`${o.toFixed(1)}mg`:`${(o/1e3).toFixed(1)}g`;case"water":return o<.001?"<1nL":o<1?`${(1e3*o).toFixed(0)}nL`:o<1e3?`${o.toFixed(1)}μL`:`${(o/1e3).toFixed(1)}mL`;case"energy":return o<.001?"<1μWh":o<1?`${(1e3*o).toFixed(0)}μWh`:o<1e3?`${o.toFixed(1)}mWh`:`${(o/1e3).toFixed(1)}Wh`;default:return"-"}}return M(()=>{d(),window.addEventListener("resize",d)}),P(()=>{window.removeEventListener("resize",d)}),(e,a)=>{const t=y("a-spin"),o=y("a-alert"),r=y("a-collapse-panel"),i=y("a-collapse");return k(),g("div",ne,[e.isLoading?(k(),g("div",re,[f(t,{size:"large"},{tip:b(()=>a[0]||(a[0]=[E("Generating response...")])),_:1})])):e.error?(k(),g("div",ie,[f(o,{type:"error",message:e.error.message||"API Error",description:e.error.details,"show-icon":""},null,8,["message","description"]),e.error.response?(k(),_(i,{key:0,ghost:"",style:{"margin-top":"16px"}},{default:b(()=>[f(r,{key:"details",header:"Full API Request/Response"},{default:b(()=>[h("pre",de,$(m(e.error.response)),1)]),_:1})]),_:1})):x("",!0)])):e.response?(k(),g("div",ue,[h("div",{class:"response-text",style:F({height:s.value+"px"})},[f(oe,{text:e.response.content,"logprobs-data":e.response.logprobs},null,8,["text","logprobs-data"])],4),h("div",{class:I(["response-divider",{dragging:l.value}]),onMousedown:n},a[1]||(a[1]=[h("div",{class:"divider-handle"},null,-1)]),34),h("div",{class:"response-metadata",style:F({height:`calc(100% - ${s.value}px - 10px)`})},[a[9]||(a[9]=h("h3",{class:"metadata-header"},"Response Details",-1)),h("div",pe,[h("div",ce,[h("div",me,[a[2]||(a[2]=h("span",{class:"label"},"Latency:",-1)),h("span",ve,$(e.response.latency)+"ms",1)]),e.response.tokens?(k(),g("div",ge,[a[3]||(a[3]=h("span",{class:"label"},"Token Usage:",-1)),h("span",he,$(e.response.tokens.prompt_tokens||"?")+" input + "+$(e.response.tokens.completion_tokens||"?")+" output = "+$(e.response.tokens.total_tokens||"?")+" total tokens ",1)])):x("",!0),e.response.cost?(k(),g("div",fe,[a[7]||(a[7]=h("span",{class:"label"},"Cost Estimate:",-1)),h("span",ye,[h("span",be,"$"+$(p(e.response.cost.input)),1),a[4]||(a[4]=E(" input + ")),h("span",ke,"$"+$(p(e.response.cost.output)),1),a[5]||(a[5]=E(" output = ")),h("span",xe,"$"+$(p(e.response.cost.total)),1),a[6]||(a[6]=E(" total "))])])):x("",!0),h("div",_e,[a[8]||(a[8]=h("span",{class:"label"},"Environmental:",-1)),h("span",we,[h("span",Ce,"CO₂ 🏭: "+$(v("carbon",e.response.tokens?.total_tokens))+"  ",1),h("span",Ee,"Water 💧: "+$(v("water",e.response.tokens?.total_tokens))+"  ",1),h("span",$e,"Energy ⚡: "+$(v("energy",e.response.tokens?.total_tokens)),1)])])]),f(i,{ghost:"",style:{"margin-top":"16px"}},{default:b(()=>[f(r,{key:"raw",header:"Raw API Response"},{default:b(()=>[h("pre",Le,$(c(e.response.raw)),1)]),_:1})]),_:1}),e.response.debug?(k(),_(i,{key:0,ghost:"",style:{"margin-top":"8px"}},{default:b(()=>[f(r,{key:"debug",header:"API Request Details"},{default:b(()=>[h("pre",Fe,$(c(e.response.debug)),1)]),_:1})]),_:1})):x("",!0)])],4)])):(k(),g("div",Me,a[10]||(a[10]=[h("div",{class:"empty-content"},[h("div",{class:"empty-icon"},"💬"),h("p",null,"Response will appear here after running a prompt")],-1)])))])}}}),[["__scopeId","data-v-7dfc4b0e"]]),Ie={class:"playground-view","data-testid":"page-playground"},je={class:"page-header"},Oe={class:"header-actions"},Re={key:0,class:"cost-estimate"},Ae={class:"cost-tooltip"},ze={class:"playground-content"},Se={class:"left-panel"},Te={class:"panel-section"},De={key:0,class:"model-info"},Ve={class:"info-header"},We={class:"model-name"},Ne={class:"provider-badge"},Ue={key:0,class:"info-details"},qe={class:"detail-item"},Be={class:"value"},Ye={class:"detail-item"},Ge={class:"value"},He={class:"dollar-amount"},Je={class:"detail-item"},Ke={class:"value"},Xe={class:"dollar-amount"},Qe={class:"detail-item"},Ze={class:"value"},ea={class:"detail-item"},aa={class:"value"},ta={class:"detail-item"},sa={class:"value"},la={class:"panel-section"},oa={class:"action-buttons"},na={key:0,class:"panel-section"},ra={class:"template-buttons"},ia={class:"center-panel"},da={class:"prompt-section"},ua={class:"section-header"},pa={class:"character-count"},ca={key:0,class:"response-section"},ma={class:"section-header"},va={key:0,class:"response-meta"},ga={class:"response-container"},ha={key:0,class:"right-panel"},fa={class:"design-list"},ya=["onClick"],ba={class:"design-name"},ka={class:"design-description"},xa={class:"design-preview"},_a=n(c({__name:"PlaygroundView",setup(n){const c=e(),v=a(),_=r(),L=u(null),F=u(""),P=u({}),I=u(!1),S=u(!1),T=u(!1),{isExecuting:D,lastResponse:V,lastError:W,executePrompt:N}=function(){const e=u(!1),a=u(null),t=u(null),n=p([]);return{isExecuting:e,lastResponse:a,lastError:t,executionHistory:n,executePrompt:async function(r){if(e.value)throw new Error("Execution already in progress");e.value=!0,a.value=null,t.value=null;const i={timestamp:new Date,model:`${r.model.provider}:${r.model.modelId}`,prompt:r.prompt,parameters:{...r.parameters}};let d;try{const e={id:`${r.model.provider}:${r.model.modelId}`,name:r.model.displayName,provider:r.model.provider,model:r.model.modelId,params:r.parameters,created_at:new Date},t=s.getResponseModes(r.model.provider),n=t.text||Object.values(t)[0],u=r.getApiKey(r.model.provider),p=r.getBaseUrl(r.model.provider);d=l.buildAPIRequest(e,r.prompt,u,p,n);const c=Date.now(),m=await fetch(d.url,{method:d.method,headers:d.headers,body:JSON.stringify(d.body)}),v=Date.now()-c,g=await m.text();let h;try{h=JSON.parse(g)}catch{h=g}if(!m.ok){const e=l.extractErrorMessage(h),a={request:{url:d.url,method:d.method,headers:z(d.headers),body:d.body},response:{status:m.status,statusText:m.statusText,headers:Object.fromEntries(m.headers.entries()),body:h}},t=new Error(`API error (${m.status}): ${e}`);throw t.fullResponse=a,t}if(l.isErrorResponse(h)){const e=l.extractErrorMessage(h),a={request:{url:d.url,method:d.method,headers:z(d.headers),body:d.body},response:{status:m.status,statusText:m.statusText,headers:Object.fromEntries(m.headers.entries()),body:h}},t=new Error(`Provider error: ${e}`);throw t.fullResponse=a,t}const f=l.extractResponseContent(r.model.provider,h),y=l.extractUsageInfo(r.model.provider,h);let b;const k=s.getLogprobsResponsePath(r.model.provider);if(k){const e=function(e,a){if(!e||!a)return;const t=a.replace(/\[(\d+)\]/g,".$1").split(".");let s=e;for(const l of t){if(null==s)return;s=s[l]}return s}(h,k);Array.isArray(e)&&(b=e.map(e=>({token:e.token,logprob:e.logprob,bytes:e.bytes,top_logprobs:e.top_logprobs})))}let x;if(r.model.capabilities&&y.prompt_tokens&&y.completion_tokens){const e=(r.model.capabilities.inputCostPerToken||0)*y.prompt_tokens,a=(r.model.capabilities.outputCostPerToken||0)*y.completion_tokens;x={input:e,output:a,total:e+a}}const _={content:f||"",latency:v,tokens:y,cost:x,logprobs:b,raw:h,debug:{request:{url:d.url,method:d.method,headers:z(d.headers),body:d.body},response:{status:m.status,statusText:m.statusText,headers:Object.fromEntries(m.headers.entries())}},model:r.model};a.value=_,i.response=_,o.info("Playground execution successful",{model:r.model.modelId,latency:v,tokens:y.total_tokens})}catch(u){const e={message:u instanceof Error?u.message:String(u),details:u instanceof Error?u.stack:void 0,response:u.fullResponse||{request:{url:d?.url||"unknown",method:d?.method||"unknown",headers:z(d?.headers||{}),body:d?.body||"unknown"},response:{status:"unknown",statusText:"Network or parsing error",headers:{},body:u instanceof Error?u.message:String(u)}}};t.value=e,i.error=e,o.error("Playground execution failed",{model:r.model.modelId,error:e.message,fullResponse:u.fullResponse})}finally{e.value=!1,n.unshift(i),n.length>10&&n.pop()}},clearResults:function(){a.value=null,t.value=null},clearHistory:function(){n.splice(0,n.length)}}}(),U=[{name:"Creative",prompt:"Write a creative short story about:"},{name:"Analysis",prompt:"Analyze the following text and provide insights:"},{name:"Explain",prompt:"Explain this concept in simple terms:"},{name:"Summarize",prompt:"Summarize the following content:"}],q=m(()=>L.value&&F.value.trim().length>0&&!D.value),B=m(()=>F.value?Math.ceil(F.value.length/4):0),G=m(()=>L.value?t.getOutputTokenLimit(L.value.provider,L.value.modelId,P.value):256);function H(e){P.value={...e}}function J(){I.value=!0}function K(){F.value=""}function X(e){L.value=e,S.value=!1,P.value={}}function Q(e){return e<.01?e.toFixed(4):e<1?e.toFixed(3):e.toFixed(2)}function Z(e){if(!L.value||!_.environmentalCostsEnabled)return"??";if(!i.hasDataForModel(L.value.provider,L.value.modelId))return"-";const a=i.calculateEnvironmentalCostUnsafe(L.value.provider,L.value.modelId,1e3)[e];if(0===a)return"-";switch(e){case"carbon":return a<.001?"<1μg":a<1?`${(1e3*a).toFixed(0)}μg`:a<1e3?`${a.toFixed(1)}mg`:`${(a/1e3).toFixed(1)}g`;case"water":return a<.001?"<1nL":a<1?`${(1e3*a).toFixed(0)}nL`:a<1e3?`${a.toFixed(1)}μL`:`${(a/1e3).toFixed(1)}mL`;case"energy":return a<.001?"<1μWh":a<1?`${(1e3*a).toFixed(0)}μWh`:a<1e3?`${a.toFixed(1)}mWh`:`${(a/1e3).toFixed(1)}Wh`;default:return"-"}}async function ee(){q.value&&L.value&&(T.value=!0,await N({model:L.value,prompt:F.value,parameters:P.value,getApiKey:e=>_.getApiKey(e),getBaseUrl:e=>_.getBaseUrl(e)}))}return M(async()=>{c.enabledModels.length>0&&(L.value=c.enabledModels[0])}),(e,a)=>{const t=y("a-tooltip"),s=y("a-button"),l=y("a-modal");return k(),g("div",Ie,[h("div",je,[a[8]||(a[8]=h("div",{class:"header-content"},[h("h1",null,"LLM Playground"),h("p",{class:"description"},"Test prompts and explore model responses interactively")],-1)),h("div",Oe,[L.value&&F.value?(k(),g("div",Re,[f(t,{placement:"bottom"},{title:b(()=>[h("div",Ae,[a[5]||(a[5]=h("div",null,"Cost estimate based on:",-1)),h("div",null,"• Input: "+$(B.value)+" tokens",1),h("div",null,"• Output: 10 - "+$(G.value)+" tokens",1),a[6]||(a[6]=h("div",null,"• Min assumes 10 token response",-1)),a[7]||(a[7]=h("div",null,"• Max assumes full response limit",-1))])]),default:b(()=>[f(j(d),{class:"info-icon"})]),_:1}),f(R,{model:L.value,mode:"range","input-tokens":B.value,"min-output-tokens":10,"max-output-tokens":G.value,layout:"inline",size:"medium"},null,8,["model","input-tokens","max-output-tokens"])])):x("",!0),f(s,{type:"primary",onClick:ee,disabled:!q.value,loading:j(D)},{default:b(()=>[E($(j(D)?"Running...":"Run"),1)]),_:1},8,["disabled","loading"])])]),h("div",ze,[h("div",Se,[h("div",Te,[a[18]||(a[18]=h("h3",null,"Select Model",-1)),f(s,{type:"primary",size:"large",style:{width:"100%"},onClick:a[0]||(a[0]=e=>S.value=!0)},{default:b(()=>a[9]||(a[9]=[E(" Select Model ")])),_:1,__:[9]}),L.value?(k(),g("div",De,[h("div",Ve,[h("span",We,$(L.value.displayName),1),h("span",Ne,$(L.value.provider),1)]),L.value.capabilities?(k(),g("div",Ue,[h("div",qe,[a[10]||(a[10]=h("span",{class:"label"},"Context:",-1)),h("span",Be,$((o=L.value.capabilities.contextWindow,o?o>=1e6?(o/1e6).toFixed(1)+"M":o>=1e3?(o/1e3).toFixed(0)+"k":o.toString():"N/A"))+" tokens",1)]),h("div",Ye,[a[12]||(a[12]=h("span",{class:"label"},"Input:",-1)),h("span",Ge,[h("span",He,"$"+$(Q(1e3*(L.value.capabilities.inputCostPerToken||0))),1),a[11]||(a[11]=E("/1k"))])]),h("div",Je,[a[14]||(a[14]=h("span",{class:"label"},"Output:",-1)),h("span",Ke,[h("span",Xe,"$"+$(Q(1e3*(L.value.capabilities.outputCostPerToken||0))),1),a[13]||(a[13]=E("/1k"))])]),h("div",Qe,[a[15]||(a[15]=h("span",{class:"label"},"CO₂: 🏭",-1)),h("span",Ze,$(Z("carbon")),1)]),h("div",ea,[a[16]||(a[16]=h("span",{class:"label"},"Water: 💧",-1)),h("span",aa,$(Z("water")),1)]),h("div",ta,[a[17]||(a[17]=h("span",{class:"label"},"Energy: ⚡",-1)),h("span",sa,$(Z("energy")),1)])])):x("",!0)])):x("",!0)]),h("div",la,[a[21]||(a[21]=h("h3",null,"Actions",-1)),h("div",oa,[f(s,{type:"default",onClick:J,disabled:!j(v).designs.length,block:""},{default:b(()=>a[19]||(a[19]=[E(" Load from Design ")])),_:1,__:[19]},8,["disabled"]),f(s,{type:"default",onClick:K,disabled:!F.value,block:""},{default:b(()=>a[20]||(a[20]=[E(" Clear Prompt ")])),_:1,__:[20]},8,["disabled"])])]),L.value?(k(),g("div",na,[a[22]||(a[22]=h("h3",null,"Quick Templates",-1)),h("div",ra,[(k(),g(w,null,C(U,e=>f(s,{key:e.name,size:"small",onClick:a=>function(e){F.value=e}(e.prompt)},{default:b(()=>[E($(e.name),1)]),_:2},1032,["onClick"])),64))])])):x("",!0)]),h("div",ia,[h("div",da,[h("div",ua,[a[23]||(a[23]=h("h3",null,"Prompt",-1)),h("span",pa,$(F.value.length)+" characters",1)]),f(O,{modelValue:F.value,"onUpdate:modelValue":a[1]||(a[1]=e=>F.value=e),rows:12,placeholder:"Enter your prompt here...","data-testid":"playground-prompt-editor"},null,8,["modelValue"])]),T.value?(k(),g("div",ca,[h("div",ma,[a[24]||(a[24]=h("h3",null,"Response",-1)),j(V)?(k(),g("div",va,[h("span",null,$(j(V).latency)+"ms",1),h("span",null,$(j(V).tokens?.total_tokens||"?")+" tokens",1)])):x("",!0)]),h("div",ga,[f(Pe,{response:j(V),"is-loading":j(D),error:j(W)},null,8,["response","is-loading","error"])])])):x("",!0)]),L.value?(k(),g("div",ha,[f(Y,{model:L.value,modelValue:P.value,"onUpdate:modelValue":a[2]||(a[2]=e=>P.value=e),onChange:H},null,8,["model","modelValue"])])):x("",!0)]),f(l,{open:I.value,"onUpdate:open":a[3]||(a[3]=e=>I.value=e),title:"Load from Design",width:"800px",footer:null},{default:b(()=>[h("div",fa,[(k(!0),g(w,null,C(j(v).designs,e=>(k(),g("div",{key:e.id,class:"design-item",onClick:a=>function(e){F.value=e.promptTemplate,I.value=!1}(e)},[h("div",ba,$(e.name),1),h("div",ka,$(e.description||"No description"),1),h("div",xa,$(e.promptTemplate.substring(0,100))+"...",1)],8,ya))),128))])]),_:1},8,["open"]),f(A,{open:S.value,mode:"playground",title:"Select Model",onClose:a[4]||(a[4]=e=>S.value=!1),onSelectModel:X},null,8,["open"])]);var o}}}),[["__scopeId","data-v-c4ae1fee"]]);export{_a as default};
