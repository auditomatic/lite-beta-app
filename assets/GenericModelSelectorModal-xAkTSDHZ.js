import{d as e,f as a,r as l,c as t,V as o,Z as i,W as s,Y as n,_ as d,a0 as r,a6 as u,a1 as c,k as p,a8 as v,F as m,aa as f,B as g,G as y}from"./vendor-AtAbR8ZE.js";import{u as h}from"./models-db-BAY7sXQ4.js";import{p as k,_ as b}from"./index-C2llNnSp.js";import{a as _}from"./cost-formatting-Bv_drrqY.js";import{i as C}from"./feature-flags-DaxAZY-J.js";import{E as x}from"./EnvironmentalCostSummary-DIjbhO7C.js";const U={class:"modal-header"},w={class:"modal-content"},P={class:"models-panel"},S={class:"panel-header"},z={class:"models-list"},T={class:"provider-header"},j={class:"provider-name"},$={class:"provider-model-count"},I={class:"provider-models"},A=["onClick"],N={class:"model-info"},B={class:"model-name"},E={class:"model-cost"},M={class:"cost-primary"},O={key:0,class:"config-panel"},F={class:"config-header"},G={class:"total-cost"},K={class:"cost-value"},L={key:0,class:"cost-info"},q={key:0,class:"config-content"},D={class:"param-description"},V={class:"param-description"},W={class:"config-footer"},Y=b(e({__name:"GenericModelSelectorModal",props:{open:{type:Boolean},mode:{},design:{},title:{},existingConfigurations:{}},emits:["close","add-configuration","select-model"],setup(e,{emit:b}){const Y=e,Z=b,H=h(),J=a(""),Q=a([]),R=a(null),X=a(""),ee=l({}),ae=a(C()),le=t(()=>{let e=H.enabledModels;if(J.value){const a=J.value.toLowerCase();e=e.filter(e=>e.displayName.toLowerCase().includes(a)||e.modelId.toLowerCase().includes(a))}const a={};for(const l of e)a[l.provider]||(a[l.provider]=[]),a[l.provider].push(l);for(const l in a)a[l].sort((e,a)=>e.displayName.localeCompare(a.displayName));return a}),te=t(()=>{if("trial"!==Y.mode||!Y.design)return 1;let e=1;for(const a of Object.values(Y.design.variableBindings))"direct"===a.type&&(e*=a.values?.length||1);return e}),oe=t(()=>"trial"===Y.mode?"Total cost":"Cost per 1K tokens"),ie=t(()=>R.value?k.getBasicParameters(R.value.provider,R.value.modelId):{}),se=t(()=>R.value?k.getAdvancedParameters(R.value.provider,R.value.modelId):{});function ne(e){if(!e.capabilities)return"—";if("trial"===Y.mode&&Y.design){const a=Y.design.tokenEstimate?.avgTokens||150,l=256,t=((e.capabilities.inputCostPerToken||0)*a+(e.capabilities.outputCostPerToken||0)*l)*te.value;return _(t)}{const a=1e3*(e.capabilities.inputCostPerToken||0),l=1e3*(e.capabilities.outputCostPerToken||0);return 0===a&&0===l?"—":`$${a.toFixed(4)}/$${l.toFixed(4)}`}}function de(){if(!R.value||!R.value.capabilities)return"—";if("trial"===Y.mode&&Y.design){const e=Y.design.tokenEstimate?.avgTokens||150,a=ee.max_tokens||ee.max_completion_tokens||256,l=(R.value.capabilities.inputCostPerToken||0)*e,t=(R.value.capabilities.outputCostPerToken||0)*a;return _((l+t)*te.value)}{const e=1e3*(R.value.capabilities.inputCostPerToken||0),a=1e3*(R.value.capabilities.outputCostPerToken||0);return 0===e&&0===a?"—":`$${e.toFixed(4)}/$${a.toFixed(4)}`}}function re(e){return e.replace(/\./g," › ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function ue(){if(!R.value||!X.value)return;const e={},a=(e,a,l)=>{const t=a.split(".");let o=e;for(let i=0;i<t.length-1;i++)o[t[i]]||(o[t[i]]={}),o=o[t[i]];o[t[t.length-1]]=l};for(const[l,t]of Object.entries(ee))(null!=t&&""!==t||!1===t)&&a(e,l,t);Z("add-configuration",{name:X.value,provider:R.value.provider,modelId:R.value.modelId,parameters:e})}function ce(){R.value&&(Z("select-model",R.value),Z("close"))}return(e,a)=>{const l=s("a-input-search"),t=s("a-button"),h=s("a-collapse-panel"),b=s("a-collapse"),_=s("a-input"),C=s("a-form-item"),Z=s("a-input-number"),H=s("a-switch"),pe=s("a-select-option"),ve=s("a-select"),me=s("a-col"),fe=s("a-row"),ge=s("a-form"),ye=s("a-modal");return n(),o(ye,{open:e.open,onCancel:a[3]||(a[3]=a=>e.$emit("close")),width:"90%",style:{"max-width":"1400px"},footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"}},{default:i(()=>[d("div",U,[d("h2",null,r(e.title||"Select Model"),1)]),d("div",w,[d("div",P,[d("div",S,[a[4]||(a[4]=d("h3",null,"Available Models",-1)),p(l,{value:J.value,"onUpdate:value":a[0]||(a[0]=e=>J.value=e),placeholder:"Search models...",size:"large","allow-clear":""},null,8,["value"])]),d("div",z,[p(b,{activeKey:Q.value,"onUpdate:activeKey":a[1]||(a[1]=e=>Q.value=e),bordered:!1},{default:i(()=>[(n(!0),u(m,null,v(le.value,(a,l)=>(n(),o(h,{key:l,class:"provider-panel"},{header:i(()=>[d("div",T,[d("span",j,r(l),1),d("span",$,r(a.length)+" models",1)])]),extra:i(()=>[p(t,{size:"small",type:"text",onClick:g(e=>function(e){const a=Q.value.indexOf(e);a>-1?Q.value.splice(a,1):Q.value.push(e)}(l),["stop"])},{default:i(()=>[y(r(Q.value.includes(l)?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:i(()=>[d("div",I,[(n(!0),u(m,null,v(a,a=>(n(),u("div",{key:a.id,class:f(["model-row",{selected:R.value?.id===a.id}]),onClick:e=>function(e){if(R.value=e,"trial"===Y.mode){X.value=e.displayName,Object.keys(ee).forEach(e=>delete ee[e]);const a={...k.getBasicParameters(e.provider,e.modelId),...k.getAdvancedParameters(e.provider,e.modelId)};for(const[e,l]of Object.entries(a))void 0!==l.default&&(ee[e]=l.default)}}(a)},[d("div",N,[d("div",B,r(a.displayName),1)]),d("div",E,[d("span",M,r(ne(a)),1),ae.value?(n(),o(x,{key:0,model:a,design:e.design,"total-calls":"trial"===e.mode?te.value:1,layout:"compact",class:"environmental-costs-inline"},null,8,["model","design","total-calls"])):c("",!0)])],10,A))),128))])]),_:2},1024))),128))]),_:1},8,["activeKey"])])]),R.value?(n(),u("div",O,[d("div",F,[d("h3",null,r("trial"===e.mode?"Configure":"Selected")+": "+r(R.value.displayName),1),d("div",G,[d("span",null,[y(r(oe.value)+": ",1),d("strong",K,r(de()),1)]),"trial"===e.mode&&te.value>1?(n(),u("span",L,"("+r(te.value)+" calls)",1)):c("",!0),ae.value&&R.value?(n(),o(x,{key:1,model:R.value,design:e.design,"total-calls":"trial"===e.mode?te.value:void 0,layout:"compact",class:"environmental-costs-inline"},null,8,["model","design","total-calls"])):c("",!0)])]),"trial"===e.mode?(n(),u("div",q,[p(ge,{layout:"vertical"},{default:i(()=>[p(C,{label:"Configuration Name",required:""},{default:i(()=>[p(_,{value:X.value,"onUpdate:value":a[2]||(a[2]=e=>X.value=e),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1}),p(b,{"default-active-key":["basic"],ghost:""},{default:i(()=>[p(h,{key:"basic",header:"Basic Parameters"},{default:i(()=>[p(fe,{gutter:16},{default:i(()=>[(n(!0),u(m,null,v(ie.value,(e,a)=>(n(),o(me,{key:a,span:12},{default:i(()=>[p(C,{label:re(a)},{default:i(()=>["number"===e.type?(n(),o(Z,{key:0,value:ee[a],"onUpdate:value":e=>ee[a]=e,min:e.min,max:e.max,step:.1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"integer"===e.type?(n(),o(Z,{key:1,value:ee[a],"onUpdate:value":e=>ee[a]=e,min:e.min,max:e.max,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"boolean"===e.type?(n(),o(H,{key:2,checked:ee[a],"onUpdate:checked":e=>ee[a]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(n(),o(ve,{key:3,value:ee[a],"onUpdate:value":e=>ee[a]=e,placeholder:String(e.default),size:"large",style:{width:"100%"},allowClear:""},{default:i(()=>[(n(!0),u(m,null,v(e.enum,e=>(n(),o(pe,{key:e,value:e},{default:i(()=>[y(r(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(n(),o(_,{key:4,value:ee[a],"onUpdate:value":e=>ee[a]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),d("div",D,r(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1}),Object.keys(se.value).length>0?(n(),o(h,{key:"advanced",header:"Advanced Parameters"},{default:i(()=>[p(fe,{gutter:16},{default:i(()=>[(n(!0),u(m,null,v(se.value,(e,a)=>(n(),o(me,{key:a,span:12},{default:i(()=>[p(C,{label:re(a)},{default:i(()=>["number"===e.type||"integer"===e.type?(n(),o(Z,{key:0,value:ee[a],"onUpdate:value":e=>ee[a]=e,min:e.min,max:e.max,step:"number"===e.type?.1:1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","step","placeholder"])):"boolean"===e.type?(n(),o(H,{key:1,checked:ee[a],"onUpdate:checked":e=>ee[a]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(n(),o(ve,{key:2,value:ee[a],"onUpdate:value":e=>ee[a]=e,placeholder:String(e.default),size:"large",style:{width:"100%"},allowClear:""},{default:i(()=>[(n(!0),u(m,null,v(e.enum,e=>(n(),o(pe,{key:e,value:e},{default:i(()=>[y(r(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(n(),o(_,{key:3,value:ee[a],"onUpdate:value":e=>ee[a]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),d("div",V,r(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1})):c("",!0)]),_:1})]),_:1})])):c("",!0),d("div",W,["trial"===e.mode?(n(),o(t,{key:0,type:"primary",size:"large",onClick:ue,disabled:!X.value||!R.value},{default:i(()=>a[5]||(a[5]=[y(" Add Configuration ")])),_:1,__:[5]},8,["disabled"])):(n(),o(t,{key:1,type:"primary",size:"large",onClick:ce,disabled:!R.value},{default:i(()=>a[6]||(a[6]=[y(" Select Model ")])),_:1,__:[6]},8,["disabled"]))])])):c("",!0)])]),_:1},8,["open"])}}}),[["__scopeId","data-v-8ebbfea8"]]);export{Y as G};
