const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./APICallDetailModal-7OujkVGA.js","./designs-db-BelWLWDl.js","./vendor-l9j4AUWK.js","./db-CL8uhZCz.js","./index-C0R72Zhc.js","./index-D0ItB65j.css","./defaultData-DyqJdH2z.js","./variables-db-pnMIqRxo.js","./logger.service-_k__GSpu.js","./registry-D04k-NiV.js","./models-db-CpJeoPhD.js","./trials-db-DxXC8GH4.js","./settings-db-DC9a7YAn.js","./ModelSelectionTable-NlYqwCsS.js","./cost-formatting-D-OPWEvg.js","./ModelSelectionTable-ClulxoLE.css","./APICallDetailModal-DUMhcDWr.css"])))=>i.map(i=>d[i]);
import{I as e,b as a,a as t,_ as l,T as s,R as n,D as i,d as r,L as o,A as u}from"./index-C0R72Zhc.js";import{u as c}from"./trials-db-DxXC8GH4.js";import{k as d,d as p,f as v,c as f,Z as m,B as g,Y as y,F as h,a6 as b,G as _,a5 as k,U as C,X as w,W as x,q as S,ac as R,ag as j,S as T,_ as E,u as I,l as $,a9 as O,o as M}from"./vendor-l9j4AUWK.js";import{u as q}from"./useResponsiveTable-BMBbK64y.js";import{A as D,a as P,_ as A,T as L}from"./APICallDetailModal-7OujkVGA.js";import"./db-CL8uhZCz.js";import"./defaultData-DyqJdH2z.js";import"./registry-D04k-NiV.js";import"./designs-db-BelWLWDl.js";import"./variables-db-pnMIqRxo.js";import"./logger.service-_k__GSpu.js";import"./settings-db-DC9a7YAn.js";import"./models-db-CpJeoPhD.js";import"./ModelSelectionTable-NlYqwCsS.js";import"./cost-formatting-D-OPWEvg.js";var z={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"};function N(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?Object(arguments[a]):{},l=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),l.forEach(function(a){U(e,a,t[a])})}return e}function U(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var F=function(a,t){var l=N({},a,t.attrs);return d(e,N({},l,{icon:z}),null)};F.displayName="ExportOutlined",F.inheritAttrs=!1;const B={class:"modal-content"},V={class:"modal-header"},H={class:"modal-body"},J={class:"section"},W={class:"format-options"},K=["value"],Y={class:"format-label"},G={class:"format-name"},X={class:"section"},Z={class:"field-groups"},Q={class:"field-list"},ee=["value"],ae={class:"field-label"},te={class:"field-name"},le={class:"field-desc"},se={class:"section"},ne={class:"preview-info"},ie={class:"preview-count"},re={class:"preview-fields"},oe={class:"preview-size"},ue={class:"modal-footer"},ce=l(p({__name:"ExportDataModal",props:{trial:{},apiCalls:{}},emits:["close"],setup(e){const l=e,s=[{id:"csv",name:"CSV",description:"Comma-separated values (Excel compatible)"},{id:"tsv",name:"TSV",description:"Tab-separated values"},{id:"excel",name:"Excel",description:"Microsoft Excel (.xlsx)"},{id:"json",name:"JSON",description:"JavaScript Object Notation"},{id:"jsonl",name:"JSONL",description:"JSON Lines (one object per line)"}],n=[{name:"Basic Info",fields:[{id:"id",name:"ID",description:"API call identifier",default:!0},{id:"trial_id",name:"Trial ID",description:"Parent trial identifier",default:!0},{id:"trial_name",name:"Trial Name",description:"Human-readable trial name",default:!0},{id:"status",name:"Status",description:"Call status (completed, failed, etc.)",default:!0},{id:"created",name:"Created",description:"When the call was initiated",default:!0},{id:"completed",name:"Completed",description:"When the call finished",default:!0}]},{name:"Configuration",fields:[{id:"configuration_index",name:"Config Index",description:"Configuration array index",default:!1},{id:"configuration_name",name:"Config Name",description:"Human-readable config name",default:!1},{id:"provider",name:"Provider",description:"LLM service provider",default:!0},{id:"model",name:"Model",description:"Model identifier",default:!0}]},{name:"Content",fields:[{id:"prompt",name:"Prompt",description:"Input prompt text",default:!0},{id:"variables",name:"Variables",description:"Variable substitutions (flattened as separate columns)",default:!0},{id:"result_content",name:"Result Content",description:"LLM response content",default:!0},{id:"result_error",name:"Result Error",description:"Error message if failed",default:!0}]},{name:"Performance",fields:[{id:"response_latency_ms",name:"Latency (ms)",description:"Response time",default:!0},{id:"duration_ms",name:"Duration (ms)",description:"Total processing time",default:!1},{id:"result_success",name:"Success",description:"Whether call succeeded",default:!0}]},{name:"Technical Details",fields:[{id:"request_url",name:"Request URL",description:"API endpoint URL",default:!0},{id:"request_method",name:"Request Method",description:"HTTP method",default:!1},{id:"request_headers",name:"Request Headers",description:"HTTP request headers",default:!1},{id:"request_body",name:"Request Body",description:"Full request payload",default:!1},{id:"response_status",name:"Response Status",description:"HTTP status code",default:!0},{id:"response_headers",name:"Response Headers",description:"HTTP response headers",default:!1},{id:"response_body",name:"Response Body",description:"Full response payload",default:!1}]},{name:"Error Handling",fields:[{id:"network_error_count",name:"Network Errors",description:"Number of network failures",default:!1},{id:"retry_count",name:"Retry Count",description:"Number of retry attempts",default:!1}]}],i=v("csv"),r=v([]),o=n.flatMap(e=>e.fields);r.value=o.filter(e=>e.default).map(e=>e.id);const u=f(()=>{const e=50*r.value.length,a=l.apiCalls.length*e;return a<1024?`${a}B`:a<1048576?`${(a/1024).toFixed(1)}KB`:`${(a/1048576).toFixed(1)}MB`});function c(){r.value=o.map(e=>e.id)}function p(){r.value=o.filter(e=>e.default).map(e=>e.id)}function T(){r.value=[]}function E(){const e=new Set;return r.value.includes("variables")&&l.apiCalls.forEach(a=>{a.variables&&"object"==typeof a.variables&&Object.keys(a.variables).forEach(a=>e.add(a))}),l.apiCalls.map(a=>{const t={};var s,n;if(r.value.includes("id")&&(t.ID=a.id),r.value.includes("trial_id")&&(t["Trial ID"]=a.trialId),r.value.includes("trial_name")&&(t["Trial Name"]=l.trial.name),r.value.includes("status")&&(t.Status=a.status),r.value.includes("created")&&(t.Created=a.created.toISOString()),r.value.includes("completed")&&(t.Completed=a.completed?.toISOString()||""),r.value.includes("configuration_index")&&(t["Configuration Index"]=a.configurationIndex),r.value.includes("configuration_name")&&(t["Configuration Name"]=(s=a.configurationIndex,l.trial.configurationSnapshots[s]&&l.trial.configurationSnapshots[s].name||`Config ${s+1}`)),r.value.includes("provider")&&(t.Provider=(n=a,n.request?.url?.includes("openai.com")?"OpenAI":n.request?.url?.includes("anthropic.com")?"Anthropic":n.request?.url?.includes("openrouter.ai")?"OpenRouter":n.request?.url?.includes("localhost:11434")?"Ollama":"Unknown")),r.value.includes("model")&&(t.Model=function(e){return e.request?.body?.model?e.request.body.model:"Unknown"}(a)),r.value.includes("prompt")&&(t.Prompt=a.prompt),r.value.includes("variables"))for(const l of e)t[`variable_${l}`]=a.variables?.[l]||"";return r.value.includes("result_content")&&(t["Result Content"]=a.result?.content||""),r.value.includes("result_error")&&(t["Result Error"]=a.result?.error||""),r.value.includes("response_latency_ms")&&(t["Response Latency (ms)"]=a.response?.latencyMs||""),r.value.includes("duration_ms")&&(t["Duration (ms)"]=a.completed?a.completed.getTime()-a.created.getTime():""),r.value.includes("result_success")&&(t["Result Success"]=a.result?.success||!1),r.value.includes("request_url")&&(t["Request URL"]=a.request?.url||""),r.value.includes("request_method")&&(t["Request Method"]=a.request?.method||""),r.value.includes("request_headers")&&(t["Request Headers"]=JSON.stringify(a.request?.headers||{})),r.value.includes("request_body")&&(t["Request Body"]=JSON.stringify(a.request?.body||{})),r.value.includes("response_status")&&(t["Response Status"]=a.response?.status||""),r.value.includes("response_headers")&&(t["Response Headers"]=JSON.stringify(a.response?.headers||{})),r.value.includes("response_body")&&(t["Response Body"]=JSON.stringify(a.response?.body||{})),r.value.includes("network_error_count")&&(t["Network Error Count"]=0),r.value.includes("retry_count")&&(t["Retry Count"]=0),t})}async function I(){const e=E(),s=(new Date).toISOString().split("T")[0],n=`${l.trial.name}_${i.value}_${s}`;try{switch(i.value){case"csv":!function(e,a){if(0===e.length)return;const t=Object.keys(e[0]||{}),l=t.filter(e=>!e.startsWith("variable_")),s=t.filter(e=>e.startsWith("variable_")).sort(),n=[...l,...s],i=[n.join(","),...e.map(e=>n.map(a=>`"${String(e[a]||"").replace(/"/g,'""')}"`).join(","))].join("\n");$(i,`${a}.csv`,"text/csv")}(e,n);break;case"tsv":!function(e,a){if(0===e.length)return;const t=Object.keys(e[0]||{}),l=t.filter(e=>!e.startsWith("variable_")),s=t.filter(e=>e.startsWith("variable_")).sort(),n=[...l,...s],i=[n.join("\t"),...e.map(e=>n.map(a=>String(e[a]||"").replace(/\t/g," ")).join("\t"))].join("\n");$(i,`${a}.tsv`,"text/tab-separated-values")}(e,n);break;case"excel":await async function(e,a){const l=await t(()=>import("./xlsx-C4WhbwXR.js"),[],import.meta.url),s=l.utils.book_new(),n=l.utils.json_to_sheet(e),i=Object.keys(e[0]||{}),r=i.map(e=>({wch:Math.min(Math.max(e.length,10),50)}));n["!cols"]=r,l.utils.book_append_sheet(s,n,"Trial Results"),l.writeFile(s,`${a}.xlsx`)}(e,n);break;case"json":!function(e,a){const t=JSON.stringify(e,null,2);$(t,`${a}.json`,"application/json")}(e,n);break;case"jsonl":!function(e,a){const t=e.map(e=>JSON.stringify(e)).join("\n");$(t,`${a}.jsonl`,"application/jsonl")}(e,n)}}catch(r){console.error("Export failed:",r),a.error("Export failed: "+(r instanceof Error?r.message:"Unknown error"))}}function $(e,a,t){let l=e;"text/csv"!==t&&"text/tab-separated-values"!==t||(l="\ufeff"+e);const s=new Blob([l],{type:`${t};charset=utf-8`}),n=URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)}return(e,a)=>{const t=C("a-button");return x(),m("div",{class:"modal-overlay",onClick:a[4]||(a[4]=g(a=>e.$emit("close"),["self"]))},[y("div",B,[y("div",V,[a[5]||(a[5]=y("h3",null,"Export Trial Data",-1)),y("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"close-btn"},"×")]),y("div",H,[y("div",J,[a[6]||(a[6]=y("h4",null,"Export Format",-1)),y("div",W,[(x(),m(h,null,b(s,e=>y("label",{key:e.id,class:"format-option"},[S(y("input",{type:"radio",value:e.id,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),class:"format-radio"},null,8,K),[[R,i.value]]),y("span",Y,[y("span",G,k(e.name),1)])])),64))])]),y("div",X,[y("h4",null,[a[7]||(a[7]=_(" Fields to Export ")),y("div",{class:"field-controls"},[y("button",{onClick:c,class:"control-btn"},"Select All"),y("button",{onClick:p,class:"control-btn"},"Defaults"),y("button",{onClick:T,class:"control-btn"},"Select None")])]),y("div",Z,[(x(),m(h,null,b(n,e=>y("div",{key:e.name,class:"field-group"},[y("h5",null,k(e.name),1),y("div",Q,[(x(!0),m(h,null,b(e.fields,e=>(x(),m("label",{key:e.id,class:"field-option"},[S(y("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value=e),class:"field-checkbox"},null,8,ee),[[j,r.value]]),y("span",ae,[y("span",te,k(e.name),1),y("span",le,k(e.description),1)])]))),128))])])),64))])]),y("div",se,[a[8]||(a[8]=y("h4",null,"Export Preview",-1)),y("div",ne,[y("span",ie,k(e.apiCalls.length)+" records",1),y("span",re,k(r.value.length)+" fields",1),y("span",oe,"~"+k(u.value),1)])])]),y("div",ue,[d(t,{onClick:a[3]||(a[3]=a=>e.$emit("close")),size:"large",class:"footer-button"},{default:w(()=>a[9]||(a[9]=[_(" Cancel ")])),_:1,__:[9]}),d(t,{type:"primary",onClick:I,disabled:0===r.value.length,size:"large",class:"footer-button footer-button-primary"},{default:w(()=>[_(" Export "+k(i.value.toUpperCase()),1)]),_:1},8,["disabled"])])])])}}}),[["__scopeId","data-v-891b72bd"]]),de={class:"results-table-container full-width"},pe={class:"results-header"},ve={class:"header-actions"},fe={class:"scientific-table-container"},me={class:"scientific-table-wrapper"},ge={key:0,class:"trial-info-cell"},ye={class:"trial-header"},he={class:"trial-name"},be={class:"trial-design"},_e={class:"text-secondary"},ke={class:"trial-created"},Ce={class:"text-secondary"},we={key:1,class:"progress-summary"},xe={class:"progress-stats"},Se={class:"stat successful"},Re={class:"stat failed"},je={class:"stat total"},Te={class:"progress-text"},Ee={key:0,class:"error-indicator"},Ie={key:2,class:"success-rate-cell"},$e={class:"rate-value"},Oe={key:3,class:"performance-cell"},Me={class:"metric"},qe={class:"metric-value"},De={class:"metric"},Pe={class:"metric-value"},Ae={key:4,class:"configurations-cell"},Le={class:"config-details"},ze={class:"text-secondary"},Ne={key:5,class:"cost-summary"},Ue={key:1,class:"text-secondary"},Fe={key:0,class:"cost-per-call"},Be={key:6,class:"table-actions-grid table-actions-grid-3"},Ve=l(p({__name:"ResultsTable",props:{trials:{},loading:{type:Boolean,default:!1}},emits:["view-results","export-trial","duplicate-trial","delete-trial","trial-details","refresh-trials","export-all","status-filter-changed"],setup(e,{emit:a}){const t=e,l=a,o=v("all"),u=v(!1),c=v(null),p=v([]),S=[{key:"all",label:"All"},{key:"completed",label:"Completed"},{key:"failed",label:"Failed"},{key:"running",label:"Running"},{key:"cancelled",label:"Cancelled"}],{getVisibleColumns:R,createResultColumns:j}=q(),M=R(j()),D=f(()=>"all"===o.value?t.trials:t.trials.filter(e=>e.status===o.value)),P=f(()=>t.trials.filter(e=>"completed"===e.status));function A(e){o.value=e,l("status-filter-changed",e)}function L(e){l("view-results",e)}function z(e){return"all"===e?t.trials.length:t.trials.filter(a=>a.status===e).length}function N(e){return 0===e.progress.total?0:Math.round(e.progress.completed/e.progress.total*100)}function U(e){if(0===e.progress.completed)return 0;const a=e.progress.completed-e.progress.networkErrors;return Math.round(a/e.progress.completed*100)}function F(e){const a=U(e);return a>=95?"#52c41a":a>=80?"#faad14":"#ff4d4f"}function B(e){return e.progress.completed>0?"1,234":"-"}function V(e){return e.progress.completed>0?"2.5":"-"}function H(e){if(0===e.progress.total||0===e.estimatedCost)return"-";return(Math.abs(e.estimatedCost)/e.progress.total).toFixed(4)}function J(e){const a=[];return"completed"===e.status&&a.push("status-completed"),"failed"===e.status&&a.push("status-failed"),"running"===e.status&&a.push("status-running"),a.join(" ")}function W(e){const a=(new Date).getTime()-e.getTime(),t=Math.floor(a/864e5);return 0===t?"Today":1===t?"Yesterday":t<7?`${t} days ago`:t<30?`${Math.floor(t/7)} weeks ago`:e.toLocaleDateString()}function K(){l("refresh-trials")}async function Y(){const e=P.value;if(0!==e.length)try{const a=[];for(const t of e){const e=await r.apiCalls.where("trialId").equals(t.id).toArray();a.push(...e)}c.value={id:"all-trials",name:`All Completed Trials (${e.length} trials)`,status:"completed",created:new Date,updated:new Date,designSnapshot:{originalName:"Multiple Designs"},configurationSnapshots:[],variableSnapshots:{},progress:{completed:a.filter(e=>"completed"===e.status).length,total:a.length,networkErrors:a.filter(e=>"failed"===e.status).length},totalCombinations:a.length,estimatedCost:e.reduce((e,a)=>e+a.estimatedCost,0)},p.value=a,u.value=!0}catch(a){console.error("Failed to load API calls:",a)}}function G(e){return $("div",{class:"expanded-trial-details"},[$("h4",{style:{margin:"0 0 12px 0",fontSize:"13px"}},"Configuration Breakdown"),$(s,{columns:[{title:"Model",dataIndex:"model",key:"model",width:200},{title:"Parameters",dataIndex:"parameters",key:"parameters",width:300},{title:"Calls",dataIndex:"calls",key:"calls",width:80,align:"center"},{title:"Success Rate",dataIndex:"successRate",key:"successRate",width:100,align:"center"},{title:"Avg Latency",dataIndex:"latency",key:"latency",width:100,align:"center"},{title:"Cost",dataIndex:"cost",key:"cost",width:80,align:"right"}],dataSource:(a=e,(a.configurationSnapshots||[]).map((e,t)=>({id:t,model:`${e.provider}:${e.modelId}`,parameters:Object.entries(e.parameters).map(([e,a])=>`${e}:${a}`).join(", "),calls:Math.floor(a.progress.total/(a.configurationSnapshots?.length||1)),successRate:`${U(a)}%`,latency:B(a)+"ms",cost:`$${H(a)}`}))),pagination:!1,size:"small",rowKey:"id"})]);var a}return(e,a)=>{const t=C("a-button"),s=C("a-space"),v=C("a-tab-pane"),f=C("a-tabs"),R=C("a-tag"),j=C("a-progress"),$=C("a-table");return x(),m("div",de,[y("div",pe,[a[4]||(a[4]=y("div",{class:"header-content"},[y("h2",null,"Trial Results"),y("p",{class:"description"}," Analyze and export completed experimental results ")],-1)),y("div",ve,[d(s,null,{default:w(()=>[d(t,{onClick:K},{icon:w(()=>[d(I(n))]),default:w(()=>[a[2]||(a[2]=_(" Refresh "))]),_:1,__:[2]}),d(t,{type:"primary",onClick:Y,disabled:0===P.value.length},{icon:w(()=>[d(I(i))]),default:w(()=>[a[3]||(a[3]=_(" Export All Data "))]),_:1,__:[3]},8,["disabled"])]),_:1})])]),d(f,{activeKey:o.value,"onUpdate:activeKey":a[0]||(a[0]=e=>o.value=e),size:"small",class:"status-tabs",onChange:A},{default:w(()=>[(x(),m(h,null,b(S,e=>d(v,{key:e.key,tab:`${e.label} (${z(e.key)})`},null,8,["tab"])),64))]),_:1},8,["activeKey"]),y("div",fe,[y("div",me,[d($,{columns:I(M),"data-source":D.value,pagination:!1,size:"small",scroll:{y:"calc(100vh - 200px)"},"row-key":"id","row-class-name":J,class:"scientific-table",onRowClick:L,"expand-row-by-click":!1,"expanded-row-render":G},{bodyCell:w(({column:e,record:s})=>{return["trial"===e.key?(x(),m("div",ge,[y("div",ye,[y("strong",he,k(s.name),1),d(R,{color:(i=s.status,{completed:"success",failed:"error",running:"processing",cancelled:"default",draft:"default",pending:"processing",paused:"warning"}[i]||"default"),size:"small",class:"trial-status-tag"},{default:w(()=>[_(k(s.status.toUpperCase()),1)]),_:2},1032,["color"])]),y("div",be,[y("small",_e," Design: "+k(s.designSnapshot?.originalName||"Unknown Design"),1)]),y("div",ke,[y("small",Ce," Created "+k(W(s.created)),1)])])):E("",!0),"progress"===e.key?(x(),m("div",we,[y("div",xe,[y("span",Se,k(s.progress.completed)+" ✓",1),y("span",Re,k(s.progress.networkErrors)+" ✗",1),y("span",je,"/ "+k(s.progress.total),1)]),d(j,{percent:N(s),size:"small",status:(n=s,"failed"===n.status?"exception":"completed"===n.status?"success":n.progress.networkErrors>0?"exception":"normal"),"show-info":!1,class:"progress-bar"},null,8,["percent","status"]),y("div",Te,[_(k(N(s))+"% complete ",1),s.progress.networkErrors>0?(x(),m("span",Ee," ("+k(s.progress.networkErrors)+" errors) ",1)):E("",!0)])])):E("",!0),"success_rate"===e.key?(x(),m("div",Ie,[y("div",$e,k(U(s))+"%",1),d(j,{percent:U(s),size:"small","show-info":!1,"stroke-color":F(s),class:"success-rate-bar"},null,8,["percent","stroke-color"])])):E("",!0),"performance"===e.key?(x(),m("div",Oe,[y("div",Me,[a[5]||(a[5]=y("small",{class:"metric-label"},"Avg Latency",-1)),y("strong",qe,k(B(s))+"ms",1)]),y("div",De,[a[6]||(a[6]=y("small",{class:"metric-label"},"Throughput",-1)),y("strong",Pe,k(V(s))+"/min",1)])])):E("",!0),"configurations"===e.key?(x(),m("div",Ae,[d(R,{size:"small",color:"blue"},{default:w(()=>[_(k(s.configurationSnapshots?.length||0)+" configs ",1)]),_:2},1024),y("div",Le,[y("small",ze,k(s.totalCombinations)+" variables ",1)])])):E("",!0),"cost"===e.key?(x(),m("div",Ne,[y("span",{class:O(["cost-value",{negative:s.estimatedCost<0}])},[Math.abs(s.estimatedCost)>0?(x(),m(h,{key:0},[_(" $"+k(Math.abs(s.estimatedCost).toFixed(3)),1)],64)):(x(),m("span",Ue,"-"))],2),s.progress.total>0?(x(),m("small",Fe," $"+k(H(s))+"/call ",1)):E("",!0)])):E("",!0),"actions"===e.key?(x(),m("div",Be,[d(t,{size:"small",onClick:g(e=>function(e){l("view-results",e)}(s),["stop"])},{default:w(()=>a[7]||(a[7]=[_(" View Results ")])),_:2,__:[7]},1032,["onClick"]),d(t,{size:"small",onClick:g(e=>async function(e){c.value=e;try{p.value=await r.apiCalls.where("trialId").equals(e.id).toArray(),u.value=!0}catch(a){console.error("Failed to load API calls:",a)}}(s),["stop"])},{default:w(()=>a[8]||(a[8]=[_(" Data Export ")])),_:2,__:[8]},1032,["onClick"]),d(t,{size:"small",onClick:g(e=>function(e){l("export-trial",e,"python")}(s),["stop"])},{default:w(()=>a[9]||(a[9]=[_(" Python Export ")])),_:2,__:[9]},1032,["onClick"])])):E("",!0)];var n,i}),_:1},8,["columns","data-source"])])]),u.value&&c.value?(x(),T(ce,{key:0,trial:c.value,"api-calls":p.value,onClose:a[1]||(a[1]=e=>u.value=!1)},null,8,["trial","api-calls"])):E("",!0)])}}}),[["__scopeId","data-v-68360871"]]),He={class:"results-table-container"},Je={class:"filters-bar"},We={key:1},Ke={key:2,class:"variables-compact"},Ye={key:0,class:"text-secondary"},Ge={key:1,class:"text-secondary"},Xe={key:2,class:"text-error"},Ze={key:3,class:"response-content"},Qe={key:4,class:"text-secondary"},ea={key:0,class:"length-value"},aa={key:1,class:"text-secondary"},ta={key:0},la={key:1,class:"text-secondary"},sa=l(p({__name:"TrialResultsTable",props:{trial:{},apiCalls:{},loading:{type:Boolean}},setup(e){const a=e,t=v(""),l=v(""),s=v(""),n=v(!1),i=v(null),r=[{title:"Status",key:"status",width:100,fixed:"left"},{title:"Config",key:"config",width:150},{title:"Variables",key:"variables",width:400},{title:"Response",key:"response",ellipsis:!0},{title:"Length",key:"length",width:80,align:"right"},{title:"Latency",key:"latency",width:80,align:"right"}],u=f(()=>{let e=a.apiCalls;if(t.value&&(e=e.filter(e=>e.status===t.value)),""!==l.value&&(e=e.filter(e=>e.configurationIndex===Number(l.value))),s.value){const a=s.value.toLowerCase();e=e.filter(e=>{if(JSON.stringify(e.variables).toLowerCase().includes(a))return!0;if(e.result?.content){if(String(e.result.content).toLowerCase().includes(a))return!0}return!1})}return e});function c(e){const t=a.trial.configurationSnapshots[e];return t?.name||`Config ${e+1}`}return(e,a)=>{const p=C("a-select-option"),v=C("a-select"),f=C("a-input-search"),g=C("a-space"),S=C("a-button"),R=C("a-tag"),j=C("a-tooltip"),$=C("a-table");return x(),m("div",He,[y("div",Je,[d(g,null,{default:w(()=>[d(v,{value:t.value,"onUpdate:value":a[0]||(a[0]=e=>t.value=e),placeholder:"All Statuses",style:{width:"150px"},size:"small","allow-clear":""},{default:w(()=>[d(p,{value:""},{default:w(()=>a[6]||(a[6]=[_("All Statuses")])),_:1,__:[6]}),d(p,{value:"completed"},{default:w(()=>a[7]||(a[7]=[_("Completed")])),_:1,__:[7]}),d(p,{value:"failed"},{default:w(()=>a[8]||(a[8]=[_("Failed")])),_:1,__:[8]}),d(p,{value:"running"},{default:w(()=>a[9]||(a[9]=[_("Running")])),_:1,__:[9]}),d(p,{value:"pending"},{default:w(()=>a[10]||(a[10]=[_("Pending")])),_:1,__:[10]})]),_:1},8,["value"]),d(v,{value:l.value,"onUpdate:value":a[1]||(a[1]=e=>l.value=e),placeholder:"All Configurations",style:{width:"200px"},size:"small","allow-clear":""},{default:w(()=>[d(p,{value:""},{default:w(()=>a[11]||(a[11]=[_("All Configurations")])),_:1,__:[11]}),(x(!0),m(h,null,b(e.trial.configurationSnapshots,(e,a)=>(x(),T(p,{key:a,value:a},{default:w(()=>[_(k(e.name||`Config ${a+1}`),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),d(f,{value:s.value,"onUpdate:value":a[2]||(a[2]=e=>s.value=e),placeholder:"Search variables or response...",style:{width:"300px"},size:"small","allow-clear":""},null,8,["value"])]),_:1}),d(S,{size:"small",onClick:a[3]||(a[3]=e=>n.value=!0)},{icon:w(()=>[d(I(F))]),default:w(()=>[a[12]||(a[12]=_(" Export Data "))]),_:1,__:[12]})]),d($,{columns:r,"data-source":u.value,loading:e.loading,pagination:!1,scroll:{y:"calc(100vh - 350px)",x:1400},size:"small","row-key":"id",class:"results-table","custom-row":e=>({onClick:()=>{return a=e,void(i.value=a);var a},class:"clickable-row"})},{bodyCell:w(({column:e,record:t})=>{return["status"===e.key?(x(),T(R,{key:0,color:(l=t.status,{completed:"success",failed:"error",running:"processing",pending:"default"}[l]||"default"),size:"small"},{default:w(()=>[_(k(t.status.toUpperCase()),1)]),_:2},1032,["color"])):E("",!0),"config"===e.key?(x(),m("code",We,k(c(t.configurationIndex)),1)):E("",!0),"variables"===e.key?(x(),m("div",Ke,[(x(!0),m(h,null,b(t.variables,(e,a)=>(x(),T(j,{key:a},{title:w(()=>[_(k(a)+": "+k(e),1)]),default:w(()=>[d(R,{size:"small"},{default:w(()=>{return[_(k(a)+": "+k((t=String(e),l=15,t.length<=l?t:t.substring(0,l)+"...")),1)];var t,l}),_:2},1024)]),_:2},1024))),128))])):E("",!0),"response"===e.key?(x(),m(h,{key:3},["pending"===t.status?(x(),m("div",Ye," Waiting... ")):"running"===t.status?(x(),m("div",Ge,[d(I(o)),a[13]||(a[13]=_(" Processing... "))])):"failed"===t.status?(x(),m("div",Xe,k(t.result?.error||"API call failed"),1)):t.result?.content?(x(),m("div",Ze,[y("span",null,k(String(t.result.content)),1)])):(x(),m("div",Qe," No content "))],64)):E("",!0),"length"===e.key?(x(),m(h,{key:4},[t.result?.content?(x(),m("span",ea,k(String(t.result.content).length),1)):(x(),m("span",aa,"-"))],64)):E("",!0),"latency"===e.key?(x(),m(h,{key:5},[t.response?.latencyMs?(x(),m("span",ta,k(t.response.latencyMs)+"ms ",1)):(x(),m("span",la,"-"))],64)):E("",!0)];var l}),_:1},8,["data-source","loading","custom-row"]),n.value?(x(),T(ce,{key:0,trial:e.trial,"api-calls":u.value,onClose:a[4]||(a[4]=e=>n.value=!1)},null,8,["trial","api-calls"])):E("",!0),i.value?(x(),T(D,{key:1,"api-call":i.value,trial:e.trial,onClose:a[5]||(a[5]=e=>i.value=null)},null,8,["api-call","trial"])):E("",!0)])}}}),[["__scopeId","data-v-25282c25"]]),na={class:"trial-analysis"},ia={class:"stats-summary"},ra=l(p({__name:"TrialAnalysisView",props:{trial:{},apiCalls:{},loading:{type:Boolean}},emits:["back-to-selection","export-trial"],setup(e){const a=e,t=f(()=>a.apiCalls.filter(e=>"completed"===e.status).length),l=f(()=>a.apiCalls.filter(e=>"failed"===e.status).length),s=f(()=>{const e=t.value+l.value;return 0===e?0:Math.round(t.value/e*100)}),n=f(()=>{const e=a.apiCalls.filter(e=>e.response?.latencyMs);if(0===e.length)return 0;const t=e.reduce((e,a)=>e+(a.response?.latencyMs||0),0);return Math.round(t/e.length)}),i=f(()=>a.trial.progress.completed*(a.trial.estimatedCost/a.trial.progress.total));return(e,a)=>{const r=C("a-statistic"),o=C("a-divider");return x(),m("div",na,[y("div",ia,[d(r,{title:"Success Rate",value:s.value,suffix:"%","value-style":{color:s.value>=90?"#52c41a":s.value>=70?"#faad14":"#ff4d4f"}},null,8,["value","value-style"]),d(o,{type:"vertical"}),d(r,{title:"Completed",value:t.value,suffix:`/ ${e.trial.progress.total}`},null,8,["value","suffix"]),d(o,{type:"vertical"}),d(r,{title:"Failed",value:l.value,"value-style":{color:l.value>0?"#ff4d4f":"#52c41a"}},null,8,["value","value-style"]),d(o,{type:"vertical"}),d(r,{title:"Avg Latency",value:n.value,suffix:"ms"},null,8,["value"]),d(o,{type:"vertical"}),d(r,{title:"Total Cost",value:i.value,prefix:"$",precision:4},null,8,["value"])]),d(sa,{trial:e.trial,"api-calls":e.apiCalls,loading:e.loading},null,8,["trial","api-calls","loading"])])}}}),[["__scopeId","data-v-29db9da1"]]),oa={class:"results-view full-width"},ua={key:0,class:"results-table-view"},ca={key:1,class:"analysis-view"},da={class:"analysis-header"},pa={class:"analysis-title"},va=l(p({__name:"ResultsView",setup(e){const a=c(),l=v("table"),s=v(null),n=v(null),o=v([]),p=v([]),f=v(!1),g=v(!1),h=v("all"),b=v(!1),S=v(!1),R=v(!1),j=v(null),$=v(null);async function O(){f.value=!0;try{await a.initialize(),o.value=a.trials}catch(e){console.error("Failed to load trials:",e)}finally{f.value=!1}}async function q(e){!function(e){s.value=e.id,n.value=e}(e),l.value="analysis",await async function(){if(s.value){g.value=!0;try{p.value=await r.apiCalls.where("trialId").equals(s.value).toArray()}catch(e){console.error("Failed to load results:",e)}finally{g.value=!1}}}()}function D(){l.value="table",s.value=null,n.value=null,p.value=[]}function z(e,a){j.value=e,"python"===a?b.value=!0:W(e)}function N(e){$.value=e,R.value=!0}function U(e){n.value=e,S.value=!0}function F(){}function B(e){h.value=e}function V(e){b.value=!1,j.value=null}function H(){O()}function J(e){R.value=!1,$.value=null,O()}async function W(e){try{const{PythonExportService:a}=await t(async()=>{const{PythonExportService:e}=await import("./APICallDetailModal-7OujkVGA.js").then(e=>e.p);return{PythonExportService:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url);await a.downloadPythonScript(e)}catch(a){console.error("Export failed:",a),alert("Export failed: "+(a instanceof Error?a.message:"Unknown error"))}}async function K(e){if(confirm(`Delete trial "${e.name}"? This cannot be undone.`))try{await a.deleteTrial(e.id),s.value===e.id&&D()}catch(t){console.error("Failed to delete trial:",t),alert("Failed to delete trial")}}return M(()=>{O()}),(e,a)=>{const t=C("a-button"),s=C("a-tag"),r=C("a-space");return x(),m("div",oa,["table"===l.value?(x(),m("div",ua,[d(Ve,{trials:o.value,loading:f.value,onViewResults:q,onExportTrial:z,onDuplicateTrial:N,onDeleteTrial:K,onTrialDetails:U,onRefreshTrials:O,onExportAll:F,onStatusFilterChanged:B},null,8,["trials","loading"])])):"analysis"===l.value&&n.value?(x(),m("div",ca,[y("div",da,[d(t,{onClick:D,type:"default",class:"back-button"},{icon:w(()=>[d(I(u))]),default:w(()=>[a[4]||(a[4]=_(" Back to Results "))]),_:1,__:[4]}),y("div",pa,[y("h2",null,k(n.value.name),1),d(s,{color:(c=n.value.status,{completed:"success",failed:"error",running:"processing",cancelled:"default",draft:"default",pending:"processing",paused:"warning"}[c]||"default"),size:"small"},{default:w(()=>[_(k(n.value.status.toUpperCase()),1)]),_:1},8,["color"])]),d(r,null,{default:w(()=>[d(t,{onClick:a[0]||(a[0]=e=>W(n.value))},{icon:w(()=>[d(I(i))]),default:w(()=>[a[5]||(a[5]=_(" Export Results "))]),_:1,__:[5]})]),_:1})]),d(ra,{trial:n.value,"api-calls":p.value,loading:g.value,onBackToSelection:D,onExportTrial:W},null,8,["trial","api-calls","loading"])])):E("",!0),b.value&&j.value?(x(),T(P,{key:2,trial:j.value,onClose:a[1]||(a[1]=e=>{b.value=!1,j.value=null}),onExported:V},null,8,["trial"])):E("",!0),S.value&&n.value?(x(),T(A,{key:3,trial:n.value,onClose:a[2]||(a[2]=e=>S.value=!1),onUpdated:H},null,8,["trial"])):E("",!0),R.value?(x(),T(L,{key:4,trialToDuplicate:$.value,onClose:a[3]||(a[3]=e=>{R.value=!1,$.value=null}),onCreated:J},null,8,["trialToDuplicate"])):E("",!0)]);var c}}}),[["__scopeId","data-v-27afa482"]]);export{va as default};
