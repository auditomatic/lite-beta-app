import{b as f,I as ne,i as D,j as c,k as e,y as V,v as M,t as y,m as l,D as H,ai as le,z as p,x as O,_ as z,u as q,c as N,F as A,A as B,r as I,w as X,a9 as te,aa as W,ab as ae,ac as re,ad as se,ap as ie,ae as G,a as J,q as x,av as de,aJ as ue,a3 as pe,n as ce,p as Z}from"./index-BHXEDjmJ.js";import{u as me}from"./useV4Models-CpNVp1kv.js";import{M as ve,G as ge}from"./GenericModelSelectorModalV3-DVbsfK4n.js";import{c as Q,i as K,g as _e}from"./useHeatmapStylingV3-iXFmdUwU.js";import{u as fe}from"./useV4ProviderParameters-BMbBHKk2.js";import"./useV4LiveQuery-1pEB3sHw.js";var be={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};function ee(k){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?Object(arguments[n]):{},a=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(s).filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable}))),a.forEach(function(d){he(k,d,s[d])})}return k}function he(k,n,s){return n in k?Object.defineProperty(k,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):k[n]=s,k}var Y=function(n,s){var a=ee({},n,s.attrs);return f(ne,ee({},a,{icon:be}),null)};Y.displayName="CaretRightOutlined";Y.inheritAttrs=!1;const ye={class:"page-header"},$e={class:"header-actions"},ke={key:0,class:"cost-estimate"},Ce={class:"cost-tooltip"},Pe=D({__name:"PlaygroundHeaderV3",props:{selectedModel:{},estimatedTokens:{},outputTokenLimit:{},disabled:{type:Boolean},loading:{type:Boolean}},emits:["execute"],setup(k){return(n,s)=>{const a=M("a-tooltip"),d=M("a-button");return l(),c("div",ye,[s[4]||(s[4]=e("div",{class:"header-content"},[e("h1",null,"LLM Playground"),e("p",{class:"description"},"Test prompts and explore model responses interactively")],-1)),e("div",$e,[n.selectedModel?(l(),c("div",ke,[f(a,{placement:"bottom"},{title:y(()=>[e("div",Ce,[s[1]||(s[1]=e("div",null,"Cost estimate based on:",-1)),e("div",null,"• Input: "+p(n.estimatedTokens)+" tokens",1),e("div",null,"• Output: 10 - "+p(n.outputTokenLimit)+" tokens",1),s[2]||(s[2]=e("div",null,"• Min assumes 10 token response",-1)),s[3]||(s[3]=e("div",null,"• Max assumes full response limit",-1))])]),default:y(()=>[f(H(le),{class:"info-icon"})]),_:1}),f(ve,{model:n.selectedModel,mode:"range","input-tokens":n.estimatedTokens,"min-output-tokens":10,"max-output-tokens":n.outputTokenLimit,layout:"inline",size:"medium"},null,8,["model","input-tokens","max-output-tokens"])])):V("",!0),f(d,{type:"primary",onClick:s[0]||(s[0]=i=>n.$emit("execute")),disabled:n.disabled,loading:n.loading},{default:y(()=>[O(p(n.loading?"Running...":"Run"),1)]),_:1},8,["disabled","loading"])])])}}}),Se=z(Pe,[["__scopeId","data-v-19aae705"]]),we={key:0,class:"model-info"},xe={class:"info-header"},Te={class:"model-name"},Ve={class:"provider-badge"},Me={key:0,class:"info-details"},Ie={class:"detail-item"},Re={class:"value"},Ee={class:"detail-item"},Oe={class:"value"},Le={class:"dollar-amount"},De={class:"detail-item"},ze={class:"value"},Ne={class:"dollar-amount"},Fe={class:"detail-item"},Ae={class:"value"},Be={class:"detail-item"},je={class:"value"},Ue={class:"detail-item"},Je={class:"value"},qe=D({__name:"ModelInfoCardV3",props:{model:{}},setup(k){const n=k,s=q(),a=N(()=>s.settings.core.preferences.value);function d(o){return o<.01?o.toFixed(4):o<1?o.toFixed(3):o.toFixed(2)}function i(o){return o?o>=1e6?(o/1e6).toFixed(1)+"M":o>=1e3?(o/1e3).toFixed(0)+"k":o.toString():"N/A"}function b(){var o;return!n.model||!((o=a.value)!=null&&o.enableEnvironmentalCosts),"??"}return(o,m)=>o.model?(l(),c("div",we,[e("div",xe,[e("span",Te,p(o.model.displayName),1),e("span",Ve,p(o.model.provider),1)]),o.model.capabilities?(l(),c("div",Me,[e("div",Ie,[m[0]||(m[0]=e("span",{class:"label"},"Context:",-1)),e("span",Re,p(i(o.model.capabilities.contextWindow))+" tokens",1)]),e("div",Ee,[m[2]||(m[2]=e("span",{class:"label"},"Input:",-1)),e("span",Oe,[e("span",Le,"$"+p(d((o.model.capabilities.inputCostPerToken||0)*1e3)),1),m[1]||(m[1]=O("/1k "))])]),e("div",De,[m[4]||(m[4]=e("span",{class:"label"},"Output:",-1)),e("span",ze,[e("span",Ne,"$"+p(d((o.model.capabilities.outputCostPerToken||0)*1e3)),1),m[3]||(m[3]=O("/1k "))])]),e("div",Fe,[m[5]||(m[5]=e("span",{class:"label"},"CO₂: 🏭",-1)),e("span",Ae,p(b()),1)]),e("div",Be,[m[6]||(m[6]=e("span",{class:"label"},"Water: 💧",-1)),e("span",je,p(b()),1)]),e("div",Ue,[m[7]||(m[7]=e("span",{class:"label"},"Energy: ⚡",-1)),e("span",Je,p(b()),1)])])):V("",!0)])):V("",!0)}}),He=z(qe,[["__scopeId","data-v-1dc544bc"]]),We={class:"left-panel"},Ge={class:"panel-section"},Qe={class:"panel-section"},Xe={class:"action-buttons"},Ye={key:0,class:"panel-section"},Ze={class:"template-buttons"},Ke=D({__name:"PlaygroundLeftPanelV3",props:{selectedModel:{},promptText:{}},emits:["open-model-selector","load-from-design","clear-prompt","load-template"],setup(k){const n=q(),s=N(()=>{const d=n.templates.templates.value||[],i=n.spreadsheet.prompts.value||[];return d.length>0||i.length>0}),a=[{name:"Creative",prompt:"Write a creative short story about:"},{name:"Analysis",prompt:"Analyze the following text and provide insights:"},{name:"Explain",prompt:"Explain this concept in simple terms:"},{name:"Summarize",prompt:"Summarize the following content:"}];return(d,i)=>{const b=M("a-button");return l(),c("div",We,[e("div",Ge,[i[4]||(i[4]=e("h3",null,"Select Model",-1)),f(b,{type:"primary",size:"large",style:{width:"100%"},onClick:i[0]||(i[0]=o=>d.$emit("open-model-selector"))},{default:y(()=>i[3]||(i[3]=[O(" Select Model ")])),_:1,__:[3]}),f(He,{model:d.selectedModel},null,8,["model"])]),e("div",Qe,[i[7]||(i[7]=e("h3",null,"Actions",-1)),e("div",Xe,[f(b,{type:"default",onClick:i[1]||(i[1]=o=>d.$emit("load-from-design")),disabled:!s.value,block:""},{default:y(()=>i[5]||(i[5]=[O(" Load from Design ")])),_:1,__:[5]},8,["disabled"]),f(b,{type:"default",onClick:i[2]||(i[2]=o=>d.$emit("clear-prompt")),disabled:!d.promptText,block:""},{default:y(()=>i[6]||(i[6]=[O(" Clear Prompt ")])),_:1,__:[6]},8,["disabled"])])]),d.selectedModel?(l(),c("div",Ye,[i[8]||(i[8]=e("h3",null,"Quick Templates",-1)),e("div",Ze,[(l(),c(A,null,B(a,o=>f(b,{key:o.name,size:"small",onClick:m=>d.$emit("load-template",o.prompt)},{default:y(()=>[O(p(o.name),1)]),_:2},1032,["onClick"])),64))])])):V("",!0)])}}}),et=z(Ke,[["__scopeId","data-v-69288157"]]),tt={class:"template-editor"},st=["placeholder","rows","data-testid","aria-label"],ot=D({__name:"TemplateEditorV3",props:{modelValue:{},label:{},placeholder:{default:"Enter your prompt template..."},required:{type:Boolean},rows:{default:4},variables:{default:()=>[]},variableColors:{default:()=>({})}},emits:["update:modelValue"],setup(k,{expose:n,emit:s}){const a=k,d=s,i=I(),b=I(),o=I(!1),m=N({get:()=>a.modelValue,set:r=>d("update:modelValue",r)}),C=N(()=>{let r=E(m.value);return r=r.replace(/\{\{(\w+)\}\}/g,(v,u)=>{const _=/^\w+$/.test(u),T=a.variableColors[u];return _&&T?`<span class="variable-highlight" style="background-color: ${T.bg}; box-shadow: 0 0 0 1px ${T.bg};">${E(v)}</span>`:_?`<span class="variable-highlight">${E(v)}</span>`:`<span class="variable-error">${E(v)}</span>`}),r=r.replace(/\n/g,"<br>"),r=r.replace(/  /g," &nbsp;"),r.endsWith("<br>")||(r+="<br>"),r});function E(r){const v=document.createElement("div");return v.textContent=r,v.innerHTML}function t(){!i.value||!b.value||(b.value.scrollTop=i.value.scrollTop,b.value.scrollLeft=i.value.scrollLeft)}return X(m,async()=>{await se(),t()}),n({focus:()=>{var r;return(r=i.value)==null?void 0:r.focus()}}),(r,v)=>{const u=ae("dompurify-html");return l(),c("div",tt,[e("div",{class:te(["editor-container",{focused:o.value}])},[W(e("div",{ref_key:"highlightRef",ref:b,class:"editor-highlight","aria-hidden":"true"},null,512),[[u,C.value,"template"]]),W(e("textarea",{ref_key:"textareaRef",ref:i,"onUpdate:modelValue":v[0]||(v[0]=_=>m.value=_),class:"editor-textarea",placeholder:r.placeholder,rows:r.rows,"data-testid":r.$attrs["data-testid"]||"textarea-template-editor","aria-label":r.$attrs["aria-label"]||"Template editor textarea",onFocus:v[1]||(v[1]=_=>o.value=!0),onBlur:v[2]||(v[2]=_=>o.value=!1),onScroll:t},null,40,st),[[re,m.value]])],2)])}}}),nt=z(ot,[["__scopeId","data-v-1880e5bc"]]),lt={class:"prompt-section"},at={class:"section-header"},rt={class:"character-count"},it=D({__name:"PromptEditorSectionV3",props:{promptText:{}},emits:["update:prompt-text"],setup(k){return(n,s)=>(l(),c("div",lt,[e("div",at,[s[1]||(s[1]=e("h3",null,"Prompt",-1)),e("span",rt,p(n.promptText.length)+" characters",1)]),f(nt,{"model-value":n.promptText,"onUpdate:modelValue":s[0]||(s[0]=a=>n.$emit("update:prompt-text",a)),rows:6,placeholder:"Enter your prompt here...","data-testid":"playground-prompt-editor"},null,8,["model-value"])]))}}),dt=z(it,[["__scopeId","data-v-cc204b24"]]),ut={key:0,class:"logprobs-container"},pt={class:"logprobs-header"},ct=["value"],mt={class:"logprobs-content"},vt=["onMouseenter"],gt={class:"tooltip-header"},_t={class:"tooltip-content"},ft={class:"tooltip-row"},bt={class:"tooltip-value"},ht={class:"tooltip-row"},yt={class:"tooltip-value"},$t={key:0,class:"tooltip-alternatives"},kt={class:"alt-token"},Ct={class:"alt-prob"},Pt={class:"logprobs-legend"},St={class:"legend-bar"},wt=D({__name:"LogprobsDisplay",props:{logprobs:{}},setup(k){const n=I("viridis"),s=I(!1),a=I(null),d=I({}),i=I(null);function b(v){const u=Math.exp(v);return Math.sqrt(u)}function o(v){const u=Q[n.value];if(!u)return J.debug("No color scale found for:",n.value),{};const _=b(v.logprob),T=K(_,u.colors),F=_e(T);return{backgroundColor:`${T} !important`,color:`${F} !important`}}function m(v){const u=Q[n.value];return u?K(v,u.colors):"transparent"}function C(v){return v===`
`?"\\n":v==="	"?"\\t":v===" "?"·":v.trim()===""?`[${v.length} spaces]`:v}function E(v,u){a.value=v,s.value=!0,r(u)}function t(){s.value=!1,a.value=null}function r(v){if(!s.value)return;const u=10,_=v.clientX+u,T=v.clientY-u;d.value={position:"fixed",left:`${_}px`,top:`${T}px`,zIndex:"1000"}}return(v,u)=>{var _,T,F,U,j;return v.logprobs.hasLogprobs?(l(),c("div",ut,[e("div",pt,[u[2]||(u[2]=e("h4",null,"Token Probabilities",-1)),W(e("select",{"onUpdate:modelValue":u[0]||(u[0]=R=>n.value=R),class:"color-scale-selector"},[(l(!0),c(A,null,B(H(Q),(R,h)=>(l(),c("option",{key:h,value:h},p(R.name),9,ct))),128))],512),[[ie,n.value]])]),e("div",mt,[(l(!0),c(A,null,B(v.logprobs.content,(R,h)=>(l(),c("span",{key:h,style:G(o(R)),class:"logprob-token",onMouseenter:S=>E(R,S),onMouseleave:t,onMousemove:u[1]||(u[1]=S=>r(S))},p(C(R.token)),45,vt))),128))]),s.value?(l(),c("div",{key:0,ref_key:"tooltipRef",ref:i,class:"logprob-tooltip",style:G(d.value)},[e("div",gt,[e("strong",null,'"'+p((_=a.value)==null?void 0:_.token)+'"',1)]),e("div",_t,[e("div",ft,[u[3]||(u[3]=e("span",{class:"tooltip-label"},"Logprob:",-1)),e("span",bt,p((F=(T=a.value)==null?void 0:T.logprob)==null?void 0:F.toFixed(4)),1)]),e("div",ht,[u[4]||(u[4]=e("span",{class:"tooltip-label"},"Probability:",-1)),e("span",yt,p((Math.exp(((U=a.value)==null?void 0:U.logprob)||0)*100).toFixed(2))+"%",1)]),(j=a.value)!=null&&j.top_logprobs&&a.value.top_logprobs.length>0?(l(),c("div",$t,[u[5]||(u[5]=e("div",{class:"tooltip-section-header"},"Top alternatives:",-1)),(l(!0),c(A,null,B(a.value.top_logprobs.slice(0,3),R=>(l(),c("div",{key:R.token,class:"tooltip-alt"},[e("span",kt,'"'+p(C(R.token))+'"',1),e("span",Ct,p((Math.exp(R.logprob)*100).toFixed(2))+"%",1)]))),128))])):V("",!0)])],4)):V("",!0),e("div",Pt,[e("div",St,[(l(),c(A,null,B(10,(R,h)=>e("div",{key:h,style:G({backgroundColor:m(h/9)}),class:"legend-segment"},null,4)),64))]),u[6]||(u[6]=e("div",{class:"legend-labels"},[e("span",null,"Low probability"),e("span",null,"High probability")],-1))])])):V("",!0)}}}),xt=z(wt,[["__scopeId","data-v-790be2ca"]]),Tt={class:"response-display"},Vt={key:0,class:"loading-state"},Mt={key:1,class:"error-state"},It={class:"error-details"},Rt={key:2,class:"response-content"},Et={class:"response-text"},Ot={class:"text-content"},Lt={class:"expand-icon"},Dt={class:"metadata-content"},zt={class:"metadata-grid"},Nt={class:"metadata-item"},Ft={class:"value"},At={key:0,class:"metadata-item"},Bt={class:"value"},jt={key:1,class:"metadata-item"},Ut={class:"value"},Jt={class:"cost-amount"},qt={class:"cost-amount"},Ht={class:"cost-amount"},Wt={class:"metadata-item"},Gt={class:"value env-costs"},Qt={class:"env-item"},Xt={class:"env-item"},Yt={class:"env-item"},Zt={class:"raw-response"},Kt={class:"debug-sections"},es={class:"debug-section"},ts={class:"debug-response"},ss={class:"debug-section"},os={class:"debug-response"},ns={class:"debug-section"},ls={class:"debug-response"},as={key:3,class:"empty-state"},rs=D({__name:"ResponseDisplayV3",props:{response:{},isLoading:{type:Boolean},error:{}},setup(k){const n=q(),s=N(()=>n.settings.core.preferences.value),a=I(!1);function d(t){return t<1e-4?t.toFixed(6):t<.01?t.toFixed(4):t.toFixed(3)}function i(t){if(!t)return"No raw response data";try{return JSON.stringify(t,null,2)}catch{return String(t)}}function b(t){if(!t)return"No error details available";try{return t.stack?`Stack Trace:
${t.stack}

Full Error Object:
${JSON.stringify(t,null,2)}`:t.details?`Error Details:
${JSON.stringify(t.details,null,2)}

Full Error Object:
${JSON.stringify(t,null,2)}`:JSON.stringify(t,null,2)}catch{return String(t)}}function o(){var t;return(t=s.value)!=null&&t.enableEnvironmentalCosts,"??"}function m(t){if(!t)return"No request data available";try{return JSON.stringify({url:t.url,method:t.method,headers:t.headers,body:t.body},null,2)}catch{return String(t)}}function C(t){if(!t)return"No response data available";try{return JSON.stringify({status:t.status,statusText:t.statusText,headers:t.headers,body:t.body},null,2)}catch{return String(t)}}function E(t){if(!t)return"No parsing data available";try{return JSON.stringify({providerId:t.providerId,modelId:t.modelId,parameters:t.parameters,parsedResponse:t.parsedResponse,contentExtracted:t.contentExtracted,contentLength:t.contentLength},null,2)}catch{return String(t)}}return(t,r)=>{const v=M("a-spin"),u=M("a-alert"),_=M("a-collapse-panel"),T=M("a-collapse");return l(),c("div",Tt,[t.isLoading?(l(),c("div",Vt,[f(v,{size:"large"},{tip:y(()=>r[1]||(r[1]=[O("Generating response...")])),_:1})])):t.error?(l(),c("div",Mt,[f(u,{type:"error",message:t.error.message||"API Error",description:t.error.details,"show-icon":""},null,8,["message","description"]),t.error.response?(l(),x(T,{key:0,ghost:"",style:{"margin-top":"16px"}},{default:y(()=>[f(_,{key:"details",header:"Full API Request/Response"},{default:y(()=>[e("pre",It,p(b(t.error.response)),1)]),_:1})]),_:1})):V("",!0)])):t.response?(l(),c("div",Rt,[e("div",Et,[e("pre",Ot,p(t.response.content),1)]),t.response.logprobs?(l(),x(xt,{key:0,logprobs:t.response.logprobs},null,8,["logprobs"])):V("",!0),e("div",{class:te(["response-metadata",{expanded:a.value}])},[e("h3",{class:"metadata-header",onClick:r[0]||(r[0]=F=>a.value=!a.value)},[e("span",Lt,[a.value?(l(),x(H(de),{key:1})):(l(),x(H(Y),{key:0}))]),r[2]||(r[2]=O(" Response Details "))]),W(e("div",Dt,[e("div",zt,[e("div",Nt,[r[3]||(r[3]=e("span",{class:"label"},"Latency:",-1)),e("span",Ft,p(t.response.latency)+"ms",1)]),t.response.tokens?(l(),c("div",At,[r[4]||(r[4]=e("span",{class:"label"},"Token Usage:",-1)),e("span",Bt,p(t.response.tokens.prompt_tokens||"?")+" input + "+p(t.response.tokens.completion_tokens||"?")+" output = "+p(t.response.tokens.total_tokens||"?")+" total tokens ",1)])):V("",!0),t.response.cost?(l(),c("div",jt,[r[8]||(r[8]=e("span",{class:"label"},"Cost Estimate:",-1)),e("span",Ut,[e("span",Jt,"$"+p(d(t.response.cost.input)),1),r[5]||(r[5]=O(" input + ")),e("span",qt,"$"+p(d(t.response.cost.output)),1),r[6]||(r[6]=O(" output = ")),e("span",Ht,"$"+p(d(t.response.cost.total)),1),r[7]||(r[7]=O(" total "))])])):V("",!0),e("div",Wt,[r[9]||(r[9]=e("span",{class:"label"},"Environmental:",-1)),e("span",Gt,[e("span",Qt,"CO₂ 🏭: "+p(o())+"  ",1),e("span",Xt,"Water 💧: "+p(o())+"  ",1),e("span",Yt,"Energy ⚡: "+p(o()),1)])])]),f(T,{ghost:"",style:{"margin-top":"16px"}},{default:y(()=>[f(_,{key:"raw",header:"Raw API Response"},{default:y(()=>[e("pre",Zt,p(i(t.response.raw)),1)]),_:1})]),_:1}),t.response.debug?(l(),x(T,{key:0,ghost:"",style:{"margin-top":"8px"}},{default:y(()=>[f(_,{key:"debug",header:"🔍 Complete API Request/Response Debug"},{default:y(()=>[e("div",Kt,[e("div",es,[r[10]||(r[10]=e("h4",null,"📤 API Request",-1)),e("pre",ts,p(m(t.response.debug.request)),1)]),e("div",ss,[r[11]||(r[11]=e("h4",null,"📥 API Response",-1)),e("pre",os,p(C(t.response.debug.response)),1)]),e("div",ns,[r[12]||(r[12]=e("h4",null,"⚙️ Response Parser Details",-1)),e("pre",ls,p(E(t.response.debug.parsing)),1)])])]),_:1})]),_:1})):V("",!0)],512),[[ue,a.value]])],2)])):(l(),c("div",as,r[13]||(r[13]=[e("div",{class:"empty-content"},[e("div",{class:"empty-icon"},"💬"),e("p",null,"Response will appear here after running a prompt")],-1)])))])}}}),is=z(rs,[["__scopeId","data-v-959f25b6"]]),ds={key:0,class:"response-section"},us={class:"section-header"},ps={key:0,class:"response-meta"},cs={class:"response-container"},ms=D({__name:"ResponseSectionV3",props:{hasExecuted:{type:Boolean},response:{},error:{},isLoading:{type:Boolean}},setup(k){return(n,s)=>{var a;return n.hasExecuted?(l(),c("div",ds,[e("div",us,[s[0]||(s[0]=e("h3",null,"Response",-1)),n.response&&!n.error?(l(),c("div",ps,[e("span",null,p(n.response.latency)+"ms",1),e("span",null,p(((a=n.response.tokens)==null?void 0:a.total_tokens)||"?")+" tokens",1)])):V("",!0)]),e("div",cs,[f(is,{response:n.response,"is-loading":n.isLoading,error:n.error},null,8,["response","is-loading","error"])])])):V("",!0)}}}),vs=z(ms,[["__scopeId","data-v-f538f8ed"]]),gs={class:"center-panel"},_s=D({__name:"PlaygroundCenterPanelV3",props:{promptText:{},hasExecuted:{type:Boolean},response:{},error:{},isExecuting:{type:Boolean}},emits:["update:prompt-text"],setup(k){return(n,s)=>(l(),c("div",gs,[f(dt,{"prompt-text":n.promptText,"onUpdate:promptText":s[0]||(s[0]=a=>n.$emit("update:prompt-text",a))},null,8,["prompt-text"]),f(vs,{"has-executed":n.hasExecuted,response:n.response,error:n.error,"is-loading":n.isExecuting},null,8,["has-executed","response","error","is-loading"])]))}}),fs=z(_s,[["__scopeId","data-v-413d0af3"]]),bs={class:"parameter-panel"},hs={key:0,class:"params-section"},ys={key:0,class:"reasoning-warning"},$s={key:5,class:"param-description"},ks={key:4,class:"param-description"},Cs={class:"panel-actions"},Ps=D({__name:"ModelParameterPanel",props:{model:{},modelValue:{}},emits:["update:modelValue","change"],setup(k,{emit:n}){const s=k,a=n;q();const{getBasicParameters:d,getAdvancedParameters:i,getUIDefaults:b}=fe(),o=pe({}),m=N(()=>s.model?d(s.model.provider,s.model.modelId):{}),C=N(()=>s.model?i(s.model.provider,s.model.modelId):{}),E=N(()=>s.model?(s.model.provider==="openai-chat"||s.model.provider==="openai-responses")&&(s.model.modelId.match(/^o[0-9]/)||s.model.modelId.match(/^gpt-5/)):!1);function t(u,_){o[u]=_,a("update:modelValue",{...o}),a("change",{...o})}function r(u){return u.replace(/\./g," › ").replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())}function v(){if(!s.model)return;Object.keys(o).forEach(_=>delete o[_]);const u=b(s.model.provider,s.model.modelId);Object.assign(o,u),a("update:modelValue",{...o}),a("change",{...o})}return X(()=>s.model,u=>{u&&v()},{immediate:!0}),X(()=>s.modelValue,u=>{Object.assign(o,u)},{immediate:!0,deep:!0}),(u,_)=>{const T=M("a-alert"),F=M("a-input-number"),U=M("a-switch"),j=M("a-select-option"),R=M("a-select"),h=M("a-input"),S=M("a-form-item"),L=M("a-collapse-panel"),w=M("a-collapse"),oe=M("a-button");return l(),c("div",bs,[Object.keys(m.value).length>0?(l(),c("div",hs,[_[1]||(_[1]=e("h4",null,"Basic Parameters",-1)),E.value?(l(),c("div",ys,[f(T,{message:"Reasoning models (O* and GPT-5*) do not support temperature",type:"info",size:"small","show-icon":"",closable:!1})])):V("",!0),(l(!0),c(A,null,B(m.value,(g,P)=>(l(),x(S,{key:P,label:r(P)},{default:y(()=>[g.type==="number"?(l(),x(F,{key:0,value:o[P],onChange:$=>t(P,$),min:g.min,max:g.max,step:g.step||.1,placeholder:String(g.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):g.type==="integer"?(l(),x(F,{key:1,value:o[P],onChange:$=>t(P,$),min:g.min,max:g.max,placeholder:String(g.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","placeholder"])):g.type==="boolean"?(l(),x(U,{key:2,checked:o[P],onChange:$=>t(P,$),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):g.type==="string"&&g.enum?(l(),x(R,{key:3,value:o[P],onChange:$=>t(P,$),placeholder:g.default?String(g.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:y(()=>[f(j,{value:void 0},{default:y(()=>_[0]||(_[0]=[e("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[0]}),(l(!0),c(A,null,B(g.enum,$=>(l(),x(j,{key:$,value:$},{default:y(()=>[O(p($),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(l(),x(h,{key:4,value:o[P],onChange:$=>t(P,$.target.value),placeholder:String(g.default),size:"large"},null,8,["value","onChange","placeholder"])),g.description?(l(),c("div",$s,p(g.description),1)):V("",!0)]),_:2},1032,["label"]))),128))])):V("",!0),Object.keys(C.value).length>0?(l(),x(w,{key:1,ghost:""},{default:y(()=>[f(L,{key:"advanced",header:"Advanced Parameters"},{default:y(()=>[(l(!0),c(A,null,B(C.value,(g,P)=>(l(),x(S,{key:P,label:r(P)},{default:y(()=>[g.type==="number"||g.type==="integer"?(l(),x(F,{key:0,value:o[P],onChange:$=>t(P,$),min:g.min,max:g.max,step:g.type==="number"?g.step||.1:1,placeholder:String(g.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):g.type==="boolean"?(l(),x(U,{key:1,checked:o[P],onChange:$=>t(P,$),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):g.type==="string"&&g.enum?(l(),x(R,{key:2,value:o[P],onChange:$=>t(P,$),placeholder:g.default?String(g.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:y(()=>[f(j,{value:void 0},{default:y(()=>_[2]||(_[2]=[e("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[2]}),(l(!0),c(A,null,B(g.enum,$=>(l(),x(j,{key:$,value:$},{default:y(()=>[O(p($),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(l(),x(h,{key:3,value:o[P],onChange:$=>t(P,$.target.value),placeholder:String(g.default),size:"large"},null,8,["value","onChange","placeholder"])),g.description?(l(),c("div",ks,p(g.description),1)):V("",!0)]),_:2},1032,["label"]))),128))]),_:1})]),_:1})):V("",!0),e("div",Cs,[f(oe,{onClick:v,size:"small"},{default:y(()=>_[3]||(_[3]=[O(" Reset to Defaults ")])),_:1,__:[3]})])])}}}),Ss=z(Ps,[["__scopeId","data-v-8acc7c31"]]),ws={class:"right-panel"},xs={class:"panel-header"},Ts={key:0},Vs={key:1},Ms={key:0,class:"panel-content"},Is={key:1,class:"no-model-message"},Rs=D({__name:"PlaygroundRightPanelV3",props:{model:{},parameters:{}},emits:["update:parameters","parameters-change"],setup(k,{emit:n}){const s=n;function a(d){s("update:parameters",d),s("parameters-change",d)}return(d,i)=>(l(),c("div",ws,[e("div",xs,[d.model?(l(),c("h3",Ts,p(d.model.displayName),1)):(l(),c("h3",Vs,"Select a Model"))]),d.model?(l(),c("div",Ms,[f(Ss,{model:d.model,modelValue:d.parameters,"onUpdate:modelValue":a,onChange:a},null,8,["model","modelValue"])])):(l(),c("div",Is,i[0]||(i[0]=[e("p",null,"Choose a model from the left panel to configure parameters.",-1)])))]))}}),Es=z(Rs,[["__scopeId","data-v-a054623d"]]),Os={class:"design-list"},Ls=["onClick"],Ds={class:"design-name"},zs={class:"design-description"},Ns={class:"design-preview"},Fs={class:"design-type"},As=D({__name:"DesignSelectorModalV3",props:{open:{type:Boolean}},emits:["close","select"],setup(k,{emit:n}){const s=n,a=q(),d=N(()=>{const b=a.templates.templates.value||[],o=a.spreadsheet.prompts.value||[];return[...b.map(m=>({id:m.id,name:m.name,description:m.description,text:m.template,type:"template"})),...o.map(m=>({id:m.id,name:m.name,description:m.description,text:m.promptPattern,type:"spreadsheet"}))]});function i(b){s("select",b),s("close")}return(b,o)=>{const m=M("a-modal");return l(),x(m,{open:b.open,title:"Load from Design",width:"800px",footer:null,onCancel:o[0]||(o[0]=C=>b.$emit("close"))},{default:y(()=>[e("div",Os,[(l(!0),c(A,null,B(d.value,C=>(l(),c("div",{key:C.id,class:"design-item",onClick:E=>i(C)},[e("div",Ds,p(C.name),1),e("div",zs,p(C.description||"No description"),1),e("div",Ns,p(C.text.substring(0,100))+"...",1),e("div",Fs,p(C.type),1)],8,Ls))),128))])]),_:1},8,["open"])}}}),Bs=z(As,[["__scopeId","data-v-d9106226"]]),js={class:"playground-view","data-testid":"page-playground"},Us={class:"playground-content"},Js=D({__name:"PlaygroundViewV3",setup(k){const{enabledModels:n}=me(),s=q(),a=I(null),d=I(""),i=I({}),b=I(!1),o=I(!1),m=I(!1),C=I(!1),E=I(null),t=I(null),r=N(()=>a.value&&d.value.trim().length>0&&!C.value),v=N(()=>d.value?Math.ceil(d.value.length/4):0),u=N(()=>a.value?i.value.max_tokens||i.value.maxTokens||1e3:256);function _(h){i.value={...h},J.debug("Parameters changed:",i.value)}function T(h){d.value=h.text}function F(h){d.value=h}function U(){d.value=""}function j(h){a.value=h,o.value=!1,i.value={},Z.supportsLogprobs(h.provider,h.modelId)&&(J.debug(`Auto-enabling logprobs for ${h.provider}/${h.modelId}`),se(()=>{i.value.logprobs=!0,h.provider.includes("openai")&&(i.value.top_logprobs=5),J.debug("Logprobs and top_logprobs set after nextTick:",i.value)}))}async function R(){var h,S,L;if(!(!r.value||!a.value)){m.value=!0,C.value=!0,E.value=null,t.value=null;try{const w=await s.executeSingleCall(d.value,0,{provider:a.value.provider,modelId:a.value.modelId,...i.value});w.ok?(E.value={content:w.value.content||"",latency:w.value.latency||0,tokens:w.value.usage,cost:w.value.cost,logprobs:w.value.logprobs,features:w.value.features,raw:w.value.raw,debug:w.value.debug,model:a.value},J.debug("Playground response set with logprobs:",w.value.logprobs)):t.value={message:((h=w.error)==null?void 0:h.message)||"Failed to execute prompt",details:((S=w.error)==null?void 0:S.details)||((L=w.error)==null?void 0:L.stack)||w.error,response:w.error}}catch(w){t.value={message:w.message||"An unexpected error occurred",details:w.stack||w.toString(),response:w}}finally{C.value=!1}}}return ce(async()=>{setTimeout(()=>{!a.value&&n.value&&n.value.length>0&&(a.value=n.value[0],Z.supportsLogprobs(a.value.provider,a.value.modelId)&&(J.debug(`Auto-enabling logprobs for initial model ${a.value.provider}/${a.value.modelId}`),setTimeout(()=>{i.value.logprobs=!0,a.value.provider.includes("openai")&&(i.value.top_logprobs=5),J.debug("Initial logprobs and top_logprobs set:",i.value)},200)))},100)}),(h,S)=>(l(),c("div",js,[f(Se,{"selected-model":a.value,"estimated-tokens":v.value,"output-token-limit":u.value,disabled:!r.value,loading:C.value,onExecute:R},null,8,["selected-model","estimated-tokens","output-token-limit","disabled","loading"]),e("div",Us,[f(et,{"selected-model":a.value,"prompt-text":d.value,onOpenModelSelector:S[0]||(S[0]=L=>o.value=!0),onLoadFromDesign:S[1]||(S[1]=L=>b.value=!0),onClearPrompt:U,onLoadTemplate:F},null,8,["selected-model","prompt-text"]),f(fs,{"prompt-text":d.value,"has-executed":m.value,response:E.value,error:t.value,"is-executing":C.value,"onUpdate:promptText":S[2]||(S[2]=L=>d.value=L)},null,8,["prompt-text","has-executed","response","error","is-executing"]),f(Es,{model:a.value,parameters:i.value,"onUpdate:parameters":S[3]||(S[3]=L=>i.value=L),onParametersChange:_},null,8,["model","parameters"])]),f(Bs,{open:b.value,onClose:S[4]||(S[4]=L=>b.value=!1),onSelect:T},null,8,["open"]),f(ge,{visible:o.value,mode:"playground",title:"Select Model","onUpdate:visible":S[5]||(S[5]=L=>o.value=L),onSelectModel:j},null,8,["visible"])]))}}),Ys=z(Js,[["__scopeId","data-v-8eb06c67"]]);export{Ys as default};
