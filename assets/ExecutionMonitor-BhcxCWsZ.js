import{k as e,d as t,r as a,c as l,V as s,W as r,Z as n,Y as o,_ as i,a6 as u,a1 as c,G as d,a0 as v,F as p,a8 as f,H as m,ah as g,f as y,o as h,b,w,ab as k,ad as x,u as C,ag as _,ai as S,q as P,aj as I,aa as T,ak as O}from"./vendor-DImCB_rW.js";import{l as j}from"./db-CL8uhZCz.js";import{I as $,_ as A,u as F,z as E,l as M,v as H,d as z,w as D}from"./index-Dynr8V5n.js";import{A as R,P as U}from"./PythonExportModal.vue_vue_type_style_index_0_lang-BKaFWCp2.js";var V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"};function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){K(e,t,a[t])})}return e}function K(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var L=function(t,a){var l=N({},t,a.attrs);return e($,N({},l,{icon:V}),null)};L.displayName="PauseOutlined",L.inheritAttrs=!1;var q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){B(e,t,a[t])})}return e}function B(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Y=function(t,a){var l=W({},t,a.attrs);return e($,W({},l,{icon:q}),null)};Y.displayName="StopOutlined",Y.inheritAttrs=!1;const G={class:"summary-row"},Z={key:0,class:"filter-row"},J=["title"],Q=["title"],X=A(t({__name:"PivotCellDetailModal",props:{row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(t){const m=t,g=a({}),y=l(()=>{const e=new Set;return m.apiCalls.forEach(t=>{t.variables&&Object.keys(t.variables).forEach(t=>e.add(t)),t.attributedVariables&&Object.entries(t.attributedVariables).forEach(([t,a])=>{a&&"object"==typeof a&&Object.keys(a).forEach(a=>{e.add(`${t}.${a}`)})})}),Array.from(e).sort()}),h=l(()=>y.value.map(e=>({title:e,dataIndex:`var_${e}`,key:`var_${e}`,width:150,ellipsis:!0,sorter:(t,a)=>{const l=t[`var_${e}`]||"",s=a[`var_${e}`]||"";return l.localeCompare(s)}}))),b=[{title:"Status",dataIndex:"status",key:"status",width:100,fixed:"left",sorter:(e,t)=>e.status.localeCompare(t.status)},{title:"Model",dataIndex:"model",key:"model",width:150,ellipsis:!0,sorter:(e,t)=>e.model.localeCompare(t.model)}],w=[{title:"Response",dataIndex:"response",key:"response",width:300,ellipsis:!0},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150,ellipsis:!0,sorter:(e,t)=>(e.extracted||"").localeCompare(t.extracted||"")},{title:"Duration",dataIndex:"duration",key:"duration",width:100,sorter:(e,t)=>(parseInt(e.duration)||0)-(parseInt(t.duration)||0)},{title:"Cost",dataIndex:"cost",key:"cost",width:100,sorter:(e,t)=>(e.cost||0)-(t.cost||0)}],k=l(()=>[...b,...h.value,...w]),x=l(()=>`${m.row} Ã— ${m.column} - ${m.apiCalls.length} API Calls`),C=l(()=>m.apiCalls.map(e=>{const t={id:e.id,status:e.status,model:e.model||"-",response:e.result?.content||e.result?.error||"-",extracted:e.extracted||"-",duration:e.duration?`${e.duration}ms`:"-",cost:e.cost||0};return y.value.forEach(a=>{if(a.includes(".")){const[l,s]=a.split("."),r=e.attributedVariables?.[l]?.[s];t[`var_${a}`]=void 0!==r?String(r):"-"}else t[`var_${a}`]=e.variables?.[a]||"-"}),t})),_=l(()=>Object.values(g).some(e=>void 0!==e&&""!==e)),S=l(()=>_.value?C.value.filter(e=>Object.entries(g).every(([t,a])=>!a||e[t]===a)):C.value),P=l(()=>{const e=m.apiCalls.filter(e=>"completed"===e.status).length;return Math.round(e/m.apiCalls.length*100)}),I=l(()=>{const e=m.apiCalls.filter(e=>e.duration).map(e=>e.duration);return 0===e.length?0:Math.round(e.reduce((e,t)=>e+t,0)/e.length)}),T=l(()=>m.apiCalls.filter(e=>e.cost).map(e=>e.cost).reduce((e,t)=>e+t,0).toFixed(4));function O(e){switch(e){case"completed":return"success";case"failed":return"error";case"pending":return"warning";case"running":return"processing";default:return"default"}}function j(e){const t=new Set;return C.value.forEach(a=>{const l=a[e];l&&"-"!==l&&t.add(l)}),Array.from(t).sort()}function $(){}function A(){Object.keys(g).forEach(e=>{delete g[e]})}return(t,a)=>{const l=r("a-select-option"),m=r("a-select"),y=r("a-button"),b=r("a-tag"),w=r("a-table"),C=r("a-modal");return o(),s(C,{open:!0,width:"98vw",footer:null,title:x.value,onCancel:a[0]||(a[0]=e=>t.$emit("close")),"body-style":{padding:"16px",height:"90vh",display:"flex",flexDirection:"column"},class:"pivot-cell-detail-modal"},{default:n(()=>[i("div",G,[i("span",null,[a[1]||(a[1]=i("b",null,"Total:",-1)),d(" "+v(t.apiCalls.length),1)]),i("span",null,[a[2]||(a[2]=i("b",null,"Success Rate:",-1)),d(" "+v(P.value)+"%",1)]),i("span",null,[a[3]||(a[3]=i("b",null,"Avg Duration:",-1)),d(" "+v(I.value)+"ms",1)]),i("span",null,[a[4]||(a[4]=i("b",null,"Total Cost:",-1)),d(" $"+v(T.value),1)])]),h.value.length>0?(o(),u("div",Z,[(o(!0),u(p,null,f(h.value,t=>(o(),u("div",{key:t.key,class:"variable-filter"},[e(m,{value:g[t.key],"onUpdate:value":e=>g[t.key]=e,placeholder:`Filter ${t.title}`,allowClear:"",style:{width:"150px"},size:"small",onChange:$},{default:n(()=>[(o(!0),u(p,null,f(j(t.key),e=>(o(),s(l,{key:e,value:e},{default:n(()=>[d(v(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])]))),128)),_.value?(o(),s(y,{key:0,size:"small",onClick:A},{default:n(()=>a[5]||(a[5]=[d("Clear Filters")])),_:1,__:[5]})):c("",!0)])):c("",!0),e(w,{columns:k.value,"data-source":S.value,scroll:{x:1500,y:"calc(90vh - 140px)"},pagination:!1,size:"small","row-key":e=>e.id,class:"api-calls-table"},{bodyCell:n(({column:e,record:t})=>{return["status"===e.key?(o(),s(b,{key:0,color:O(t.status),style:{margin:"0"}},{default:n(()=>[d(v(t.status),1)]),_:2},1032,["color"])):"response"===e.key?(o(),u("span",{key:1,class:"response-cell",title:t.response},v((a=t.response,l=100,a?a.length<=l?a:a.slice(0,l)+"...":"")),9,J)):"cost"===e.key?(o(),u(p,{key:2},[d(v(0===t.cost?"-":`$${t.cost.toFixed(4)}`),1)],64)):e.key.startsWith("var_")?(o(),u("span",{key:3,class:"variable-cell",title:t[e.key]},v(t[e.key]||"-"),9,Q)):c("",!0)];var a,l}),_:1},8,["columns","data-source","row-key"])]),_:1},8,["title"])}}}),[["__scopeId","data-v-d1eba3c3"]]);"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const ee=()=>{};function te(e,t=200,a=!1,l=!0,s=!1){return function(e,t){return function(...a){return new Promise((l,s)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(l).catch(s)})}}(function(...e){let t,a,l,s,r,n,o=0,i=!0,u=ee;m(e[0])||"object"!=typeof e[0]?[l,s=!0,r=!0,n=!1]=e:({delay:l,trailing:s=!0,leading:r=!0,rejectOnCancel:n=!1}=e[0]);const c=()=>{t&&(clearTimeout(t),t=void 0,u(),u=ee)};return e=>{const d=g(l),v=Date.now()-o,p=()=>a=e();return c(),d<=0?(o=Date.now(),p()):(v>d&&(r||!i)?(o=Date.now(),p()):s&&(a=new Promise((e,a)=>{u=n?a:e,t=setTimeout(()=>{o=Date.now(),i=!0,e(p()),c()},Math.max(0,d-v))})),r||t||(t=setTimeout(()=>i=!0,d)),i=!1,a)}}(t,a,l,s),e)}const ae={class:"virtual-table"},le={class:"virtual-table"},se=["data-row-index","data-row-id"],re=A(t({__name:"VirtualTable",props:{columns:{},dataSource:{},rowHeight:{default:48},rowKey:{type:[String,Function],default:"id"},overscan:{default:5},showHeader:{type:Boolean,default:!0},getRowClass:{},minHeight:{default:"300px"},maxHeight:{default:"calc(100vh - 250px)"}},setup(e,{expose:t}){S(e=>({fb3a8ad6:e.minHeight,"5457a427":e.maxHeight}));const a=e,s=y(),r=y(),n=y(0),m=y(0),g=y(0);let P=null;const I=l(()=>a.dataSource.length*a.rowHeight),T=l(()=>{const e=Math.floor(n.value/a.rowHeight),t=Math.ceil((n.value+m.value)/a.rowHeight);return{start:Math.max(0,e-a.overscan),end:Math.min(a.dataSource.length,t+a.overscan)}}),O=l(()=>T.value.start),j=l(()=>a.dataSource.slice(T.value.start,T.value.end)),$=l(()=>O.value*a.rowHeight);function A(e){return"function"==typeof a.rowKey?a.rowKey(e):e[a.rowKey]}function F(e,t){return e[t.key]}function E(e){const t={};return e.width&&(t.width="number"==typeof e.width?`${e.width}px`:e.width),e.align&&(t.textAlign=e.align),t}const M=te(e=>{null!==P&&cancelAnimationFrame(P),P=requestAnimationFrame(()=>{const t=e.target;n.value=t.scrollTop,P=null})},16);let H=null;function z(){if(s.value){const e=s.value.querySelector(".virtual-content");m.value=e?e.clientHeight:s.value.clientHeight}r.value&&(g.value=r.value.offsetHeight)}function D(){if(s.value){const e=s.value.querySelector(".virtual-content");e&&(e.scrollTop=0)}}return h(()=>{z(),s.value&&(H=new ResizeObserver(()=>{z()}),H.observe(s.value))}),b(()=>{H&&H.disconnect(),null!==P&&cancelAnimationFrame(P)}),w(()=>a.dataSource.length,()=>{n.value>I.value&&D()}),t({scrollToRow:function(e){if(s.value){const t=s.value.querySelector(".virtual-content");if(t){const l=e*a.rowHeight;t.scrollTop=l}}},scrollToTop:D}),(e,t)=>(o(),u("div",{class:"virtual-table-container",ref_key:"containerRef",ref:s,"data-testid":"virtual-table",role:"table","aria-label":"Data table with virtual scrolling"},[e.showHeader?(o(),u("div",{key:0,class:"virtual-header",ref_key:"headerRef",ref:r},[i("table",ae,[i("thead",null,[i("tr",null,[(o(!0),u(p,null,f(e.columns,e=>(o(),u("th",{key:e.key,style:x(E(e)),class:k(e.className)},v(e.title),7))),128))])])])],512)):c("",!0),i("div",{class:"virtual-content",style:x({height:`calc(100% - ${g.value}px)`}),onScrollPassive:t[0]||(t[0]=(...e)=>C(M)&&C(M)(...e))},[i("div",{class:"virtual-spacer",style:x({height:I.value+"px"})},[i("div",{class:"virtual-viewport",style:x({transform:`translateY(${$.value}px)`})},[i("table",le,[i("tbody",null,[(o(!0),u(p,null,f(j.value,(t,a)=>(o(),u("tr",{key:A(t),"data-row-index":O.value+a,"data-row-id":A(t),class:k(e.getRowClass?e.getRowClass(t):""),"data-testid":"table-row",role:"row"},[(o(!0),u(p,null,f(e.columns,a=>(o(),u("td",{key:a.key,style:x(E(a)),class:k(a.className)},[_(e.$slots,"cell",{column:a,record:t,value:F(t,a)},()=>[d(v(F(t,a)),1)],!0)],6))),128))],10,se))),128))])])],4)],4)],36)],512))}}),[["__scopeId","data-v-c8787a4b"]]),ne={class:"execution-monitor","data-testid":"execution-monitor"},oe={key:0,class:"monitor-header"},ie={class:"header-left"},ue={key:0,class:"progress-summary"},ce={class:"progress-bar"},de={class:"progress-text"},ve={key:0,class:"time-estimate"},pe={key:1,class:"network-errors"},fe={key:0,class:"header-right"},me={class:"header-stats"},ge={class:"stat"},ye={class:"stat pending"},he={class:"stat running"},be={class:"stat completed"},we={class:"stat failed"},ke={key:0,class:"execution-controls"},xe={key:1,class:"monitor-tabs"},Ce={class:"monitor-filters"},_e={class:"pending-toggle"},Se={class:"monitor-content"},Pe={key:0,class:"empty-state"},Ie={class:"placeholder-content"},Te={key:1,class:"results-table"},Oe={key:0,class:"col-status"},je={key:1,class:"col-config"},$e={class:"config-info"},Ae={class:"model-name"},Fe={class:"provider-name"},Ee={key:2,class:"col-repeat"},Me={key:0,class:"repeat-info"},He={key:1,class:"repeat-placeholder"},ze={key:3,class:"col-variables"},De={class:"variables-list"},Re={class:"var-key"},Ue={class:"var-value"},Ve={key:0,class:"separator"},Ne={key:4,class:"col-response"},Ke={key:0,class:"response-placeholder"},Le={key:1,class:"response-placeholder"},qe={key:2,class:"response-error"},We={key:3,class:"response-content"},Be={key:4,class:"response-placeholder"},Ye={key:5,class:"col-time"},Ge={key:0,class:"time-info"},Ze={class:"duration"},Je={key:0,class:"latency"},Qe={key:1,class:"time-placeholder"},Xe={class:"pivot-container"},et={class:"pivot-wrapper"},tt={key:1,class:"empty-state"},at={key:2,class:"monitor-content"},lt={class:"empty-state"},st={key:0,class:"loading-state"},rt={key:1,class:"placeholder-content"},nt=A(t({__name:"ExecutionMonitor",props:{trialId:{},embedded:{type:Boolean}},setup(t){const a=t,m=y(null),g=y([]),_=y("all"),S=y(""),$=y(null),A=y("list"),V=l(()=>a.embedded||!1),N=y(!0),K=y(null),q=y(!0),W=l(()=>{const e=[{key:"status",title:"Status",width:120},{key:"config",title:"Config",width:150}];return m.value?.repeatConfig?.callsPerPrompt&&m.value.repeatConfig.callsPerPrompt>1&&e.push({key:"repeat",title:"Repeat",width:80}),e.push({key:"variables",title:"Variables",width:"30%"},{key:"response",title:"Response",width:"40%"},{key:"time",title:"Time",width:100}),e}),B=y({rowField:"",columnField:"model",valueField:"extracted_value",aggregation:"mean"}),G=y(null),Z=y([]),J=y(!1),Q=F();let ee=null,te=null,ae=null;const le=l(()=>{const e={total:0,pending:0,running:0,completed:0,failed:0};return g.value.forEach(t=>{e.total++,"completed"===t.status?e.completed++:"failed"===t.status?(e.failed++,e.completed++):e[t.status]++}),e}),se=l(()=>m.value&&0!==m.value.progress.total?m.value.progress.completed/m.value.progress.total*100:0),nt=l(()=>{if(!m.value||"running"!==m.value.status||!G.value)return null;const e=m.value.progress.completed,t=m.value.progress.total-e;if(0===e||t<=0)return null;const a=Z.value.slice(-10);if(a.length<2){return ft((Date.now()-G.value.getTime())/e*t)}let l=0,s=0;for(let r=1;r<a.length;r++){const e=a[r].time.getTime()-a[r-1].time.getTime(),t=a[r].completed-a[r-1].completed;if(t>0){const n=e/t,o=r/a.length;l+=n*o,s+=o}}if(0===s)return null;return ft(1.1*(l/s*t))}),ot=l(()=>{let e=g.value;if("all"!==_.value&&(e=e.filter(e=>e.status===_.value)),q.value||(e=e.filter(e=>"pending"!==e.status)),S.value.trim()){const t=S.value.toLowerCase();e=e.filter(e=>Object.values(e.variables).some(e=>e.toLowerCase().includes(t))||e.result?.content&&String(e.result.content).toLowerCase().includes(t)||e.result?.error&&e.result.error.toLowerCase().includes(t))}return e.sort((e,t)=>{const a=e=>"running"===e?1:"completed"===e||"failed"===e?2:"pending"===e?3:4,l=a(e.status),s=a(t.status);return l!==s?l-s:t.created.getTime()-e.created.getTime()})}),it=l(()=>m.value&&["running","paused","pending"].includes(m.value.status));function ut(e){return e.status}function ct(e){const t=e.target.closest("tr");if(t){const e=t.getAttribute("data-row-id"),a=ot.value.find(t=>t.id===e);a&&function(e){$.value=e}(a)}}function dt(e){if(!m.value||!m.value.configurationSnapshots[e])return"Unknown Model";return m.value.configurationSnapshots[e].modelId||"Unknown Model"}function vt(e){if(!m.value||!m.value.configurationSnapshots[e])return"Unknown Provider";return m.value.configurationSnapshots[e].provider||"Unknown Provider"}function pt(e,t){return e.length<=t?e:e.slice(0,t)+"..."}function ft(e){const t=Math.floor(e/1e3),a=Math.floor(t/60),l=Math.floor(a/60);if(l>0){return`${l}h ${a%60}m`}if(a>0){return`${a}m ${t%60}s`}return`${t}s`}async function mt(){if(m.value){J.value=!0;try{await Q.pauseTrial(m.value.id),M.info("Trial paused",{trialId:m.value.id})}catch(e){M.error("Failed to pause trial",e),H.error({title:"Failed to pause trial",content:e instanceof Error?e.message:"Unknown error"})}finally{J.value=!1}}}async function gt(){if(m.value){J.value=!0;try{await Q.executeTrial(m.value.id),M.info("Trial resumed",{trialId:m.value.id})}catch(e){M.error("Failed to resume trial",e),H.error({title:"Failed to resume trial",content:e instanceof Error?e.message:"Unknown error"})}finally{J.value=!1}}}function yt(){m.value&&H.confirm({title:"Cancel Trial Execution?",content:"This will permanently cancel the trial. You will not be able to resume it.",okText:"Yes, Cancel",okType:"danger",cancelText:"No, Keep Running",onOk:ht})}async function ht(){if(m.value){J.value=!0;try{await Q.cancelTrial(m.value.id),M.info("Trial cancelled",{trialId:m.value.id})}catch(e){M.error("Failed to cancel trial",e),H.error({title:"Failed to cancel trial",content:e instanceof Error?e.message:"Unknown error"})}finally{J.value=!1}}}function bt(e){B.value=e}function wt(e){if(!e.cell)return;const t=e.cell.apiCalls||[];if(0===t.length)return;const a=t.map(e=>{const t=m.value?.configurationSnapshots[e.configurationIndex];return{...e,model:t?.modelId||"Unknown Model",duration:e.response?.latencyMs,cost:e.response?.cost,extracted:e.result?.extracted,attributedVariables:e.attributedVariables}});K.value={row:e.row,column:e.column,apiCalls:a,value:e.cell.value}}async function kt(){if(m.value&&G.value&&"running"===m.value.status)try{await z.trialExecutionStates.put({trialId:m.value.id,startedAt:G.value,lastActivityAt:new Date,progressHistory:Z.value.map(e=>({time:e.time,completed:e.completed}))}),M.debug("Saved execution state",{trialId:m.value.id})}catch(e){M.error("Failed to save execution state",e)}}function xt(){ee&&(clearInterval(ee),ee=null)}function Ct(){te&&te.unsubscribe(),ae&&ae.unsubscribe(),te=j(()=>z.trials.get(a.trialId)).subscribe({next:async e=>{const t=m.value;if(m.value=e||null,N.value=!1,e&&("running"===e.status&&"running"!==t?.status&&(await async function(e){try{const t=await z.trialExecutionStates.get(e);t&&(G.value=t.startedAt,Z.value=t.progressHistory,M.info("Restored execution state",{trialId:e,historyLength:t.progressHistory.length}))}catch(t){M.error("Failed to restore execution state",t)}}(e.id),G.value||(G.value=new Date,Z.value=[{time:new Date,completed:e.progress.completed}]),xt(),ee=window.setInterval(()=>{kt()},5e3)),"running"===e.status&&t&&e.progress.completed>t.progress.completed&&(Z.value.push({time:new Date,completed:e.progress.completed}),Z.value.length>20&&(Z.value=Z.value.slice(-20)),await kt()),"running"!==e.status&&"running"===t?.status)){xt();try{await z.trialExecutionStates.delete(e.id)}catch(a){M.warn("Failed to clean up execution state",{error:a})}G.value=null,Z.value=[]}},error:e=>{M.error("Trial subscription error",e),N.value=!1}}),ae=j(()=>z.apiCalls.where("trialId").equals(a.trialId).toArray()).subscribe({next:e=>{g.value=e},error:e=>{M.error("API calls subscription error",e)}})}return w(()=>a.trialId,e=>{e&&(N.value=!0,Ct())},{immediate:!0}),w([_,S],()=>{}),h(()=>{Ct()}),b(()=>{xt(),kt(),te&&te.unsubscribe(),ae&&ae.unsubscribe()}),(t,a)=>{const l=r("a-tag"),y=r("a-button"),h=r("a-tab-pane"),b=r("a-tabs");return o(),u("div",ne,[V.value?c("",!0):(o(),u("div",oe,[i("div",ie,[i("h3",null,[d(v(m.value?.name||"Select a trial to monitor")+" ",1),m.value?.repeatConfig?.callsPerPrompt&&m.value.repeatConfig.callsPerPrompt>1?(o(),s(l,{key:0,size:"small",color:"purple",style:{"margin-left":"8px"}},{default:n(()=>[d(v(m.value.repeatConfig.callsPerPrompt)+"Ã— repeat ",1)]),_:1})):c("",!0)]),m.value?(o(),u("div",ue,[i("div",ce,[i("div",{class:"progress-fill",style:x({width:se.value+"%"})},null,4)]),i("span",de,[d(v(m.value.progress.completed)+" / "+v(m.value.progress.total)+" completed ",1),nt.value&&"running"===m.value.status?(o(),u("span",ve," â€¢ "+v(nt.value)+" remaining ",1)):c("",!0),m.value.progress.networkErrors>0?(o(),u("span",pe,"("+v(m.value.progress.networkErrors)+" network errors)",1)):c("",!0)])])):c("",!0)]),m.value?(o(),u("div",fe,[i("div",me,[i("span",ge,v(le.value.total)+" total",1),i("span",ye,v(le.value.pending)+" pending",1),i("span",he,v(le.value.running)+" running",1),i("span",be,v(le.value.completed)+" completed",1),i("span",we,v(le.value.failed)+" failed",1)]),it.value?(o(),u("div",ke,["running"===m.value.status?(o(),s(y,{key:0,size:"small",onClick:mt,loading:J.value,"data-testid":"btn-pause-trial"},{icon:n(()=>[e(C(L))]),default:n(()=>[a[6]||(a[6]=d(" Pause "))]),_:1,__:[6]},8,["loading"])):"paused"===m.value.status?(o(),s(y,{key:1,type:"primary",size:"small",onClick:gt,loading:J.value,"data-testid":"btn-resume-trial"},{icon:n(()=>[e(C(D))]),default:n(()=>[a[7]||(a[7]=d(" Resume "))]),_:1,__:[7]},8,["loading"])):c("",!0),"running"===m.value.status||"paused"===m.value.status?(o(),s(y,{key:2,danger:"",size:"small",onClick:yt,loading:J.value,"data-testid":"btn-cancel-trial"},{icon:n(()=>[e(C(Y))]),default:n(()=>[a[8]||(a[8]=d(" Cancel "))]),_:1,__:[8]},8,["loading"])):c("",!0)])):c("",!0)])):c("",!0)])),m.value?(o(),u("div",xe,[e(b,{activeKey:A.value,"onUpdate:activeKey":a[3]||(a[3]=e=>A.value=e),type:"card",size:"large"},{default:n(()=>[e(h,{key:"list"},{tab:n(()=>a[9]||(a[9]=[i("span",{style:{"font-size":"20px","font-weight":"500"}},"List View",-1)])),default:n(()=>[i("div",Ce,[P(i("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>_.value=e),class:"filter-select","data-testid":"filter-status","aria-label":"Filter by task status"},a[10]||(a[10]=[i("option",{value:"all"},"All Statuses",-1),i("option",{value:"pending"},"Pending",-1),i("option",{value:"running"},"Running",-1),i("option",{value:"completed"},"Completed",-1),i("option",{value:"failed"},"Failed",-1)]),512),[[I,_.value]]),P(i("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>S.value=e),type:"text",placeholder:"Search variables or response...",class:"search-input","data-testid":"input-search-tasks","aria-label":"Search tasks by variables or response content"},null,512),[[T,S.value]]),i("label",_e,[P(i("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=e=>q.value=e),"data-testid":"toggle-pending-calls"},null,512),[[O,q.value]]),i("span",null,"Show Pending ("+v(le.value.pending)+")",1)])]),i("div",Se,[0===ot.value.length?(o(),u("div",Pe,[i("div",Ie,[a[11]||(a[11]=i("h4",null,"No API Calls",-1)),i("p",null,v(0===le.value.total?"Start the trial to see API calls here.":"No API calls match the current filters."),1)])])):(o(),u("div",Te,[e(re,{columns:W.value,"data-source":ot.value,"row-height":60,overscan:10,"max-height":"calc(100vh - 350px)","get-row-class":ut,onClick:ct},{cell:n(({column:e,record:t})=>{return["status"===e.key?(o(),u("div",Oe,[i("span",{class:k(["status-badge",t.status])},v(t.status),3)])):"config"===e.key?(o(),u("div",je,[i("div",$e,[i("div",Ae,v(dt(t.configurationIndex)),1),i("div",Fe,v(vt(t.configurationIndex)),1)])])):"repeat"===e.key?(o(),u("div",Ee,[void 0!==t.repeatIndex?(o(),u("span",Me,v(t.repeatIndex+1)+"/"+v(m.value?.repeatConfig?.callsPerPrompt||1),1)):(o(),u("span",He,"â€”"))])):"variables"===e.key?(o(),u("div",ze,[i("div",De,[(o(!0),u(p,null,f(Object.entries(t.variables),([e,a],l)=>(o(),u("span",{key:e,class:"variable-pair"},[i("span",Re,v(e)+":",1),i("span",Ue,v(pt(String(a),30)),1),l<Object.entries(t.variables).length-1?(o(),u("span",Ve,"â€¢")):c("",!0)]))),128))])])):"response"===e.key?(o(),u("div",Ne,["pending"===t.status?(o(),u("div",Ke," Waiting... ")):"running"===t.status?(o(),u("div",Le," Processing... ")):"failed"===t.status?(o(),u("div",qe,v(t.result?.error||"API call failed"),1)):t.result?.content?(o(),u("div",We,v(pt(String(t.result.content),100)),1)):(o(),u("div",Be," No content "))])):"time"===e.key?(o(),u("div",Ye,[t.completed?(o(),u("div",Ge,[i("div",Ze,v((a=t.completed.getTime()-t.created.getTime(),a<1e3?`${a}ms`:`${(a/1e3).toFixed(1)}s`)),1),t.response?(o(),u("div",Je,v(t.response.latencyMs)+"ms",1)):c("",!0)])):(o(),u("div",Qe,"â€”"))])):c("",!0)];var a}),_:1},8,["columns","data-source"])]))])]),_:1}),e(h,{key:"pivot"},{tab:n(()=>a[12]||(a[12]=[i("span",{style:{"font-size":"20px","font-weight":"500"}},"Pivot Table",-1)])),default:n(()=>[i("div",Xe,[i("div",et,[g.value.length>0?(o(),s(U,{key:0,"api-calls":ot.value,trial:m.value,config:B.value,"show-totals":!0,onConfigChange:bt,onCellClick:wt},null,8,["api-calls","trial","config"])):(o(),u("div",tt,a[13]||(a[13]=[i("div",{class:"placeholder-content"},[i("h4",null,"No Data Available"),i("p",null,"Start the trial to see pivot table analysis.")],-1)])))])])]),_:1})]),_:1},8,["activeKey"])])):(o(),u("div",at,[i("div",lt,[N.value?(o(),u("div",st,[e(C(E),{size:"large"},{tip:n(()=>a[14]||(a[14]=[d("Loading trial data...")])),_:1})])):(o(),u("div",rt,a[15]||(a[15]=[i("h4",null,"No Trial Selected",-1),i("p",null,"Click on a trial card to monitor its execution progress and view results.",-1)])))])])),$.value?(o(),s(R,{key:3,"api-call":$.value,trial:m.value,onClose:a[4]||(a[4]=e=>$.value=null)},null,8,["api-call","trial"])):c("",!0),K.value?(o(),s(X,{key:4,row:K.value.row,column:K.value.column,"api-calls":K.value.apiCalls,trial:m.value,value:K.value.value,onClose:a[5]||(a[5]=e=>K.value=null)},null,8,["row","column","api-calls","trial","value"])):c("",!0)])}}}),[["__scopeId","data-v-4223ce02"]]);export{nt as E,Y as S};
