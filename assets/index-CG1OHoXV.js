import{i as e}from"./core-CZTvG38D.js";import{l as n}from"./event-yMW41Jxh.js";var a,r;async function o(n,a,r){const o=function(e){if(e){if(!e.startsWith("Error")){const n=e.split("\n").map(e=>e.split("@")).filter(([e,n])=>e.length>0&&"[native code]"!==n);return n[2]?.filter(e=>e.length>0).join("@")}{const n=e.split("\n"),a=n[3]?.trim();if(!a)return;const r=/at\s+(?<functionName>.*?)\s+\((?<fileName>.*?):(?<lineNumber>\d+):(?<columnNumber>\d+)\)/,o=a.match(r);if(o){const{functionName:e,fileName:n,lineNumber:a,columnNumber:r}=o.groups;return`${e}@${n}:${a}:${r}`}{const e=/at\s+(?<fileName>.*?):(?<lineNumber>\d+):(?<columnNumber>\d+)/,n=a.match(e);if(n){const{fileName:e,lineNumber:a,columnNumber:r}=n.groups;return`<anonymous>@${e}:${a}:${r}`}}}}}((new Error).stack),{file:t,line:c,keyValues:i}=r??{};await e("plugin:log|log",{level:n,message:a,location:o,file:t,line:c,keyValues:i})}async function t(e,n){await o(a.Error,e,n)}async function c(e,n){await o(a.Warn,e,n)}async function i(e,n){await o(a.Info,e,n)}async function l(e,n){await o(a.Debug,e,n)}async function s(e,n){await o(a.Trace,e,n)}async function u(e){return await n("log://log",n=>{const{level:a}=n.payload;let{message:r}=n.payload;r=r.replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,""),e({message:r,level:a})})}async function f(){return await u(({level:e,message:n})=>{switch(e){case a.Trace:case a.Debug:break;case a.Info:console.info(n);break;case a.Warn:console.warn(n);break;case a.Error:console.error(n);break;default:throw new Error(`unknown log level ${e}`)}})}(r=a||(a={}))[r.Trace=1]="Trace",r[r.Debug=2]="Debug",r[r.Info=3]="Info",r[r.Warn=4]="Warn",r[r.Error=5]="Error";export{a as LogLevel,f as attachConsole,u as attachLogger,l as debug,t as error,i as info,s as trace,c as warn};
