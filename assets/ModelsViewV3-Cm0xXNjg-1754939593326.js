const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BMvx8pDm-1754939593326.js","assets/index-Rfcl7loQ-1754939611421.css"])))=>i.map(i=>d[i]);
import{b as p,I as je,d as q,aA as Ne,r as P,c as V,p as $t,i as de,j as b,m as s,k as e,v as T,t as c,x as O,y as B,F as Q,A as le,z as f,D as w,q as F,_ as ce,aa as ne,aB as ue,ah as ge,J as Oe,aC as He,a as U,B as ze,w as Mt,C as Le,n as Se,E as Qe,aD as qe,L as Ke,u as We,aE as Je,U as zt,am as Ot,s as Ue,aF as St,aG as Tt,a2 as Pt,o as Bt,aH as Et,aI as Ie,aJ as xt,ak as Dt,M as Gt}from"./index-BMvx8pDm-1754939593326.js";import{u as Xe}from"./useV4Models-nxkTzANI-1754939593326.js";import{u as Ye}from"./useV4ProviderParameters-BFdFaAVG-1754939593326.js";import{F as Rt}from"./FilterOutlined-KFHUVo07-1754939593326.js";import{U as Ze}from"./UnorderedListOutlined-Bf7KYr5Q-1754939593326.js";import{S as At}from"./SaveOutlined-CElnwaWh-1754939593326.js";import"./useV4LiveQuery-CJ-qgrFo-1754939593326.js";var Lt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zM464 544H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H212V612h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200z"}}]},name:"appstore",theme:"outlined"};function Fe(k){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?Object(arguments[t]):{},l=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(u){return Object.getOwnPropertyDescriptor(a,u).enumerable}))),l.forEach(function(u){Ut(k,u,a[u])})}return k}function Ut(k,t,a){return t in k?Object.defineProperty(k,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):k[t]=a,k}var Te=function(t,a){var l=Fe({},t,a.attrs);return p(je,Fe({},l,{icon:Lt}),null)};Te.displayName="AppstoreOutlined";Te.inheritAttrs=!1;var It={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};function Ve(k){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?Object(arguments[t]):{},l=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(u){return Object.getOwnPropertyDescriptor(a,u).enumerable}))),l.forEach(function(u){Ft(k,u,a[u])})}return k}function Ft(k,t,a){return t in k?Object.defineProperty(k,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):k[t]=a,k}var Pe=function(t,a){var l=Ve({},t,a.attrs);return p(je,Ve({},l,{icon:It}),null)};Pe.displayName="UploadOutlined";Pe.inheritAttrs=!1;class Vt{async bulkWrite(t,a,l="put"){a.length!==0&&await q.transaction("rw",q[t],async()=>{switch(l){case"put":await q[t].bulkPut(a);break;case"add":await q[t].bulkAdd(a);break;case"update":const u=a.map($=>q[t].update($.id,$));await Promise.all(u);break}})}async bulkDelete(t,a){a.length!==0&&await q.transaction("rw",q[t],async()=>{await q[t].bulkDelete(a)})}async conditionalBulkUpdate(t,a,l){let u=0;return await q.transaction("rw",q[t],async()=>{await q[t].toCollection().modify($=>{a($)&&(Object.assign($,l),u++)})}),u}freezeDeep(t){const a=t.map(l=>Object.freeze(l));return Object.freeze(a)}async getAndFreeze(t,a){const l=await q[t].get(a);return l?Object.freeze(l):null}async getAllAndFreeze(t){const a=await q[t].toArray();return this.freezeDeep(a)}}const we=new Vt;class jt{async bulkUpsertModels(t){t.length!==0&&await q.transaction("rw",q.models,async()=>{const a=t.map(l=>Object.freeze({...l,enabled:l.enabled??!1,available:l.available??!0}));await q.models.bulkPut(a)})}async clearProviderModels(t){return await q.transaction("rw",q.models,async()=>{const u=(await q.models.where("provider").equals(t).toArray()).map($=>$.id);return u.length>0&&await q.models.bulkDelete(u),u.length})}async toggleModelEnabled(t,a){return await q.models.update(t,{enabled:a})===1}async toggleProviderModels(t,a){return await we.conditionalBulkUpdate("models",l=>l.provider===t,{enabled:a})}async toggleAllModels(t){return await we.conditionalBulkUpdate("models",()=>!0,{enabled:t})}async getModelStatistics(){const t=await q.models.toArray(),a={total:t.length,enabled:0,byProvider:{}};for(const l of t)l.enabled&&a.enabled++,a.byProvider[l.provider]||(a.byProvider[l.provider]={total:0,enabled:0}),a.byProvider[l.provider].total++,l.enabled&&a.byProvider[l.provider].enabled++;return Object.freeze(a)}async updateModelAvailability(t,a){return await we.conditionalBulkUpdate("models",l=>l.provider===t,{available:a})}async searchModels(t){let a=q.models.toCollection();if(t.provider&&(a=q.models.where("provider").equals(t.provider)),t.enabled!==void 0&&(a=a.and(u=>u.enabled===t.enabled)),t.available!==void 0&&(a=a.and(u=>u.available===t.available)),t.search){const u=t.search.toLowerCase();a=a.and($=>$.displayName.toLowerCase().includes(u)||$.modelId.toLowerCase().includes(u))}const l=await a.toArray();return we.freezeDeep(l)}async clearAllModels(){await q.models.clear()}}const Nt=new jt;function Ht(){const k=Ne(),t=P(!1),a=P(null),l=P(!1),u=P(!1);async function $(_,r){t.value=!0,r&&(r.value=!0),a.value=null;try{return{ok:!0,value:await _()}}catch(o){const d=o instanceof Error?o:new Error(String(o));return a.value=d,{ok:!1,error:d}}finally{t.value=!1,r&&(r.value=!1)}}async function E(_){return $(()=>k.discoverModels(_),l)}async function R(_){return $(()=>k.refreshModelSource(_),l)}async function y(_,r){return $(async()=>{await k.toggleModel(_,r)},u)}async function h(_){return $(async()=>{await k.toggleAllModels(_)},u)}async function i(_,r){return $(async()=>{await k.toggleProviderModels(_,r)},u)}async function z(){return $(async()=>{await k.enableOpenRouterFavorites()},u)}async function I(){return $(async()=>{await k.clearAllModels()})}async function v(_,r){return $(async()=>{await Nt.updateModelAvailability(_,r)})}return{discoverModels:E,refreshDiscoverySource:R,toggleModel:y,toggleAllModels:h,toggleProviderModels:i,enableOpenRouterFavorites:z,clearAllModels:I,updateModelAvailability:v,isExecuting:t,lastError:a,isDiscovering:l,isTogglingModels:u}}function et(){const k=Ne(),t=P([]),a=P(!1),l=P([]);function u(){const R=k.getDiscoveryStatus();t.value=R.map(y=>({id:y.id,status:y.status==="loading"?"loading":y.status==="idle"?"success":y.status,modelCount:y.modelCount,error:y.error})),a.value=k.isDiscovering(),l.value=k.getDiscoveryErrors()}function $(R){return{litellm:"LiteLLM",openrouter:"OpenRouter",ollama:"Ollama",deterministic:"Deterministic"}[R]||R}function E(R){const y=$t.getProvider(R);return(y==null?void 0:y.name)||R}return u(),{discoveryStatus:V(()=>t.value),isDiscovering:V(()=>a.value),discoveryErrors:V(()=>l.value),getSourceDisplayName:$,getProviderDisplayName:E,refreshStatus:u}}const Qt={class:"search-section"},qt={class:"search-controls"},Kt={class:"size-filter"},Wt={class:"size-controls"},Jt={class:"size-presets"},Xt={key:0,class:"size-filter-indicator"},Yt={class:"quantized-filter"},Zt={class:"filter-description"},es={class:"category-filters"},ts=de({__name:"OllamaSearchFilters",props:{searchQuery:{},sortBy:{},selectedCategories:{},maxSizeGB:{},showQuantized:{type:Boolean},categories:{}},emits:["update:searchQuery","update:sortBy","update:maxSizeGB","update:showQuantized","toggle-category"],setup(k,{emit:t}){const a=k,l=t,u=V({get:()=>a.searchQuery,set:h=>l("update:searchQuery",h)}),$=V({get:()=>a.sortBy,set:h=>l("update:sortBy",h)}),E=V({get:()=>a.maxSizeGB,set:h=>l("update:maxSizeGB",h)}),R=V({get:()=>a.showQuantized,set:h=>l("update:showQuantized",h)}),y=[{label:"1GB",value:1},{label:"2GB",value:2},{label:"4GB",value:4},{label:"8GB",value:8},{label:"16GB",value:16},{label:"None",value:999}];return(h,i)=>{const z=T("a-input-search"),I=T("a-select-option"),v=T("a-select"),_=T("a-input-number"),r=T("a-button"),o=T("a-tag");return s(),b("div",Qt,[e("div",qt,[p(z,{value:u.value,"onUpdate:value":i[0]||(i[0]=d=>u.value=d),placeholder:"Search models by name or description...","allow-clear":"",size:"large",class:"search-input"},null,8,["value"]),p(v,{value:$.value,"onUpdate:value":i[1]||(i[1]=d=>$.value=d),placeholder:"Sort by",style:{width:"180px"},size:"large"},{default:c(()=>[p(I,{value:"popularity"},{default:c(()=>i[4]||(i[4]=[O("Popularity")])),_:1,__:[4]}),p(I,{value:"lastUpdated"},{default:c(()=>i[5]||(i[5]=[O("Last Updated")])),_:1,__:[5]}),p(I,{value:"name"},{default:c(()=>i[6]||(i[6]=[O("Name")])),_:1,__:[6]}),p(I,{value:"tagCount"},{default:c(()=>i[7]||(i[7]=[O("Tag Count")])),_:1,__:[7]})]),_:1},8,["value"])]),e("div",Kt,[e("div",Wt,[i[8]||(i[8]=e("span",{class:"filter-label"},"Filter to models smaller than:",-1)),p(_,{value:E.value,"onUpdate:value":i[2]||(i[2]=d=>E.value=d),min:1,max:999,step:1,size:"small",class:"size-input","addon-after":"GB"},null,8,["value"]),e("div",Jt,[(s(),b(Q,null,le(y,d=>p(r,{key:d.value,size:"small",type:E.value===d.value?"primary":"default",onClick:m=>E.value=d.value,class:"preset-button"},{default:c(()=>[O(f(d.label),1)]),_:2},1032,["type","onClick"])),64))])]),E.value<999?(s(),b("span",Xt," â‰¤"+f(E.value)+"GB filter active ",1)):B("",!0)]),e("div",Yt,[p(r,{type:R.value?"default":"primary",size:"small",onClick:i[3]||(i[3]=d=>R.value=!R.value)},{icon:c(()=>[p(w(Rt))]),default:c(()=>[O(" "+f(R.value?"Hide":"Show")+" Quantized Versions ",1)]),_:1},8,["type"]),e("span",Zt,f(R.value?"Showing all versions":"Hiding q2_K, q3_K, q4_0, q5_1, q6_K, q8_0, fp16..."),1)]),e("div",es,[(s(!0),b(Q,null,le(h.categories,d=>(s(),F(o,{key:d,color:h.selectedCategories.includes(d)?"blue":"default",checkable:!0,checked:h.selectedCategories.includes(d),onClick:m=>h.$emit("toggle-category",d),class:"category-tag"},{default:c(()=>[O(f(d),1)]),_:2},1032,["color","checked","onClick"]))),128))])])}}}),ss=ce(ts,[["__scopeId","data-v-a03d8794"]]),as={key:0,class:"downloads-section"},ls={class:"download-items"},os={class:"download-info"},ns={class:"download-tag"},rs={class:"download-status"},is=de({__name:"OllamaDownloadProgress",props:{pullProgress:{}},setup(k){return(t,a)=>{const l=T("a-progress");return Object.keys(t.pullProgress).length>0?(s(),b("div",as,[a[0]||(a[0]=e("h4",null,"Active Downloads",-1)),e("div",ls,[(s(!0),b(Q,null,le(t.pullProgress,(u,$)=>(s(),b("div",{key:$,class:"download-item"},[e("div",os,[e("code",ns,f($),1),e("span",rs,f(u.message),1)]),p(l,{percent:u.percent,status:u.status==="success"?"success":"active",size:"small",class:"download-progress"},null,8,["percent","status"])]))),128))])])):B("",!0)}}}),us=ce(is,[["__scopeId","data-v-88ba3f68"]]),ds={class:"model-info"},cs={class:"model-name"},ps={key:0},ms={class:"model-description"},vs={class:"model-actions"},fs={key:0,class:"button-size-info"},gs={key:0,class:"tags-preview"},ys={class:"preview-tags"},_s=["onClick","title"],bs={key:1,class:"tag-actual"},hs={class:"tag-size"},ws={key:0,class:"more-tags"},ks={key:1,class:"tags-expanded"},Cs={key:0,class:"tag-name"},$s={key:2},Ms={key:1,class:"text-secondary"},zs=de({__name:"OllamaModelCard",props:{model:{},expanded:{type:Boolean},pullingModels:{},pullProgress:{},installedModels:{},maxSizeGB:{},showQuantized:{type:Boolean},isQuantizedTag:{type:Function},parseSizeToGB:{type:Function},getSizeClass:{type:Function},getLatestTagInfo:{type:Function}},emits:["toggle-expand","pull-model"],setup(k){const t=k,a=[{title:"Tag",key:"name",width:200},{title:"Size",key:"size",width:100,align:"right"},{title:"Context",key:"context",width:100,align:"center"},{title:"Status",key:"status",width:80,align:"center"},{title:"Action",key:"actions",width:80,align:"center"}],l=V(()=>t.installedModels.some(d=>d.startsWith(t.model.name))),u=V(()=>t.installedModels.filter(d=>d.startsWith(t.model.name+":")).length),$=V(()=>v(`${t.model.name}:latest`)||v(t.model.name)),E=V(()=>t.pullingModels.has(`${t.model.name}:latest`)),R=V(()=>t.pullProgress[`${t.model.name}:latest`]),y=V(()=>t.getLatestTagInfo(t.model)),h=V(()=>t.maxSizeGB<999||!t.showQuantized),i=V(()=>t.model.tags?Object.entries(t.model.tags).map(([d,m])=>({...m,name:d})).filter(d=>!(t.maxSizeGB<999&&t.parseSizeToGB(d.size||"0GB")>t.maxSizeGB||!t.showQuantized&&t.isQuantizedTag(d.name))).sort((d,m)=>d.name.localeCompare(m.name)):[]),z=V(()=>i.value.length),I=V(()=>i.value.sort((m,M)=>{const x=["latest","instruct","8b","7b","3b","1b"],D=x.indexOf(m.name),C=x.indexOf(M.name);return D!==-1&&C!==-1?D-C:D!==-1?-1:C!==-1?1:m.name.localeCompare(M.name)}).slice(0,5));function v(d){return t.installedModels.includes(d)}function _(d){return t.pullingModels.has(d)}function r(d){return t.pullProgress[d]}const o=V(()=>{const d=y.value;return d?{actualTag:d.actualTag||"",size:d.size||""}:null});return(d,m)=>{const M=T("a-tag"),x=T("a-button"),D=T("a-table");return s(),b("div",{class:ne(["model-item",{expanded:d.expanded}])},[e("div",{class:"model-header",onClick:m[2]||(m[2]=C=>d.$emit("toggle-expand"))},[e("div",ds,[e("div",cs,[e("h4",null,f(d.model.name),1),p(M,{size:"small",color:"blue"},{default:c(()=>[O(f(d.model.pullCount||"0")+" pulls",1)]),_:1}),p(M,{size:"small",color:"green"},{default:c(()=>[O(f(z.value)+" ",1),h.value?(s(),b("span",ps,"/"+f(d.model.tagCount||0),1)):B("",!0),m[3]||(m[3]=O(" versions "))]),_:1,__:[3]}),l.value?(s(),F(M,{key:0,size:"small",color:"success",class:"installed-tag"},{icon:c(()=>[p(w(ue))]),default:c(()=>[O(" "+f(u.value)+" installed ",1)]),_:1})):B("",!0)]),e("p",ms,f(d.model.description||"No description available"),1)]),e("div",vs,[p(x,{type:$.value?"default":"primary",size:"small",onClick:m[0]||(m[0]=ge(C=>d.$emit("pull-model",d.model.name,"latest"),["stop"])),loading:E.value,disabled:$.value},{default:c(()=>[R.value?(s(),b(Q,{key:0},[O(f(Math.round(R.value.percent))+"% ",1)],64)):$.value?(s(),b(Q,{key:1},[p(w(ue)),m[4]||(m[4]=O(" Installed "))],64)):(s(),b(Q,{key:2},[m[5]||(m[5]=O(" Pull Latest ")),o.value?(s(),b("span",fs," ("+f(o.value.actualTag?o.value.actualTag+", ":"")+f(o.value.size)+") ",1)):B("",!0)],64))]),_:1},8,["type","loading","disabled"]),p(x,{type:"text",size:"small",onClick:m[1]||(m[1]=ge(C=>d.$emit("toggle-expand"),["stop"]))},{icon:c(()=>[d.expanded?(s(),F(w(He),{key:1})):(s(),F(w(Oe),{key:0}))]),default:c(()=>[O(" "+f(d.expanded?"Hide versions":"See all versions"),1)]),_:1})])]),d.expanded?B("",!0):(s(),b("div",gs,[e("div",ys,[(s(!0),b(Q,null,le(I.value,C=>(s(),b("span",{key:C.name,class:ne(["tag-chip",[d.getSizeClass(C.size),{installed:v(C.fullTag)}]]),onClick:S=>v(C.fullTag)?null:d.$emit("pull-model",d.model.name,C.name),title:`${C.fullTag} - ${C.size}${v(C.fullTag)?" (Installed)":""}`},[v(C.fullTag)?(s(),F(w(ue),{key:0,class:"installed-icon"})):B("",!0),O(" "+f(C.name)+" ",1),C.name==="latest"&&o.value?(s(),b("span",bs," ("+f(o.value.actualTag)+") ",1)):B("",!0),e("span",hs,f(C.size),1)],10,_s))),128)),z.value>5?(s(),b("span",ws," +"+f(z.value-5)+" more versions ",1)):B("",!0)])])),d.expanded?(s(),b("div",ks,[p(D,{columns:a,"data-source":i.value,pagination:!1,size:"small",scroll:{y:300},class:"tags-table"},{bodyCell:c(({column:C,record:S})=>[C.key==="name"?(s(),b("code",Cs,f(S.name),1)):B("",!0),C.key==="size"?(s(),b("span",{key:1,class:ne(["tag-size",d.getSizeClass(S.size)])},f(S.size),3)):B("",!0),C.key==="context"?(s(),b("span",$s,f(S.contextWindow),1)):B("",!0),C.key==="status"?(s(),b(Q,{key:3},[v(S.fullTag)?(s(),F(M,{key:0,size:"small",color:"success"},{default:c(()=>[p(w(ue)),m[6]||(m[6]=O(" Installed "))]),_:1,__:[6]})):(s(),b("span",Ms,"-"))],64)):B("",!0),C.key==="actions"?(s(),F(x,{key:4,type:v(S.fullTag)?"default":"primary",size:"small",onClick:N=>d.$emit("pull-model",d.model.name,S.name),loading:_(S.fullTag),disabled:v(S.fullTag)},{default:c(()=>[r(S.fullTag)?(s(),b(Q,{key:0},[O(f(Math.round(r(S.fullTag).percent))+"% ",1)],64)):v(S.fullTag)?(s(),b(Q,{key:1},[p(w(ue)),m[7]||(m[7]=O(" Installed "))],64)):(s(),b(Q,{key:2},[O(" Pull ")],64))]),_:2},1032,["type","onClick","loading","disabled"])):B("",!0)]),_:1},8,["data-source"])])):B("",!0)],2)}}}),Os=ce(zs,[["__scopeId","data-v-83727817"]]),Ss={class:"list-view"},Ts={class:"expanded-tags-container"},Ps={class:"expanded-tags-grid"},Bs={class:"tag-name"},Es={key:0,class:"tag-actual"},xs={class:"tag-size"},Ds={class:"tag-context"},Gs={key:0,class:"model-name-cell"},Rs={key:1,class:"description-cell"},As={key:2,class:"stats-cell"},Ls={class:"stat-item"},Us={class:"stat-item"},Is={key:0},Fs={key:3,class:"size-range"},Vs=de({__name:"OllamaModelList",props:{models:{},expandedModels:{},pullingModels:{},pullProgress:{},installedModels:{},maxSizeGB:{},showQuantized:{type:Boolean},isQuantizedTag:{type:Function},parseSizeToGB:{type:Function},getSizeClass:{type:Function},getLatestTagInfo:{type:Function},getModelSizeRange:{type:Function}},emits:["toggle-model","pull-model","expand"],setup(k){const t=k,a=[{title:"Model",key:"name",width:200,fixed:"left"},{title:"Description",key:"description",ellipsis:!0},{title:"Stats",key:"stats",width:200},{title:"Size Range",key:"sizeRange",width:120,align:"center"},{title:"Actions",key:"actions",width:220,align:"center",fixed:"right"}];function l(y){return y.tags?Object.entries(y.tags).map(([h,i])=>({...i,name:h})).filter(h=>!(t.maxSizeGB<999&&t.parseSizeToGB(h.size||"0GB")>t.maxSizeGB||!t.showQuantized&&t.isQuantizedTag(h.name))).sort((h,i)=>h.name.localeCompare(i.name)):[]}function u(y){return y.tags?Object.entries(y.tags).filter(([h,i])=>!(t.maxSizeGB<999&&t.parseSizeToGB(i.size||"0GB")>t.maxSizeGB||!t.showQuantized&&t.isQuantizedTag(h))).length:0}function $(y){return t.installedModels.some(h=>h.startsWith(y))}function E(y){return t.installedModels.includes(y)}function R(y){return t.installedModels.filter(h=>h.startsWith(y+":"))}return(y,h)=>{const i=T("a-tag"),z=T("a-button"),I=T("a-space"),v=T("a-table");return s(),b("div",Ss,[p(v,{"data-source":y.models,columns:a,pagination:!1,"row-key":_=>_.name,size:"small",scroll:{y:"calc(100% - 48px)"},"expanded-row-keys":y.expandedModels,"expand-row-by-click":!1,onExpand:h[0]||(h[0]=(_,r)=>y.$emit("expand",_,r)),class:"models-list-table"},{expandedRowRender:c(({record:_})=>[e("div",Ts,[e("div",Ps,[(s(!0),b(Q,null,le(l(_),r=>{var o;return s(),b("div",{key:r.fullTag,class:ne(["expanded-tag-item",y.getSizeClass(r.size)])},[e("span",Bs,f(r.name),1),r.name==="latest"&&y.getLatestTagInfo(_)?(s(),b("span",Es," ("+f((o=y.getLatestTagInfo(_))==null?void 0:o.actualTag)+") ",1)):B("",!0),e("span",xs,f(r.size),1),e("span",Ds,f(r.contextWindow||"-"),1),E(r.fullTag)?(s(),F(i,{key:1,size:"small",color:"success"},{default:c(()=>[p(w(ue)),h[1]||(h[1]=O(" Installed "))]),_:1,__:[1]})):(s(),F(z,{key:2,type:"primary",size:"small",loading:y.pullingModels.has(r.fullTag),onClick:d=>y.$emit("pull-model",_.name,r.name)},{default:c(()=>[y.pullProgress[r.fullTag]?(s(),b(Q,{key:0},[O(f(Math.round(y.pullProgress[r.fullTag].percent))+"% ",1)],64)):(s(),b(Q,{key:1},[O(" Pull ")],64))]),_:2},1032,["loading","onClick"]))],2)}),128))])])]),bodyCell:c(({column:_,record:r})=>[_.key==="name"?(s(),b("div",Gs,[e("code",null,f(r.name),1),$(r.name)?(s(),F(i,{key:0,size:"small",color:"success"},{default:c(()=>[p(w(ue)),O(" "+f(R(r.name).length)+" installed ",1)]),_:2},1024)):B("",!0)])):B("",!0),_.key==="description"?(s(),b("span",Rs,f(r.description||"No description"),1)):B("",!0),_.key==="stats"?(s(),b("div",As,[e("span",Ls,f(r.pullCount||"0")+" pulls",1),h[3]||(h[3]=e("span",{class:"stat-divider"},"â€¢",-1)),e("span",Us,[O(f(u(r))+" ",1),y.maxSizeGB<999||!y.showQuantized?(s(),b("span",Is,"/"+f(r.tagCount||0),1)):B("",!0),h[2]||(h[2]=O(" versions "))])])):B("",!0),_.key==="sizeRange"?(s(),b("span",Fs,f(y.getModelSizeRange(r)),1)):B("",!0),_.key==="actions"?(s(),F(I,{key:4,size:"small"},{default:c(()=>[p(z,{type:"text",size:"small",onClick:o=>y.$emit("toggle-model",r.name)},{icon:c(()=>[y.expandedModels.includes(r.name)?(s(),F(w(He),{key:1})):(s(),F(w(Oe),{key:0}))]),default:c(()=>[O(" "+f(y.expandedModels.includes(r.name)?"Hide":"See")+" Versions ",1)]),_:2},1032,["onClick"]),p(z,{type:E(`${r.name}:latest`)||E(r.name)?"default":"primary",size:"small",onClick:o=>y.$emit("pull-model",r.name,"latest"),loading:y.pullingModels.has(`${r.name}:latest`),disabled:E(`${r.name}:latest`)||E(r.name)},{default:c(()=>[y.pullProgress[`${r.name}:latest`]?(s(),b(Q,{key:0},[O(f(Math.round(y.pullProgress[`${r.name}:latest`].percent))+"% ",1)],64)):E(`${r.name}:latest`)||E(r.name)?(s(),F(w(ue),{key:1})):(s(),b(Q,{key:2},[O(" Pull Latest ")],64))]),_:2},1032,["type","onClick","loading","disabled"])]),_:2},1024)):B("",!0)]),_:1},8,["data-source","row-key","expanded-row-keys"])])}}}),js=ce(Vs,[["__scopeId","data-v-7d1c26f3"]]);async function be(k,t={}){var y,h;const l=`http://localhost:11434${k}`,u=window.location.protocol==="https:",$=t.timeout||3e4,E=new AbortController,R=setTimeout(()=>E.abort(),$);try{const i=await fetch(l,{...t,signal:E.signal,headers:{"Content-Type":"application/json",...t.headers}});return clearTimeout(R),i}catch(i){clearTimeout(R);const z=new Error;throw z.isHttps=u,i.name==="AbortError"?(z.type="timeout",z.message="Request to Ollama timed out",z.details=`The request took longer than ${$/1e3} seconds`):(y=i.message)!=null&&y.includes("Failed to fetch")||(h=i.message)!=null&&h.includes("NetworkError")?u?(z.type="cors",z.message="Cannot connect to Ollama from HTTPS site",z.details="Browser security prevents HTTPS sites from accessing local HTTP services. To use Ollama: 1) Download the desktop app, 2) Run Auditomatic locally, or 3) Configure Ollama with OLLAMA_ORIGINS=*"):(z.type="network",z.message="Cannot connect to Ollama",z.details="Make sure Ollama is running on your computer (http://localhost:11434)"):(z.type="unknown",z.message=i.message||"Unknown error connecting to Ollama",z.details=i.stack),U.warn("Ollama fetch error",{type:z.type,endpoint:k,isHttps:u,originalError:i.message}),z}}async function Ns(){try{return{available:(await be("/api/tags",{timeout:5e3})).ok}}catch(k){return{available:!1,error:k}}}async function Hs(){var k,t,a;U.warn("[CORS DEBUG] Starting detectOllamaCORSIssue..."),U.warn("[CORS DEBUG] Current origin:",window.location.origin);try{const l="http://localhost:11434/api/tags";U.warn("[CORS DEBUG] Attempting fetch to:",l);const u=await fetch(l,{method:"GET",headers:{Accept:"application/json"}});return U.warn("[CORS DEBUG] Fetch successful, response ok:",u.ok),{hasCORSIssue:!1,canConnect:!0}}catch(l){if(U.warn("[CORS DEBUG] Fetch failed with error:",l.message),U.warn("[CORS DEBUG] Error type:",l.name),(k=l.message)!=null&&k.includes("Failed to fetch")||(t=l.message)!=null&&t.includes("NetworkError")||(a=l.message)!=null&&a.includes("CORS")||l.name==="TypeError"){U.warn("[CORS DEBUG] Detected potential CORS/network error, checking server availability...");try{const u=new Image,$=new Promise((R,y)=>{u.onload=()=>{U.warn("[CORS DEBUG] Image loaded - server is responding"),R("server_up")},u.onerror=()=>{U.warn("[CORS DEBUG] Image failed - likely CORS or server down"),y("image_failed")},u.src="http://localhost:11434/favicon.ico?"+Date.now()}),E=new Promise((R,y)=>setTimeout(()=>{U.warn("[CORS DEBUG] Image test timeout"),y("timeout")},3e3));return await Promise.race([$,E]),U.warn("[CORS DEBUG] Server appears to be up, API failed - CORS issue likely"),{hasCORSIssue:!0,canConnect:!0,error:`Ollama is running but CORS is not configured to allow requests from ${window.location.origin}. Set OLLAMA_ORIGINS=* in your Ollama service configuration.`}}catch(u){return U.warn("[CORS DEBUG] Image test also failed:",u),{hasCORSIssue:!1,canConnect:!1,error:"Cannot connect to Ollama - server may not be running"}}}return U.warn("[CORS DEBUG] Unknown error type"),{hasCORSIssue:!1,canConnect:!1,error:l.message||"Unknown connection error"}}}async function Qs(){const k=await be("/api/tags");if(!k.ok)throw new Error(`Failed to fetch models: ${k.status} ${k.statusText}`);return k.json()}async function qs(k){const t=await be("/api/delete",{method:"DELETE",body:JSON.stringify({name:k})});if(!t.ok)throw new Error(`Failed to delete model: ${t.status} ${t.statusText}`)}function Ks(){const k=P(null),t=P(!1),a=P(""),l=P(new Set),u=P({}),$=P([]);async function E(){t.value=!0,a.value="";try{const m=await fetch("https://ollama.models.auditomatic.org/models.json");if(!m.ok)throw new Error(`Failed to fetch models: ${m.statusText}`);k.value=await m.json(),await R()}catch(m){a.value=`Failed to load model library: ${m instanceof Error?m.message:"Unknown error"}`}finally{t.value=!1}}async function R(){try{const m=await be("/api/tags");if(m.ok){const M=await m.json();$.value=(M.models||[]).map(x=>x.name)}}catch(m){const M=m;M.type==="cors"&&M.isHttps&&U.debug("Cannot access Ollama from HTTPS site"),$.value=[]}}async function y(m,M,x){var C;const D=M==="latest"?m:`${m}:${M}`;if(!l.value.has(D)){l.value.add(D),u.value[D]={percent:0,status:"active",message:"Starting download..."};try{const S=await be("/api/pull",{method:"POST",body:JSON.stringify({name:D,stream:!0})});if(!S.ok)throw new Error(`Failed to pull model: ${S.statusText}`);const N=(C=S.body)==null?void 0:C.getReader();if(!N)throw new Error("Unable to read response stream");let J=0,j=0;for(;;){const{done:X,value:pe}=await N.read();if(X)break;const ye=new TextDecoder().decode(pe).split(`
`).filter(oe=>oe.trim());for(const oe of ye)try{const A=JSON.parse(oe);A.total&&(J=A.total),A.completed&&(j=A.completed);const G=J>0?Math.round(j/J*100):0;if(u.value[D]={status:A.status==="success"?"success":"active",percent:G,message:A.status||"Downloading..."},A.status==="success"){ze.success(`Successfully pulled ${D}`),await R(),x==null||x(),setTimeout(()=>{delete u.value[D]},3e3);return}}catch{}}}catch(S){const N=S;let J=S instanceof Error?S.message:"Unknown error";N.type==="cors"&&N.isHttps&&(J="Cannot access Ollama from HTTPS site. Please use the desktop app or run locally."),ze.error(`Failed to pull ${D}: ${J}`),u.value[D]={status:"exception",percent:0,message:"Download failed"},setTimeout(()=>{delete u.value[D]},5e3)}finally{l.value.delete(D)}}}function h(m){const M=parseFloat(m.replace(/[^\d.]/g,""))||0,x=m.replace(/[\d.]/g,"").trim().toUpperCase();return x.includes("MB")?M/1e3:x.includes("TB")?M*1e3:(x.includes("GB"),M)}function i(m){return/-q\d{1,2}_|-fp\d+/.test(m)}function z(m){return $.value.some(M=>M.startsWith(m))}function I(m){return $.value.includes(m)}function v(m){return $.value.filter(M=>M.startsWith(m+":"))}function _(m){return m<1?`${Math.round(m*1e3)}MB`:`${m.toFixed(1)}GB`}function r(m){const M=h(m);return M<5?"size-small":M<20?"size-medium":"size-large"}function o(m){if(!m.tags)return"N/A";const M=Object.values(m.tags).map(C=>h(C.size||"0GB")).filter(C=>C>0);if(M.length===0)return"N/A";const x=Math.min(...M),D=Math.max(...M);return x===D?_(x):`${_(x)} - ${_(D)}`}function d(m){if(!m.tags||!m.tags.latest)return null;const M=m.tags.latest,x=Object.entries(m.tags).find(([D,C])=>D!=="latest"&&C.modelHash===M.modelHash);return x?{actualTag:x[0],size:x[1].size||M.size}:{actualTag:"",size:M.size}}return{modelsData:k,loading:t,error:a,pullingModels:l,pullProgress:u,installedModels:$,fetchModels:E,fetchInstalledModels:R,pullModel:y,parseSizeToGB:h,isQuantizedTag:i,isModelInstalled:z,isTagInstalled:I,getInstalledTagsForModel:v,formatSizeGB:_,getSizeClass:r,getModelSizeRange:o,getLatestTagInfo:d}}const Ws={class:"modal-content"},Js={class:"stats-bar"},Xs={class:"view-controls"},Ys={key:0,class:"loading-text"},Zs={class:"models-container"},ea=de({__name:"OllamaModelLibraryModalV3",props:{modelValue:{type:Boolean}},emits:["update:modelValue","models-updated"],setup(k,{emit:t}){const a=k,l=t,{modelsData:u,loading:$,error:E,pullingModels:R,pullProgress:y,installedModels:h,fetchModels:i,pullModel:z,parseSizeToGB:I,isQuantizedTag:v,getSizeClass:_,getModelSizeRange:r,getLatestTagInfo:o}=Ks(),d=P(""),m=P("popularity"),M=P([]),x=P(8),D=P(!1),C=P("card"),S=P(new Set),N=V({get:()=>a.modelValue,set:A=>l("update:modelValue",A)}),J=V(()=>{var A;return((A=u.value)==null?void 0:A.totalModels)||0}),j=V(()=>{var A;return((A=u.value)==null?void 0:A.categories)||[]}),X=V(()=>{if(!u.value)return[];let A=Object.entries(u.value.models).map(([G,K])=>({...K,name:G}));if(d.value){const G=d.value.toLowerCase();A=A.filter(K=>K.name.toLowerCase().includes(G)||K.description.toLowerCase().includes(G))}switch(M.value.length>0&&(A=A.filter(G=>M.value.some(K=>(G.categories||[]).includes(K)))),x.value<999&&(A=A.filter(G=>G.tags?Object.values(G.tags).some(K=>I(K.size||"0GB")<=x.value):!0)),m.value){case"popularity":A.sort((G,K)=>{const re=G.pullCount||"0",ie=K.pullCount||"0",se=parseFloat(re.replace(/[^\d.]/g,""))||0,ve=parseFloat(ie.replace(/[^\d.]/g,""))||0,W=re.includes("M")?1e6:re.includes("K")?1e3:1,he=ie.includes("M")?1e6:ie.includes("K")?1e3:1;return ve*he-se*W});break;case"lastUpdated":A.sort((G,K)=>{const re=G.lastUpdated?new Date(G.lastUpdated).getTime():0;return(K.lastUpdated?new Date(K.lastUpdated).getTime():0)-re});break;case"name":A.sort((G,K)=>G.name.localeCompare(K.name));break;case"tagCount":A.sort((G,K)=>(K.tagCount||0)-(G.tagCount||0));break}return A});function pe(A){const G=M.value.indexOf(A);G===-1?M.value.push(A):M.value.splice(G,1)}function me(A){S.value.has(A)?S.value.delete(A):S.value.add(A)}function ye(A,G){A?S.value.add(G.name):S.value.delete(G.name)}async function oe(A,G){await z(A,G,()=>l("models-updated"))}return Mt(N,A=>{A&&!u.value&&i(),A||(S.value.clear(),d.value="",M.value=[],x.value=8,D.value=!1,E.value="")}),(A,G)=>{const K=T("a-button"),re=T("a-button-group"),ie=T("a-spin"),se=T("a-alert"),ve=T("a-modal");return s(),F(ve,{open:N.value,"onUpdate:open":G[7]||(G[7]=W=>N.value=W),title:"Ollama Model Library",width:"95vw",footer:null,destroyOnClose:!0,"wrap-class-name":"ollama-library-modal-full",class:"ollama-library-modal"},{default:c(()=>[e("div",Ws,[p(ss,{"search-query":d.value,"onUpdate:searchQuery":G[0]||(G[0]=W=>d.value=W),"sort-by":m.value,"onUpdate:sortBy":G[1]||(G[1]=W=>m.value=W),"max-size-g-b":x.value,"onUpdate:maxSizeGB":G[2]||(G[2]=W=>x.value=W),"show-quantized":D.value,"onUpdate:showQuantized":G[3]||(G[3]=W=>D.value=W),"selected-categories":M.value,categories:j.value,onToggleCategory:pe},null,8,["search-query","sort-by","max-size-g-b","show-quantized","selected-categories","categories"]),e("div",Js,[e("span",null,"Showing "+f(X.value.length)+" of "+f(J.value)+" models",1),e("div",Xs,[p(re,{size:"small"},{default:c(()=>[p(K,{type:C.value==="card"?"primary":"default",onClick:G[4]||(G[4]=W=>C.value="card"),icon:Le(w(Te)),title:"Card View"},null,8,["type","icon"]),p(K,{type:C.value==="list"?"primary":"default",onClick:G[5]||(G[5]=W=>C.value="list"),icon:Le(w(Ze)),title:"List View"},null,8,["type","icon"])]),_:1}),w($)?(s(),b("span",Ys,"Loading...")):B("",!0)])]),p(us,{"pull-progress":w(y)},null,8,["pull-progress"]),e("div",Zs,[p(ie,{spinning:w($),size:"large"},{default:c(()=>[C.value==="card"?(s(!0),b(Q,{key:0},le(X.value,W=>(s(),F(Os,{key:W.name,model:W,expanded:S.value.has(W.name),"pulling-models":w(R),"pull-progress":w(y),"installed-models":w(h),"max-size-g-b":x.value,"show-quantized":D.value,"is-quantized-tag":w(v),"parse-size-to-g-b":w(I),"get-size-class":w(_),"get-latest-tag-info":w(o),onToggleExpand:he=>me(W.name),onPullModel:oe},null,8,["model","expanded","pulling-models","pull-progress","installed-models","max-size-g-b","show-quantized","is-quantized-tag","parse-size-to-g-b","get-size-class","get-latest-tag-info","onToggleExpand"]))),128)):B("",!0),C.value==="list"?(s(),F(js,{key:1,models:X.value,"expanded-models":Array.from(S.value),"pulling-models":w(R),"pull-progress":w(y),"installed-models":w(h),"max-size-g-b":x.value,"show-quantized":D.value,"is-quantized-tag":w(v),"parse-size-to-g-b":w(I),"get-size-class":w(_),"get-latest-tag-info":w(o),"get-model-size-range":w(r),onToggleModel:me,onPullModel:oe,onExpand:ye},null,8,["models","expanded-models","pulling-models","pull-progress","installed-models","max-size-g-b","show-quantized","is-quantized-tag","parse-size-to-g-b","get-size-class","get-latest-tag-info","get-model-size-range"])):B("",!0)]),_:1},8,["spinning"])]),w(E)?(s(),F(se,{key:0,type:"error",message:w(E),closable:"",onClose:G[6]||(G[6]=W=>E.value=""),class:"error-alert"},null,8,["message"])):B("",!0)])]),_:1},8,["open"])}}}),ta=ce(ea,[["__scopeId","data-v-96287dbe"]]),sa={class:"ollama-model-manager"},aa={class:"action-bar"},la={class:"models-section"},oa={key:0,class:"model-name"},na={key:1,class:"model-size"},ra={key:2,class:"model-date"},ia=de({__name:"OllamaModelManagerV3",setup(k){const t=P([]),a=P(!1),l=P(new Set),u=P(""),$=P(!1),E=[{title:"Model Name",key:"name",width:"40%"},{title:"Size",key:"size",width:"20%",align:"right"},{title:"Modified",key:"modified",width:"25%"},{title:"Actions",key:"actions",width:"15%",align:"center"}];async function R(){const v=await Ns();return!v.available&&v.error&&(v.error.type==="cors"&&v.error.isHttps?u.value=v.error.details||"Cannot connect to Ollama from HTTPS site":u.value=v.error.message),v.available}async function y(){try{const v=await Qs();t.value=v.models||[]}catch(v){const _=v;_.type==="cors"&&_.isHttps?u.value=_.details||"Cannot access Ollama from HTTPS site":u.value=`Failed to fetch models: ${v instanceof Error?v.message:"Unknown error"}`,t.value=[]}}async function h(v){l.value.add(v),u.value="";try{await qs(v),ze.success(`Successfully removed ${v}`),await i()}catch(_){const r=_;r.type==="cors"&&r.isHttps?u.value=r.details||"Cannot access Ollama from HTTPS site":u.value=`Failed to remove model: ${_ instanceof Error?_.message:"Unknown error"}`}finally{l.value.delete(v)}}async function i(){a.value=!0,await y(),a.value=!1}function z(v){if(!v)return"0 B";const _=["B","KB","MB","GB","TB"],r=Math.floor(Math.log(v)/Math.log(1024));return`${(v/Math.pow(1024,r)).toFixed(1)} ${_[r]}`}function I(v){try{return new Date(v).toLocaleDateString()}catch{return"Unknown"}}return Se(async()=>{await R()?await i():u.value="Cannot connect to Ollama. Make sure Ollama is running on localhost:11434"}),(v,_)=>{const r=T("a-button"),o=T("a-tag"),d=T("a-popconfirm"),m=T("a-table"),M=T("a-empty"),x=T("a-alert");return s(),b("div",sa,[e("div",aa,[p(r,{type:"primary",onClick:_[0]||(_[0]=D=>$.value=!0)},{icon:c(()=>[p(w(Qe))]),default:c(()=>[_[3]||(_[3]=O(" Download Ollama Models "))]),_:1,__:[3]}),p(r,{onClick:i,loading:a.value},{icon:c(()=>[p(w(qe))]),default:c(()=>[_[4]||(_[4]=O(" Refresh "))]),_:1,__:[4]},8,["loading"])]),e("div",la,[_[7]||(_[7]=e("h4",{class:"section-title"},"Installed Models",-1)),p(m,{columns:E,"data-source":t.value,pagination:!1,size:"small",loading:a.value,"row-key":"name",class:"models-table"},{bodyCell:c(({column:D,record:C})=>{var S;return[D.key==="name"?(s(),b("div",oa,[e("code",null,f(C.name),1),(S=C.details)!=null&&S.family?(s(),F(o,{key:0,size:"small",color:"blue"},{default:c(()=>[O(f(C.details.family),1)]),_:2},1024)):B("",!0)])):B("",!0),D.key==="size"?(s(),b("span",na,f(z(C.size)),1)):B("",!0),D.key==="modified"?(s(),b("span",ra,f(I(C.modified_at)),1)):B("",!0),D.key==="actions"?(s(),F(d,{key:3,title:"Are you sure you want to delete this model?",description:`This will permanently remove ${C.name} from your system.`,"ok-text":"Delete","cancel-text":"Cancel",onConfirm:N=>h(C.name)},{default:c(()=>[p(r,{type:"text",danger:"",size:"small",loading:l.value.has(C.name)},{icon:c(()=>[p(w(Ke))]),default:c(()=>[_[5]||(_[5]=O(" Remove "))]),_:2,__:[5]},1032,["loading"])]),_:2},1032,["description","onConfirm"])):B("",!0)]}),_:1},8,["data-source","loading"]),!a.value&&t.value.length===0?(s(),F(M,{key:0,description:"No Ollama models installed",class:"empty-state"},{image:c(()=>_[6]||(_[6]=[e("div",{class:"empty-icon"},"ðŸ“¦",-1)])),_:1})):B("",!0)]),u.value?(s(),F(x,{key:0,type:"error",message:u.value,closable:"",onClose:_[1]||(_[1]=D=>u.value=""),class:"error-alert"},null,8,["message"])):B("",!0),p(ta,{modelValue:$.value,"onUpdate:modelValue":_[2]||(_[2]=D=>$.value=D),onModelsUpdated:i},null,8,["modelValue"])])}}}),ua=ce(ia,[["__scopeId","data-v-9a88ecb1"]]),da={class:"model-list"},ca={class:"model-header"},pa={class:"model-table"},ma=["onClick"],va={class:"model-name"},fa={class:"model-source"},ga={class:"model-context"},ya={key:0},_a={key:1,class:"text-secondary"},ba={key:0,class:"model-cost-in"},ha={key:0,class:"cost-value"},wa={key:1,class:"text-secondary"},ka={key:1,class:"model-cost-out"},Ca={key:0,class:"cost-value"},$a={key:1,class:"text-secondary"},Ma={class:"model-enviro-carbon"},za={class:"enviro-value"},Oa={class:"model-enviro-water"},Sa={class:"enviro-value"},Ta={class:"model-enviro-energy"},Pa={class:"enviro-value"},Ba=de({__name:"ModelListV3",props:{models:{},providerId:{}},emits:["toggle-model"],setup(k){const t=k,a=We(),l=P("name"),u=P("asc"),$=V(()=>!t.models||t.models.length===0?[]:[...t.models].sort((z,I)=>{var _,r,o,d,m,M;let v=0;switch(l.value){case"enabled":v=(z.enabled?1:0)-(I.enabled?1:0);break;case"name":v=z.displayName.localeCompare(I.displayName);break;case"source":v=(z.source||"").localeCompare(I.source||"");break;case"context":const x=((_=z.capabilities)==null?void 0:_.contextWindow)||0,D=((r=I.capabilities)==null?void 0:r.contextWindow)||0;v=x-D;break;case"inputCost":const C=((o=z.capabilities)==null?void 0:o.inputCostPerToken)||0,S=((d=I.capabilities)==null?void 0:d.inputCostPerToken)||0;v=C-S;break;case"outputCost":const N=((m=z.capabilities)==null?void 0:m.outputCostPerToken)||0,J=((M=I.capabilities)==null?void 0:M.outputCostPerToken)||0;v=N-J;break}return u.value==="asc"?v:-v}));function E(h){l.value===h?u.value=u.value==="asc"?"desc":"asc":(l.value=h,u.value="asc")}function R(h){return h>=1e6?(h/1e6).toFixed(1)+"M":h>=1e3?(h/1e3).toFixed(0)+"K":h.toString()}function y(h){if(!h||h===0)return"0.00";const i=h*1e6;return i<.01?i.toFixed(4):i<1?i.toFixed(3):i<10?i.toFixed(2):i<100?i.toFixed(1):i.toFixed(0)}return(h,i)=>{const z=T("a-switch"),I=T("a-tag");return s(),b("div",da,[e("div",ca,[e("div",{class:"header-switch sortable",onClick:i[0]||(i[0]=v=>E("enabled"))},[i[7]||(i[7]=e("span",null,"Enabled",-1)),e("span",{class:ne(["sort-indicator",{active:l.value==="enabled"}])},f(l.value==="enabled"&&u.value==="asc"?"â–²":"â–¼"),3)]),e("div",{class:"header-name sortable",onClick:i[1]||(i[1]=v=>E("name"))},[i[8]||(i[8]=e("span",null,"Model",-1)),e("span",{class:ne(["sort-indicator",{active:l.value==="name"}])},f(l.value==="name"&&u.value==="asc"?"â–²":"â–¼"),3)]),e("div",{class:"header-source sortable",onClick:i[2]||(i[2]=v=>E("source"))},[i[9]||(i[9]=e("span",null,"Source",-1)),e("span",{class:ne(["sort-indicator",{active:l.value==="source"}])},f(l.value==="source"&&u.value==="asc"?"â–²":"â–¼"),3)]),e("div",{class:"header-context sortable",onClick:i[3]||(i[3]=v=>E("context"))},[i[10]||(i[10]=e("span",null,"Context",-1)),e("span",{class:ne(["sort-indicator",{active:l.value==="context"}])},f(l.value==="context"&&u.value==="asc"?"â–²":"â–¼"),3)]),w(a).showFinancialCosts.value?(s(),b("div",{key:0,class:"header-cost-in sortable",onClick:i[4]||(i[4]=v=>E("inputCost"))},[i[11]||(i[11]=e("span",null,"Input $/1M",-1)),e("span",{class:ne(["sort-indicator",{active:l.value==="inputCost"}])},f(l.value==="inputCost"&&u.value==="asc"?"â–²":"â–¼"),3)])):B("",!0),w(a).showFinancialCosts.value?(s(),b("div",{key:1,class:"header-cost-out sortable",onClick:i[5]||(i[5]=v=>E("outputCost"))},[i[12]||(i[12]=e("span",null,"Output $/1M",-1)),e("span",{class:ne(["sort-indicator",{active:l.value==="outputCost"}])},f(l.value==="outputCost"&&u.value==="asc"?"â–²":"â–¼"),3)])):B("",!0),i[13]||(i[13]=e("div",{class:"header-enviro-carbon"},[e("span",null,"COâ‚‚")],-1)),i[14]||(i[14]=e("div",{class:"header-enviro-water"},[e("span",null,"ðŸ’§")],-1)),i[15]||(i[15]=e("div",{class:"header-enviro-energy"},[e("span",null,"âš¡")],-1))]),e("div",pa,[(s(!0),b(Q,null,le($.value,v=>{var _,r,o;return s(),b("div",{key:v.id,class:"model-row",onClick:d=>h.$emit("toggle-model",v.id,!v.enabled)},[e("div",{class:"model-switch",onClick:i[6]||(i[6]=ge(()=>{},["stop"]))},[p(z,{checked:v.enabled,size:"small",onChange:d=>h.$emit("toggle-model",v.id,d),"data-testid":"model-toggle","data-provider":v.provider,"data-model":v.modelId,"aria-label":`${v.enabled?"Disable":"Enable"} model ${v.modelId}`},null,8,["checked","onChange","data-provider","data-model","aria-label"])]),e("div",va,[e("code",null,f(v.modelId),1)]),e("div",fa,[v.source?(s(),F(I,{key:0,size:"small",color:"cyan"},{default:c(()=>[O(f(v.source),1)]),_:2},1024)):B("",!0)]),e("div",ga,[(_=v.capabilities)!=null&&_.contextWindow?(s(),b("span",ya,f(R(v.capabilities.contextWindow)),1)):(s(),b("span",_a,"-"))]),w(a).showFinancialCosts.value?(s(),b("div",ba,[(r=v.capabilities)!=null&&r.inputCostPerToken?(s(),b("span",ha," $"+f(y(v.capabilities.inputCostPerToken)),1)):(s(),b("span",wa,"-"))])):B("",!0),w(a).showFinancialCosts.value?(s(),b("div",ka,[(o=v.capabilities)!=null&&o.outputCostPerToken?(s(),b("span",Ca," $"+f(y(v.capabilities.outputCostPerToken)),1)):(s(),b("span",$a,"-"))])):B("",!0),e("div",Ma,[e("span",za,f(w(a).getEnvironmentalCost(v,"carbon")),1)]),e("div",Oa,[e("span",Sa,f(w(a).getEnvironmentalCost(v,"water")),1)]),e("div",Ta,[e("span",Pa,f(w(a).getEnvironmentalCost(v,"energy")),1)])],8,ma)}),128))])])}}}),Ea=ce(Ba,[["__scopeId","data-v-f51d3c44"]]),xa={class:"model-preference-manager"},Da={class:"preferences-section"},Ga={class:"action-group"},Ra={class:"action-group"},Aa={class:"status-grid"},La={class:"status-item"},Ua={class:"status-value"},Ia={class:"status-item"},Fa={class:"status-value"},Va={class:"status-item"},ja={class:"status-value"},Na={class:"status-item"},Ha={class:"status-value"},Qa={class:"status-item"},qa={class:"status-value"},Ka={class:"status-item"},Wa={class:"status-value"},Ja={class:"action-group"},Xa={class:"provider-grid"},Ya={class:"provider-name"},Za={class:"provider-stats"},el={class:"provider-total"},tl={class:"provider-enabled"},sl=de({__name:"ModelPreferenceManagerV3",setup(k){const{models:t,enabledModels:a,modelsByProvider:l,showFinancialCosts:u,showEnvironmentalCosts:$}=Xe(),{discoveryStatus:E}=et(),R=We(),y=P([]),h=P(!1),i=P(!1),z=P(""),I=P("");async function v(){h.value=!0,z.value="";try{const r=await R.exportModelPreferences();if(r.ok){const o=new Blob([JSON.stringify(r.value,null,2)],{type:"application/json"}),d=URL.createObjectURL(o),m=document.createElement("a");m.href=d,m.download=`model-preferences-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(d),I.value="Model preferences exported successfully!"}else z.value=r.error.message}catch(r){z.value=`Failed to export preferences: ${r instanceof Error?r.message:"Unknown error"}`}finally{h.value=!1}}async function _(r){i.value=!0,z.value="";try{const o=await r.text(),d=JSON.parse(o),m=await R.importModelPreferences(d);m.ok?I.value="Model preferences imported successfully!":z.value=m.error.message}catch(o){o instanceof SyntaxError?z.value="Invalid JSON file format":z.value=`Failed to import preferences: ${o instanceof Error?o.message:"Unknown error"}`}finally{i.value=!1}return!1}return(r,o)=>{const d=T("a-button"),m=T("a-upload"),M=T("a-space"),x=T("a-divider"),D=T("a-alert"),C=T("a-collapse-panel"),S=T("a-collapse");return s(),b("div",xa,[p(S,{activeKey:y.value,"onUpdate:activeKey":o[2]||(o[2]=N=>y.value=N),bordered:!1,class:"preferences-collapse"},{default:c(()=>[p(C,{key:"preferences"},{header:c(()=>o[3]||(o[3]=[e("div",{class:"preferences-header"},[e("strong",null,"ðŸ”§ V3 Enhanced Features"),e("span",{class:"preferences-description"},"Advanced model preference management")],-1)])),default:c(()=>{var N,J,j;return[e("div",Da,[e("div",Ga,[o[6]||(o[6]=e("h5",{class:"action-title"},"Model Preferences",-1)),o[7]||(o[7]=e("p",{class:"action-description"}," Export and import your model enabled/disabled preferences for backup or sharing. ",-1)),p(M,null,{default:c(()=>[p(d,{onClick:v,loading:h.value,type:"primary"},{icon:c(()=>[p(w(Qe))]),default:c(()=>[o[4]||(o[4]=O(" Export Preferences "))]),_:1,__:[4]},8,["loading"]),p(m,{"before-upload":_,"show-upload-list":!1,accept:".json"},{default:c(()=>[p(d,{loading:i.value},{icon:c(()=>[p(w(Pe))]),default:c(()=>[o[5]||(o[5]=O(" Import Preferences "))]),_:1,__:[5]},8,["loading"])]),_:1})]),_:1})]),p(x),e("div",Ra,[o[14]||(o[14]=e("h5",{class:"action-title"},"V3 System Information",-1)),o[15]||(o[15]=e("p",{class:"action-description"}," Enhanced V3 backend capabilities and status. ",-1)),e("div",Aa,[e("div",La,[o[8]||(o[8]=e("span",{class:"status-label"},"Total Models:",-1)),e("span",Ua,f(((N=w(t))==null?void 0:N.length)||0),1)]),e("div",Ia,[o[9]||(o[9]=e("span",{class:"status-label"},"Enabled Models:",-1)),e("span",Fa,f(((J=w(a))==null?void 0:J.length)||0),1)]),e("div",Va,[o[10]||(o[10]=e("span",{class:"status-label"},"Active Providers:",-1)),e("span",ja,f(Object.keys(w(l)||{}).length),1)]),e("div",Na,[o[11]||(o[11]=e("span",{class:"status-label"},"Discovery Sources:",-1)),e("span",Ha,f(((j=w(E))==null?void 0:j.length)||0),1)]),e("div",Qa,[o[12]||(o[12]=e("span",{class:"status-label"},"Cost Display:",-1)),e("span",qa,f(w(u)?"Enabled":"Disabled"),1)]),e("div",Ka,[o[13]||(o[13]=e("span",{class:"status-label"},"Environmental Display:",-1)),e("span",Wa,f(w($)?"Enabled":"Disabled"),1)])])]),p(x),e("div",Ja,[o[16]||(o[16]=e("h5",{class:"action-title"},"Provider Status",-1)),o[17]||(o[17]=e("p",{class:"action-description"}," Real-time provider status and model counts. ",-1)),e("div",Xa,[(s(!0),b(Q,null,le(w(l),(X,pe)=>(s(),b("div",{key:pe,class:"provider-item"},[e("div",Ya,f(w(R).getProviderDisplayName(pe)),1),e("div",Za,[e("span",el,f(X.length)+" total",1),e("span",tl,f(X.filter(me=>me.enabled).length)+" enabled",1)])]))),128))])])]),z.value?(s(),F(D,{key:0,type:"error",message:z.value,closable:"",onClose:o[0]||(o[0]=X=>z.value=""),class:"error-alert"},null,8,["message"])):B("",!0),I.value?(s(),F(D,{key:1,type:"success",message:I.value,closable:"",onClose:o[1]||(o[1]=X=>I.value=""),class:"success-alert"},null,8,["message"])):B("",!0)]}),_:1})]),_:1},8,["activeKey"])])}}}),al=ce(sl,[["__scopeId","data-v-65aaac20"]]),ll={key:0,class:"loading-state"},ol={key:1,class:"error-state"},nl={class:"error-message"},rl=["onClick"],il={class:"list-header"},ul={class:"list-info"},dl={class:"list-name"},cl={class:"list-meta"},pl={class:"list-actions"},ml={class:"list-description"},vl={class:"list-preview"},fl={key:0,class:"more-models"},gl=de({__name:"ModelListsDropdownV3",props:{currentModels:{},isLoading:{type:Boolean,default:!1}},emits:["apply-list","close"],setup(k,{emit:t}){const a=k,l=t,{getProviderGroup:u}=Ye(),$=P([]),E=P(!0),R=P(""),y=P(!1),h=P("");Se(async()=>{try{E.value=!0,R.value="";const{getModelListManager:r}=await Je(async()=>{const{getModelListManager:m}=await import("./index-BMvx8pDm-1754939593326.js").then(M=>M.a$);return{getModelListManager:m}},__vite__mapDeps([0,1])),d=await r().getLists();$.value=d.filter(m=>["openrouter-favorites","cost-efficient","high-performance"].includes(m.id)),U.info("Model lists loaded:",{lists:$.value.length})}catch(r){U.error("Failed to load model lists:",r),R.value="Failed to load model lists"}finally{E.value=!1}});function i(r){return a.currentModels.some(o=>o.modelId!==r.modelId?!1:r.provider?o.provider===r.provider&&o.enabled:r.providerGroup?u(o.provider)===r.providerGroup&&o.enabled:!1)}function z(r){return r.models.slice(0,3)}function I(r){return r.modelId.replace(/^.*\//,"").replace(/-instruct$/,"").replace(/-preview$/,"")}async function v(r){if(!(y.value||a.isLoading))try{y.value=!0,h.value=r,await new Promise((o,d)=>{l("apply-list",r),setTimeout(()=>{o()},2e3)})}catch(o){U.error("Failed to apply list:",o)}finally{y.value=!1,h.value=""}}function _(r){var o;(o=r.domEvent)==null||o.stopPropagation()}return(r,o)=>{const d=T("a-spin"),m=T("a-button"),M=T("a-menu-item"),x=T("a-menu-divider"),D=T("a-tag"),C=T("a-menu");return s(),F(C,{class:"model-lists-menu",onClick:_},{default:c(()=>[E.value?(s(),b("div",ll,[p(d,{size:"small"}),o[0]||(o[0]=e("span",null,"Loading model lists...",-1))])):R.value?(s(),b("div",ol,[e("span",nl,f(R.value),1)])):(s(),b(Q,{key:2},[o[6]||(o[6]=e("div",{class:"menu-header"},[e("span",null,"Built-in Lists")],-1)),(s(!0),b(Q,null,le($.value,S=>(s(),F(M,{key:S.id,class:"list-menu-item"},{default:c(()=>[e("div",{class:"list-item",onClick:N=>v(S.id)},[e("div",il,[e("div",ul,[e("span",dl,f(S.name),1),e("span",cl,f(S.models.length)+" models",1)]),e("div",pl,[p(m,{type:"primary",size:"small",loading:y.value&&h.value===S.id,onClick:ge(N=>v(S.id),["stop"])},{default:c(()=>o[1]||(o[1]=[O(" Apply ")])),_:2,__:[1]},1032,["loading","onClick"])])]),e("div",ml,f(S.description),1),e("div",vl,[(s(!0),b(Q,null,le(z(S),(N,J)=>(s(),b("span",{key:`${N.provider||N.providerGroup}-${N.modelId}`,class:ne(["preview-model",{enabled:i(N)}])},f(I(N))+f(J<z(S).length-1?", ":""),3))),128)),S.models.length>3?(s(),b("span",fl," +"+f(S.models.length-3)+" more ",1)):B("",!0)])],8,rl)]),_:2},1024))),128)),p(x),p(M,{disabled:"",class:"future-feature"},{default:c(()=>[p(w(At)),o[3]||(o[3]=e("span",null,"Save Current Selection...",-1)),p(D,{color:"blue",size:"small"},{default:c(()=>o[2]||(o[2]=[O("Soon")])),_:1,__:[2]})]),_:1,__:[3]}),p(M,{disabled:"",class:"future-feature"},{default:c(()=>[p(w(zt)),o[5]||(o[5]=e("span",null,"Manage Lists...",-1)),p(D,{color:"blue",size:"small"},{default:c(()=>o[4]||(o[4]=[O("Soon")])),_:1,__:[4]})]),_:1,__:[5]})],64))]),_:1})}}}),yl=ce(gl,[["__scopeId","data-v-e613a393"]]),_l={class:"models-view","data-testid":"page-models"},bl={class:"page-header"},hl={class:"ollama-cors-message"},wl={class:"cors-help"},kl={key:3,class:"discovery-status-bar"},Cl={class:"source-name"},$l=["onClick","data-testid","aria-label"],Ml={class:"search-filter-bar"},zl={class:"control-bar"},Ol={class:"left-controls"},Sl={class:"stats"},Tl={class:"provider-header"},Pl={class:"provider-info"},Bl={key:1,class:"provider-summary"},El=de({__name:"ModelsViewV3",setup(k){const t=Gt(),{models:a,modelsByProvider:l,stats:u}=Xe(),{getProviderGroup:$,requiresApiKey:E}=Ye(),{hasApiKey:R}=Ot(),{discoverModels:y,refreshDiscoverySource:h,toggleModel:i,toggleAllModels:z,toggleProviderModels:I,clearAllModels:v,isDiscovering:_,isTogglingModels:r}=Ht(),{discoveryStatus:o,getSourceDisplayName:d,getProviderDisplayName:m,refreshStatus:M}=et(),x=P(""),D=P(""),C=P("all"),S=P(!1),N=V(()=>{const g={};return Object.keys(l.value||{}).forEach(n=>{const L=$(n),Y=E(n),te=R(L);g[n]={hasKey:te,providerGroup:L,requiresKey:Y}}),g}),J=P(!1),j=P(""),X=P([]),pe=P(null),me=P([]),ye=P(!1),oe=P(null),A=P(!1),G=P(!1);let K=null;const re=g=>{K&&clearTimeout(K),K=setTimeout(()=>{D.value=g},300)},ie=V(()=>{const g={};for(const[n,L]of Object.entries(l.value))g[n]=L.filter(Y=>Y.enabled).length;return g}),se=P([]),ve=V(()=>{const g=D.value.toLowerCase(),n={},L=Object.keys(l.value);if(se.value.length===0||L.some(Y=>!se.value.includes(Y))){const Y=se.value.filter(Z=>L.includes(Z)),te=L.filter(Z=>!se.value.includes(Z)).sort();se.value=[...Y,...te]}for(const Y of se.value){const te=l.value[Y];if(!te)continue;let Z=[...te];g&&(Z=Z.filter(fe=>fe.displayName.toLowerCase().includes(g)||fe.modelId.toLowerCase().includes(g)||Y.toLowerCase().includes(g))),C.value==="enabled"?Z=Z.filter(fe=>fe.enabled):C.value==="disabled"&&(Z=Z.filter(fe=>!fe.enabled)),Z.length>0&&(n[Y]=Z)}return n}),W=V(()=>{const g=u.value.total;return U.info("ModelsViewV3 V4 totalCount:",g),g}),he=V(()=>u.value.enabled),tt=V(()=>x.value?`No models found matching "${x.value}"`:C.value!=="all"?`No ${C.value} models found`:'No models available. Click "Refresh Models" to discover models.'),ke=V(()=>{if(!j.value)return!1;const g=j.value.toLowerCase();return g.includes("ollama")&&(g.includes("failed to fetch")||g.includes("networkerror when attempting to fetch"))&&!g.includes("litellm")&&!g.includes("openrouter")}),st=V(()=>{var L,Y;const g=((L=l.value["ollama-chat"])==null?void 0:L.length)>0||((Y=l.value["ollama-generate"])==null?void 0:Y.length)>0,n=o.value.some(te=>te.id==="ollama");return g||n||ke.value});V(()=>!!l.value.openrouter);const Ce=V(()=>{const g=se.value.length;return X.value.length===g&&g>0}),at=Ue(St),lt=Ue(Tt);function ot(g){return{idle:"default",loading:"processing",success:"success",error:"error"}[g]||"default"}function nt(g){return ie.value[g]||0}function rt(g){const n=nt(g),L=(l.value[g]||[]).length;return n===0?"default":n===L?"success":"warning"}function it(g){const n=ve.value[g]||[];return n.length>0&&n.every(L=>L.enabled)}function ut(g){const n=ve.value[g]||[];return n.length>0&&n.every(L=>!L.enabled)}function dt(g){t.push({path:"/settings",query:g?{provider:g}:void 0})}function ct(){Ce.value?X.value=[]:X.value=[...se.value]}async function pt(g,n){const L=await i(g,n);L.ok||(j.value=L.error.message)}async function Be(g,n){const L=await I(g,n);L.ok||(j.value=L.error.message)}async function mt(){const g=await z(!0);g.ok||(j.value=g.error.message)}async function vt(){const g=await z(!1);g.ok||(j.value=g.error.message)}async function $e(){S.value=!0,j.value="";try{U.info("V4 DEBUG: Starting discovery...");const g=await y({forceRefresh:!0});U.info("V4 DEBUG: Discovery result:",g),g.ok?(U.info("V4 DEBUG: Discovery successful, models found:",g.value.totalModels),U.info("V4 DEBUG: After discovery, models.value.length =",a.value.length),g.value.errors.length>0&&(j.value=`Some sources failed: ${g.value.errors.join("; ")}`)):(U.info("V4 DEBUG: Discovery failed:",g.error),j.value=`Discovery failed: ${g.error.message}`),M()}catch(g){U.error("Failed to refresh models",g),j.value="Failed to refresh models. Please check your connection and try again."}finally{S.value=!1}}async function ft(g){pe.value=g,j.value="";try{const n=await h(g);n.ok&&n.value.errors.length>0?j.value=`Failed to refresh ${d(g)}: ${n.value.errors.join("; ")}`:n.ok||(j.value=`Failed to refresh ${d(g)}: ${n.error.message}`),M()}catch(n){U.error("Failed to retry source",n,{sourceId:g}),j.value=`Failed to refresh ${d(g)}: ${n instanceof Error?n.message:"Unknown error"}`}finally{pe.value=null}}async function gt(){try{await h("ollama"),M(),Ee()}catch(g){U.error("Failed to refresh Ollama models after update",g)}}async function Ee(){U.warn("[CORS DEBUG] Starting CORS check...");try{const g=await Hs();U.warn("[CORS DEBUG] CORS check result:",g),g.hasCORSIssue&&g.canConnect?(U.warn("[CORS DEBUG] Setting CORS issue alert"),oe.value=g.error||"CORS configuration issue detected"):(U.warn("[CORS DEBUG] No CORS issue detected, clearing alert"),oe.value=null)}catch(g){U.warn("[CORS DEBUG] CORS check failed:",g)}}async function yt(){if(confirm("This will remove all models and re-discover them from scratch. Any custom model configurations will be lost. Continue?")){J.value=!0,j.value="";try{const n=await v();if(!n.ok){j.value=n.error.message;return}const L=await y({forceRefresh:!0});L.ok&&L.value.errors.length>0?j.value=`Some sources failed: ${L.value.errors.join("; ")}`:L.ok||(j.value=`Discovery failed: ${L.error.message}`),M()}catch(n){U.error("Failed to clear and refresh models",n),j.value="Failed to clear and refresh models. Please check your connection and try again."}finally{J.value=!1}}}async function _t(g){try{U.info("Applying model list:",g);const{getModelListManager:n}=await Je(async()=>{const{getModelListManager:te}=await import("./index-BMvx8pDm-1754939593326.js").then(Z=>Z.a$);return{getModelListManager:te}},__vite__mapDeps([0,1])),Y=await n().applyList(g);U.info("Model list applied:",Y),await $e()}catch(n){U.error("Failed to apply model list:",n),j.value=`Failed to apply model list: ${n instanceof Error?n.message:"Unknown error"}`}}Pt(()=>{re(x.value)});const ae=V(()=>r.value);return Se(async()=>{U.info("V4 DEBUG: models.value.length =",a.value.length),U.info("V4 DEBUG: models.value =",a.value),U.info("V4 DEBUG: modelsByProvider.value =",l.value),a.value.length===0&&(U.info("V4 DEBUG: No models found, refreshing..."),$e()),X.value=[],Ee()}),Bt(()=>{x.value="",X.value=[],j.value=""}),(g,n)=>{const L=T("a-button"),Y=T("a-space"),te=T("a-alert"),Z=T("a-tag"),fe=T("a-input-search"),Me=T("a-radio-button"),bt=T("a-radio-group"),ht=T("a-divider"),wt=T("a-dropdown"),kt=T("a-tooltip"),xe=T("a-collapse-panel"),De=T("a-collapse"),Ct=T("a-empty");return s(),b("div",_l,[e("div",bl,[n[12]||(n[12]=e("div",{class:"header-content"},[e("h1",null,"Model Management"),e("p",{class:"description"},"Configure and enable LLM models for testing")],-1)),p(Y,null,{default:c(()=>[p(L,{type:"primary",onClick:$e,loading:S.value||w(_),"data-testid":"btn-refresh-models","aria-label":"Refresh available models"},{icon:c(()=>[p(w(qe))]),default:c(()=>[n[10]||(n[10]=O(" Refresh Models "))]),_:1,__:[10]},8,["loading"]),p(L,{danger:"",onClick:yt,loading:J.value,"data-testid":"btn-clear-refresh-models","aria-label":"Clear all models and refresh"},{icon:c(()=>[p(w(Ke))]),default:c(()=>[n[11]||(n[11]=O(" Clear and Refresh Models "))]),_:1,__:[11]},8,["loading"])]),_:1})]),j.value&&!ke.value?(s(),F(te,{key:0,type:"error",message:j.value,closable:"",onClose:n[0]||(n[0]=H=>j.value=""),class:"error-alert"},null,8,["message"])):B("",!0),ke.value?(s(),F(te,{key:1,type:"info",closable:"",onClose:n[1]||(n[1]=H=>j.value=""),class:"ollama-info-alert"},{message:c(()=>n[13]||(n[13]=[e("div",{class:"ollama-message"},[O(" Ollama is not running on this computer. To audit local LLMs, install "),e("a",{href:"https://ollama.com",target:"_blank",rel:"noopener noreferrer"},"Ollama"),O(". ")],-1)])),_:1})):B("",!0),oe.value?(s(),F(te,{key:2,type:"warning",closable:"",onClose:n[3]||(n[3]=H=>oe.value=null),class:"ollama-cors-alert"},{message:c(()=>[e("div",hl,[n[14]||(n[14]=e("strong",null,"Ollama CORS Configuration Issue",-1)),n[15]||(n[15]=e("br",null,null,-1)),n[16]||(n[16]=O(" Ollama is running but not configured to allow browser requests. Add ")),n[17]||(n[17]=e("code",null,"OLLAMA_ORIGINS=*",-1)),n[18]||(n[18]=O(" to your Ollama service configuration. ")),e("div",wl,[e("a",{href:"#",onClick:n[2]||(n[2]=ge(H=>A.value=!0,["prevent"]))},"Show setup instructions")])])]),_:1})):B("",!0),w(o).length>0?(s(),b("div",kl,[n[19]||(n[19]=e("span",{class:"status-label"},"Sources:",-1)),(s(!0),b(Q,null,le(w(o),H=>(s(),b("div",{key:H.id,class:"source-status-compact"},[e("span",Cl,f(w(d)(H.id)),1),p(Z,{color:ot(H.status),size:"small"},{default:c(()=>[H.status==="success"&&H.modelCount?(s(),b(Q,{key:0},[O(f(H.modelCount),1)],64)):H.status==="error"?(s(),b("span",{key:1,onClick:ee=>ft(H.id),style:{cursor:"pointer"},"data-testid":`retry-source-${H.id}`,"aria-label":`Retry loading models from ${w(d)(H.id)}`},"âŸ³ retry",8,$l)):(s(),b(Q,{key:2},[O(f(H.status),1)],64))]),_:2},1032,["color"])]))),128))])):B("",!0),e("div",Ml,[p(fe,{value:x.value,"onUpdate:value":n[4]||(n[4]=H=>x.value=H),placeholder:"Search models by name, provider, or ID...","allow-clear":"",size:"large",class:"search-input","data-testid":"input-model-search","aria-label":"Search models",loading:x.value!==D.value},null,8,["value","loading"]),p(bt,{value:C.value,"onUpdate:value":n[5]||(n[5]=H=>C.value=H),"button-style":"solid",size:"large"},{default:c(()=>[p(Me,{value:"all"},{default:c(()=>n[20]||(n[20]=[O("All")])),_:1,__:[20]}),p(Me,{value:"enabled"},{default:c(()=>n[21]||(n[21]=[O("Enabled")])),_:1,__:[21]}),p(Me,{value:"disabled"},{default:c(()=>n[22]||(n[22]=[O("Disabled")])),_:1,__:[22]})]),_:1},8,["value"])]),e("div",zl,[e("div",Ol,[p(L,{type:"text",size:"small",onClick:ct},{icon:c(()=>[(s(),F(Et(Ce.value?lt.value:at.value)))]),default:c(()=>[O(" "+f(Ce.value?"Collapse All":"Expand All"),1)]),_:1}),p(ht,{type:"vertical"}),p(L,{type:"text",size:"small",onClick:mt,loading:ae.value,disabled:ae.value},{icon:c(()=>[p(w(ue))]),default:c(()=>[n[23]||(n[23]=O(" Enable All "))]),_:1,__:[23]},8,["loading","disabled"]),p(L,{type:"text",size:"small",onClick:vt,loading:ae.value,disabled:ae.value},{icon:c(()=>[p(w(Ie))]),default:c(()=>[n[24]||(n[24]=O(" Disable All "))]),_:1,__:[24]},8,["loading","disabled"]),p(wt,{open:G.value,"onUpdate:open":n[7]||(n[7]=H=>G.value=H),placement:"bottomLeft",disabled:ae.value},{overlay:c(()=>[p(yl,{"current-models":Array.from(w(a)),"is-loading":ae.value,onApplyList:_t,onClose:n[6]||(n[6]=H=>G.value=!1)},null,8,["current-models","is-loading"])]),default:c(()=>[p(L,{type:"text",size:"small",loading:ae.value,disabled:ae.value},{icon:c(()=>[p(w(Ze))]),default:c(()=>[n[25]||(n[25]=O(" Model Lists ")),p(w(Oe))]),_:1,__:[25]},8,["loading","disabled"])]),_:1},8,["open","disabled"])]),e("div",Sl,[e("span",null,f(he.value)+" of "+f(W.value)+" models enabled",1)])]),p(De,{activeKey:X.value,"onUpdate:activeKey":n[8]||(n[8]=H=>X.value=H),bordered:!1,class:"provider-collapse",destroyInactivePanel:!1},{default:c(()=>[(s(!0),b(Q,null,le(ve.value,(H,ee)=>(s(),F(xe,{key:`provider-${ee}`},{header:c(()=>{var Ge,Re;return[e("div",Tl,[e("div",Pl,[e("strong",null,f(w(m)(ee)),1),(Ge=N.value[ee])!=null&&Ge.requiresKey&&!((Re=N.value[ee])!=null&&Re.hasKey)?(s(),F(kt,{key:0,placement:"top"},{title:c(()=>{var _e;return[O(" API key not set for "+f((_e=N.value[ee])==null?void 0:_e.providerGroup)+". Click to add in settings. ",1)]}),default:c(()=>[p(L,{type:"link",danger:"",size:"small",onClick:ge(_e=>{var Ae;return dt((Ae=N.value[ee])==null?void 0:Ae.providerGroup)},["stop"])},{icon:c(()=>[p(w(Dt))]),default:c(()=>[n[26]||(n[26]=O(" API Key Missing "))]),_:2,__:[26]},1032,["onClick"])]),_:2},1024)):B("",!0),X.value.includes(ee)?(s(),b(Q,{key:2},[p(Z,{size:"small",color:"blue"},{default:c(()=>[O(f(H.length)+" models",1)]),_:2},1024),p(Z,{size:"small",color:rt(ee)},{default:c(()=>[O(f(ie.value[ee]||0)+" enabled ",1)]),_:2},1032,["color"])],64)):(s(),b("span",Bl,f(ie.value[ee]||0)+" / "+f((w(l)[ee]||[]).length)+" enabled ",1))]),p(Y,{size:"small"},{default:c(()=>[p(L,{type:"text",size:"small",onClick:ge(_e=>Be(ee,!0),["stop"]),disabled:it(ee)||ae.value,loading:ae.value},{icon:c(()=>[p(w(ue))]),default:c(()=>[n[27]||(n[27]=O(" Enable All "))]),_:2,__:[27]},1032,["onClick","disabled","loading"]),p(L,{type:"text",size:"small",onClick:ge(_e=>Be(ee,!1),["stop"]),disabled:ut(ee)||ae.value,loading:ae.value},{icon:c(()=>[p(w(Ie))]),default:c(()=>[n[28]||(n[28]=O(" Disable All "))]),_:2,__:[28]},1032,["onClick","disabled","loading"])]),_:2},1024)])]}),default:c(()=>[(s(),F(xt,null,[p(Ea,{models:H,"provider-id":ee,onToggleModel:pt},null,8,["models","provider-id"])],1024))]),_:2},1024))),128))]),_:1},8,["activeKey"]),Object.keys(ve.value).length===0?(s(),F(Ct,{key:4,description:tt.value,class:"empty-state"},null,8,["description"])):B("",!0),st.value?(s(),F(De,{key:5,activeKey:me.value,"onUpdate:activeKey":n[9]||(n[9]=H=>me.value=H),bordered:!1,class:"ollama-manager-collapse"},{default:c(()=>[p(xe,{key:"ollama"},{header:c(()=>n[29]||(n[29]=[e("div",{class:"ollama-header"},[e("strong",null,"Ollama Model Management"),e("span",{class:"ollama-description"},"Download and manage local Ollama models")],-1)])),default:c(()=>[p(ua,{onModelsUpdated:gt})]),_:1})]),_:1},8,["activeKey"])):B("",!0),ye.value?(s(),F(al,{key:6,class:"enhanced-features"})):B("",!0)])}}}),Il=ce(El,[["__scopeId","data-v-8bb54e66"]]);export{Il as default};
