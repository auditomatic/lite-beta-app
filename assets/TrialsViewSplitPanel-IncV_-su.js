var e=Object.defineProperty,t=(t,a,l)=>((t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l)(t,"symbol"!=typeof a?a+"":a,l);import{k as a,S as l,f as n,c as r,W as s,V as i,d as o,w as c,o as u,b as d,aa as p,a0 as m,$ as f,X as v,u as g,Y as h,_ as y,F as b,ab as _,Z as w,G as k,a3 as x,a2 as C,ae as S,H as T,ai as I,ah as O,aj as E,ak as P,B as $,g as M,s as R,h as N,a6 as F,q as A,A as D,al as j,am as L,af as z,an as U,r as q,ag as V,ad as H,a1 as B}from"./vendor-BsQOyEiA.js";import{I as W,c as G,i as K,h as J,l as Y,K as Q,J as X,R as Z,L as ee,_ as te,N as ae,O as le,T as ne,k as re,n as se,V as ie,w as oe,o as ce,W as ue,m as de,X as pe,H as me,Y as fe,F as ve,Z as ge,p as he,g as ye,e as be,D as _e,C as we,v as ke,$ as xe,E as Ce,A as Se,a0 as Te}from"./index-B0lyZ-Of.js";import{F as Ie}from"./FilterOutlined-C9fokYul.js";import{F as Oe,T as Ee}from"./TrialCreationModalNew-Bt6lx579.js";import{r as Pe,C as $e}from"./api-key-redactor-bj3Cbo2e.js";import{l as Me}from"./db-CL8uhZCz.js";import{_ as Re}from"./BaseModal.vue_vue_type_style_index_0_lang-BT4Y_nhz.js";import"./useEnvironmentalCost-BBcJqOsz.js";import"./token-calculation.service-hs0heR08.js";import"./variable.service-fP1wovT0.js";import"./cost-formatting-Bv_drrqY.js";import"./GenericModelSelectorModal-8IG5KvFy.js";var Ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M516 673c0 4.4 3.4 8 7.5 8h185c4.1 0 7.5-3.6 7.5-8v-48c0-4.4-3.4-8-7.5-8h-185c-4.1 0-7.5 3.6-7.5 8v48zm-194.9 6.1l192-161c3.8-3.2 3.8-9.1 0-12.3l-192-160.9A7.95 7.95 0 00308 351v62.7c0 2.4 1 4.6 2.9 6.1L420.7 512l-109.8 92.2a8.1 8.1 0 00-2.9 6.1V673c0 6.8 7.9 10.5 13.1 6.1zM880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"code",theme:"outlined"};function Fe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){Ae(e,t,a[t])})}return e}function Ae(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var De=function(e,t){var l=Fe({},e,t.attrs);return a(W,Fe({},l,{icon:Ne}),null)};De.displayName="CodeOutlined",De.inheritAttrs=!1;var je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"}}]},name:"dollar",theme:"outlined"};function Le(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){ze(e,t,a[t])})}return e}function ze(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ue=function(e,t){var l=Le({},e,t.attrs);return a(W,Le({},l,{icon:je}),null)};Ue.displayName="DollarOutlined",Ue.inheritAttrs=!1;var qe={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"};function Ve(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){He(e,t,a[t])})}return e}function He(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Be=function(e,t){var l=Ve({},e,t.attrs);return a(W,Ve({},l,{icon:qe}),null)};Be.displayName="ExportOutlined",Be.inheritAttrs=!1;var We={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"}},{tag:"path",attrs:{d:"M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"}}]},name:"field-time",theme:"outlined"};function Ge(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){Ke(e,t,a[t])})}return e}function Ke(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Je=function(e,t){var l=Ge({},e,t.attrs);return a(W,Ge({},l,{icon:We}),null)};Je.displayName="FieldTimeOutlined",Je.inheritAttrs=!1;var Ye={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function Qe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){Xe(e,t,a[t])})}return e}function Xe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ze=function(e,t){var l=Qe({},e,t.attrs);return a(W,Qe({},l,{icon:Ye}),null)};Ze.displayName="InboxOutlined",Ze.inheritAttrs=!1;var et={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};function tt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){at(e,t,a[t])})}return e}function at(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var lt=function(e,t){var l=tt({},e,t.attrs);return a(W,tt({},l,{icon:et}),null)};lt.displayName="PauseCircleOutlined",lt.inheritAttrs=!1;var nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"};function rt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){st(e,t,a[t])})}return e}function st(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var it=function(e,t){var l=rt({},e,t.attrs);return a(W,rt({},l,{icon:nt}),null)};it.displayName="RobotOutlined",it.inheritAttrs=!1;var ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};function ct(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){ut(e,t,a[t])})}return e}function ut(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var dt=function(e,t){var l=ct({},e,t.attrs);return a(W,ct({},l,{icon:ot}),null)};dt.displayName="StopOutlined",dt.inheritAttrs=!1;var pt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M848 359.3H627.7L825.8 109c4.1-5.3.4-13-6.3-13H436c-2.8 0-5.5 1.5-6.9 4L170 547.5c-3.1 5.3.7 12 6.9 12h174.4l-89.4 357.6c-1.9 7.8 7.5 13.3 13.3 7.7L853.5 373c5.2-4.9 1.7-13.7-5.5-13.7zM378.2 732.5l60.3-241H281.1l189.6-327.4h224.6L487 427.4h211L378.2 732.5z"}}]},name:"thunderbolt",theme:"outlined"};function mt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){ft(e,t,a[t])})}return e}function ft(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var vt=function(e,t){var l=mt({},e,t.attrs);return a(W,mt({},l,{icon:pt}),null)};vt.displayName="ThunderboltOutlined",vt.inheritAttrs=!1;const gt="auditomatic.trial-split-view",ht=l("trial-split-view",()=>{const e=s(),t=i(),a=G(),l=n(null),o=n("medium"),c=n(""),u=n("all"),d=n(-1),p=r(()=>l.value&&a.trials.find(e=>e.id===l.value)||null),m=r(()=>{switch(o.value){case"wide":return 400;case"medium":return 250;case"collapsed":return 100}}),f=r(()=>"collapsed"===o.value),v=r(()=>{let e=a.trials;if("all"!==u.value&&(e=e.filter(e=>e.status===u.value)),c.value){const t=c.value.toLowerCase();e=e.filter(e=>!!e.name.toLowerCase().includes(t)||(!(!K(e)||!e.templateName.toLowerCase().includes(t))||!(!J(e)||!e.datasetName.toLowerCase().includes(t))))}return[...e].sort((e,t)=>{const a=e.completed||e.started||e.created;return(t.completed||t.started||t.created).getTime()-a.getTime()})}),g=r(()=>({running:v.value.filter(e=>"running"===e.status),recent:v.value.filter(e=>"running"!==e.status)})),h=r(()=>v.value.length),y=r(()=>{const e={all:a.trials.length,running:0,completed:0,failed:0,draft:0,paused:0};return a.trials.forEach(t=>{const a=t.status;a in e&&e[a]++}),e});function b(t){l.value=t,d.value=-1,t?e.push({name:"trials",params:{trialId:t}}):e.push({name:"trials"}),Y.debug("Trial selected",{trialId:t})}function _(){try{const e={panelMode:o.value,statusFilter:u.value,searchQuery:c.value};localStorage.setItem(`${gt}.preferences`,JSON.stringify(e))}catch(e){Y.warn("Failed to save split view preferences",{error:e})}}return function(){try{const e=localStorage.getItem(`${gt}.preferences`);if(e){const t=JSON.parse(e);t.panelMode&&(o.value=t.panelMode),t.statusFilter&&(u.value=t.statusFilter),t.searchQuery&&(c.value=t.searchQuery)}}catch(e){Y.warn("Failed to load split view preferences",{error:e})}}(),{selectedTrialId:r(()=>l.value),selectedTrial:r(()=>p.value),panelMode:r(()=>o.value),effectiveWidth:r(()=>m.value),isCollapsed:r(()=>f.value),searchQuery:r(()=>c.value),statusFilter:r(()=>u.value),keyboardFocusIndex:r(()=>d.value),filteredTrials:r(()=>v.value),groupedTrials:r(()=>g.value),totalFilteredCount:r(()=>h.value),statusCounts:r(()=>y.value),selectTrial:b,setSearchQuery:function(e){c.value=e,_()},setStatusFilter:function(e){u.value=e,_()},navigateByKeyboard:function(e){const t=[...g.value.running,...g.value.recent];0!==t.length&&(d.value="down"===e?Math.min(d.value+1,t.length-1):Math.max(d.value-1,0),d.value>=0&&d.value<t.length&&b(t[d.value].id))},togglePanelMode:function(){switch(o.value){case"wide":o.value="medium";break;case"medium":o.value="collapsed";break;case"collapsed":o.value="wide"}_()},setPanelMode:function(e){o.value=e,_()},savePreferences:_,clearPreferences:function(){try{localStorage.removeItem(`${gt}.preferences`),o.value="medium",u.value="all",c.value=""}catch(e){Y.warn("Failed to clear split view preferences",{error:e})}},syncWithRoute:function(){const e=t.params.trialId;e&&e!==l.value?l.value=e:e||(l.value=null)}}}),yt=["data-collapsed"],bt={class:"list-toolbar"},_t={class:"list-title"},wt={key:1},kt={key:0,class:"list-actions"},xt={key:0,class:"list-search"},Ct={key:1,class:"status-tabs"},St=["onClick"],Tt={class:"tab-icon"},It={class:"tab-label"},Ot={class:"tab-count"},Et={key:0,class:"list-section"},Pt=["onClick","data-index"],$t={key:0,class:"collapsed-content"},Mt={class:"collapsed-info"},Rt={class:"collapsed-count"},Nt={key:1,class:"item-content"},Ft={class:"item-header"},At={class:"item-name"},Dt={class:"item-meta"},jt={class:"meta-text"},Lt={class:"meta-text"},zt={class:"meta-text"},Ut={key:1,class:"list-section"},qt=["onClick","data-index"],Vt={key:0,class:"collapsed-content"},Ht={class:"collapsed-info"},Bt={class:"collapsed-count"},Wt={key:1,class:"item-content"},Gt={class:"item-header"},Kt={class:"item-name"},Jt={class:"item-meta"},Yt={class:"meta-text"},Qt={class:"meta-text"},Xt={class:"meta-text"},Zt={key:2,class:"empty-list"},ea=te(o({__name:"TrialListPanel",props:{collapsed:{type:Boolean,default:!1}},emits:["create-trial"],setup(e){const t=ht(),l=G(),s=n(),i=n(),o=n(t.searchQuery),S=r(()=>t.selectedTrialId),T=r(()=>t.statusFilter),I=r(()=>t.groupedTrials),O=r(()=>t.totalFilteredCount),E=r(()=>t.keyboardFocusIndex),P=r(()=>t.statusCounts),$=r(()=>[{key:"all",label:"All",icon:"ðŸ“Š",count:P.value.all},{key:"running",label:"Active",icon:"ðŸŸ¢",count:P.value.running+P.value.paused},{key:"completed",label:"Done",icon:"âœ…",count:P.value.completed}]);function M(e){t.selectTrial(e)}function R(e){return 0===e.progress.total?0:Math.round(e.progress.completed/e.progress.total*100)}function N(e){const t=(new Date).getTime()-e.getTime(),a=Math.floor(t/6e4),l=Math.floor(a/60),n=Math.floor(l/24);return a<1?"now":a<60?`${a}m`:l<24?`${l}h`:n<7?`${n}d`:e.toLocaleDateString()}function F(e){"ArrowDown"===e.key||"j"===e.key?(e.preventDefault(),t.navigateByKeyboard("down"),A()):"ArrowUp"!==e.key&&"k"!==e.key||(e.preventDefault(),t.navigateByKeyboard("up"),A())}function A(){const e=i.value?.querySelectorAll(".list-item"),t=E.value;e&&t>=0&&e[t]&&e[t].scrollIntoView({behavior:"smooth",block:"nearest"})}function D({key:e}){t.setStatusFilter(e)}async function j(){await l.initialize()}c(o,e=>{t.setSearchQuery(e)});const L=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),s.value?.focus())};return u(()=>{document.addEventListener("keydown",L)}),d(()=>{document.removeEventListener("keydown",L)}),(e,l)=>{const n=h("a-badge"),r=h("a-button"),c=h("a-tooltip"),u=h("a-menu-item"),d=h("a-menu-divider"),P=h("a-menu"),A=h("a-dropdown"),L=h("a-input"),z=h("a-progress"),U=h("a-tag");return w(),p("div",{class:"trial-list-panel","data-collapsed":e.collapsed},[m("div",bt,[m("div",_t,[e.collapsed?f("",!0):(w(),v(g(Q),{key:0})),e.collapsed?f("",!0):(w(),p("span",wt,"Trials")),a(n,{count:O.value,showZero:!0,style:{"margin-left":"8px"}},null,8,["count"])]),e.collapsed?f("",!0):(w(),p("div",kt,[a(r,{type:"primary",size:"small",onClick:l[0]||(l[0]=t=>e.$emit("create-trial"))},{icon:y(()=>[a(g(X))]),default:y(()=>[l[3]||(l[3]=k(" New Trial "))]),_:1,__:[3]}),a(c,{title:"Refresh"},{default:y(()=>[a(r,{type:"text",size:"small",onClick:j},{icon:y(()=>[a(g(Z))]),_:1})]),_:1}),a(A,null,{overlay:y(()=>[a(P,{onClick:D},{default:y(()=>[a(u,{key:"all"},{default:y(()=>l[4]||(l[4]=[k("All Trials")])),_:1,__:[4]}),a(d),a(u,{key:"running"},{default:y(()=>l[5]||(l[5]=[m("span",{class:"status-dot running"},null,-1),k(" Running Only ")])),_:1,__:[5]}),a(u,{key:"completed"},{default:y(()=>l[6]||(l[6]=[m("span",{class:"status-dot completed"},null,-1),k(" Completed Only ")])),_:1,__:[6]}),a(u,{key:"failed"},{default:y(()=>l[7]||(l[7]=[m("span",{class:"status-dot failed"},null,-1),k(" Failed Only ")])),_:1,__:[7]}),a(u,{key:"paused"},{default:y(()=>l[8]||(l[8]=[m("span",{class:"status-dot paused"},null,-1),k(" Paused Only ")])),_:1,__:[8]}),a(u,{key:"draft"},{default:y(()=>l[9]||(l[9]=[m("span",{class:"status-dot draft"},null,-1),k(" Draft Only ")])),_:1,__:[9]})]),_:1})]),default:y(()=>[a(r,{type:"text",size:"small"},{icon:y(()=>[a(g(Ie))]),_:1})]),_:1})]))]),e.collapsed?f("",!0):(w(),p("div",xt,[a(L,{placeholder:"Filter trials...",size:"small",value:o.value,"onUpdate:value":l[1]||(l[1]=e=>o.value=e),onKeydown:F,ref_key:"searchInputRef",ref:s},{prefix:y(()=>[a(g(ee))]),_:1},8,["value"])])),e.collapsed?f("",!0):(w(),p("div",Ct,[(w(!0),p(b,null,_($.value,e=>(w(),p("div",{key:e.key,class:x(["status-tab",{active:T.value===e.key}]),onClick:a=>{return l=e.key,void t.setStatusFilter(l);var l}},[m("span",Tt,C(e.icon),1),m("span",It,C(e.label),1),m("span",Ot,C(e.count),1)],10,St))),128))])),m("div",{class:"trial-list",ref_key:"trialListRef",ref:i},[I.value.running.length>0?(w(),p("div",Et,[l[14]||(l[14]=m("div",{class:"section-header"},"RUNNING",-1)),(w(!0),p(b,null,_(I.value.running,(t,n)=>(w(),p("div",{key:t.id,class:x(["list-item running-item",{active:S.value===t.id,"keyboard-focus":E.value===n}]),onClick:e=>M(t.id),"data-index":n},[l[13]||(l[13]=m("div",{class:"item-indicator running"},null,-1)),e.collapsed?(w(),p("div",$t,[a(c,{title:`${t.name} - ${t.progress.completed}/${t.progress.total} tasks`},{default:y(()=>[m("div",Mt,[m("span",Rt,C(t.progress.completed),1),a(z,{type:"circle",percent:R(t),width:20,showInfo:!1,strokeWidth:3},null,8,["percent"])])]),_:2},1032,["title"])])):(w(),p("div",Nt,[m("div",Ft,[m("span",At,C(t.name),1),a(U,{color:"blue",size:"small"},{default:y(()=>l[10]||(l[10]=[k("RUNNING")])),_:1,__:[10]}),a(z,{percent:R(t),showInfo:!1,strokeWidth:3,style:{width:"80px"}},null,8,["percent"])]),m("div",Dt,[m("span",jt,C(t.progress.completed)+"/"+C(t.progress.total)+" tasks",1),l[11]||(l[11]=m("span",{class:"meta-separator"},"â€¢",-1)),m("span",Lt,C(N(t.completed||t.started||t.created)),1),l[12]||(l[12]=m("span",{class:"meta-separator"},"â€¢",-1)),m("span",zt,"$"+C((t.estimatedCost||0).toFixed(2)),1)])]))],10,Pt))),128))])):f("",!0),I.value.recent.length>0?(w(),p("div",Ut,[l[17]||(l[17]=m("div",{class:"section-header"},"RECENT",-1)),(w(!0),p(b,null,_(I.value.recent,(t,n)=>{return w(),p("div",{key:t.id,class:x(["list-item",{active:S.value===t.id,"keyboard-focus":E.value===I.value.running.length+n}]),onClick:e=>M(t.id),"data-index":I.value.running.length+n},[m("div",{class:x(["item-indicator",t.status])},null,2),e.collapsed?(w(),p("div",Vt,[a(c,{title:`${t.name} - ${t.status} - ${t.progress.completed} tasks`},{default:y(()=>[m("div",Ht,[m("span",Bt,C(t.progress.completed),1)])]),_:2},1032,["title"])])):(w(),p("div",Wt,[m("div",Gt,[m("span",Kt,C(t.name),1),a(U,{color:(r=t.status,{running:"blue",completed:"green",failed:"red",paused:"orange",draft:"default"}[r]||"default"),size:"small"},{default:y(()=>[k(C(t.status),1)]),_:2},1032,["color"])]),m("div",Jt,[m("span",Yt,C(t.progress.completed)+" tasks",1),l[15]||(l[15]=m("span",{class:"meta-separator"},"â€¢",-1)),m("span",Qt,C(N(t.completed||t.started||t.created)),1),l[16]||(l[16]=m("span",{class:"meta-separator"},"â€¢",-1)),m("span",Xt,"$"+C((t.estimatedCost||0).toFixed(2)),1)])]))],10,qt);var r}),128))])):f("",!0),0===O.value?(w(),p("div",Zt,[a(g(Ze),{style:{"font-size":"32px",color:"#ccc"}}),l[19]||(l[19]=m("p",null,"No trials found",-1)),a(r,{type:"primary",onClick:l[2]||(l[2]=t=>e.$emit("create-trial"))},{default:y(()=>l[18]||(l[18]=[k(" Create New Trial ")])),_:1,__:[18]})])):f("",!0)],512)],8,yt)}}}),[["__scopeId","data-v-cba73fd3"]]),ta={class:"trial-header"},aa={class:"header-top-row"},la={class:"header-left"},na={class:"trial-title"},ra={class:"trial-meta"},sa={class:"progress-inline"},ia={class:"progress-bar-small"},oa={class:"progress-text-inline"},ca={class:"inline-stats"},ua={class:"stat-item"},da={class:"stat-item"},pa={class:"stat-item"},ma={key:0,class:"stat-item"},fa=te(o({__name:"TrialHeader",props:{trial:{}},setup(e){const t=e,l=r(()=>t.trial.name.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}/g,"").replace(/\s*\(Copy\)(\s*\(Copy\))*$/g,"").trim()),n=r(()=>({running:"blue",completed:"green",failed:"red",paused:"orange",draft:"default"}[t.trial.status]||"default")),s=r(()=>0===t.trial.progress.total?0:Math.round(t.trial.progress.completed/t.trial.progress.total*100)),i=r(()=>{if(0===t.trial.progress.total)return 0;const e=t.trial.progress.completed-(t.trial.progress.networkErrors||0);return Math.round(e/t.trial.progress.total*100)}),o=r(()=>{if(!t.trial.created)return"N/A";const e=new Date(t.trial.started||t.trial.created).getTime(),a=(t.trial.completed?new Date(t.trial.completed).getTime():Date.now())-e,l=Math.floor(a/36e5),n=Math.floor(a%36e5/6e4);return l>0?`${l}h ${n}m`:`${n}m`}),c=r(()=>"3.6s"),u=r(()=>{if(!t.trial.started)return"calculating...";const e=Date.now()-new Date(t.trial.started).getTime(),a=t.trial.progress.completed;if(0===a)return"calculating...";const l=e/a*(t.trial.progress.total-a),n=Math.floor(l/6e4),r=Math.floor(l%6e4/1e3);if(n>60){return`${Math.floor(n/60)}h ${n%60}m`}return`${n}m ${r}s`});return(e,t)=>{const r=h("a-tag");return w(),p("div",ta,[m("div",aa,[m("div",la,[m("h2",na,C(l.value),1),m("div",ra,[a(r,{color:n.value,class:"status-tag"},{default:y(()=>[k(C(e.trial.status.toUpperCase()),1)]),_:1},8,["color"]),m("div",sa,[m("div",ia,[m("div",{class:"progress-fill",style:S({width:s.value+"%"})},null,4)]),m("span",oa,C(e.trial.progress.completed)+"/"+C(e.trial.progress.total)+" ("+C(i.value)+"%) ",1)]),m("div",ca,[m("span",ua,[a(g(ae)),t[0]||(t[0]=m("span",null,"Duration:",-1)),m("strong",null,C(o.value),1)]),m("span",da,[a(g(vt)),t[1]||(t[1]=m("span",null,"Latency:",-1)),m("strong",null,C(c.value),1)]),m("span",pa,[a(g(Ue)),t[2]||(t[2]=m("span",null,"Cost:",-1)),m("strong",null,"$"+C((e.trial.estimatedCost||0).toFixed(2)),1)]),"running"===e.trial.status||"paused"===e.trial.status?(w(),p("span",ma,[a(g(Je)),t[3]||(t[3]=m("span",null,"Remaining:",-1)),m("strong",null,"~"+C(u.value),1)])):f("",!0)])])])])])}}}),[["__scopeId","data-v-5e979bc9"]]),va={class:"trial-actions"},ga=te(o({__name:"TrialActions",props:{trial:{},isResuming:{type:Boolean}},emits:["pause-trial","resume-trial","cancel-trial","export-data","export-python","duplicate-trial","edit-trial","delete-trial"],setup:e=>(e,t)=>{const l=h("a-button"),n=h("a-menu-item"),r=h("a-menu"),s=h("a-dropdown");return w(),p("div",va,["running"===e.trial.status?(w(),p(b,{key:0},[a(l,{onClick:t[0]||(t[0]=t=>e.$emit("pause-trial")),size:"large",class:"action-button"},{icon:y(()=>[a(g(lt))]),default:y(()=>[t[9]||(t[9]=k(" Pause "))]),_:1,__:[9]}),a(l,{onClick:t[1]||(t[1]=t=>e.$emit("cancel-trial")),danger:"",size:"large",class:"action-button"},{icon:y(()=>[a(g(dt))]),default:y(()=>[t[10]||(t[10]=k(" Cancel "))]),_:1,__:[10]})],64)):"paused"===e.trial.status?(w(),p(b,{key:1},[a(l,{type:"primary",onClick:t[2]||(t[2]=t=>e.$emit("resume-trial")),disabled:e.isResuming,size:"large",class:"action-button"},{icon:y(()=>[e.isResuming?(w(),v(g(le),{key:0,spin:""})):(w(),v(g(ne),{key:1}))]),default:y(()=>[k(" "+C(e.isResuming?"Resuming...":"Resume"),1)]),_:1},8,["disabled"]),a(l,{onClick:t[3]||(t[3]=t=>e.$emit("cancel-trial")),danger:"",size:"large",class:"action-button"},{icon:y(()=>[a(g(dt))]),default:y(()=>[t[11]||(t[11]=k(" Cancel "))]),_:1,__:[11]})],64)):f("",!0),a(s,null,{overlay:y(()=>[a(r,null,{default:y(()=>[a(n,{onClick:t[4]||(t[4]=t=>e.$emit("export-data"))},{default:y(()=>[a(g(Oe)),t[13]||(t[13]=k(" Export Data "))]),_:1,__:[13]}),a(n,{onClick:t[5]||(t[5]=t=>e.$emit("export-python"))},{default:y(()=>[a(g(De)),t[14]||(t[14]=k(" Export Python Script "))]),_:1,__:[14]})]),_:1})]),default:y(()=>[a(l,{size:"large",class:"action-button"},{icon:y(()=>[a(g(se))]),default:y(()=>[t[12]||(t[12]=k(" Export ")),a(g(re))]),_:1,__:[12]})]),_:1}),a(l,{onClick:t[6]||(t[6]=t=>e.$emit("duplicate-trial")),size:"large",class:"action-button"},{icon:y(()=>[a(g(ie))]),default:y(()=>[t[15]||(t[15]=k(" Duplicate "))]),_:1,__:[15]}),"draft"===e.trial.status?(w(),v(l,{key:2,onClick:t[7]||(t[7]=t=>e.$emit("edit-trial")),size:"large",class:"action-button"},{icon:y(()=>[a(g(oe))]),default:y(()=>[t[16]||(t[16]=k(" Edit "))]),_:1,__:[16]})):f("",!0),a(l,{onClick:t[8]||(t[8]=t=>e.$emit("delete-trial")),danger:"",size:"large",class:"action-button"},{icon:y(()=>[a(g(ce))]),default:y(()=>[t[17]||(t[17]=k(" Delete "))]),_:1,__:[17]})])}}),[["__scopeId","data-v-7a87e1d1"]]);"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const ha=()=>{};function ya(e,t=200,a=!1,l=!0,n=!1){return function(e,t){return function(...a){return new Promise((l,n)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(l).catch(n)})}}(function(...e){let t,a,l,n,r,s,i=0,o=!0,c=ha;T(e[0])||"object"!=typeof e[0]?[l,n=!0,r=!0,s=!1]=e:({delay:l,trailing:n=!0,leading:r=!0,rejectOnCancel:s=!1}=e[0]);const u=()=>{t&&(clearTimeout(t),t=void 0,c(),c=ha)};return e=>{const d=I(l),p=Date.now()-i,m=()=>a=e();return u(),d<=0?(i=Date.now(),m()):(p>d&&(r||!o)?(i=Date.now(),m()):n&&(a=new Promise((e,a)=>{c=s?a:e,t=setTimeout(()=>{i=Date.now(),o=!0,e(m()),u()},Math.max(0,d-p))})),r||t||(t=setTimeout(()=>o=!0,d)),o=!1,a)}}(t,a,l,n),e)}const ba={class:"virtual-table"},_a={class:"virtual-table"},wa=["data-row-index","data-row-id","onClick"],ka=te(o({__name:"VirtualTable",props:{columns:{},dataSource:{},rowHeight:{default:48},rowKey:{type:[String,Function],default:"id"},overscan:{default:5},showHeader:{type:Boolean,default:!0},getRowClass:{},minHeight:{default:"300px"},maxHeight:{default:"calc(100vh - 250px)"}},emits:["row-click"],setup(e,{expose:t,emit:a}){E(e=>({"78c5e07f":e.minHeight,"4abaca11":e.maxHeight}));const l=e,s=a,i=n(),o=n(),v=n(0),h=n(0),y=n(0);let T=null;const I=r(()=>l.dataSource.length*l.rowHeight),P=r(()=>{const e=Math.floor(v.value/l.rowHeight),t=Math.ceil((v.value+h.value)/l.rowHeight);return{start:Math.max(0,e-l.overscan),end:Math.min(l.dataSource.length,t+l.overscan)}}),$=r(()=>P.value.start),M=r(()=>l.dataSource.slice(P.value.start,P.value.end)),R=r(()=>$.value*l.rowHeight);function N(e){return"function"==typeof l.rowKey?l.rowKey(e):e[l.rowKey]}function F(e,t){const a=t.key.split(".");let l=e;for(const n of a){if(!l||"object"!=typeof l)return;l=l[n]}return l}function A(e){const t={};return e.width&&(t.width="number"==typeof e.width?`${e.width}px`:e.width),e.align&&(t.textAlign=e.align),t}const D=ya(e=>{null!==T&&cancelAnimationFrame(T),T=requestAnimationFrame(()=>{const t=e.target;v.value=t.scrollTop,T=null})},16);let j=null;function L(){if(i.value){const e=i.value.querySelector(".virtual-content");h.value=e?e.clientHeight:i.value.clientHeight}o.value&&(y.value=o.value.offsetHeight)}function z(){if(i.value){const e=i.value.querySelector(".virtual-content");e&&(e.scrollTop=0)}}return u(()=>{L(),i.value&&(j=new ResizeObserver(()=>{L()}),j.observe(i.value))}),d(()=>{j&&j.disconnect(),null!==T&&cancelAnimationFrame(T)}),c(()=>l.dataSource.length,()=>{v.value>I.value&&z()}),t({scrollToRow:function(e){if(i.value){const t=i.value.querySelector(".virtual-content");if(t){const a=e*l.rowHeight;t.scrollTop=a}}},scrollToTop:z}),(e,t)=>(w(),p("div",{class:"virtual-table-container",ref_key:"containerRef",ref:i,"data-testid":"virtual-table",role:"table","aria-label":"Data table with virtual scrolling"},[e.showHeader?(w(),p("div",{key:0,class:"virtual-header",ref_key:"headerRef",ref:o},[m("table",ba,[m("thead",null,[m("tr",null,[(w(!0),p(b,null,_(e.columns,e=>(w(),p("th",{key:e.key,style:S(A(e)),class:x(e.className)},C(e.title),7))),128))])])])],512)):f("",!0),m("div",{class:"virtual-content",style:S({height:`calc(100% - ${y.value}px)`}),onScrollPassive:t[0]||(t[0]=(...e)=>g(D)&&g(D)(...e))},[m("div",{class:"virtual-spacer",style:S({height:I.value+"px"})},[m("div",{class:"virtual-viewport",style:S({transform:`translateY(${R.value}px)`})},[m("table",_a,[m("tbody",null,[(w(!0),p(b,null,_(M.value,(t,a)=>(w(),p("tr",{key:N(t),"data-row-index":$.value+a,"data-row-id":N(t),class:x(e.getRowClass?e.getRowClass(t):""),"data-testid":"table-row",role:"row",onClick:e=>function(e){s("row-click",e)}(t)},[(w(!0),p(b,null,_(e.columns,a=>(w(),p("td",{key:a.key,style:S(A(a)),class:x(a.className)},[O(e.$slots,"cell",{column:a,record:t,value:F(t,a)},()=>[k(C(F(t,a)),1)],!0)],6))),128))],10,wa))),128))])])],4)],4)],36)],512))}}),[["__scopeId","data-v-abacd51a"]]);const xa=new class{constructor(){t(this,"metrics",[]),t(this,"recording",!1),t(this,"recordingStartTime",null),t(this,"overlayElement",null),t(this,"rafId",null),t(this,"lastFrameTime",0),t(this,"fpsHistory",[]),t(this,"componentRenderCounts",{}),t(this,"measurementMap",new Map)}calculateFPS(){const e=performance.now();if(0===this.lastFrameTime)return this.lastFrameTime=e,60;const t=1e3/(e-this.lastFrameTime);return this.lastFrameTime=e,this.fpsHistory.push(t),this.fpsHistory.length>60&&this.fpsHistory.shift(),this.fpsHistory.reduce((e,t)=>e+t,0)/this.fpsHistory.length}getMemoryUsage(){if("memory"in performance&&performance.memory){return performance.memory.usedJSHeapSize/1048576}return 0}getDOMNodeCount(){return document.querySelectorAll("*").length}start(e){this.measurementMap.set(e,performance.now())}end(e){const t=this.measurementMap.get(e);if(!t)return console.warn(`No start time found for label: ${e}`),0;const a=performance.now()-t;return this.measurementMap.delete(e),a}measure(e,t){const a=performance.now(),l=t(),n=performance.now()-a;if(this.recording){this.getCurrentMetrics().renderTime=n}return l}trackComponentRender(e){this.componentRenderCounts[e]=(this.componentRenderCounts[e]||0)+1}getCurrentMetrics(){return{fps:this.calculateFPS(),renderTime:0,updateTime:0,memoryUsage:this.getMemoryUsage(),domNodes:this.getDOMNodeCount(),componentRenders:{...this.componentRenderCounts}}}showOverlay(e){e&&!this.overlayElement?(this.createOverlay(),this.startOverlayUpdate()):!e&&this.overlayElement&&this.destroyOverlay()}createOverlay(){this.overlayElement=document.createElement("div"),this.overlayElement.id="performance-overlay",this.overlayElement.style.cssText="\n      position: fixed;\n      top: 10px;\n      right: 10px;\n      background: rgba(0, 0, 0, 0.8);\n      color: #0f0;\n      font-family: monospace;\n      font-size: 12px;\n      padding: 10px;\n      border-radius: 5px;\n      z-index: 999999;\n      pointer-events: none;\n      min-width: 200px;\n    ",document.body.appendChild(this.overlayElement)}destroyOverlay(){this.overlayElement&&(document.body.removeChild(this.overlayElement),this.overlayElement=null),null!==this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null)}updateOverlay(){if(!this.overlayElement)return;const e=this.getCurrentMetrics(),t=e.memoryUsage>100?"#f00":e.memoryUsage>50?"#ff0":"#0f0",a=e.fps<30?"#f00":e.fps<55?"#ff0":"#0f0",l=e.domNodes>5e3?"#f00":e.domNodes>2e3?"#ff0":"#0f0";this.overlayElement.innerHTML=`\n      <div style="margin-bottom: 5px; font-weight: bold;">Performance Monitor</div>\n      <div>FPS: <span style="color: ${a}">${e.fps.toFixed(1)}</span></div>\n      <div>Memory: <span style="color: ${t}">${e.memoryUsage.toFixed(1)} MB</span></div>\n      <div>DOM Nodes: <span style="color: ${l}">${e.domNodes}</span></div>\n      ${e.renderTime>0?`<div>Render: ${e.renderTime.toFixed(1)}ms</div>`:""}\n      ${e.updateTime>0?`<div>Update: ${e.updateTime.toFixed(1)}ms</div>`:""}\n    `}startOverlayUpdate(){const e=()=>{this.updateOverlay(),this.rafId=requestAnimationFrame(e)};e()}startRecording(){this.recording=!0,this.recordingStartTime=new Date,this.metrics=[],this.componentRenderCounts={};const e=setInterval(()=>{this.recording?this.metrics.push(this.getCurrentMetrics()):clearInterval(e)},100)}stopRecording(){if(!this.recording||!this.recordingStartTime)throw new Error("No recording in progress");this.recording=!1;const e=new Date,t={avgFps:this.metrics.reduce((e,t)=>e+t.fps,0)/this.metrics.length||0,avgRenderTime:this.metrics.reduce((e,t)=>e+t.renderTime,0)/this.metrics.length||0,avgUpdateTime:this.metrics.reduce((e,t)=>e+t.updateTime,0)/this.metrics.length||0,peakMemoryUsage:Math.max(...this.metrics.map(e=>e.memoryUsage)),totalRenders:Object.values(this.componentRenderCounts).reduce((e,t)=>e+t,0)},a={startTime:this.recordingStartTime,endTime:e,duration:e.getTime()-this.recordingStartTime.getTime(),metrics:this.metrics,summary:t};return this.recordingStartTime=null,this.metrics=[],a}exportReport(e){const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download=`performance-report-${e.startTime.toISOString()}.json`,l.click(),URL.revokeObjectURL(a)}logWarning(e,t){console.warn(`[Performance Warning] ${e}`,t)}checkPerformance(){const e=this.getCurrentMetrics();e.fps<30&&this.logWarning(`Low FPS detected: ${e.fps.toFixed(1)}`,{fps:e.fps}),e.memoryUsage>100&&this.logWarning(`High memory usage: ${e.memoryUsage.toFixed(1)} MB`,{memoryUsage:e.memoryUsage}),e.domNodes>5e3&&this.logWarning(`Excessive DOM nodes: ${e.domNodes}`,{domNodes:e.domNodes})}},Ca=te(o({__name:"VirtualDataTable",props:{columns:{},dataSource:{},loading:{type:Boolean,default:!1},rowKey:{},rowHeight:{type:[Number,Function],default:60},overscan:{default:10},pagination:{type:[Boolean,Object],default:!1},scroll:{},size:{default:"small"},customRow:{},onRow:{},rowClassName:{},className:{},style:{},forceVirtual:{type:Boolean,default:!1}},emits:["row-click","cell-click"],setup(e,{emit:t}){const a=e,l=t,n=r(()=>!!a.forceVirtual||a.dataSource.length>100&&(xa.trackComponentRender("VirtualDataTable"),!0)),s=r(()=>a.columns.map(e=>({key:e.key||("string"==typeof e.dataIndex?e.dataIndex:e.dataIndex?.[0])||"",title:e.title,width:e.width,align:e.align,className:e.className}))),i=r(()=>{if("function"==typeof a.rowHeight)return a.rowHeight;return{small:48,middle:60,large:72}[a.size||"small"]||a.rowHeight});function o(e){if(l("row-click",e),a.customRow){const t=a.customRow(e);t&&"object"==typeof t&&"onClick"in t&&t.onClick()}}function c(e){if("function"==typeof a.rowClassName){const t=a.dataSource.indexOf(e);return a.rowClassName(e,t)}return a.rowClassName||""}const u=r(()=>{const e={};return a.customRow&&(e.customRow=a.customRow),a.onRow&&(e.onRow=a.onRow),a.rowClassName&&(e.rowClassName=a.rowClassName),e});return(e,t)=>(w(),p("div",{class:x(["virtual-data-table",{"virtual-enabled":n.value}])},[n.value?(w(),v(ka,{key:0,columns:s.value,"data-source":e.dataSource,"row-height":"function"==typeof i.value?void 0:i.value,"row-key":e.rowKey,overscan:e.overscan,"show-header":!0,"get-row-class":c,"min-height":e.scroll?.y?`${e.scroll.y}px`:"400px","max-height":e.scroll?.y?`${e.scroll.y}px`:"calc(100vh - 300px)",onRowClick:o},{cell:y(({column:t,record:a,value:l})=>[O(e.$slots,"bodyCell",{column:e.columns.find(e=>e.key===t.key||e.dataIndex===t.key),record:a,text:l,value:l,index:e.dataSource.indexOf(a)},()=>[k(C(l),1)],!0)]),_:3},8,["columns","data-source","row-height","row-key","overscan","min-height","max-height"])):(w(),v(g(ue),P({key:1},u.value,{columns:e.columns,"data-source":e.dataSource,loading:e.loading,pagination:e.pagination,scroll:e.scroll,size:e.size,"row-key":e.rowKey,"custom-row":e.customRow,"row-class-name":e.rowClassName,class:e.className,style:e.style}),{bodyCell:y(({column:t,record:a,text:l,value:n,index:r})=>[O(e.$slots,"bodyCell",{column:t,record:a,text:l,value:n,index:r},void 0,!0)]),_:3},16,["columns","data-source","loading","pagination","scroll","size","row-key","custom-row","row-class-name","class","style"]))],2))}}),[["__scopeId","data-v-2264c400"]]),Sa={class:"api-call-modal"},Ta={class:"modal-header"},Ia={class:"modal-content"},Oa={class:"section"},Ea={class:"info-grid"},Pa={class:"info-item"},$a={class:"call-id"},Ma={class:"info-item"},Ra={class:"info-item"},Na={class:"info-item"},Fa={key:0,class:"info-item"},Aa={key:1,class:"info-item"},Da={key:2,class:"info-item"},ja={class:"section"},La={class:"variables-detail"},za={class:"variable-value"},Ua={key:0,class:"attributes-section"},qa={class:"attribute-items"},Va={class:"section"},Ha={class:"prompt-display"},Ba={key:0,class:"section"},Wa={key:0,class:"response-info"},Ga={class:"info-grid"},Ka={class:"info-item"},Ja={class:"info-item"},Ya={key:1,class:"result-content"},Qa={key:0,class:"error-result"},Xa={class:"error-message"},Za={key:0,class:"error-raw"},el={class:"error-response"},tl={key:1,class:"content-result"},al={class:"content-display"},ll={class:"section"},nl={class:"raw-data"},rl={key:1,class:"section"},sl={class:"raw-data"},il={class:"modal-footer"},ol=te(o({__name:"APICallDetailModal",props:{apiCall:{},trial:{}},emits:["close"],setup(e){const t=e,l=r(()=>{if(!t.apiCall.request)return"No request data";let e;t.trial&&t.trial.configurationSnapshots[t.apiCall.configurationIndex]&&(e=t.trial.configurationSnapshots[t.apiCall.configurationIndex].provider);const a=Pe(t.apiCall.request,e);return JSON.stringify(a,null,2)});function n(){return t.trial&&t.trial.configurationSnapshots[t.apiCall.configurationIndex]&&t.trial.configurationSnapshots[t.apiCall.configurationIndex].name||`Configuration ${t.apiCall.configurationIndex+1}`}function s(e){const t="string"==typeof e?new Date(e):e;return isNaN(t.getTime())?"Invalid date":t.toLocaleString()}async function i(){const e={id:t.apiCall.id,status:t.apiCall.status,configuration:n(),variables:t.apiCall.variables,variableAttributes:t.apiCall.variableAttributes,prompt:t.apiCall.prompt,request:JSON.parse(l.value),response:t.apiCall.response,result:t.apiCall.result,created:t.apiCall.created,completed:t.apiCall.completed},a=JSON.stringify(e,null,2);try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(a),void de.success("Details copied to clipboard!");const e=document.createElement("textarea");e.value=a,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();const t=document.execCommand("copy");if(document.body.removeChild(e),!t)throw new Error("execCommand failed");de.success("Details copied to clipboard!")}catch(r){Y.error("Failed to copy to clipboard",r),prompt("Copy this text manually:",a)}}return(e,t)=>{const r=h("a-button");return w(),p("div",{class:"modal-overlay",onClick:t[2]||(t[2]=$(t=>e.$emit("close"),["self"]))},[m("div",Sa,[m("div",Ta,[t[3]||(t[3]=m("h2",null,"API Call Details",-1)),m("button",{class:"close-btn",onClick:t[0]||(t[0]=t=>e.$emit("close")),"data-testid":"btn-close-api-call-modal","aria-label":"Close API call details"},"Ã—")]),m("div",Ia,[m("div",Oa,[t[11]||(t[11]=m("h3",null,"Overview",-1)),m("div",Ea,[m("div",Pa,[t[4]||(t[4]=m("label",null,"Call ID:",-1)),m("span",$a,C(e.apiCall.id),1)]),m("div",Ma,[t[5]||(t[5]=m("label",null,"Status:",-1)),m("span",{class:x(["status-badge",e.apiCall.status])},C(e.apiCall.status),3)]),m("div",Ra,[t[6]||(t[6]=m("label",null,"Configuration:",-1)),m("span",null,C(n()),1)]),m("div",Na,[t[7]||(t[7]=m("label",null,"Created:",-1)),m("span",null,C(s(e.apiCall.created)),1)]),e.apiCall.completed?(w(),p("div",Fa,[t[8]||(t[8]=m("label",null,"Completed:",-1)),m("span",null,C(s(e.apiCall.completed)),1)])):f("",!0),e.apiCall.completed?(w(),p("div",Aa,[t[9]||(t[9]=m("label",null,"Duration:",-1)),m("span",null,C((o=e.apiCall.completed.getTime()-e.apiCall.created.getTime(),o<1e3?`${o}ms`:`${(o/1e3).toFixed(1)}s`)),1)])):f("",!0),e.apiCall.response?.latencyMs?(w(),p("div",Da,[t[10]||(t[10]=m("label",null,"API Latency:",-1)),m("span",null,C(e.apiCall.response.latencyMs)+"ms",1)])):f("",!0)])]),m("div",ja,[t[13]||(t[13]=m("h3",null,"Variables",-1)),m("div",La,[(w(!0),p(b,null,_(Object.entries(e.apiCall.variables),([e,t])=>(w(),p("div",{key:e,class:"variable-item"},[m("label",null,C(e)+":",1),m("span",za,C(t),1)]))),128))]),e.apiCall.variableAttributes&&Object.keys(e.apiCall.variableAttributes).length>0?(w(),p("div",Ua,[t[12]||(t[12]=m("h4",null,"Variable Attributes",-1)),(w(!0),p(b,null,_(Object.entries(e.apiCall.variableAttributes),([e,t])=>(w(),p("div",{key:e,class:"attribute-group"},[m("h5",null,C(e),1),m("div",qa,[(w(!0),p(b,null,_(Object.entries(t),([e,t])=>(w(),p("div",{key:e,class:"attribute-item"},[m("label",null,C(e)+":",1),m("span",null,C(t),1)]))),128))])]))),128))])):f("",!0)]),m("div",Va,[t[14]||(t[14]=m("h3",null,"Resolved Prompt",-1)),m("div",Ha,C(e.apiCall.prompt),1)]),e.apiCall.response||e.apiCall.result?(w(),p("div",Ba,[t[20]||(t[20]=m("h3",null,"Response",-1)),e.apiCall.response?(w(),p("div",Wa,[m("div",Ga,[m("div",Ka,[t[15]||(t[15]=m("label",null,"HTTP Status:",-1)),m("span",null,C(e.apiCall.response.status),1)]),m("div",Ja,[t[16]||(t[16]=m("label",null,"Latency:",-1)),m("span",null,C(e.apiCall.response.latencyMs)+"ms",1)])])])):f("",!0),e.apiCall.result?(w(),p("div",Ya,[!1===e.apiCall.result.success?(w(),p("div",Qa,[t[18]||(t[18]=m("h4",null,"Error",-1)),m("div",Xa,C(e.apiCall.result.error),1),e.apiCall.response?(w(),p("div",Za,[t[17]||(t[17]=m("h5",null,"Raw Response:",-1)),m("pre",el,C(JSON.stringify(e.apiCall.response,null,2)),1)])):f("",!0)])):f("",!0),e.apiCall.result.content?(w(),p("div",tl,[t[19]||(t[19]=m("h4",null,"Content",-1)),m("div",al,C(e.apiCall.result.content),1)])):f("",!0)])):f("",!0)])):f("",!0),m("div",ll,[t[21]||(t[21]=m("h3",null,"Raw Request",-1)),m("pre",nl,C(l.value),1)]),e.apiCall.response?(w(),p("div",rl,[t[22]||(t[22]=m("h3",null,"Raw Response",-1)),m("pre",sl,C(JSON.stringify(e.apiCall.response,null,2)),1)])):f("",!0)]),m("div",il,[a(r,{onClick:t[1]||(t[1]=t=>e.$emit("close")),size:"large",class:"footer-button","data-testid":"btn-close-modal-footer","aria-label":"Close modal"},{default:y(()=>t[23]||(t[23]=[k(" Close ")])),_:1,__:[23]}),a(r,{type:"primary",onClick:i,size:"large",class:"footer-button footer-button-primary","data-testid":"btn-copy-api-call-details","aria-label":"Copy API call details to clipboard"},{default:y(()=>t[24]||(t[24]=[k(" Copy Details ")])),_:1,__:[24]})])])]);var o}}}),[["__scopeId","data-v-d0b393dd"]]),cl={VIRTUAL_SCROLLING:{key:"VIRTUAL_SCROLLING",name:"Virtual Scrolling",description:"Enable virtual scrolling for large data tables",defaultValue:!1,experimental:!0},WEB_WORKERS:{key:"WEB_WORKERS",name:"Web Workers",description:"Offload expensive calculations to web workers",defaultValue:!1,experimental:!0},OPTIMIZED_SORTING:{key:"OPTIMIZED_SORTING",name:"Optimized Sorting",description:"Use optimized sorting algorithms with memoization",defaultValue:!1},SHALLOW_REACTIVITY:{key:"SHALLOW_REACTIVITY",name:"Shallow Reactivity",description:"Use shallowRef for large arrays to reduce reactivity overhead",defaultValue:!1},DEBOUNCED_UPDATES:{key:"DEBOUNCED_UPDATES",name:"Debounced Updates",description:"Batch and debounce rapid data updates",defaultValue:!1},DIFFERENTIAL_UPDATES:{key:"DIFFERENTIAL_UPDATES",name:"Differential Updates",description:"Only update changed data instead of full replacement",defaultValue:!1,experimental:!0,dependencies:["DEBOUNCED_UPDATES"]},DATA_WINDOWING:{key:"DATA_WINDOWING",name:"Data Windowing",description:"Keep only visible data in memory with progressive loading",defaultValue:!1,experimental:!0,dependencies:["VIRTUAL_SCROLLING"]},PERFORMANCE_MONITORING:{key:"PERFORMANCE_MONITORING",name:"Performance Monitoring",description:"Enable performance monitoring overlay and metrics",defaultValue:!1}};const ul=new class{constructor(){t(this,"flags"),t(this,"overrides",{});const e={};Object.values(cl).forEach(t=>{e[t.key]=t.defaultValue}),this.flags=n(e),this.loadOverrides(),this.applyURLParams()}isEnabled(e){if(e in this.overrides)return this.overrides[e];if(!(e in cl))return Y.warn(`Unknown feature flag: ${e}`),!1;const t=cl[e];if(t.dependencies)for(const a of t.dependencies)if(!this.isEnabled(a))return!1;return this.flags.value[e]??!1}useFlag(e){return r(()=>this.isEnabled(e))}enable(e,t=!0){e in cl?(this.flags.value[e]=!0,this.overrides[e]=!0,t&&this.saveOverrides(),Y.info(`Feature enabled: ${e}`)):Y.warn(`Unknown feature flag: ${e}`)}disable(e,t=!0){e in cl?(this.flags.value[e]=!1,this.overrides[e]=!1,t&&this.saveOverrides(),Y.info(`Feature disabled: ${e}`)):Y.warn(`Unknown feature flag: ${e}`)}toggle(e,t=!0){this.isEnabled(e)?this.disable(e,t):this.enable(e,t)}resetToDefaults(){Object.values(cl).forEach(e=>{this.flags.value[e.key]=e.defaultValue}),this.overrides={},this.saveOverrides(),Y.info("Feature flags reset to defaults")}enableExperimental(){Object.values(cl).forEach(e=>{e.experimental&&this.enable(e.key,!1)}),this.saveOverrides(),Y.info("All experimental features enabled")}getState(){const e={};return Object.keys(cl).forEach(t=>{e[t]=this.isEnabled(t)}),e}getFlagInfo(e){return cl[e]}getAllFlags(){return Object.values(cl)}loadOverrides(){try{const e=localStorage.getItem("auditomatic_feature_flags");e&&(this.overrides=JSON.parse(e),Object.entries(this.overrides).forEach(([e,t])=>{e in this.flags.value&&(this.flags.value[e]=t)}),Y.info("Loaded feature flag overrides",this.overrides))}catch(e){Y.error("Failed to load feature flag overrides",e)}}saveOverrides(){try{localStorage.setItem("auditomatic_feature_flags",JSON.stringify(this.overrides))}catch(e){Y.error("Failed to save feature flag overrides",e)}}applyURLParams(){new URLSearchParams(window.location.search).forEach((e,t)=>{if(t.startsWith("feature_")){const a=t.substring(8).toUpperCase(),l="true"===e||"1"===e;a in cl&&(this.overrides[a]=l,this.flags.value[a]=l,Y.info(`Feature flag set from URL: ${a} = ${l}`))}})}enablePerformanceOptimizations(e="basic"){const t=["VIRTUAL_SCROLLING","WEB_WORKERS","DIFFERENTIAL_UPDATES"],a=["DATA_WINDOWING"];"basic"!==e&&"advanced"!==e&&"all"!==e||["OPTIMIZED_SORTING","SHALLOW_REACTIVITY","DEBOUNCED_UPDATES","PERFORMANCE_MONITORING"].forEach(e=>this.enable(e,!1)),"advanced"!==e&&"all"!==e||t.forEach(e=>this.enable(e,!1)),"all"===e&&a.forEach(e=>this.enable(e,!1)),this.saveOverrides(),Y.info(`Performance optimizations enabled: ${e}`)}},dl=new Map;function pl(e,t={}){const a=n(0),l=ul.isEnabled("OPTIMIZED_SORTING"),s=r(()=>{a.value;const n=e.value;if(!n||0===n.length)return[];const r=t.compareFunction||((e,t)=>e<t?-1:e>t?1:0);t.trackPerformance&&xa.start("optimizedSort");try{const e=t.cacheKey||(l?function(e,t){const a=e[0],l=e[e.length-1],n=e[Math.floor(e.length/2)];return`${e.length}-${JSON.stringify(a)?.slice(0,20)}-${JSON.stringify(n)?.slice(0,20)}-${JSON.stringify(l)?.slice(0,20)}-${t?.toString().slice(0,50)}`}(n,r):null);if(l&&e&&dl.has(e)){const a=dl.get(e);if(a.length===n.length){if(t.trackPerformance){const e=xa.end("optimizedSort");Y.debug(`Sort cache hit: ${e}ms`)}return a}}const a=l?function(e,t,a){return e.length<32?function(e,t,a){const l=a?e:[...e];for(let n=1;n<l.length;n++){const e=l[n];let a=n-1;for(;a>=0&&t(l[a],e)>0;)l[a+1]=l[a],a--;l[a+1]=e}return l}(e,t,a):function(e,t){for(let a=1;a<e.length;a++)if(t(e[a-1],e[a])>0)return!1;return!0}(e,t)?a?e:[...e]:(a?e:[...e]).sort(t)}(n,r,!1):[...n].sort(r);if(l&&e&&(dl.set(e,a),function(){if(dl.size>100){const e=Math.floor(dl.size/2),t=Array.from(dl.keys());for(let a=0;a<e;a++)dl.delete(t[a])}}()),t.trackPerformance){const e=xa.end("optimizedSort");e>16&&xa.logWarning(`Slow sort: ${e}ms for ${n.length} items`)}return a}catch(s){return t.trackPerformance&&xa.end("optimizedSort"),Y.error("Sort error:",s),[...n]}});return{sorted:s,resort:function(){a.value++},clearCache:function(){if(t.cacheKey)dl.delete(t.cacheKey);else if(e.value){const t=`${e.value.length}-`;Array.from(dl.keys()).filter(e=>e.startsWith(t)).forEach(e=>dl.delete(e))}a.value++}}}const ml={class:"results-table-container"},fl={class:"filters-bar"},vl={key:0,class:"queue-position"},gl={key:1},hl={key:0,class:"repeat-index"},yl={key:1,class:"text-secondary"},bl={key:3,class:"variables-compact"},_l={key:0,class:"text-secondary"},wl={key:1,class:"text-secondary"},kl={key:2,class:"text-error"},xl={key:3,class:"response-content"},Cl={key:4,class:"text-secondary"},Sl={key:0,class:"length-value"},Tl={key:1,class:"text-secondary"},Il={key:0},Ol={key:1,class:"text-secondary"},El=te(o({__name:"TrialResultsTable",props:{trial:{},apiCalls:{},loading:{type:Boolean}},setup(e){const t=e,l=n(""),s=n(""),i=n(""),o=function(e,t=300){const a=n(e.value);let l;const r=c(e,e=>{clearTimeout(l),l=window.setTimeout(()=>{a.value=e},t)});return M()&&d(()=>{clearTimeout(l),r()}),a}(i,300),u=n(!1),x=n(null),S=r(()=>{const e=t.trial.repeatConfig?.callsPerPrompt?96:80;return ul.isEnabled("SHALLOW_REACTIVITY")?e:e+16}),T=r(()=>{const e=[{title:"Status",key:"status",dataIndex:"status",width:120,fixed:"left"},{title:"Configuration",key:"config",dataIndex:"configurationIndex",width:200}];return pe(t.trial)&&e.push({title:"Repeat",key:"repeat",dataIndex:"repeatIndex",width:100}),[...e,{title:"Variables",key:"variables",dataIndex:"variables",width:500},{title:"Response",key:"response",dataIndex:"result",ellipsis:!0,minWidth:400},{title:"Length",key:"length",dataIndex:"result",width:120,align:"right"},{title:"Latency",key:"latency",dataIndex:"response",width:120,align:"right"}]}),I=R([]),O=R([]);let E=0,P="";N(()=>{const e=t.apiCalls||[];if(e.length!==E)return E=e.length,void(O.value=e);let a=`${e.length}`;const l=Math.min(5,e.length),n=Math.max(1,Math.floor(e.length/l));for(let t=0;t<e.length;t+=n){const l=e[t];l&&(a+=`|${l.id}-${l.status}-${l.result?.success}-${l.response?.latencyMs}`)}a!==P&&(P=a,O.value=e)});const{sorted:$}=function(e,t={}){const a=e=>{switch(e){case"pending":return 1;case"running":return 2;case"completed":case"failed":return 3;default:return 4}};return pl(e,{...t,compareFunction:(e,t)=>{const l=a(e.status),n=a(t.status);if(l!==n)return l-n;const r=e.created instanceof Date?e.created.getTime():new Date(e.created).getTime(),s=t.created instanceof Date?t.created.getTime():new Date(t.created).getTime();return"pending"===e.status?r-s:s-r},cacheKey:`apiCall-${e.value.length}-${e.value[0]?.id||""}-${e.value[e.value.length-1]?.id||""}`})}(O,{trackPerformance:ul.isEnabled("PERFORMANCE_MONITORING")}),A=r(()=>ul.isEnabled("OPTIMIZED_SORTING")?$.value:O.value);let D="";N(()=>{const e=A.value.slice(0,3).map(e=>`${e.id}-${e.status}`).join(","),a=`${l.value}|${s.value}|${o.value}|${A.value.length}|${e}`;if(a===D)return;D=a,ul.isEnabled("PERFORMANCE_MONITORING")&&xa.start("filterApiCalls");let n=A.value;if(l.value&&(n=n.filter(e=>e.status===l.value)),""!==s.value&&(n=n.filter(e=>e.configurationIndex===Number(s.value))),o.value){const e=o.value.toLowerCase();n=n.filter(t=>{if(JSON.stringify(t.variables).toLowerCase().includes(e))return!0;if(t.result?.content){if(String(t.result.content).toLowerCase().includes(e))return!0}return!1})}if(I.value=n,ul.isEnabled("PERFORMANCE_MONITORING")){const e=xa.end("filterApiCalls");e>16&&xa.logWarning(`Slow filter operation: ${e}ms for ${t.apiCalls.length} items`)}});const j=r(()=>I.value);function L(e){const a=t.trial.configurationSnapshots[e];return a?.name||`Config ${e+1}`}return(e,t)=>{const n=h("a-select-option"),r=h("a-select"),o=h("a-input-search"),c=h("a-space"),d=h("a-button"),I=h("a-tag"),O=h("a-tooltip");return w(),p("div",ml,[m("div",fl,[a(c,{size:"large",style:{flex:"1"}},{default:y(()=>[a(r,{value:l.value,"onUpdate:value":t[0]||(t[0]=e=>l.value=e),placeholder:"All Statuses",style:{width:"200px"},size:"large","allow-clear":"","data-testid":"select-status-filter","aria-label":"Filter results by status"},{default:y(()=>[a(n,{value:""},{default:y(()=>t[6]||(t[6]=[k("All Statuses")])),_:1,__:[6]}),a(n,{value:"completed"},{default:y(()=>t[7]||(t[7]=[k("Completed")])),_:1,__:[7]}),a(n,{value:"failed"},{default:y(()=>t[8]||(t[8]=[k("Failed")])),_:1,__:[8]}),a(n,{value:"running"},{default:y(()=>t[9]||(t[9]=[k("Running")])),_:1,__:[9]}),a(n,{value:"pending"},{default:y(()=>t[10]||(t[10]=[k("Pending")])),_:1,__:[10]})]),_:1},8,["value"]),a(r,{value:s.value,"onUpdate:value":t[1]||(t[1]=e=>s.value=e),placeholder:"All Configurations",style:{width:"250px"},size:"large","allow-clear":"","data-testid":"select-config-filter","aria-label":"Filter results by configuration"},{default:y(()=>[a(n,{value:""},{default:y(()=>t[11]||(t[11]=[k("All Configurations")])),_:1,__:[11]}),(w(!0),p(b,null,_(e.trial.configurationSnapshots,(e,t)=>(w(),v(n,{key:`config-${e.name||t}`,value:t},{default:y(()=>[k(C(e.name||`Config ${t+1}`),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),a(o,{value:i.value,"onUpdate:value":t[2]||(t[2]=e=>i.value=e),placeholder:"Search variables or response...",style:{width:"400px",flex:"1"},size:"large","allow-clear":"","data-testid":"input-search-results","aria-label":"Search in variables or response content"},null,8,["value"])]),_:1}),a(d,{size:"large",type:"primary",onClick:t[3]||(t[3]=e=>u.value=!0),"data-testid":"btn-export-results-data","aria-label":"Export trial results data"},{icon:y(()=>[a(g(Be))]),default:y(()=>[t[12]||(t[12]=k(" Export Data "))]),_:1,__:[12]})]),a(Ca,{columns:T.value,"data-source":j.value,loading:e.loading,pagination:!1,scroll:{x:1600,y:800},size:"middle","row-key":"id",class:"results-table","custom-row":e=>({onClick:()=>{return t=e,void(x.value=t);var t},class:"clickable-row"}),"row-height":S.value,overscan:10,"force-virtual":!0},{bodyCell:y(({column:e,record:l})=>{return["status"===e.key?(w(),p(b,{key:0},[a(I,{color:(n=l.status,{completed:"success",failed:"error",running:"processing",pending:"default"}[n]||"default")},{default:y(()=>[k(C(l.status.toUpperCase()),1)]),_:2},1032,["color"]),"pending"===l.status&&l.queuePosition?(w(),p("span",vl," #"+C(l.queuePosition)+" in queue ",1)):f("",!0)],64)):f("",!0),"config"===e.key?(w(),p("code",gl,C(L(l.configurationIndex)),1)):f("",!0),"repeat"===e.key?(w(),p(b,{key:2},[void 0!==l.repeatIndex?(w(),p("span",hl," #"+C(l.repeatIndex+1),1)):(w(),p("span",yl,"-"))],64)):f("",!0),"variables"===e.key?(w(),p("div",bl,[(w(!0),p(b,null,_(l.variables,(e,t)=>(w(),v(O,{key:t},{title:y(()=>[k(C(t)+": "+C(e),1)]),default:y(()=>[a(I,null,{default:y(()=>{return[k(C(t)+": "+C((a=String(e),l=20,a.length<=l?a:a.substring(0,l)+"...")),1)];var a,l}),_:2},1024)]),_:2},1024))),128))])):f("",!0),"response"===e.key?(w(),p(b,{key:4},["pending"===l.status?(w(),p("div",_l," Waiting... ")):"running"===l.status?(w(),p("div",wl,[a(g(le)),t[13]||(t[13]=k(" Processing... "))])):"failed"===l.status?(w(),p("div",kl,C(l.result?.error||"API call failed"),1)):l.result?.content?(w(),p("div",xl,[m("span",null,C(String(l.result.content)),1)])):(w(),p("div",Cl," No content "))],64)):f("",!0),"length"===e.key?(w(),p(b,{key:5},[l.result?.content?(w(),p("span",Sl,C(String(l.result.content).length),1)):(w(),p("span",Tl,"-"))],64)):f("",!0),"latency"===e.key?(w(),p(b,{key:6},[l.response?.latencyMs?(w(),p("span",Il,C(l.response.latencyMs)+"ms ",1)):(w(),p("span",Ol,"-"))],64)):f("",!0)];var n}),_:1},8,["columns","data-source","loading","custom-row","row-height"]),u.value?(w(),v(F(()=>me(()=>Promise.resolve().then(()=>Vs),void 0,import.meta.url)),{key:0,trial:e.trial,"api-calls":j.value,onClose:t[4]||(t[4]=e=>u.value=!1)},null,40,["trial","api-calls"])):f("",!0),x.value?(w(),v(ol,{key:1,"api-call":x.value,trial:e.trial,onClose:t[5]||(t[5]=e=>x.value=null)},null,8,["api-call","trial"])):f("",!0)])}}}),[["__scopeId","data-v-4f5c5a3e"]]),Pl={class:"stats-grid"},$l={class:"stat-item"},Ml={class:"stat-value"},Rl={class:"stat-item"},Nl={class:"stat-value"},Fl={class:"stat-item"},Al={class:"stat-value"},Dl={class:"stat-item"},jl={class:"stat-value"},Ll={class:"detail-sections"},zl={class:"detail-row"},Ul={class:"detail-value"},ql={class:"detail-value"},Vl={class:"detail-value"},Hl={key:0,class:"detail-row"},Bl={key:0,class:"separator"},Wl={key:1,class:"detail-row"},Gl={class:"detail-value error"},Kl={key:2,class:"detail-row"},Jl={key:0,class:"separator"},Yl={key:3,class:"detail-row"},Ql={class:"detail-value"},Xl={key:4,class:"detail-row"},Zl={key:5,class:"detail-section"},en={class:"template-preview"},tn={key:0,class:"action-buttons"},an=te(o({__name:"TrialDetailView",props:{trial:{},compact:{type:Boolean}},setup(e){const t=e,l=s(),i=G(),o=n(!1),c=r(()=>K(t.trial)?t.trial.templateName:t.trial.spreadsheetName),u=r(()=>fe(t.trial));function d(e,t){const a=t.getTime()-e.getTime(),l=Math.floor(a/36e5),n=Math.floor(a%36e5/6e4);return l>0?`${l}h ${n}m`:`${n}m`}async function S(){if(o.value)Y.warn("Trial start already in progress",{trialId:t.trial.id});else{o.value=!0;try{const e=await i.executeTrialWithConfirmation(t.trial.id);if(e.needsConfirmation&&e.runningTrial){if(!(await new Promise(t=>{ge.confirm({title:"Another Trial is Running",content:`"${e.runningTrial.name}" is currently running. Starting this trial will pause it. Continue?`,onOk:()=>t(!0),onCancel:()=>t(!1)})})))return;await i.executeTrialWithConfirmation(t.trial.id,!0)}Y.info("Trial started",{trialId:t.trial.id})}catch(e){Y.error("Failed to start trial",e),ge.error({title:"Failed to start trial",content:e instanceof Error?e.message:"Unknown error"})}finally{o.value=!1}}}function T(){l.push({name:"trials",query:{tab:"create",duplicate:t.trial.id,edit:"true"}})}return(e,l)=>{const n=h("a-button");return w(),p("div",{class:x(["trial-detail-view",{compact:e.compact}])},[m("div",Pl,[m("div",$l,[a(g(ae),{class:"stat-icon-inline"}),l[0]||(l[0]=m("span",{class:"stat-label"},"Duration:",-1)),m("span",Ml,C(d(e.trial.created,e.trial.completed||new Date)),1)]),m("div",Rl,[a(g(Ue),{class:"stat-icon-inline"}),l[1]||(l[1]=m("span",{class:"stat-label"},"Cost:",-1)),m("span",Nl,"$"+C((e.trial.estimatedCost||0).toFixed(2)),1)]),m("div",Fl,[a(g(it),{class:"stat-icon-inline"}),l[2]||(l[2]=m("span",{class:"stat-label"},"Models:",-1)),m("span",Al,C(e.trial.configurationSnapshots?.length||0),1)]),m("div",Dl,[a(g(ve),{class:"stat-icon-inline"}),l[3]||(l[3]=m("span",{class:"stat-label"},"Design:",-1)),m("span",jl,C(c.value),1)])]),m("div",Ll,[m("div",zl,[l[4]||(l[4]=m("span",{class:"detail-label"},"Created:",-1)),m("span",Ul,C(new Date(e.trial.created).toLocaleString()),1),l[5]||(l[5]=m("span",{class:"detail-label"},"Repeats:",-1)),m("span",ql,C(e.trial.repeatConfig?.callsPerPrompt||1)+"x",1),l[6]||(l[6]=m("span",{class:"detail-label"},"Variables:",-1)),m("span",Vl,C((K(t.trial)&&t.trial.variableSnapshots.length>0?t.trial.variableSnapshots[0].originalListName:J(t.trial)?t.trial.datasetName:null)||"None"),1)]),e.trial.configurationSnapshots?.length>0?(w(),p("div",Hl,[l[7]||(l[7]=m("span",{class:"detail-label"},"Models:",-1)),(w(!0),p(b,null,_(e.trial.configurationSnapshots,(t,l)=>(w(),p("span",{key:`trial-config-${t.name}-${l}`,class:"model-inline"},[a(g(it)),k(" "+C(t.name)+" ("+C(t.provider)+", temp: "+C(t.parameters?.temperature||.7)+") ",1),l<e.trial.configurationSnapshots.length-1?(w(),p("span",Bl,"â€¢")):f("",!0)]))),128))])):f("",!0),e.trial.progress.networkErrors>0?(w(),p("div",Wl,[l[8]||(l[8]=m("span",{class:"detail-label"},"Issues:",-1)),m("span",Gl,C(e.trial.progress.networkErrors)+" network errors occurred",1)])):f("",!0),g(K)(e.trial)&&e.trial.variableSnapshots&&e.trial.variableSnapshots.length>0?(w(),p("div",Kl,[l[9]||(l[9]=m("span",{class:"detail-label"},"Variables Used:",-1)),(w(!0),p(b,null,_(e.trial.variableSnapshots,(t,a)=>(w(),p("span",{key:t.variableName,class:"detail-value"},[m("strong",null,C(t.variableName),1),k(" from "+C(t.originalListName)+" ("+C(t.data.itemCount)+" values) ",1),a<e.trial.variableSnapshots.length-1?(w(),p("span",Jl,"â€¢")):f("",!0)]))),128))])):f("",!0),g(J)(e.trial)?(w(),p("div",Yl,[l[10]||(l[10]=m("span",{class:"detail-label"},"Dataset:",-1)),m("span",Ql,C(e.trial.datasetName)+" ("+C(e.trial.totalRows)+" rows)",1)])):f("",!0),"failed"===e.trial.status?(w(),p("div",Xl,l[11]||(l[11]=[m("span",{class:"detail-label"},"Status:",-1),m("span",{class:"detail-value error"},"Trial failed - check task details for more information",-1)]))):f("",!0),u.value?(w(),p("div",Zl,[m("h4",null,[a(g(ve)),l[12]||(l[12]=k(" Prompt Template"))]),m("div",en,[m("pre",null,C(u.value),1)])])):f("",!0)]),"draft"===e.trial.status?(w(),p("div",tn,[o.value?(w(),v(n,{key:0,type:"primary",disabled:!0},{icon:y(()=>[a(g(le),{spin:""})]),default:y(()=>[l[13]||(l[13]=k(" Starting... "))]),_:1,__:[13]})):(w(),v(n,{key:1,type:"primary",onClick:S,disabled:o.value},{icon:y(()=>[a(g(ne))]),default:y(()=>[l[14]||(l[14]=k(" Start Trial "))]),_:1,__:[14]},8,["disabled"])),a(n,{onClick:T},{icon:y(()=>[a(g(oe))]),default:y(()=>[l[15]||(l[15]=k(" Edit Configuration "))]),_:1,__:[15]})])):f("",!0)],2)}}}),[["__scopeId","data-v-7ef29e11"]]),ln=l("taskMonitoring",()=>{const e=R([]),t=R([]);let a=null,l=null;const n=r(()=>{let t=0,a=0,l=0,n=0,r=0;for(const s of e.value)switch(s.status){case"pending":t++;break;case"running":a++;break;case"completed":l++;break;case"failed":n++;break;case"cancelled":r++}return{pending:t,running:a,completed:l,failed:n,cancelled:r,total:e.value.length}}),s=r(()=>{const e=t.value.filter(e=>"running"===e.status);return 0===e.length?null:(e.sort((e,t)=>(e.started?.getTime()||0)-(t.started?.getTime()||0)),e[0])}),i=r(()=>{const a=new Map,l=he.getAllGroups();for(const e of l)a.set(e,{provider:e,pending:0,running:0,completed:0,failed:0});for(const n of e.value){const e=t.value.find(e=>e.id===n.trialId);if(!e)continue;const l=e.configurationSnapshots[n.configurationIndex];if(!l)continue;const r=he.getProviderGroup(l.provider),s=a.get(r);if(s)switch(n.status){case"pending":s.pending++;break;case"running":s.running++;break;case"completed":s.completed++;break;case"failed":s.failed++}}return Array.from(a.values()).filter(e=>e.pending>0||e.running>0||e.completed>0||e.failed>0)});let o=0;return{allApiCalls:e,trials:t,globalStats:n,providerStats:i,activeTrial:s,getTrialStats:function(a){const l=e.value.filter(e=>e.trialId===a);let n=0,r=0,s=0,i=0;for(const e of l)switch(e.status){case"pending":n++;break;case"running":r++;break;case"completed":s++;break;case"failed":i++}let o=0;if(n>0){const l=t.value.find(e=>e.id===a);l&&l.created&&(o=e.value.filter(e=>{if("pending"!==e.status||e.trialId===a)return!1;const n=t.value.find(t=>t.id===e.trialId);return n&&n.created&&n.created<l.created}).length)}return{pending:n,running:r,completed:s,failed:i,total:l.length,queuePosition:o}},initialize:function(){o++,a||l?Y.debug("Task monitoring store already initialized",{count:o}):(a=Me(async()=>{const e=(await ye.trials.where("status").anyOf(["running","paused"]).toArray()).map(e=>e.id);if(0===e.length)return[];return(await ye.apiCalls.where("trialId").anyOf(e).toArray()).map(e=>({id:e.id,trialId:e.trialId,status:e.status,configurationIndex:e.configurationIndex}))}).subscribe({next:t=>{e.value=t},error:e=>{Y.error("Error in API calls subscription",e)}}),l=Me(()=>ye.trials.toArray()).subscribe({next:e=>{t.value=e},error:e=>{Y.error("Error in trials subscription",e)}}))},destroy:function(){o--,o>0?Y.debug("Task monitoring store still has references",{count:o}):(a&&(a.unsubscribe(),a=null),l&&(l.unsubscribe(),l=null),Y.debug("Task monitoring store destroyed"))}}});const nn={class:"header-left"},rn={class:"queue-title"},sn={key:0,class:"mini-dashboard"},on={class:"mini-stat"},cn={class:"mini-value"},un={class:"mini-stat"},dn={class:"mini-value"},pn={class:"mini-stat"},mn={class:"mini-value"},fn={class:"mini-stat error"},vn={class:"mini-value"},gn={class:"mini-stat active-trial"},hn={class:"leader-status"},yn={class:"expandable-content"},bn={key:0,class:"active-trial-banner"},_n={class:"active-text"},wn={class:"queue-stats-grid"},kn={class:"stat-card"},xn={class:"stat-value"},Cn={class:"stat-card"},Sn={class:"stat-value"},Tn={class:"stat-card"},In={class:"stat-value"},On={class:"stat-card"},En={class:"stat-value"},Pn={key:1,class:"provider-section"},$n={class:"section-subtitle"},Mn={class:"provider-list"},Rn={class:"provider-header"},Nn={class:"provider-name"},Fn={key:0,class:"provider-status"},An={class:"provider-counts"},Dn={key:1,class:"provider-status"},jn={class:"concurrency-gauge"},Ln={class:"gauge-label"},zn={class:"gauge-value"},Un={class:"gauge-info"},qn={key:2,class:"trial-queue-section"},Vn={class:"trial-queue-stats"},Hn={class:"trial-stat"},Bn={class:"trial-stat-value"},Wn=te(o({__name:"QueueStatusPanel",props:{trialId:{},trial:{},compact:{type:Boolean,default:!1}},setup(e){const t=e,l=n(!1);function s(){l.value=!l.value}const{isLeader:i,queueStats:o,providerStats:c}=function(){const e=ln(),t=be();return u(()=>{e.initialize()}),d(()=>{e.destroy()}),{isLeader:n(!0),leaderId:n("browser-native"),queueStats:r(()=>({pending:e.globalStats.pending,reserved:0,executing:e.globalStats.running,completed:e.globalStats.completed,failed:e.globalStats.failed,buried:e.globalStats.cancelled,total:e.globalStats.total})),providerStats:r(()=>e.providerStats.map(e=>{let a=t.getGroupConcurrency(e.provider);if(void 0===a){const t=he.getProvidersInGroup(e.provider);a=1;for(const e of t)e.execution?.defaultConcurrency&&(a=Math.max(a,e.execution.defaultConcurrency))}const l=a>0?Math.round(e.running/a*100):0;return{provider:e.provider,pending:e.pending,executing:e.running,rateLimit:{tokens:a-e.running,requestsPerSecond:a,burstSize:a,utilization:l}}})),rateLimits:n({}),getTrialQueueInfo:function(t){return r(()=>{const a=e.getTrialStats(t);return{position:a.queuePosition,pending:a.pending,executing:a.running,completed:a.completed}})},getTaskInfo:async function(e){},refreshStats:async function(){},refreshRateLimits:async function(){},destroy:function(){e.destroy()}}}(),S=ln(),T=r(()=>t.trialId?null:S.activeTrial);u(()=>{t.trialId||S.initialize()}),d(()=>{t.trialId||S.destroy()});const I=r(()=>t.trialId||""),O=t.trialId?function(e){const t=ln(),a=n([]),l=r(()=>{const a=t.getTrialStats(e.value);return{pending:a.pending,reserved:0,executing:a.running,completed:a.completed,failed:a.failed,buried:0,queuePosition:a.queuePosition}});return u(()=>{t.initialize()}),{tasks:a,stats:l,destroy:function(){}}}(I):null,E=r(()=>O?O.stats.value:{pending:0,executing:0,queuePosition:0}),P=r(()=>{if(t.trialId&&E.value){const e=t.trial?.progress||{completed:0,failed:0};return{pending:E.value.pending||0,executing:E.value.executing||0,completed:e.completed||0,failed:e.failed||0}}return o.value}),$=r(()=>{if(!t.trialId||!t.trial)return c.value;const e=new Set;return t.trial.configurationSnapshots&&t.trial.configurationSnapshots.forEach(t=>{if(t.provider){const a=he.getProviderGroup(t.provider);e.add(t.provider),e.add(a)}}),c.value.filter(t=>e.has(t.provider)).map(e=>({...e,pending:0,executing:0,rateLimit:e.rateLimit}))});return(e,t)=>{const n=h("router-link"),r=h("a-tag"),o=h("a-progress");return w(),p("div",{class:x(["queue-status-panel",{collapsed:l.value}])},[m("div",{class:"queue-header",onClick:s},[m("div",nn,[a(g($e),{class:x(["collapse-icon",{rotated:!l.value}])},null,8,["class"]),m("h3",rn,[a(g(_e)),k(" "+C(e.trialId?"Trial Progress":"Global Task Queue (All Trials)"),1)]),l.value?(w(),p("div",sn,[m("span",on,[m("span",cn,C(P.value.pending),1),t[0]||(t[0]=k(" pending "))]),t[6]||(t[6]=m("span",{class:"mini-divider"},"|",-1)),m("span",un,[m("span",dn,C(P.value.executing),1),t[1]||(t[1]=k(" running "))]),t[7]||(t[7]=m("span",{class:"mini-divider"},"|",-1)),m("span",pn,[m("span",mn,C(P.value.completed),1),t[2]||(t[2]=k(" done "))]),P.value.failed>0?(w(),p(b,{key:0},[t[4]||(t[4]=m("span",{class:"mini-divider"},"|",-1)),m("span",fn,[m("span",vn,C(P.value.failed),1),t[3]||(t[3]=k(" failed "))])],64)):f("",!0),T.value&&!e.trialId?(w(),p(b,{key:1},[t[5]||(t[5]=m("span",{class:"mini-divider"},"|",-1)),m("span",gn,[a(g(ne)),k(" "+C(T.value.name),1)])],64)):f("",!0)])):f("",!0)]),m("div",hn,[g(i)?(w(),p(b,{key:0},[a(g(we),{class:"leader-icon active"}),t[8]||(t[8]=m("span",{class:"leader-text"},"Queue Processor (Leader)",-1))],64)):(w(),p(b,{key:1},[a(g(ke),{class:"leader-icon"}),t[9]||(t[9]=m("span",{class:"leader-text"},"Observer",-1))],64))])]),A(m("div",yn,[!e.trialId&&T.value?(w(),p("div",bn,[a(g(ne),{class:"active-icon"}),m("span",_n,"Active Trial: "+C(T.value.name),1),a(n,{to:`/trials/${T.value.id}`,class:"active-link"},{default:y(()=>[t[10]||(t[10]=k(" View ")),a(g(xe))]),_:1,__:[10]},8,["to"])])):f("",!0),m("div",wn,[m("div",kn,[m("div",xn,C(P.value.pending),1),t[11]||(t[11]=m("div",{class:"stat-label"},"Pending",-1))]),m("div",Cn,[m("div",Sn,C(P.value.executing),1),t[12]||(t[12]=m("div",{class:"stat-label"},"Executing",-1))]),m("div",Tn,[m("div",In,C(P.value.completed),1),t[13]||(t[13]=m("div",{class:"stat-label"},"Completed",-1))]),m("div",On,[m("div",En,C(P.value.failed),1),t[14]||(t[14]=m("div",{class:"stat-label"},"Failed",-1))])]),$.value.length>0?(w(),p("div",Pn,[m("h4",$n,C(e.trialId?"Trial Provider Status":"Provider Status"),1),m("div",Mn,[(w(!0),p(b,null,_($.value,l=>{return w(),p("div",{key:l.provider,class:"provider-item"},[m("div",Rn,[m("span",Nn,C(l.provider),1),e.trialId?(w(),p("div",Dn,[a(r,{color:"blue",size:"small"},{default:y(()=>t[15]||(t[15]=[k("Used by this trial")])),_:1,__:[15]})])):(w(),p("div",Fn,[m("div",An,[l.pending>0?(w(),v(r,{key:0,color:"blue"},{default:y(()=>[k(C(l.pending)+" pending ",1)]),_:2},1024)):f("",!0),l.executing>0?(w(),v(r,{key:1,color:"green"},{default:y(()=>[k(C(l.executing)+" running ",1)]),_:2},1024)):f("",!0)])]))]),m("div",jn,[m("div",Ln,[t[16]||(t[16]=m("span",null,"Concurrency",-1)),m("span",zn,C(l.rateLimit.utilization)+"% slots used ",1)]),a(o,{percent:l.rateLimit.utilization,"stroke-color":(n=l.rateLimit.utilization,n<50?"#52c41a":n<80?"#faad14":"#f5222d"),"show-info":!1,size:"small"},null,8,["percent","stroke-color"]),m("div",Un,C(l.rateLimit.requestsPerSecond)+" max concurrent ",1)])]);var n}),128))])])):f("",!0),e.trialId?(w(),p("div",qn,[t[18]||(t[18]=m("h4",{class:"section-subtitle"},"Additional Info",-1)),m("div",Vn,[m("div",Hn,[t[17]||(t[17]=m("span",{class:"trial-stat-label"},"Queue Position:",-1)),m("span",Bn,C(E.value.queuePosition||"Processing"),1)])])])):f("",!0)],512),[[D,!l.value]])],2)}}}),[["__scopeId","data-v-f7f4d7f6"]]);function Gn(e,t){const a=new Set,l=new Set,n=new Set;e.forEach(e=>{e.variables&&Object.keys(e.variables).forEach(e=>a.add(e)),e.variableAttributes&&Object.values(e.variableAttributes).forEach(e=>{e&&Object.keys(e).forEach(e=>l.add(e))})});const r=Array.from(a).sort(),s=Array.from(l).sort(),i=Array.from(n).sort(),o=[];t&&(K(t)||J(t))&&t.extractPattern&&o.push("extracted_value");const c=["success","refused",...o,...i];return{categorical:[...r,...s,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens","extracted_value",...o].sort(),extracted:c}}function Kn(e,t,a){switch(t){case"model":if(a&&e.configurationIndex<a.configurationSnapshots.length){return a.configurationSnapshots[e.configurationIndex].modelId||"Unknown"}return"Unknown";case"status":return e.status;case"response_time":return e.response?.latencyMs||0;case"total_tokens":if(e.response?.body?.usage){const t=e.response.body.usage;return t.total_tokens||t.prompt_tokens+t.completion_tokens||0}return 0;case"prompt_tokens":return e.response?.body?.usage?.prompt_tokens||e.response?.body?.usage?.input_tokens||0;case"completion_tokens":return e.response?.body?.usage?.completion_tokens||e.response?.body?.usage?.output_tokens||0;case"error_type":return e.result?.errorType||(!1===e.result?.success?"api_error":"success");case"success":return e.result?.success?1:0;case"refused":return e.result?.refused?1:0;case"extracted_value":if(e.result?.success&&void 0!==e.result?.content){const t=String(e.result.content),a=parseFloat(t);return isNaN(a)||t.trim()!==String(a)?t:a}return null}if(void 0!==e.variables?.[t])return e.variables[t];if(e.variableAttributes)for(const l of Object.keys(e.variableAttributes)){const a=e.variableAttributes[l];if(a&&void 0!==a[t])return a[t]}return null}const Jn={count:{label:"Count",calculate:e=>e.length,format:e=>e.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?t.reduce((e,t)=>e+t,0):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},mean:{label:"Mean",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?t.reduce((e,t)=>e+t,0)/t.length:null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},median:{label:"Median",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);if(0===t.length)return null;const a=[...t].sort((e,t)=>e-t),l=Math.floor(a.length/2);return a.length%2==0?(a[l-1]+a[l])/2:a[l]},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},mode:{label:"Mode",calculate:e=>{if(0===e.length)return null;const t=new Map;e.forEach(e=>t.set(e,(t.get(e)||0)+1));let a=0,l=null;return t.forEach((e,t)=>{e>a&&(a=e,l=t)}),{value:l,count:a,total:e.length}},format:e=>e?`${e.value} (${e.count}/${e.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);if(t.length<=1)return null;const a=t.reduce((e,t)=>e+t,0)/t.length;return t.reduce((e,t)=>e+Math.pow(t-a,2),0)/(t.length-1)},format:e=>e?.toFixed(3)||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:e=>{const t=Jn.variance.calculate(e);return null!==t?Math.sqrt(t):null},format:e=>e?.toFixed(3)||"-",needsNumeric:!0},min:{label:"Min",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?Math.min(...t):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},max:{label:"Max",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?Math.max(...t):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(e,t)=>{const a=t.filter(e=>e.result?.success).length;return t.length>0?a/t.length:0},format:e=>`${Math.round(100*e)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(e,t)=>{const a=t.filter(e=>e.result?.refused).length;return t.length>0?a/t.length:0},format:e=>`${Math.round(100*e)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(e,t)=>{const a=t.filter(e=>e.response?.latencyMs).map(e=>e.response.latencyMs);return a.length>0?a.reduce((e,t)=>e+t,0)/a.length:null},format:e=>e?`${Math.round(e)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function Yn(e,t){if(!e||null===e.value)return"-";return Jn[t].format(e.value)}const Qn={"blue-subtle":{name:"Blue (Subtle)",colors:["rgba(59, 130, 246, 0.1)","rgba(59, 130, 246, 0.3)","rgba(59, 130, 246, 0.7)"]},"green-red":{name:"Green-Red",colors:["#dc2626","#fbbf24","#10b981"]},"blue-yellow":{name:"Blue-Yellow",colors:["#1e40af","#3b82f6","#fbbf24"]},"purple-orange":{name:"Purple-Orange",colors:["#7c3aed","#a855f7","#ff9500"]},grayscale:{name:"Grayscale",colors:["#f3f4f6","#9ca3af","#374151"]},viridis:{name:"Viridis",colors:["#440154","#482878","#3e4989","#31688e","#26828e","#1f9e89","#35b779","#6ece58","#b5de2b","#fde725"]},inferno:{name:"Inferno",colors:["#000004","#1b0c41","#4a0c6b","#781c6d","#a52c60","#cf4446","#ed6925","#fb9b06","#f7d13d","#fcffa4"]},magma:{name:"Magma",colors:["#000004","#180f3d","#440f76","#721f81","#9e2f7f","#cd4071","#f1605d","#fd9668","#feca8d","#fcfdbf"]},plasma:{name:"Plasma",colors:["#0d0887","#46039f","#7201a8","#9c179e","#bd3786","#d8576b","#ed7953","#fb9f3a","#fdca26","#f0f921"]}};function Xn(e,t){if(0===t.length)return"transparent";if(1===t.length)return t[0];e=Math.max(0,Math.min(1,e));const a=1/(t.length-1),l=Math.floor(e/a),n=e%a/a;return Zn(t[Math.min(l,t.length-1)],t[Math.min(l+1,t.length-1)],n)}function Zn(e,t,a){if(e.startsWith("rgba")&&t.startsWith("rgba")){const l=e=>{const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]*)\)/);return t?{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:t[4]?parseFloat(t[4]):1}:null},n=l(e),r=l(t);if(n&&r){return`rgba(${Math.round(n.r+(r.r-n.r)*a)}, ${Math.round(n.g+(r.g-n.g)*a)}, ${Math.round(n.b+(r.b-n.b)*a)}, ${(n.a+(r.a-n.a)*a).toFixed(2)})`}}if(e.startsWith("rgba")||t.startsWith("rgba"))return a<.5?e:t;const l=e.replace("#",""),n=t.replace("#",""),r=parseInt(l.substr(0,2),16),s=parseInt(l.substr(2,2),16),i=parseInt(l.substr(4,2),16),o=parseInt(n.substr(0,2),16),c=parseInt(n.substr(2,2),16),u=parseInt(n.substr(4,2),16),d=Math.round(r+(o-r)*a),p=Math.round(s+(c-s)*a),m=Math.round(i+(u-i)*a);return`#${d.toString(16).padStart(2,"0")}${p.toString(16).padStart(2,"0")}${m.toString(16).padStart(2,"0")}`}function er(e){let t,a,l;if(e.startsWith("rgba")){const n=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]*)\)/);if(!n)return!1;t=parseInt(n[1]),a=parseInt(n[2]),l=parseInt(n[3])}else{const n="#"===e.charAt(0)?e.substring(1,7):e;t=parseInt(n.substring(0,2),16),a=parseInt(n.substring(2,4),16),l=parseInt(n.substring(4,6),16)}const n=[t/255,a/255,l/255].map(e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*n[0]+.7152*n[1]+.0722*n[2]<=.179}function tr(e){return er(e)?"#FFFFFF":"#000000"}function ar(e,t,a){const{colorScales:l,interpolateColor:n,getContrastColor:s}={colorScales:Qn,interpolateColor:Xn,interpolateBetweenColors:Zn,colorIsDarkAdvanced:er,getContrastColor:tr};function i(e){if("number"==typeof e)return e;if("string"==typeof e){const t=parseFloat(e);return isNaN(t)?null:t}return null}return{getCellStyle:function(r,o,c){if(!r||null===r.value||"number"!=typeof r.value)return{};const u=l[t.value];if(!u)return{};const d=function(t,l,n){const r=i(t.value);if(null===r)return.5;if("global"===a.value){const t=e.value.rows.flatMap(e=>e.cells).filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(t.length>0){const e=Math.min(...t),a=Math.max(...t);if(a!==e)return(r-e)/(a-e)}}else if("column"===a.value){const t=e.value.rows.map(e=>e.cells[n]).filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(t.length>0){const e=Math.min(...t),a=Math.max(...t);if(a!==e)return(r-e)/(a-e)}}else if("row"===a.value){const t=e.value.rows.find(e=>e.label===l);if(t){const e=t.cells.filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(e.length>0){const t=Math.min(...e),a=Math.max(...e);if(a!==t)return(r-t)/(a-t)}}}return.5}(r,o,c),p=n(d,u.colors);return{backgroundColor:`${p} !important`,color:`${s(p)} !important`,fontSize:"15px !important",fontWeight:"600 !important"}},getSummaryStyle:function(a){if(!a||null===a.value||"number"!=typeof a.value)return{};const r=l[t.value];if(!r)return{};let o=.5;const c=e.value.rows.flatMap(e=>e.cells).filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(c.length>0){const e=Math.min(...c),t=Math.max(...c),l=i(a.value);null!==l&&(o=t!==e?(l-e)/(t-e):.5)}const u=n(o,r.colors);return{backgroundColor:`${u} !important`,color:`${s(u)} !important`,fontSize:"15px !important",fontWeight:"600 !important"}},styleKey:r(()=>`${t.value}-${a.value}`)}}const lr={class:"pivot-config"},nr={class:"config-row"},rr={class:"config-group"},sr=["value","aria-label"],ir={label:"Categorical"},or=["value"],cr={class:"config-group"},ur=["value","aria-label"],dr={label:"Categorical"},pr=["value"],mr={class:"config-group"},fr=["value","aria-label"],vr={label:"Extracted Values"},gr=["value"],hr={label:"Numeric Fields"},yr=["value"],br={class:"config-group"},_r=["value","aria-label"],wr=te(o({__name:"PivotConfiguration",props:{config:{},availableFields:{}},emits:["update-config"],setup(e,{emit:t}){const a=t;function l(e,t){a("update-config",e,t)}function n(e){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[e]||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}return(e,t)=>(w(),p("div",lr,[m("div",nr,[m("div",rr,[t[4]||(t[4]=m("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),m("select",{id:"pivot-row-field",value:e.config.rowField,"aria-label":"Group rows by "+n(e.config.rowField),onChange:t[0]||(t[0]=e=>l("rowField",e.target.value))},[m("optgroup",ir,[(w(!0),p(b,null,_(e.availableFields.categorical,e=>(w(),p("option",{key:e,value:e},C(n(e)),9,or))),128))])],40,sr)]),m("div",cr,[t[5]||(t[5]=m("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),m("select",{id:"pivot-column-field",value:e.config.columnField,"aria-label":"Group columns by "+n(e.config.columnField),onChange:t[1]||(t[1]=e=>l("columnField",e.target.value))},[m("optgroup",dr,[(w(!0),p(b,null,_(e.availableFields.categorical,e=>(w(),p("option",{key:e,value:e},C(n(e)),9,pr))),128))])],40,ur)]),m("div",mr,[t[6]||(t[6]=m("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),m("select",{id:"pivot-value-field",value:e.config.valueField,"aria-label":"Aggregate "+e.config.valueField+" values",onChange:t[2]||(t[2]=e=>l("valueField",e.target.value))},[m("optgroup",vr,[(w(!0),p(b,null,_(e.availableFields.extracted,e=>(w(),p("option",{key:e,value:e},C(e),9,gr))),128))]),m("optgroup",hr,[(w(!0),p(b,null,_(e.availableFields.numeric,e=>(w(),p("option",{key:e,value:e},C(n(e)),9,yr))),128))])],40,fr)]),m("div",br,[t[8]||(t[8]=m("label",{for:"pivot-aggregation"},"Aggregation:",-1)),m("select",{id:"pivot-aggregation",value:e.config.aggregation,"aria-label":"Aggregation method: "+e.config.aggregation,onChange:t[3]||(t[3]=e=>l("aggregation",e.target.value))},t[7]||(t[7]=[j('<optgroup label="Statistical" data-v-efb8a7c2><option value="mean" data-v-efb8a7c2>Mean</option><option value="median" data-v-efb8a7c2>Median</option><option value="variance" data-v-efb8a7c2>Variance</option><option value="std_dev" data-v-efb8a7c2>Std Dev</option><option value="min" data-v-efb8a7c2>Min</option><option value="max" data-v-efb8a7c2>Max</option></optgroup><optgroup label="Frequency" data-v-efb8a7c2><option value="count" data-v-efb8a7c2>Count</option><option value="mode" data-v-efb8a7c2>Mode</option></optgroup><optgroup label="Performance" data-v-efb8a7c2><option value="success_rate" data-v-efb8a7c2>Success Rate</option><option value="refusal_rate" data-v-efb8a7c2>Refusal Rate</option><option value="avg_time" data-v-efb8a7c2>Avg Time</option></optgroup>',3)]),40,_r)])])]))}}),[["__scopeId","data-v-efb8a7c2"]]),kr={class:"heatmap-controls"},xr={class:"color-scale-selector"},Cr=["value","aria-label"],Sr={class:"gradient-mode-selector"},Tr={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},Ir=["aria-pressed"],Or=["aria-pressed"],Er=["aria-pressed"],Pr=["title","aria-label"],$r=te(o({__name:"PivotHeatmapControls",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(e,{emit:t}){const a=t;function l(e){const t=e.target.value;a("update-color-scale",t)}function n(e){a("update-gradient-mode",e)}return(e,t)=>(w(),p("div",kr,[m("div",xr,[t[5]||(t[5]=m("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),m("select",{id:"heatmap-color-scale",value:e.selectedColorScale,"aria-label":"Color scale: "+e.selectedColorScale,onChange:l},t[4]||(t[4]=[j('<option value="blue-subtle" data-v-4b4f9d62>Blue (Subtle)</option><option value="green-red" data-v-4b4f9d62>Green-Red (Success)</option><option value="blue-yellow" data-v-4b4f9d62>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-4b4f9d62>Purple-Orange (General)</option><option value="viridis" data-v-4b4f9d62>Viridis</option><option value="inferno" data-v-4b4f9d62>Inferno</option><option value="magma" data-v-4b4f9d62>Magma</option><option value="plasma" data-v-4b4f9d62>Plasma</option><option value="grayscale" data-v-4b4f9d62>Grayscale</option>',9)]),40,Cr)]),m("div",Sr,[t[6]||(t[6]=m("label",null,"Gradient Mode:",-1)),m("div",Tr,[m("button",{type:"button",class:x(["toggle-btn",{active:"global"===e.gradientMode}]),"aria-pressed":"global"===e.gradientMode,onClick:t[0]||(t[0]=e=>n("global"))}," Global ",10,Ir),m("button",{type:"button",class:x(["toggle-btn",{active:"column"===e.gradientMode}]),"aria-pressed":"column"===e.gradientMode,onClick:t[1]||(t[1]=e=>n("column"))}," Per Column ",10,Or),m("button",{type:"button",class:x(["toggle-btn",{active:"row"===e.gradientMode}]),"aria-pressed":"row"===e.gradientMode,onClick:t[2]||(t[2]=e=>n("row"))}," Per Row ",10,Er)])]),m("button",{type:"button",class:"fullscreen-btn",title:e.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":e.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:t[3]||(t[3]=t=>e.$emit("toggle-fullscreen"))},C(e.isFullscreen?"âŠŸ":"âŠž"),9,Pr)]))}}),[["__scopeId","data-v-4b4f9d62"]]),Mr={class:"filters-row"},Rr={key:0,class:"filter-group"},Nr=["value"],Fr=["for"],Ar=["id","onUpdate:modelValue","aria-label"],Dr={value:""},jr=["value"],Lr={key:1,class:"filter-group"},zr=["value"],Ur={class:"table-view"},qr={key:0,class:"empty-state","data-testid":"empty-data-message"},Vr={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},Hr={key:2,class:"pivot-table-container"},Br={class:"pivot-table-grid responsive-table",role:"table"},Wr={role:"row"},Gr={class:"corner-cell",role:"columnheader"},Kr={key:0,class:"total-header",role:"columnheader"},Jr={class:"row-header",role:"rowheader"},Yr=["data-testid","title","aria-label","role","onClick","onKeydown"],Qr={key:0,class:"cell-content"},Xr=["title"],Zr={class:"cell-value"},es={class:"error-message"},ts={key:1},as=te(o({__name:"PivotTableCore",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0}},emits:["config-change","cell-click"],setup(e,{emit:t}){const l=e,s=t,i=n(!1),o=n("viridis"),u=n("global"),v=n({rowField:l.config?.rowField||"",columnField:l.config?.columnField||"",valueField:l.config?.valueField||"",aggregation:l.config?.aggregation||"mean"});c(()=>l.config,e=>{e&&Object.assign(v.value,e)},{deep:!0});const h=n({}),y=n([]),k=r(()=>Object.values(h.value).some(e=>""!==e)),T=R(Gn(l.apiCalls,l.trial));let I=0;c(()=>l.apiCalls,e=>{if(0===e.length||0===I||e.length-I>=10){const t=y.value.length>0||k.value?y.value:e;T.value=Gn(t,l.trial),I=e.length}},{immediate:!0});const O=R({});let E=0;c(()=>l.apiCalls.length,e=>{(0===e||0===E||e-E>=5)&&((()=>{if(0===l.apiCalls.length)return void(O.value={});const e={};l.apiCalls.forEach(t=>{if(l.trial&&t.configurationIndex<l.trial.configurationSnapshots.length){const a=l.trial.configurationSnapshots[t.configurationIndex].modelId||"Unknown";e.model||(e.model=new Set),e.model.add(a)}t.status&&(e.status||(e.status=new Set),e.status.add(t.status)),t.variables&&Object.entries(t.variables).forEach(([t,a])=>{a&&String(a).trim()&&(e[t]||(e[t]=new Set),e[t].add(String(a)))})});const t={};Object.entries(e).forEach(([e,a])=>{t[e]=Array.from(a).sort()}),O.value=t})(),E=e)},{immediate:!0});const P=r(()=>{const{model:e,status:t,...a}=O.value;return a});function M(){y.value=l.apiCalls.filter(e=>{if(h.value.model&&""!==h.value.model){if(!l.trial||e.configurationIndex>=l.trial.configurationSnapshots.length)return!1;if((l.trial.configurationSnapshots[e.configurationIndex].modelId||"Unknown")!==h.value.model)return!1}if(h.value.status&&""!==h.value.status&&e.status!==h.value.status)return!1;for(const[t,a]of Object.entries(h.value))if(a&&""!==a&&"model"!==t&&"status"!==t){const l=e.variables?.[t];if(l!==a)return!1}return!0})}function N(){h.value={},M()}c(()=>l.apiCalls,()=>{k.value?M():y.value=l.apiCalls},{immediate:!0});const F=r(()=>{const e=y.value.length>0||k.value?y.value:l.apiCalls;return 0===e.length?{rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}:function(e,t,a){const l=new Map,n=new Set,r=new Set;e.forEach(e=>{const s=String(Kn(e,t.rowField,a)||"Unknown"),i=String(Kn(e,t.columnField,a)||"Unknown");n.add(s),r.add(i),l.has(s)||l.set(s,new Map),l.get(s).has(i)||l.get(s).set(i,[]),l.get(s).get(i).push(e)});const s=e=>e.every(e=>!isNaN(Number(e))&&""!==e.trim())?e.sort((e,t)=>Number(e)-Number(t)):e.sort(),i=s(Array.from(n)),o=s(Array.from(r)),c=Jn[t.aggregation];function u(e){const l=e.map(e=>Kn(e,t.valueField,a));if(!c||"function"!=typeof c.calculate)return Y.error("Invalid aggregation function:",t.aggregation,c),{value:null,count:e.length,apiCalls:e,rawValues:l,error:"Invalid aggregation function"};const n={nonNumeric:0,nullUndefined:0};return c.needsNumeric&&(n.nonNumeric=l.filter(e=>"number"!=typeof e).length),n.nullUndefined=l.filter(e=>null==e).length,{value:c.usesApiCalls?c.calculate(l,e):c.calculate(l),count:e.length,apiCalls:e,rawValues:l,excludedCounts:n}}const d=i.map(e=>{const t=[],a=[];return o.forEach(n=>{const r=l.get(e)?.get(n)||[];t.push(r.length>0?u(r):null),a.push(...r)}),{label:e,cells:t,total:u(a)}}),p=o.map(e=>{const t=[];return i.forEach(a=>{const n=l.get(a)?.get(e)||[];t.push(...n)}),u(t)});return{rows:d,columns:o,totals:p,grandTotal:u(e)}}(e,v.value,l.trial)}),D=r(()=>F.value.rows),{getCellStyle:j,getSummaryStyle:q,styleKey:V}=ar(F,o,u);function H(e){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[e]||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function B(e,t,a){if(!a)return`${e} Ã— ${t}: No data`;let l=`${e} Ã— ${t}: ${Yn(a,v.value.aggregation)} (${a.count} calls)`;if(a.excludedCounts){const e=[];a.excludedCounts.nonNumeric>0&&e.push(`${a.excludedCounts.nonNumeric} non-numeric responses excluded`),a.excludedCounts.nullUndefined>0&&e.push(`${a.excludedCounts.nullUndefined} null/empty responses`),e.length>0&&(l+=` | ${e.join(", ")}`)}return a.error&&(l+=` - ERROR: ${a.error}`),l}function W(e,t,a){if(!a)return`${e} by ${t}: No data`;const l=Yn(a,v.value.aggregation);return a.error?`${e} by ${t}: ${l} with data integrity error: ${a.error}`:`${e} by ${t}: ${l} from ${a.count} API calls`}function G(e,t){"rowField"!==e&&"columnField"!==e&&"valueField"!==e&&"aggregation"!==e||(v.value[e]=t),s("config-change",{...v.value})}function K(e,t,a){a&&s("cell-click",{row:e,column:t,cell:a})}function J(){i.value=!i.value,i.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return d(()=>{i.value&&(document.body.style.overflow="")}),c([T,()=>l.apiCalls.length],([e])=>{if(l.apiCalls.length>0&&(!v.value.rowField||""===v.value.rowField)&&e.categorical.length>0){if(v.value.rowField=e.categorical.find(e=>"model"!==e&&"status"!==e&&"error_type"!==e)||e.categorical[0]||"model",v.value.columnField=v.value.columnField||"model",v.value.valueField=v.value.valueField||"extracted_value",!v.value.aggregation||""===v.value.aggregation){const e=l.apiCalls.slice(0,3).map(e=>Kn(e,v.value.valueField,l.trial)).filter(e=>null!=e),t=e.length>0&&e.every(e=>"number"==typeof e);v.value.aggregation=t?"mean":"mode"}s("config-change",{...v.value})}},{immediate:!0}),(e,t)=>(w(),p("div",{class:x(["pivot-table-core",{fullscreen:i.value}])},[L([T.value,v.value],()=>(w(),p("div",null,[a(wr,{config:v.value,"available-fields":T.value,onUpdateConfig:G},null,8,["config","available-fields"])])),t,0),a($r,{"selected-color-scale":o.value,"gradient-mode":u.value,"is-fullscreen":i.value,onUpdateColorScale:t[1]||(t[1]=e=>o.value=e),onUpdateGradientMode:t[2]||(t[2]=e=>u.value=e),onToggleFullscreen:J},null,8,["selected-color-scale","gradient-mode","is-fullscreen"]),Object.keys(O.value).length>0?L([O.value,h.value],()=>(w(),p("div",{key:0,class:"data-filters"},[m("div",Mr,[O.value.model&&O.value.model.length>1?(w(),p("div",Rr,[t[7]||(t[7]=m("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),A(m("select",{id:"filter-model","onUpdate:modelValue":t[3]||(t[3]=e=>h.value.model=e),class:"filter-select","aria-label":"Filter by model",onChange:M},[t[6]||(t[6]=m("option",{value:""},"All Models",-1)),(w(!0),p(b,null,_(O.value.model,e=>(w(),p("option",{key:e,value:e},C(e),9,Nr))),128))],544),[[U,h.value.model]])])):f("",!0),(w(!0),p(b,null,_(P.value,(e,t)=>(w(),p("div",{key:t,class:"filter-group"},[m("label",{for:`filter-${t}`,class:"filter-label"},C(H(String(t)))+": ",9,Fr),A(m("select",{id:`filter-${t}`,"onUpdate:modelValue":e=>h.value[t]=e,class:"filter-select","aria-label":`Filter by ${H(String(t))}`,onChange:M},[m("option",Dr,"All "+C(H(String(t))),1),(w(!0),p(b,null,_(e,e=>(w(),p("option",{key:e,value:e},C(e),9,jr))),128))],40,Ar),[[U,h.value[t]]])]))),128)),O.value.status&&O.value.status.length>1?(w(),p("div",Lr,[t[9]||(t[9]=m("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),A(m("select",{id:"filter-status","onUpdate:modelValue":t[4]||(t[4]=e=>h.value.status=e),class:"filter-select","aria-label":"Filter by status",onChange:M},[t[8]||(t[8]=m("option",{value:""},"All Statuses",-1)),(w(!0),p(b,null,_(O.value.status,e=>(w(),p("option",{key:e,value:e},C(e),9,zr))),128))],544),[[U,h.value.status]])])):f("",!0),k.value?(w(),p("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:N}," Clear Filters ")):f("",!0)])])),t,5):f("",!0),m("div",Ur,[0===l.apiCalls.length?(w(),p("div",qr,t[10]||(t[10]=[m("p",null,"No data available for pivot table analysis.",-1)]))):v.value.aggregation in g(Jn)?(w(),p("div",Hr,[m("table",Br,[m("thead",null,[m("tr",Wr,[m("th",Gr,C(H(v.value.rowField)||"Items")+" / "+C(H(v.value.columnField)||"Aggregated"),1),(w(!0),p(b,null,_(F.value.columns,e=>(w(),p("th",{key:e,class:"column-header",role:"columnheader"},C(e),1))),128)),v.value.columnField&&e.showTotals?(w(),p("th",Kr," Total ")):f("",!0)])]),m("tbody",null,[(w(!0),p(b,null,_(D.value,t=>(w(),p("tr",{key:`${t.label}-${g(V)}`,class:"data-row",role:"row"},[m("td",Jr,C(t.label),1),(w(!0),p(b,null,_(t.cells,(e,a)=>(w(),p("td",{key:`${a}-${g(V)}`,class:x(["data-cell",{"error-cell":e?.error}]),"data-testid":e?.error?"pivot-cell-error":"pivot-cell",style:S(g(j)(e,t.label,a)),title:B(t.label,F.value.columns[a],e),"aria-label":W(t.label,F.value.columns[a],e),role:e?.error?"alert":"cell",tabindex:"0",onClick:l=>K(t.label,F.value.columns[a],e),onKeydown:[z(l=>K(t.label,F.value.columns[a],e),["enter"]),z($(l=>K(t.label,F.value.columns[a],e),["prevent"]),["space"])]},[e?.error?(w(),p("div",Qr,[m("span",{class:"error-indicator",title:e.error},"âš ï¸",8,Xr),m("span",Zr,C(e?g(Yn)(e,v.value.aggregation):"-"),1),m("div",es,C(e.error),1)])):(w(),p("span",ts,C(e?g(Yn)(e,v.value.aggregation):"-"),1))],46,Yr))),128)),v.value.columnField&&e.showTotals?(w(),p("td",{key:0,class:"total-cell",style:S(g(q)(t.total)),role:"cell"},C(g(Yn)(t.total,v.value.aggregation)),5)):f("",!0)]))),128)),v.value.rowField&&e.showTotals?(w(),p("tr",{key:`totals-${g(V)}`,class:"total-row",role:"row"},[t[12]||(t[12]=m("td",{class:"row-header",role:"rowheader"},"Total",-1)),(w(!0),p(b,null,_(F.value.totals,(e,t)=>(w(),p("td",{key:`total-${t}-${g(V)}`,class:"total-cell",style:S(g(q)(e)),role:"cell"},C(g(Yn)(e,v.value.aggregation)),5))),128)),v.value.columnField?(w(),p("td",{key:0,class:"grand-total-cell",style:S(g(q)(F.value.grandTotal)),role:"cell"},C(g(Yn)(F.value.grandTotal,v.value.aggregation)),5)):f("",!0)])):f("",!0)])])])):(w(),p("div",Vr,[m("p",null,"Invalid aggregation function: "+C(v.value.aggregation),1),t[11]||(t[11]=m("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),[["__scopeId","data-v-6da58b58"]]),ls={class:"summary-row"},ns={key:0,class:"filter-row"},rs=["title"],ss=["title"],is=te(o({__name:"PivotCellDetailModal",props:{row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(e){const t=e,l=q({}),n=r(()=>{const e=new Set;return t.apiCalls.forEach(t=>{t.variables&&Object.keys(t.variables).forEach(t=>e.add(t)),t.attributedVariables&&Object.entries(t.attributedVariables).forEach(([t,a])=>{a&&"object"==typeof a&&Object.keys(a).forEach(a=>{e.add(`${t}.${a}`)})})}),Array.from(e).sort()}),s=r(()=>n.value.map(e=>({title:e,dataIndex:`var_${e}`,key:`var_${e}`,width:150,ellipsis:!0,sorter:(t,a)=>{const l=t[`var_${e}`]||"",n=a[`var_${e}`]||"";return l.localeCompare(n)}}))),i=[{title:"Status",dataIndex:"status",key:"status",width:100,fixed:"left",sorter:(e,t)=>e.status.localeCompare(t.status)},{title:"Model",dataIndex:"model",key:"model",width:150,ellipsis:!0,sorter:(e,t)=>e.model.localeCompare(t.model)}],o=[{title:"Response",dataIndex:"response",key:"response",width:300,ellipsis:!0},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150,ellipsis:!0,sorter:(e,t)=>(e.extracted||"").localeCompare(t.extracted||"")},{title:"Duration",dataIndex:"duration",key:"duration",width:100,sorter:(e,t)=>(parseInt(e.duration)||0)-(parseInt(t.duration)||0)},{title:"Cost",dataIndex:"cost",key:"cost",width:100,sorter:(e,t)=>(e.cost||0)-(t.cost||0)}],c=r(()=>[...i,...s.value,...o]),u=r(()=>`${t.row} Ã— ${t.column} - ${t.apiCalls.length} API Calls`),d=r(()=>t.apiCalls.map(e=>{const t={id:e.id,status:e.status,model:e.model||"-",response:e.result?.content||e.result?.error||"-",extracted:e.extracted||"-",duration:e.duration?`${e.duration}ms`:"-",cost:e.cost||0};return n.value.forEach(a=>{if(a.includes(".")){const[l,n]=a.split("."),r=e.attributedVariables?.[l]?.[n];t[`var_${a}`]=void 0!==r?String(r):"-"}else t[`var_${a}`]=e.variables?.[a]||"-"}),t})),g=r(()=>Object.values(l).some(e=>void 0!==e&&""!==e)),x=r(()=>g.value?d.value.filter(e=>Object.entries(l).every(([t,a])=>!a||e[t]===a)):d.value),S=r(()=>{const e=t.apiCalls.filter(e=>"completed"===e.status).length;return Math.round(e/t.apiCalls.length*100)}),T=r(()=>{const e=t.apiCalls.filter(e=>e.duration).map(e=>e.duration);return 0===e.length?0:Math.round(e.reduce((e,t)=>e+t,0)/e.length)}),I=r(()=>t.apiCalls.filter(e=>e.cost).map(e=>e.cost).reduce((e,t)=>e+t,0).toFixed(4));function O(e){switch(e){case"completed":return"success";case"failed":return"error";case"pending":return"warning";case"running":return"processing";default:return"default"}}function E(e){const t=new Set;return d.value.forEach(a=>{const l=a[e];l&&"-"!==l&&t.add(l)}),Array.from(t).sort()}function P(){}function $(){Object.keys(l).forEach(e=>{delete l[e]})}return(e,t)=>{const n=h("a-select-option"),r=h("a-select"),i=h("a-button"),o=h("a-tag"),d=h("a-table"),M=h("a-modal");return w(),v(M,{open:!0,width:"98vw",footer:null,title:u.value,onCancel:t[0]||(t[0]=t=>e.$emit("close")),"body-style":{padding:"16px",height:"90vh",display:"flex",flexDirection:"column"},class:"pivot-cell-detail-modal"},{default:y(()=>[m("div",ls,[m("span",null,[t[1]||(t[1]=m("b",null,"Total:",-1)),k(" "+C(e.apiCalls.length),1)]),m("span",null,[t[2]||(t[2]=m("b",null,"Success Rate:",-1)),k(" "+C(S.value)+"%",1)]),m("span",null,[t[3]||(t[3]=m("b",null,"Avg Duration:",-1)),k(" "+C(T.value)+"ms",1)]),m("span",null,[t[4]||(t[4]=m("b",null,"Total Cost:",-1)),k(" $"+C(I.value),1)])]),s.value.length>0?(w(),p("div",ns,[(w(!0),p(b,null,_(s.value,e=>(w(),p("div",{key:e.key,class:"variable-filter"},[a(r,{value:l[e.key],"onUpdate:value":t=>l[e.key]=t,placeholder:`Filter ${e.title}`,allowClear:"",style:{width:"150px"},size:"small",onChange:P},{default:y(()=>[(w(!0),p(b,null,_(E(e.key),e=>(w(),v(n,{key:e,value:e},{default:y(()=>[k(C(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])]))),128)),g.value?(w(),v(i,{key:0,size:"small",onClick:$},{default:y(()=>t[5]||(t[5]=[k("Clear Filters")])),_:1,__:[5]})):f("",!0)])):f("",!0),a(d,{columns:c.value,"data-source":x.value,scroll:{x:1500,y:"calc(90vh - 140px)"},pagination:!1,size:"small","row-key":e=>e.id,class:"api-calls-table"},{bodyCell:y(({column:e,record:t})=>{return["status"===e.key?(w(),v(o,{key:0,color:O(t.status),style:{margin:"0"}},{default:y(()=>[k(C(t.status),1)]),_:2},1032,["color"])):"response"===e.key?(w(),p("span",{key:1,class:"response-cell",title:t.response},C((a=t.response,l=100,a?a.length<=l?a:a.slice(0,l)+"...":"")),9,rs)):"cost"===e.key?(w(),p(b,{key:2},[k(C(0===t.cost?"-":`$${t.cost.toFixed(4)}`),1)],64)):e.key.startsWith("var_")?(w(),p("span",{key:3,class:"variable-cell",title:t[e.key]},C(t[e.key]||"-"),9,ss)):f("",!0)];var a,l}),_:1},8,["columns","data-source","row-key"])]),_:1},8,["title"])}}}),[["__scopeId","data-v-d1eba3c3"]]),os={class:"trial-tab-content"},cs={class:"tab-content status-tab-content"},us={class:"status-scroll-container"},ds={key:0,class:"queue-status-section"},ps={class:"tab-content task-view-tab"},ms={class:"tab-content pivot-tab-content"},fs={class:"pivot-scroll-container"},vs={class:"pivot-container"},gs={key:1,class:"empty-state"},hs=te(o({__name:"TrialTabContent",props:{trial:{},apiCalls:{},loading:{type:Boolean}},setup(e){const t=e,l=n("status"),s=n({rowField:"",columnField:"model",valueField:"success",aggregation:"mean"}),i=n(!1),o=n({row:"",column:"",apiCalls:[],value:0}),c=r(()=>[...t.apiCalls].sort((e,t)=>{if("running"===e.status&&"running"!==t.status)return-1;if("running"!==e.status&&"running"===t.status)return 1;const a=e.completed||e.created||new Date(0);return(t.completed||t.created||new Date(0)).getTime()-a.getTime()})),u=e=>{s.value=e},d=e=>{if(!e.cell)return;const t=e.cell.apiCalls||[];0!==t.length&&(o.value={row:e.row,column:e.column,apiCalls:t,value:e.cell.value},i.value=!0)};return(e,t)=>{const n=h("a-tab-pane"),r=h("a-tabs");return w(),p("div",os,[a(r,{activeKey:l.value,"onUpdate:activeKey":t[0]||(t[0]=e=>l.value=e),class:"detail-tabs","tab-bar-style":{marginBottom:0}},{default:y(()=>[a(n,{key:"status",tab:"Status"},{default:y(()=>[m("div",cs,[m("div",us,[a(an,{trial:e.trial,compact:!1},null,8,["trial"]),"running"===e.trial.status||"paused"===e.trial.status?(w(),p("div",ds,[t[2]||(t[2]=m("h3",{class:"section-title"},"Queue Status",-1)),a(Wn,{"trial-id":e.trial.id,trial:e.trial,compact:!1},null,8,["trial-id","trial"])])):f("",!0)])])]),_:1}),a(n,{key:"tasks",tab:"Task View"},{default:y(()=>[m("div",ps,[a(El,{trial:e.trial,"api-calls":c.value,loading:e.loading},null,8,["trial","api-calls","loading"])])]),_:1}),a(n,{key:"pivot",tab:"Pivot Table"},{default:y(()=>[m("div",ms,[m("div",fs,[m("div",vs,[e.apiCalls.length>0?(w(),v(as,{key:0,"api-calls":e.apiCalls,trial:e.trial,config:s.value,"show-totals":!0,onConfigChange:u,onCellClick:d},null,8,["api-calls","trial","config"])):(w(),p("div",gs,t[3]||(t[3]=[m("p",null,"No data available for pivot table analysis.",-1)])))])])])]),_:1})]),_:1},8,["activeKey"]),i.value?(w(),v(is,{key:0,row:o.value.row,column:o.value.column,"api-calls":o.value.apiCalls,trial:e.trial,value:o.value.value,onClose:t[1]||(t[1]=e=>i.value=!1)},null,8,["row","column","api-calls","trial","value"])):f("",!0)])}}}),[["__scopeId","data-v-6cc8ebfb"]]),ys={class:"modal-content"},bs={class:"modal-header"},_s={class:"modal-body"},ws={class:"section"},ks={class:"format-options"},xs=["data-testid","aria-label"],Cs=["value","data-testid","aria-label"],Ss={class:"format-label"},Ts={class:"format-name"},Is={class:"section"},Os={class:"field-groups"},Es=["data-testid"],Ps={class:"field-list"},$s=["data-testid","aria-label"],Ms=["value","data-testid","aria-label"],Rs={class:"field-label"},Ns={class:"field-name"},Fs={class:"field-desc"},As={class:"section"},Ds={class:"preview-info"},js={class:"preview-count"},Ls={class:"preview-fields"},zs={class:"preview-size"},Us={class:"modal-footer"},qs=te(o({__name:"ExportDataModal",props:{trial:{},apiCalls:{}},emits:["close"],setup(e){const t=e,l=[{id:"csv",name:"CSV",description:"Comma-separated values (Excel compatible)"},{id:"tsv",name:"TSV",description:"Tab-separated values"},{id:"excel",name:"Excel",description:"Microsoft Excel (.xlsx)"},{id:"json",name:"JSON",description:"JavaScript Object Notation"},{id:"jsonl",name:"JSONL",description:"JSON Lines (one object per line)"}],s=[{name:"Basic Info",fields:[{id:"id",name:"ID",description:"API call identifier",default:!0},{id:"trial_id",name:"Trial ID",description:"Parent trial identifier",default:!0},{id:"trial_name",name:"Trial Name",description:"Human-readable trial name",default:!0},{id:"status",name:"Status",description:"Call status (completed, failed, etc.)",default:!0},{id:"created",name:"Created",description:"When the call was initiated",default:!0},{id:"completed",name:"Completed",description:"When the call finished",default:!0}]},{name:"Configuration",fields:[{id:"configuration_index",name:"Config Index",description:"Configuration array index",default:!1},{id:"configuration_name",name:"Config Name",description:"Human-readable config name",default:!1},{id:"provider",name:"Provider",description:"LLM service provider",default:!0},{id:"model",name:"Model",description:"Model identifier",default:!0},{id:"parameters",name:"Parameters",description:"Model parameters as separate columns (temperature, max_tokens, etc.)",default:!0}]},{name:"Content",fields:[{id:"prompt",name:"Prompt",description:"Input prompt text",default:!0},{id:"variables",name:"Variables",description:"Variable substitutions (flattened as separate columns)",default:!0},{id:"result_content",name:"Result Content",description:"LLM response content",default:!0},{id:"result_error",name:"Result Error",description:"Error message if failed",default:!0}]},{name:"Performance",fields:[{id:"response_latency_ms",name:"Latency (ms)",description:"Response time",default:!0},{id:"duration_ms",name:"Duration (ms)",description:"Total processing time",default:!1},{id:"result_success",name:"Success",description:"Whether call succeeded",default:!0}]},{name:"Technical Details",fields:[{id:"request_url",name:"Request URL",description:"API endpoint URL",default:!0},{id:"request_method",name:"Request Method",description:"HTTP method",default:!1},{id:"request_headers",name:"Request Headers",description:"HTTP request headers",default:!1},{id:"request_body",name:"Request Body",description:"Full request payload",default:!1},{id:"response_status",name:"Response Status",description:"HTTP status code",default:!0},{id:"response_headers",name:"Response Headers",description:"HTTP response headers",default:!1},{id:"response_body",name:"Response Body",description:"Full response payload",default:!1}]},{name:"Error Handling",fields:[{id:"network_error_count",name:"Network Errors",description:"Number of network failures",default:!1},{id:"retry_count",name:"Retry Count",description:"Number of retry attempts",default:!1}]}],i=n("csv"),o=n([]),c=s.flatMap(e=>e.fields);o.value=c.filter(e=>e.default).map(e=>e.id);const u=r(()=>{const e=50*o.value.length,a=t.apiCalls.length*e;return a<1024?`${a}B`:a<1048576?`${(a/1024).toFixed(1)}KB`:`${(a/1048576).toFixed(1)}MB`});function d(){o.value=c.map(e=>e.id)}function f(){o.value=c.filter(e=>e.default).map(e=>e.id)}function v(){o.value=[]}function g(e){const t=new Set(["model","messages","prompt","stream","user"]),a={};for(const[l,n]of Object.entries(e))t.has(l)||(a[l]=n);return a}function x(e,t=""){const a={};for(const[l,n]of Object.entries(e)){const e=t?`${t}.${l}`:l;null===n||"object"!=typeof n||Array.isArray(n)?a[e]=Array.isArray(n)?JSON.stringify(n):n:Object.assign(a,x(n,e))}return a}function S(){const e=new Set,a=[];if(J(t.trial)){const{columns:l}=t.trial.datasetSnapshot;a.push(...l),l.forEach(t=>e.add(t))}o.value.includes("variables")&&t.apiCalls.forEach(t=>{t.variables&&"object"==typeof t.variables&&Object.keys(t.variables).forEach(t=>{e.has(t)||(e.add(t),a.push(t))})});const l=new Set,n=[];return o.value.includes("parameters")&&t.apiCalls.forEach(e=>{if(e.request?.body){const t=x(g(e.request.body));Object.keys(t).forEach(e=>{l.has(e)||(l.add(e),n.push(e))})}}),t.apiCalls.map((e,l)=>{const r={};var s,i;if(J(t.trial)&&(r.Row=l+1),o.value.includes("id")&&(r.ID=e.id),o.value.includes("trial_id")&&(r["Trial ID"]=e.trialId),o.value.includes("trial_name")&&(r["Trial Name"]=t.trial.name),o.value.includes("status")&&(r.Status=e.status),o.value.includes("created")&&(r.Created=e.created?new Date(e.created).toISOString():""),o.value.includes("completed")&&(r.Completed=e.completed?new Date(e.completed).toISOString():""),o.value.includes("configuration_index")&&(r["Configuration Index"]=e.configurationIndex),o.value.includes("configuration_name")&&(r["Configuration Name"]=(s=e.configurationIndex,t.trial.configurationSnapshots[s]&&t.trial.configurationSnapshots[s].name||`Config ${s+1}`)),o.value.includes("provider")&&(r.Provider=t.trial.configurationSnapshots?.[e.configurationIndex]?.provider||(i=e,i.request?.url?.includes("openai.com")?"OpenAI":i.request?.url?.includes("anthropic.com")?"Anthropic":i.request?.url?.includes("openrouter.ai")?"OpenRouter":i.request?.url?.includes("localhost:11434")?"Ollama":"Unknown")),o.value.includes("model")&&(r.Model=t.trial.configurationSnapshots?.[e.configurationIndex]?.modelId||function(e){return e.request?.body?.model?e.request.body.model:"Unknown"}(e)),o.value.includes("prompt")&&(r.Prompt=e.prompt),o.value.includes("variables"))for(const t of a)r[t]=e.variables?.[t]||"";if(o.value.includes("result_content")&&(r["Result Content"]=e.result?.content||""),o.value.includes("result_error")&&(r["Result Error"]=e.result?.error||""),o.value.includes("response_latency_ms")&&(r["Response Latency (ms)"]=e.response?.latencyMs||""),o.value.includes("duration_ms")){const t=e.created?new Date(e.created).getTime():0,a=e.completed?new Date(e.completed).getTime():0;r["Duration (ms)"]=t&&a?a-t:""}if(o.value.includes("result_success")&&(r["Result Success"]=e.result?.success||!1),o.value.includes("request_url")&&(r["Request URL"]=e.request?.url||""),o.value.includes("request_method")&&(r["Request Method"]=e.request?.method||""),o.value.includes("request_headers")&&(r["Request Headers"]=JSON.stringify(e.request?.headers||{})),o.value.includes("request_body")&&(r["Request Body"]=JSON.stringify(e.request?.body||{})),o.value.includes("response_status")&&(r["Response Status"]=e.response?.status||""),o.value.includes("response_headers")&&(r["Response Headers"]=JSON.stringify(e.response?.headers||{})),o.value.includes("response_body")&&(r["Response Body"]=JSON.stringify(e.response?.body||{})),o.value.includes("network_error_count")&&(r["Network Error Count"]=0),o.value.includes("retry_count")&&(r["Retry Count"]=0),o.value.includes("parameters")&&n.length>0)if(e.request?.body){const t=g(e.request.body),a=x(t);l<3&&Y.debug("Export parameters debug",{callId:e.id,requestBody:e.request.body,extractedParams:t,flatParams:a,parameterOrder:n});for(const e of n){r[`param.${e}`]=void 0!==a[e]?a[e]:""}}else for(const t of n){r[`param.${t}`]=""}return void 0!==e.repeatIndex&&(r.Repeat=e.repeatIndex+1,r["Repeat Group"]=e.repeatGroupId),r})}async function T(){const e=S(),a=(new Date).toISOString().split("T")[0],l=`${t.trial.name}_${i.value}_${a}`;try{switch(i.value){case"csv":!function(e,t){if(0===e.length)return;const a=Object.keys(e[0]||{}),l=[a.join(","),...e.map(e=>a.map(t=>`"${String(e[t]??"").replace(/"/g,'""')}"`).join(","))].join("\n");I(l,`${t}.csv`,"text/csv")}(e,l);break;case"tsv":!function(e,t){if(0===e.length)return;const a=Object.keys(e[0]||{}),l=[a.join("\t"),...e.map(e=>a.map(t=>String(e[t]||"").replace(/\t/g," ")).join("\t"))].join("\n");I(l,`${t}.tsv`,"text/tab-separated-values")}(e,l);break;case"excel":await async function(e,t){const a=await me(()=>import("./xlsx-C4WhbwXR.js"),[],import.meta.url),l=a.utils.book_new(),n=a.utils.json_to_sheet(e),r=Object.keys(e[0]||{}),s=r.map(e=>({wch:Math.min(Math.max(e.length,10),50)}));n["!cols"]=s,a.utils.book_append_sheet(l,n,"Trial Results"),a.writeFile(l,`${t}.xlsx`)}(e,l);break;case"json":!function(e,t){const a=JSON.stringify(e,null,2);I(a,`${t}.json`,"application/json")}(e,l);break;case"jsonl":!function(e,t){const a=e.map(e=>JSON.stringify(e)).join("\n");I(a,`${t}.jsonl`,"application/jsonl")}(e,l)}}catch(n){Y.error("Export failed",n),de.error("Export failed: "+(n instanceof Error?n.message:"Unknown error"))}}function I(e,t,a){let l=e;"text/csv"!==a&&"text/tab-separated-values"!==a||(l="\ufeff"+e);const n=new Blob([l],{type:`${a};charset=utf-8`}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}return(e,t)=>{const n=h("a-button");return w(),p("div",{class:"modal-overlay",onClick:t[4]||(t[4]=$(t=>e.$emit("close"),["self"]))},[m("div",ys,[m("div",bs,[t[5]||(t[5]=m("h3",null,"Export Trial Data",-1)),m("button",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"close-btn","data-testid":"btn-close-export-modal","aria-label":"Close export modal"},"Ã—")]),m("div",_s,[m("div",ws,[t[6]||(t[6]=m("h4",null,"Export Format",-1)),m("div",ks,[(w(),p(b,null,_(l,e=>m("label",{key:e.id,class:"format-option","data-testid":`label-format-${e.id}`,"aria-label":`Export as ${e.name} format`},[A(m("input",{type:"radio",value:e.id,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),class:"format-radio","data-testid":`radio-format-${e.id}`,"aria-label":`Select ${e.name} format`},null,8,Cs),[[V,i.value]]),m("span",Ss,[m("span",Ts,C(e.name),1)])],8,xs)),64))])]),m("div",Is,[m("h4",null,[t[7]||(t[7]=k(" Fields to Export ")),m("div",{class:"field-controls"},[m("button",{onClick:d,class:"control-btn","data-testid":"btn-select-all-fields","aria-label":"Select all export fields"},"Select All"),m("button",{onClick:f,class:"control-btn","data-testid":"btn-select-default-fields","aria-label":"Select default export fields"},"Defaults"),m("button",{onClick:v,class:"control-btn","data-testid":"btn-select-no-fields","aria-label":"Deselect all export fields"},"Select None")])]),m("div",Os,[(w(),p(b,null,_(s,e=>m("div",{key:e.name,class:"field-group","data-testid":`field-group-${e.name.toLowerCase().replace(/\s+/g,"-")}`},[m("h5",null,C(e.name),1),m("div",Ps,[(w(!0),p(b,null,_(e.fields,e=>(w(),p("label",{key:e.id,class:"field-option","data-testid":`label-field-${e.id}`,"aria-label":`Include ${e.name} in export`},[A(m("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value=e),class:"field-checkbox","data-testid":`checkbox-field-${e.id}`,"aria-label":`Select ${e.name} field for export`},null,8,Ms),[[H,o.value]]),m("span",Rs,[m("span",Ns,C(e.name),1),m("span",Fs,C(e.description),1)])],8,$s))),128))])],8,Es)),64))])]),m("div",As,[t[8]||(t[8]=m("h4",null,"Export Preview",-1)),m("div",Ds,[m("span",js,C(e.apiCalls.length)+" records",1),m("span",Ls,C(o.value.length)+" fields",1),m("span",zs,"~"+C(u.value),1)])])]),m("div",Us,[a(n,{onClick:t[3]||(t[3]=t=>e.$emit("close")),size:"large",class:"footer-button","data-testid":"btn-cancel-export","aria-label":"Cancel export"},{default:y(()=>t[9]||(t[9]=[k(" Cancel ")])),_:1,__:[9]}),a(n,{type:"primary",onClick:T,disabled:0===o.value.length,size:"large",class:"footer-button footer-button-primary","data-testid":"btn-confirm-export","data-format":i.value,"aria-label":`Export data as ${i.value.toUpperCase()}`},{default:y(()=>[k(" Export "+C(i.value.toUpperCase()),1)]),_:1},8,["disabled","data-format","aria-label"])])])])}}}),[["__scopeId","data-v-4705d0fc"]]),Vs=Object.freeze(Object.defineProperty({__proto__:null,default:qs},Symbol.toStringTag,{value:"Module"}));function Hs(e,t={}){const{embedded:a=!1,providedApiCalls:l}=t,r=R(l||[]),s=n(!0),i=n(null);let o=null;return c(e,(e,t)=>{e!==t&&(o&&(o.unsubscribe(),o=null),a&&!l&&e?(async e=>{s.value=!0,i.value=null;try{if(l)return r.value=l,void(s.value=!1);o=Me(()=>ye.apiCalls.where("trialId").equals(e).toArray()).subscribe({next:e=>{r.value=e,s.value=!1},error:t=>{Y.error("Error loading API calls",t,{component:"useTrialApiCalls",trialId:e}),i.value=t instanceof Error?t:new Error("Failed to load API calls"),s.value=!1}})}catch(t){Y.error("Error setting up API calls subscription",t,{component:"useTrialApiCalls",trialId:e}),i.value=t instanceof Error?t:new Error("Failed to setup API calls subscription"),s.value=!1}})(e):s.value=!1)},{immediate:!0}),d(()=>{o&&o.unsubscribe()}),{apiCalls:r,loading:s,error:i}}const Bs={class:"trial-details-panel"},Ws={key:0,class:"empty-details"},Gs={class:"empty-illustration"},Ks={key:1,class:"trial-details"},Js={class:"details-header-fixed"},Ys={class:"details-content-tabbed"},Qs=te(o({__name:"TrialDetailsPanel",emits:["create-trial"],setup(e){const t=ht(),l=G(),i=s(),o=n(!1),c=n(null),u=n([]),d=n(!1),_=r(()=>t.selectedTrial),x=r(()=>_.value?.id||void 0),{apiCalls:C,loading:S}=Hs(x,{embedded:!0});async function T(){if(_.value)try{await l.pauseTrial(_.value.id),Y.info("Trial paused",{trialId:_.value.id})}catch(e){Y.error("Failed to pause trial",e),ge.error({title:"Failed to pause trial",content:e instanceof Error?e.message:"Unknown error"})}}async function I(){if(_.value&&!d.value){d.value=!0;try{const e=await l.getRunningTrials();e.length>0?ge.confirm({title:"Another trial is already running",content:`The trial "${e[0].name}" is currently running. Resuming this trial will pause it. Do you want to continue?`,okText:"Yes, resume this trial",cancelText:"No, keep current trial",onOk:async()=>{try{await l.resumeTrial(_.value.id),Y.info("Trial resumed",{trialId:_.value.id})}catch(e){Y.error("Failed to resume trial",e),ge.error({title:"Failed to resume trial",content:e instanceof Error?e.message:"Unknown error"})}finally{d.value=!1}},onCancel:()=>{d.value=!1}}):(await l.resumeTrial(_.value.id),Y.info("Trial resumed",{trialId:_.value.id}),d.value=!1)}catch(e){Y.error("Failed to check running trials",e),ge.error({title:"Failed to resume trial",content:e instanceof Error?e.message:"Unknown error"}),d.value=!1}}}async function O(){_.value&&ge.confirm({title:"Cancel Trial?",content:"Are you sure you want to cancel this trial? This action cannot be undone.",okText:"Cancel Trial",okType:"danger",cancelText:"Keep Running",onOk:async()=>{try{await l.cancelTrial(_.value.id),Y.info("Trial cancelled",{trialId:_.value.id})}catch(e){Y.error("Failed to cancel trial",e),ge.error({title:"Failed to cancel trial",content:e instanceof Error?e.message:"Unknown error"})}}})}async function E(){await async function(){if(!_.value)return;try{const{PythonExportService:e}=await me(async()=>{const{PythonExportService:e}=await Promise.resolve().then(()=>ai);return{PythonExportService:e}},void 0,import.meta.url),t=e.validateTrialForExport(_.value);if(!t.valid)return void ge.error({title:"Cannot export trial",content:t.errors.join("\n")});const a=await e.generatePythonScript(_.value,{mode:"simple"}),l=new Blob([a],{type:"text/x-python"}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=`auditomatic_${_.value.name.replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.py`,r.click(),URL.revokeObjectURL(n),Y.info("Trial exported",{trialId:_.value.id})}catch(e){Y.error("Failed to export trial",e),ge.error({title:"Failed to export trial",content:e instanceof Error?e.message:"Unknown error"})}}()}async function P(){if(!_.value)return;const e=await ye.apiCalls.where("trialId").equals(_.value.id).toArray();o.value=!0,c.value=_.value,u.value=e}function $(){_.value&&i.push({name:"trials",query:{tab:"create",duplicate:_.value.id}})}function M(){_.value&&i.push({name:"trials",query:{tab:"create",duplicate:_.value.id,edit:"true"}})}async function R(){_.value&&ge.confirm({title:"Delete Trial?",content:`Are you sure you want to delete "${_.value.name}"? This action cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{try{await l.deleteTrial(_.value.id),t.selectTrial(null),Y.info("Trial deleted",{trialId:_.value.id})}catch(e){Y.error("Failed to delete trial",e),ge.error({title:"Failed to delete trial",content:e instanceof Error?e.message:"Unknown error"})}}})}return(e,t)=>{const l=h("a-button");return w(),p(b,null,[m("div",Bs,[_.value?(w(),p("div",Ks,[m("div",Js,[a(fa,{trial:_.value},null,8,["trial"]),a(ga,{trial:_.value,"is-resuming":d.value,onPauseTrial:T,onResumeTrial:I,onCancelTrial:O,onExportData:P,onExportPython:E,onDuplicateTrial:$,onEditTrial:M,onDeleteTrial:R},null,8,["trial","is-resuming"])]),m("div",Ys,[a(hs,{trial:_.value,"api-calls":g(C),loading:g(S)},null,8,["trial","api-calls","loading"])])])):(w(),p("div",Ws,[m("div",Gs,[a(g(Ce),{style:{"font-size":"64px",color:"var(--color-primary-alpha)"}})]),t[3]||(t[3]=m("h3",null,"Select a trial to view details",-1)),t[4]||(t[4]=m("p",null,"Choose from the list or create a new one",-1)),a(l,{type:"primary",class:"create-trial-button-large",onClick:t[0]||(t[0]=t=>e.$emit("create-trial"))},{icon:y(()=>[a(g(X))]),default:y(()=>[t[2]||(t[2]=k(" Create New Trial "))]),_:1,__:[2]})]))]),o.value?(w(),v(qs,{key:0,trial:c.value,"api-calls":u.value,onClose:t[1]||(t[1]=e=>o.value=!1)},null,8,["trial","api-calls"])):f("",!0)],64)}}}),[["__scopeId","data-v-4dbb5d84"]]);class Xs{static generate(e){const t=this.extractData(e);return this.generateScript(t,e.name)}static extractData(e){const t=e.configurationSnapshots.map(e=>({provider:e.provider,modelId:e.modelId,displayName:e.name,parameters:e.parameters})),a=new Set(t.map(e=>e.provider)),l={};for(const n of a){const e=he.getProvider(n);e&&(l[n]=this.buildProviderConfig(n,e))}if(J(e)){const{columns:a,rows:n}=e.datasetSnapshot;return{trialType:"spreadsheet",experiment:{promptTemplate:e.promptPattern,dataset:{columns:a,rows:n}},models:t,providerConfigs:l}}if(K(e)){const a={};return e.variableSnapshots.forEach(e=>{"simple"===e.category&&e.data.values?a[e.variableName]=e.data.values:"attributed"===e.category&&e.data.items&&(a[e.variableName]=e.data.items.map(e=>e.value))}),{trialType:"template",experiment:{promptTemplate:e.template,variables:a},models:t,providerConfigs:l}}throw new Error("Unknown trial type for export")}static buildProviderConfig(e,t){const a=t.requestTransform||{},l=t.auth||{type:"none"};let n="direct";"messages"===a.promptKey&&a.wrapPrompt?n="messages":"input"===a.promptKey&&(n="input");let r,s,i="root";"ollama-chat"===e?(i="options",r={max_tokens:"num_predict",max_completion_tokens:"num_predict"}):"ollama-generate"===e&&(i="mixed",s={root:["model","prompt","stream","format","raw"],options:["temperature","num_predict","top_k","top_p"]},r={max_tokens:"num_predict",max_completion_tokens:"num_predict"});const o=Object.values(t.responseModes||{})[0],c=this.parseResponsePath(o?.responseTransform?.contentPath),u=o?.responseTransform?.fallbackPaths?.map(e=>this.parseResponsePath(e)),d=t.api.baseUrl+(t.api.endpoints.chat||t.api.endpoints.generate||"");return{name:t.name,endpoint:d,auth:{type:l.type,header:l.header,prefix:"bearer"===l.type?"Bearer":void 0},headers:t.headers,request:{modelPrefixStrip:!0,promptFormat:n,messageRole:a.messageRole,paramLocation:i,paramRenames:r,mixedParams:s},response:{successPath:c,fallbackPaths:u,errorPath:["error","message"]}}}static parseResponsePath(e){return e?e.split(/[\.\[\]]/).filter(Boolean).map(e=>{const t=parseInt(e);return isNaN(t)?e:t}):["content"]}static generateScript(e,t){const a=(new Date).toISOString(),l=JSON.stringify(e.models,null,4),n=JSON.stringify(e.providerConfigs,null,4),r="template"===e.trialType?`"variables": ${JSON.stringify(e.experiment.variables,null,4)}`:`"dataset": ${JSON.stringify(e.experiment.dataset,null,4)}`;return`#!/usr/bin/env python3\n"""\nAI Model Testing Script - Simple Mode\n=====================================\nGenerated by Auditomatic Lite v${Se.short} on ${a}\n\nThis script reproduces your experiment by generating API calls from variables.\nPerfect for understanding, modifying, and extending your experiments.\n\nOriginal trial: ${t}\n"""\n\nimport os\nimport json\nimport time\nimport requests\nimport pandas as pd\nfrom datetime import datetime\nfrom typing import Dict, List, Any, Optional\n\n# === CONFIGURATION ===\n\n# API Keys - Add your keys here or set as environment variables\nAPI_KEYS = {\n${Object.keys(e.providerConfigs).map(e=>{const t=e.split("-")[0].toUpperCase();return`    "${e}": os.environ.get("${t}_API_KEY", ""),`}).join("\n")}\n}\n\n# Your experiment design\nEXPERIMENT = {\n    "trial_type": "${e.trialType}",\n    "prompt_template": "${e.experiment.promptTemplate.replace(/"/g,'\\"')}",\n    ${r}\n}\n\n# Models to test\nMODELS = ${l}\n\n# Provider configurations (how to talk to each API)\nPROVIDER_CONFIGS = ${n}\n\n# Output settings\nOUTPUT_FORMAT = "csv"  # Options: csv, excel, json, parquet, html, markdown, stata, pickle\n\n# === IMPLEMENTATION ===\n\ndef make_api_call(provider_id: str, model: str, prompt: str, params: dict) -> dict:\n    """\n    Universal API caller that handles all provider quirks.\n    \n    Returns dict with 'success', 'content', 'error', and timing info.\n    """\n    config = PROVIDER_CONFIGS[provider_id]\n    \n    # Build headers\n    headers = {"Content-Type": "application/json"}\n    \n    # Add authentication\n    auth = config["auth"]\n    if auth["type"] == "bearer":\n        api_key = API_KEYS.get(provider_id, "")\n        if not api_key:\n            return {"success": False, "error": f"No API key for {provider_id}"}\n        headers[auth["header"]] = f"{auth['prefix']} {api_key}"\n    elif auth["type"] == "header":\n        api_key = API_KEYS.get(provider_id, "")\n        if not api_key:\n            return {"success": False, "error": f"No API key for {provider_id}"}\n        headers[auth["header"]] = api_key\n    \n    # Add provider-specific headers\n    if config.get("headers"):\n        headers.update(config["headers"])\n    \n    # Build request body\n    request = config["request"]\n    \n    # Strip provider prefix from model\n    if request.get("modelPrefixStrip"):\n        model = model.split(":", 1)[-1]\n    \n    body = {"model": model}\n    \n    # Format prompt\n    if request["promptFormat"] == "messages":\n        body["messages"] = [{"role": request.get("messageRole", "user"), "content": prompt}]\n    elif request["promptFormat"] == "direct":\n        body["prompt"] = prompt\n    elif request["promptFormat"] == "input":\n        body["input"] = prompt\n    \n    # Handle parameters\n    processed_params = params.copy()\n    \n    # Apply renames\n    if request.get("paramRenames"):\n        for old_key, new_key in request["paramRenames"].items():\n            if old_key in processed_params:\n                processed_params[new_key] = processed_params.pop(old_key)\n    \n    # Place parameters\n    if request["paramLocation"] == "root":\n        body.update(processed_params)\n    elif request["paramLocation"] == "options":\n        body["options"] = processed_params\n    elif request.get("mixedParams"):\n        mixed = request["mixedParams"]\n        for key, value in processed_params.items():\n            if key in mixed.get("root", []):\n                body[key] = value\n            else:\n                if "options" not in body:\n                    body["options"] = {}\n                body["options"][key] = value\n    \n    # Make request\n    start_time = time.time()\n    try:\n        response = requests.post(\n            config["endpoint"],\n            headers=headers,\n            json=body,\n            timeout=30\n        )\n        latency_ms = (time.time() - start_time) * 1000\n        \n        if response.ok:\n            data = response.json()\n            content = extract_from_path(data, config["response"]["successPath"])\n            \n            # Try fallback paths\n            if content is None and config["response"].get("fallbackPaths"):\n                for path in config["response"]["fallbackPaths"]:\n                    content = extract_from_path(data, path)\n                    if content is not None:\n                        break\n            \n            return {\n                "success": True,\n                "content": content or "",\n                "latency_ms": latency_ms,\n                "status_code": response.status_code\n            }\n        else:\n            return {\n                "success": False,\n                "error": f"HTTP {response.status_code}: {response.text[:200]}",\n                "latency_ms": latency_ms,\n                "status_code": response.status_code\n            }\n            \n    except Exception as e:\n        return {\n            "success": False,\n            "error": str(e),\n            "latency_ms": (time.time() - start_time) * 1000\n        }\n\ndef extract_from_path(data: Any, path: List[Any]) -> Optional[str]:\n    """Extract value from nested data using a path like ['choices', 0, 'message', 'content']"""\n    try:\n        current = data\n        for key in path:\n            if isinstance(current, dict):\n                current = current[key]\n            elif isinstance(current, list):\n                current = current[int(key)]\n            else:\n                return None\n        return str(current) if current is not None else None\n    except (KeyError, IndexError, TypeError):\n        return None\n\ndef generate_prompts():\n    """Generate all prompts from template and variables"""\n    template = EXPERIMENT["prompt_template"]\n    trial_type = EXPERIMENT["trial_type"]\n    \n    if trial_type == "spreadsheet":\n        # Spreadsheet trials: row-by-row execution\n        dataset = EXPERIMENT["dataset"]\n        \n        for row in dataset["rows"]:\n            # Replace variables in template with values from this row\n            prompt = template\n            var_dict = {}\n            \n            for col, value in row.items():\n                var_dict[col] = str(value) if value is not None else ""\n                prompt = prompt.replace(f"{{{{{col}}}}}", var_dict[col])\n            \n            yield prompt, var_dict\n    else:\n        # Template trials: cartesian product execution\n        variables = EXPERIMENT["variables"]\n        \n        # Get variable names from template\n        import re\n        var_names = re.findall(r'{{(\\w+)}}', template)\n        \n        # Generate all combinations\n        from itertools import product\n        \n        var_lists = [variables[var] for var in var_names if var in variables]\n        if not var_lists:\n            yield template, {}\n            return\n            \n        for values in product(*var_lists):\n            var_dict = dict(zip(var_names, values))\n            \n            # Replace variables in template\n            prompt = template\n            for var, val in var_dict.items():\n                prompt = prompt.replace(f"{{{{{var}}}}}", str(val))\n            \n            yield prompt, var_dict\n\ndef run_experiment():\n    """Run the full experiment"""\n    results = []\n    total_calls = len(MODELS) * len(list(generate_prompts()))\n    current = 0\n    \n    print(f"Running experiment with {len(MODELS)} models and {total_calls} total API calls")\n    print("=" * 60)\n    \n    for model_config in MODELS:\n        print(f"\\nTesting {model_config['displayName']}...")\n        \n        for prompt, variables in generate_prompts():\n            current += 1\n            print(f"[{current}/{total_calls}] {prompt[:50]}...", end=" ")\n            \n            # Make API call\n            result = make_api_call(\n                model_config["provider"],\n                model_config["modelId"],\n                prompt,\n                model_config["parameters"]\n            )\n            \n            # Collect results\n            results.append({\n                "timestamp": datetime.now(),\n                "provider": model_config["provider"],\n                "model": model_config["modelId"],\n                "model_name": model_config["displayName"],\n                "prompt": prompt,\n                "response": result.get("content", ""),\n                "success": result.get("success", False),\n                "error": result.get("error", ""),\n                "latency_ms": result.get("latency_ms", 0),\n                "status_code": result.get("status_code", 0),\n                **variables  # Add variables as columns\n            })\n            \n            # Show result\n            if result["success"]:\n                print(f"âœ“ {result['content'][:30]}")\n            else:\n                print(f"âœ— {result['error'][:30]}")\n            \n            # Rate limiting\n            time.sleep(0.1)\n    \n    return results\n\ndef save_results(results: List[Dict[str, Any]], format: str = OUTPUT_FORMAT):\n    """Save results using pandas in the specified format"""\n    df = pd.DataFrame(results)\n    \n    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")\n    base_filename = f"experiment_results_{timestamp}"\n    \n    if format == "csv":\n        filename = f"{base_filename}.csv"\n        df.to_csv(filename, index=False)\n    elif format == "excel":\n        filename = f"{base_filename}.xlsx"\n        df.to_excel(filename, index=False)\n    elif format == "json":\n        filename = f"{base_filename}.json"\n        df.to_json(filename, orient="records", indent=2)\n    elif format == "parquet":\n        filename = f"{base_filename}.parquet"\n        df.to_parquet(filename)\n    elif format == "html":\n        filename = f"{base_filename}.html"\n        df.to_html(filename, index=False)\n    elif format == "markdown":\n        filename = f"{base_filename}.md"\n        with open(filename, "w") as f:\n            f.write(df.to_markdown(index=False))\n    elif format == "stata":\n        filename = f"{base_filename}.dta"\n        df.to_stata(filename)\n    elif format == "pickle":\n        filename = f"{base_filename}.pkl"\n        df.to_pickle(filename)\n    else:\n        filename = f"{base_filename}.csv"\n        df.to_csv(filename, index=False)\n    \n    print(f"\\nResults saved to {filename}")\n    return filename\n\ndef main():\n    """Main entry point"""\n    # Check for API keys\n    missing_keys = []\n    for model in MODELS:\n        provider = model["provider"]\n        if provider not in API_KEYS or not API_KEYS[provider]:\n            missing_keys.append(provider)\n    \n    if missing_keys:\n        print("WARNING: Missing API keys for:", ", ".join(set(missing_keys)))\n        print("Set them in the API_KEYS dict or as environment variables.")\n        response = input("\\nContinue anyway? (y/N): ")\n        if response.lower() != 'y':\n            return\n    \n    # Run experiment\n    results = run_experiment()\n    \n    # Save results\n    if results:\n        save_results(results)\n        \n        # Basic summary\n        df = pd.DataFrame(results)\n        print(f"\\nSummary:")\n        print(f"Total calls: {len(df)}")\n        print(f"Successful: {df['success'].sum()}")\n        print(f"Failed: {(~df['success']).sum()}")\n        if 'latency_ms' in df.columns:\n            print(f"Avg latency: {df['latency_ms'].mean():.1f}ms")\n    else:\n        print("\\nNo results to save")\n\nif __name__ == "__main__":\n    main()\n`}}class Zs{static generate(e){return this.generateDisabledScript(e.name)}static generateDisabledScript(e){return`#!/usr/bin/env python3\n"""\nLiteral Mode Export - Currently Disabled\n=======================================\nGenerated by Auditomatic Lite on ${(new Date).toISOString()}\n\nThis export mode is temporarily disabled during V2 migration.\nLiteral mode will be restored in the next release with support for:\n- Template trials (cartesian product execution)  \n- Spreadsheet trials (row-by-row execution)\n- Pre-computed exact API calls for reproduction\n\nOriginal trial: ${e}\n\nFor now, please use Simple Mode export which provides full functionality.\n"""\n\nprint("âŒ Literal mode export is temporarily disabled during V2 migration.")\nprint("âœ… Please use Simple Mode export for full trial reproduction functionality.")\nprint("ðŸ“… Literal mode will be restored in the next release.")\n`}}class ei{static generate(e){return this.generateDisabledScript(e.name)}static generateDisabledScript(e){return`#!/usr/bin/env python3\n"""\nNative Mode Export - Currently Disabled\n=======================================\nGenerated by Auditomatic Lite on ${(new Date).toISOString()}\n\nThis export mode is temporarily disabled during V2 migration.\nNative mode will be restored in the next release with support for:\n- Template trials (cartesian product execution)\n- Spreadsheet trials (row-by-row execution)  \n- Official Python SDKs (openai, anthropic, ollama)\n- Clean production-ready code\n\nOriginal trial: ${e}\n\nFor now, please use Simple Mode export which provides full functionality.\nRequired packages when restored: pip install openai anthropic ollama\n"""\n\nprint("âŒ Native mode export is temporarily disabled during V2 migration.")\nprint("âœ… Please use Simple Mode export for full trial reproduction functionality.")\nprint("ðŸ“… Native mode will be restored in the next release.")\nprint("ðŸ“¦ When restored, install with: pip install openai anthropic ollama")\n`}}class ti{static async generatePythonScript(e,t){try{const a=t||this.getDefaultOptions(),l=this.validateTrialForExport(e);if(!l.valid)throw new Error(`Trial validation failed: ${l.errors.join(", ")}`);switch(a.mode){case"simple":return Xs.generate(e);case"literal":return Zs.generate(e);case"native":return ei.generate(e);default:throw new Error(`Unknown export mode: ${a.mode}`)}}catch(a){throw new Error(`Failed to generate Python export: ${a instanceof Error?a.message:String(a)}`)}}static async downloadPythonScript(e,t){const a=await this.generatePythonScript(e,t),l=t||this.getDefaultOptions(),n=new Blob([a],{type:"text/x-python"}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=this.generateFilename(e,l.mode),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}static validateTrialForExport(e){const t=[];return K(e)?(e.template||t.push("Template trial missing template text"),e.variableSnapshots||t.push("Template trial missing variable snapshots"),e.totalCombinations||t.push("Template trial missing combination count")):J(e)?(e.promptPattern||t.push("Spreadsheet trial missing prompt pattern"),e.datasetSnapshot||t.push("Spreadsheet trial missing dataset snapshot"),e.datasetSnapshot?.rows?.length||t.push("Spreadsheet trial missing dataset rows"),e.totalRows||t.push("Spreadsheet trial missing row count")):t.push("Unknown trial type for export"),e.configurationSnapshots&&0!==e.configurationSnapshots.length?e.configurationSnapshots.forEach((e,a)=>{e.provider||t.push(`Configuration ${a+1} missing provider`),e.modelId||t.push(`Configuration ${a+1} missing model`),e.parameters||t.push(`Configuration ${a+1} missing parameters`)}):t.push("Trial missing model configurations"),{valid:0===t.length,errors:t}}static getExportSummary(e){const t=new Set(e.configurationSnapshots.map(e=>e.provider)),a=Te(e);return{apiCallCount:e.configurationSnapshots.length*a,providersUsed:Array.from(t),variableCombinations:a,configurations:e.configurationSnapshots.length}}static getDefaultOptions(){return{mode:"simple"}}static generateFilename(e,t){const a=e.name||`trial_${e.id}`,l=(new Date).toISOString().split("T")[0];return`${a.toLowerCase().replace(/[^a-z0-9]/g,"_")}_${t}_${l}.py`}}const ai=Object.freeze(Object.defineProperty({__proto__:null,PythonExportService:ti},Symbol.toStringTag,{value:"Module"})),li={class:"trial-info"},ni={class:"trial-stats"},ri={class:"export-section"},si={class:"mode-content"},ii={class:"mode-content"},oi={class:"mode-content"},ci={class:"export-section"},ui={class:"preview-content"},di={class:"preview-info"},pi=o({__name:"PythonExportModal",props:{trial:{}},emits:["close","exported"],setup(e,{emit:t}){const l=e,s=t,i=n("simple"),o=n(!1),c=r(()=>l.trial.progress.total),u=r(()=>l.trial.configurationSnapshots?.length||0),d=r(()=>{if(K(l.trial))return l.trial.totalCombinations||0;if(J(l.trial)){return(l.trial.datasetSnapshot?.rows?.length||0)*(l.trial.configurationSnapshots?.length||0)}return 0}),p=r(()=>{const e=.05*d.value+.3*u.value;return Math.round(15+e)}),f=r(()=>{const e=l.trial.name.toLowerCase().replace(/\s+/g,"_"),t=(new Date).toISOString().split("T")[0];return`${e}_${i.value}_${t}.py`}),g=r(()=>{if("simple"===i.value){return 300+(d.value+10*u.value)}if("native"===i.value){return 250+(d.value+8*u.value)}return 200+15*c.value});async function b(){o.value=!0;try{const e={mode:i.value};await ti.downloadPythonScript(l.trial,e),s("exported",f.value),s("close")}catch(e){Y.error("Export failed",e),alert("Export failed: "+(e instanceof Error?e.message:"Unknown error"))}finally{o.value=!1}}return(e,t)=>{const l=h("a-button"),n=h("a-tag"),r=h("a-radio"),s=h("a-radio-group"),_=h("a-typography-text");return w(),v(Re,{"model-value":!0,title:"Export Python Script",size:"full","onUpdate:modelValue":t[2]||(t[2]=t=>e.$emit("close"))},{footer:y(()=>[a(l,{onClick:t[0]||(t[0]=t=>e.$emit("close")),size:"large","data-testid":"btn-cancel-python-export","aria-label":"Cancel Python export"},{default:y(()=>t[3]||(t[3]=[k(" Cancel ")])),_:1,__:[3]}),a(l,{type:"primary",onClick:b,loading:o.value,size:"large","data-testid":"btn-confirm-python-export","data-mode":i.value,"aria-label":`Export Python script in ${i.value} mode`},{default:y(()=>t[4]||(t[4]=[k(" Export Script ")])),_:1,__:[4]},8,["loading","data-mode","aria-label"])]),default:y(()=>[m("div",li,[m("h3",null,C(e.trial.name),1),m("div",ni,[a(n,null,{default:y(()=>[k(C(c.value)+" API calls",1)]),_:1}),a(n,null,{default:y(()=>[k(C(u.value)+" configurations",1)]),_:1}),a(n,null,{default:y(()=>[k(C(d.value)+" variable combinations",1)]),_:1})])]),m("div",ri,[t[13]||(t[13]=m("h4",null,"Export Mode",-1)),a(s,{value:i.value,"onUpdate:value":t[1]||(t[1]=e=>i.value=e),class:"mode-options","data-testid":"radiogroup-export-mode","aria-label":"Select Python export mode"},{default:y(()=>[a(r,{value:"simple",class:"mode-radio","data-testid":"radio-mode-simple","aria-label":"Simple script mode"},{default:y(()=>[m("div",si,[t[5]||(t[5]=m("div",{class:"mode-title"},"Simple Script",-1)),t[6]||(t[6]=m("div",{class:"mode-description"}," Educational script with variables as lists. Easy to understand, modify, and extend. Perfect for learning how AI APIs work. ",-1)),a(n,{color:"blue",size:"small"},{default:y(()=>[k("~"+C(p.value)+"KB",1)]),_:1})])]),_:1}),a(r,{value:"literal",class:"mode-radio disabled-mode","data-testid":"radio-mode-literal","aria-label":"Literal reproduction mode",disabled:""},{default:y(()=>[m("div",ii,[t[8]||(t[8]=m("div",{class:"mode-title"},"Literal Reproduction (Coming Soon)",-1)),t[9]||(t[9]=m("div",{class:"mode-description"}," Exact API calls pre-computed. Currently being updated for V2 trials. Will be available in the next release. ",-1)),a(n,{color:"orange",size:"small"},{default:y(()=>t[7]||(t[7]=[k("V2 Migration")])),_:1,__:[7]})])]),_:1}),a(r,{value:"native",class:"mode-radio disabled-mode","data-testid":"radio-mode-native","aria-label":"Native libraries mode",disabled:""},{default:y(()=>[m("div",oi,[t[11]||(t[11]=m("div",{class:"mode-title"},"Native Libraries (Coming Soon)",-1)),t[12]||(t[12]=m("div",{class:"mode-description"}," Uses official Python SDKs (openai, anthropic, ollama). Currently being updated for V2 trials. Will be available in the next release. ",-1)),a(n,{color:"orange",size:"small"},{default:y(()=>t[10]||(t[10]=[k("V2 Migration")])),_:1,__:[10]})])]),_:1})]),_:1},8,["value"])]),t[15]||(t[15]=m("div",{class:"export-section"},[m("h4",null,"Output Format"),m("div",{class:"format-info"},[m("p",null,"Both scripts save results using pandas in your choice of format:"),m("ul",null,[m("li",null,[m("strong",null,"CSV"),k(" - Universal format, opens in Excel/Google Sheets")]),m("li",null,[m("strong",null,"Excel"),k(" - Native Excel format")]),m("li",null,[m("strong",null,"JSON"),k(" - For programmatic access")]),m("li",null,[m("strong",null,"Parquet"),k(" - Efficient compressed format")]),m("li",null,[m("strong",null,"HTML"),k(" - For web viewing")]),m("li",null,[m("strong",null,"Markdown"),k(" - For documentation")]),m("li",null,[m("strong",null,"Stata"),k(" - For statistical analysis")]),m("li",null,[m("strong",null,"Pickle"),k(" - Python native format")])])])],-1)),m("div",ci,[t[14]||(t[14]=m("h4",null,"Script Preview",-1)),m("div",ui,[a(_,{code:"",class:"preview-filename"},{default:y(()=>[k(C(f.value),1)]),_:1}),m("div",di,[a(n,{size:"small"},{default:y(()=>[k(C(g.value)+" lines",1)]),_:1}),a(n,{size:"small"},{default:y(()=>[k(C(i.value)+" mode",1)]),_:1})])])])]),_:1,__:[15]})}}}),mi=te(o({__name:"ResizableDivider",props:{minSize:{default:300},maxSize:{default:600},currentWidth:{default:380},disabled:{type:Boolean,default:!1}},emits:["resize","resizeStart","resizeEnd","reset"],setup(e,{emit:t}){const a=e,l=t,r=n(!1);return(e,t)=>(w(),p("div",{class:x(["resizable-divider",{resizing:r.value,disabled:e.disabled}]),onMousedown:t[0]||(t[0]=t=>!e.disabled&&function(e){e.preventDefault(),r.value=!0;const t=e.clientX,n=a.currentWidth;l("resizeStart");const s=e=>{if(!r.value)return;const s=e.clientX-t,i=n+s,o=Math.max(a.minSize,Math.min(a.maxSize,i));l("resize",o)},i=()=>{r.value=!1,l("resizeEnd"),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",i),document.body.style.userSelect="",document.body.style.cursor=""};document.body.style.userSelect="none",document.body.style.cursor="col-resize",document.addEventListener("mousemove",s),document.addEventListener("mouseup",i)}(t)),onDblclick:t[1]||(t[1]=t=>!e.disabled&&e.$emit("reset"))},t[2]||(t[2]=[m("div",{class:"divider-handle"},[m("div",{class:"handle-bar"})],-1)]),34))}}),[["__scopeId","data-v-d9082894"]]),fi={class:"trials-view-split","data-testid":"page-trials"},vi={class:"trials-layout"},gi={class:"trials-content"},hi="auditomatic.trial-sider-width",yi=te(o({__name:"TrialsViewSplitPanel",setup(e){const t=G(),l=be(),o=ht(),b=i(),_=s(),x=n(!1),C=n(!1),T=n(null),I=n(null),O=n(!1),E=n(),P=n(),$=n(250),M=localStorage.getItem(hi);M&&($.value=parseInt(M,10));const R=r(()=>l.hasAnyApiKeys||l.isProviderEnabled("ollama-chat")||l.isProviderEnabled("ollama-generate"));function N(e){$.value=e,localStorage.setItem(hi,e.toString())}function F(){$.value=250,localStorage.setItem(hi,"250")}function A(){x.value=!1,E.value=void 0,I.value=null,O.value=!1}function D(e){Y.info("Trial created",{trialId:e}),A(),o.selectTrial(e)}async function j(e){Y.info("Trial created and started",{trialId:e}),A(),await new Promise(e=>setTimeout(e,100)),o.selectTrial(e)}function L(e){Y.info("Opening export for trial",{trialId:e.id}),T.value=e,C.value=!0}function z(e){Y.info("Python script exported",{filename:e})}function U(){const e=b.query;if(e.duplicate&&"string"==typeof e.duplicate){const a=t.trials.find(t=>t.id===e.duplicate);a&&(I.value=a,O.value="true"===e.edit,x.value=!0)}else e.designId&&"string"==typeof e.designId?(E.value=e.designId,x.value=!0):e.promptSource&&e.promptId&&(P.value={type:e.promptSource,id:e.promptId},x.value=!0);(e.duplicate||e.designId||e.edit||e.promptSource)&&_.replace({query:{}})}const q=e=>{if((e.metaKey||e.ctrlKey)&&"k"===e.key){e.preventDefault();const t=document.querySelector(".trial-list-search input");t?.focus()}};return c(()=>b.query,()=>{U()}),c(()=>b.params.trialId,()=>{o.syncWithRoute()},{immediate:!0}),u(async()=>{if(document.addEventListener("keydown",q),await t.initialize(),await new Promise(e=>setTimeout(e,50)),U(),o.syncWithRoute(),!o.selectedTrialId){const e=t.trials.find(e=>"running"===e.status);e&&o.selectTrial(e.id)}}),d(()=>{document.removeEventListener("keydown",q)}),(e,t)=>{const l=h("a-button"),n=h("a-alert");return w(),p("div",fi,[R.value?f("",!0):(w(),v(n,{key:0,type:"warning",message:"No LLM providers configured",description:"Add keys for external APIs (local Ollama does not need keys) or enable Ollama provider.","show-icon":"",class:"provider-warning"},{action:y(()=>[a(g(B),{to:"/settings"},{default:y(()=>[a(l,{size:"small",type:"primary"},{default:y(()=>t[3]||(t[3]=[k(" Go to Settings ")])),_:1,__:[3]})]),_:1})]),_:1})),m("div",vi,[m("div",{class:"trials-sider",style:S({width:$.value+"px"})},[a(ea,{collapsed:$.value<100,onCreateTrial:t[0]||(t[0]=e=>x.value=!0)},null,8,["collapsed"])],4),a(mi,{"min-size":50,"max-size":600,"current-width":$.value,onResize:N,onReset:F},null,8,["current-width"]),m("div",gi,[a(Qs,{onCreateTrial:t[1]||(t[1]=e=>x.value=!0)})])]),x.value?(w(),v(Ee,{key:1,initialDesignId:E.value,initialPromptSource:P.value,trialToDuplicate:I.value||void 0,isEditMode:O.value,onClose:A,onCreated:D,onCreatedAndStarted:j,onExportTrial:L},null,8,["initialDesignId","initialPromptSource","trialToDuplicate","isEditMode"])):f("",!0),C.value&&T.value?(w(),v(pi,{key:2,trial:T.value,onClose:t[2]||(t[2]=e=>{C.value=!1,T.value=null}),onExported:z},null,8,["trial"])):f("",!0)])}}}),[["__scopeId","data-v-1b13d29a"]]);export{yi as default};
