import{u as e}from"./models-db-ClcV8tSQ.js";import{u as t,a}from"./designs-db-b5FxS9e9.js";import{p as s,X as l,l as o,_ as n,a as r,i,n as d}from"./index-Dynr8V5n.js";import{f as u,r as c,d as p,c as m,w as v,a6 as g,_ as f,k as y,W as h,Z as b,Y as k,a1 as x,V as _,F as C,a8 as w,G as $,a0 as E,a7 as F,ad as L,ab as M,o as I,b as j,u as P}from"./vendor-DImCB_rW.js";import{T as A}from"./TemplateEditor-CY9X46jD.js";import{M as R,G as O}from"./GenericModelSelectorModal-B1wj_vmD.js";import"./db-CL8uhZCz.js";import"./defaultData-BR5V2V3r.js";import"./variable.service-DGu7U4d3.js";import"./cost-formatting-Bv_drrqY.js";function z(e){if(!e||"object"!=typeof e)return e;const t=Array.isArray(e)?[...e]:{...e};if(t.Authorization){const e=t.Authorization;if(e.startsWith("Bearer ")){const a=e.substring(7);t.Authorization=`Bearer ${a.substring(0,8)}...${a.substring(a.length-4)}`}else t.Authorization="[REDACTED]"}return Object.keys(t).forEach(e=>{"object"==typeof t[e]&&null!==t[e]&&(t[e]=z(t[e]))}),t}const S={class:"parameter-panel"},T={class:"panel-content"},D={key:0,class:"params-section"},N={key:0,class:"reasoning-warning"},V={key:5,class:"param-description"},W={key:4,class:"param-description"},U={key:2,class:"params-section"},q={class:"logprobs-controls"},H={class:"panel-actions"},B=n(p({__name:"ParameterPanel",props:{model:{},modelValue:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=e,l=t,o=c({}),n=u(!1),r=u(3),i=m(()=>{if(!a.model)return{};const e=s.getParametersForModel(a.model.provider,a.model.modelId),t={},l=(e,a="")=>{Object.entries(e).forEach(([e,s])=>{const o=a?`${a}.${e}`:e;"object"===s.type&&s.properties?l(s.properties,o):t[o]=s})};l(e);const o={};for(const[a,s]of Object.entries(t))s.basic&&(o[a]=s);const n={},r=o.temperature?"temperature":o["options.temperature"]?"options.temperature":null;r&&(n[r]=o[r]);for(const[a,s]of Object.entries(o))a!==r&&(n[a]=s);return n}),d=m(()=>{if(!a.model)return{};const e=s.getParametersForModel(a.model.provider,a.model.modelId),t={},l=(e,a="")=>{Object.entries(e).forEach(([e,s])=>{const o=a?`${a}.${e}`:e;"object"===s.type&&s.properties?l(s.properties,o):t[o]=s})};l(e);const o={};for(const[a,s]of Object.entries(t))s.basic||(o[a]=s);return o}),p=m(()=>!!a.model&&(("openai-chat"===a.model.provider||"openai-responses"===a.model.provider)&&a.model.modelId.match(/^o[0-9]/))),F=m(()=>!!a.model&&s.supportsLogprobs(a.model.provider,a.model.modelId)),L=m(()=>a.model?s.getLogprobsParameters(a.model.provider,a.model.modelId):{}),M=m(()=>!!L.value.topLogprobs);function I(e,t){o[e]=t,l("update:modelValue",{...o}),l("change",{...o})}function j(e){return e.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function P(e){n.value=e,R()}function A(e){r.value=e||3,R()}function R(){const e=L.value;if(Object.keys(o).forEach(e=>{(e.includes("logprobs")||"include"===e)&&delete o[e]}),n.value){if(e.enableParams)for(const t of e.enableParams)if("boolean"===t.type)if(t.name.includes(".")){const e=t.name.split(".");let a=o;for(let t=0;t<e.length-1;t++)a[e[t]]||(a[e[t]]={}),a=a[e[t]];a[e[e.length-1]]=t.value}else o[t.name]=t.value;else"array"===t.type&&(o[t.name]||(o[t.name]=[]),o[t.name].includes(t.value)||o[t.name].push(t.value));if(e.topLogprobs)if(e.topLogprobs.includes(".")){const t=e.topLogprobs.split(".");let a=o;for(let e=0;e<t.length-1;e++)a[t[e]]||(a[t[e]]={}),a=a[t[e]];a[t[t.length-1]]=r.value}else o[e.topLogprobs]=r.value}else if(e.enableParams)for(const t of e.enableParams)"array"===t.type&&o[t.name]&&(o[t.name]=o[t.name].filter(e=>e!==t.value),0===o[t.name].length&&delete o[t.name]);l("update:modelValue",{...o}),l("change",{...o})}function O(){if(!a.model)return;Object.keys(o).forEach(e=>delete o[e]);const e=s.supportsLogprobs(a.model.provider,a.model.modelId);n.value=e,r.value=3;const t=(e,a="")=>{Object.entries(e).forEach(([e,s])=>{const l=a?`${a}.${e}`:e;"object"===s.type&&s.properties?t(s.properties,l):void 0!==s.default&&(o[l]=s.default)})},i=s.getParametersForModel(a.model.provider,a.model.modelId);t(i),e&&R(),l("update:modelValue",{...o}),l("change",{...o})}return v(()=>a.model,e=>{if(e){const t=s.supportsLogprobs(e.provider,e.modelId);n.value=t,r.value=3,O(),t&&R()}},{immediate:!0}),v(()=>a.modelValue,e=>{Object.assign(o,e)},{immediate:!0,deep:!0}),(e,t)=>{const a=h("a-alert"),s=h("a-input-number"),l=h("a-switch"),u=h("a-select-option"),c=h("a-select"),m=h("a-input"),v=h("a-form-item"),L=h("a-collapse-panel"),R=h("a-collapse"),z=h("a-button"),B=h("a-form");return k(),g("div",S,[t[6]||(t[6]=f("div",{class:"panel-header"},[f("h3",null,"Parameters")],-1)),f("div",T,[y(B,{layout:"vertical"},{default:b(()=>[Object.keys(i.value).length>0?(k(),g("div",D,[t[1]||(t[1]=f("h4",null,"Basic Parameters",-1)),p.value?(k(),g("div",N,[y(a,{message:"O* reasoning models do not support temperature",type:"info",size:"small","show-icon":"",closable:!1})])):x("",!0),(k(!0),g(C,null,w(i.value,(e,a)=>(k(),_(v,{key:a,label:j(a)},{default:b(()=>["number"===e.type?(k(),_(s,{key:0,value:o[a],onChange:e=>I(a,e),min:e.min,max:e.max,step:e.step||.1,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):"integer"===e.type?(k(),_(s,{key:1,value:o[a],onChange:e=>I(a,e),min:e.min,max:e.max,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","placeholder"])):"boolean"===e.type?(k(),_(l,{key:2,checked:o[a],onChange:e=>I(a,e),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):"string"===e.type&&e.enum?(k(),_(c,{key:3,value:o[a],onChange:e=>I(a,e),placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:b(()=>[y(u,{value:void 0},{default:b(()=>t[0]||(t[0]=[f("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[0]}),(k(!0),g(C,null,w(e.enum,e=>(k(),_(u,{key:e,value:e},{default:b(()=>[$(E(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(k(),_(m,{key:4,value:o[a],onChange:e=>I(a,e.target.value),placeholder:String(e.default),size:"large"},null,8,["value","onChange","placeholder"])),e.description?(k(),g("div",V,E(e.description),1)):x("",!0)]),_:2},1032,["label"]))),128))])):x("",!0),Object.keys(d.value).length>0?(k(),_(R,{key:1,ghost:""},{default:b(()=>[y(L,{key:"advanced",header:"Advanced Parameters"},{default:b(()=>[(k(!0),g(C,null,w(d.value,(e,a)=>(k(),_(v,{key:a,label:j(a)},{default:b(()=>["number"===e.type||"integer"===e.type?(k(),_(s,{key:0,value:o[a],onChange:e=>I(a,e),min:e.min,max:e.max,step:"number"===e.type?e.step||.1:1,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):"boolean"===e.type?(k(),_(l,{key:1,checked:o[a],onChange:e=>I(a,e),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):"string"===e.type&&e.enum?(k(),_(c,{key:2,value:o[a],onChange:e=>I(a,e),placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:b(()=>[y(u,{value:void 0},{default:b(()=>t[2]||(t[2]=[f("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[2]}),(k(!0),g(C,null,w(e.enum,e=>(k(),_(u,{key:e,value:e},{default:b(()=>[$(E(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(k(),_(m,{key:3,value:o[a],onChange:e=>I(a,e.target.value),placeholder:String(e.default),size:"large"},null,8,["value","onChange","placeholder"])),e.description?(k(),g("div",W,E(e.description),1)):x("",!0)]),_:2},1032,["label"]))),128))]),_:1})]),_:1})):x("",!0),F.value?(k(),g("div",U,[t[4]||(t[4]=f("h4",null,"Log Probabilities",-1)),f("div",q,[y(v,{label:"Enable Logprobs"},{default:b(()=>[y(l,{checked:n.value,onChange:P,"checked-children":"On","un-checked-children":"Off"},null,8,["checked"])]),_:1}),n.value&&M.value?(k(),_(v,{key:0,label:"Top Alternatives"},{default:b(()=>[y(s,{value:r.value,onChange:A,min:0,max:20,size:"large",style:{width:"100%"},placeholder:"3"},null,8,["value"]),t[3]||(t[3]=f("div",{class:"param-description"}," Number of alternative tokens to show (0-20) ",-1))]),_:1,__:[3]})):x("",!0)])])):x("",!0),f("div",H,[y(z,{onClick:O,size:"small"},{default:b(()=>t[5]||(t[5]=[$(" Reset to Defaults ")])),_:1,__:[5]})])]),_:1})])])}}}),[["__scopeId","data-v-0c19834d"]]),J={class:"logprobs-display"},G={key:0,class:"color-legend"},Y={key:1,class:"tokens-container"},K=["onMouseenter"],X={key:2,class:"regular-text"},Q={class:"tooltip-header"},Z={class:"token-text"},ee={class:"token-probability"},te={key:0,class:"alternatives"},ae={class:"alt-text"},se={class:"alt-probability"},le={class:"logprob-raw"},oe=n(p({__name:"LogprobsDisplay",props:{text:{},logprobsData:{}},setup(e){const t=e,a=u({visible:!1,token:{text:"",logprob:0},style:{}}),s=m(()=>t.logprobsData?t.logprobsData.map(e=>({text:e.token,logprob:e.logprob,bytes:e.bytes,topLogprobs:e.top_logprobs})):[]),l=["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#abd9e9","#74add1","#4575b4","#313695"];function o(e){const t=100*Math.exp(e.logprob),a=Math.min(Math.floor(t/(100/(l.length-1))),l.length-1);return{color:l[a],cursor:"pointer",transition:"all 0.2s ease"}}function n(e){return(100*Math.exp(e)).toFixed(2)}function r(){a.value.visible=!1}return(e,t)=>(k(),g("div",J,[s.value.length>0?(k(),g("div",G,t[1]||(t[1]=[F('<span class="legend-label" data-v-a0458886>Token Confidence:</span><div class="legend-gradient" data-v-a0458886><span class="legend-low" data-v-a0458886>Low</span><div class="gradient-bar" data-v-a0458886></div><span class="legend-high" data-v-a0458886>High</span></div>',2)]))):x("",!0),s.value.length>0?(k(),g("div",Y,[(k(!0),g(C,null,w(s.value,(e,s)=>(k(),g("span",{key:s,class:"token",style:L(o(e)),onMouseenter:t=>function(e,t,s){a.value={visible:!0,token:e,style:{position:"fixed",left:`${s.clientX+10}px`,top:s.clientY-10+"px",zIndex:"1000"}}}(e,0,t),onMouseleave:r,onMousemove:t[0]||(t[0]=e=>{return t=e,void(a.value.visible&&(a.value.style={...a.value.style,left:`${t.clientX+10}px`,top:t.clientY-10+"px"}));var t})},E(e.text),45,K))),128))])):(k(),g("div",X,E(e.text),1)),a.value.visible?(k(),g("div",{key:3,class:"token-tooltip",style:L(a.value.style)},[f("div",Q,[f("span",Z,'"'+E(a.value.token.text)+'"',1),f("span",ee,E(n(a.value.token.logprob))+"%",1)]),a.value.token.topLogprobs&&a.value.token.topLogprobs.length>0?(k(),g("div",te,[t[2]||(t[2]=f("div",{class:"alternatives-header"},"Alternative tokens:",-1)),(k(!0),g(C,null,w(a.value.token.topLogprobs?.slice(0,5),(e,t)=>(k(),g("div",{key:t,class:"alternative-token"},[f("span",ae,'"'+E(e.token)+'"',1),f("span",se,E(n(e.logprob))+"%",1)]))),128))])):x("",!0),f("div",le," Raw logprob: "+E(a.value.token.logprob.toFixed(6)),1)],4)):x("",!0)]))}}),[["__scopeId","data-v-a0458886"]]),ne={class:"feature-content-renderer"},re={key:0,class:"reasoning-content"},ie={class:"reasoning-text"},de={key:1,class:"tool-calls-content"},ue={class:"tool-call-header"},ce={class:"tool-name"},pe={class:"tool-type"},me={class:"tool-call-arguments"},ve={key:2,class:"search-results-content"},ge={class:"search-result-title"},fe={class:"search-result-snippet"},ye={key:0,class:"search-result-url"},he=["href"],be={key:3,class:"images-content"},ke={class:"image-gallery"},xe=["src","alt","onClick"],_e={key:1,class:"image-caption"},Ce={key:4,class:"array-content"},we={key:0},$e={key:1},Ee={key:5,class:"object-content"},Fe={key:6,class:"text-content"},Le=n(p({__name:"FeatureContentRenderer",props:{featureName:{},content:{},config:{}},setup(e){function t(e){if(!e)return"";if("string"==typeof e)try{return JSON.stringify(JSON.parse(e),null,2)}catch{return e}return JSON.stringify(e,null,2)}return(e,a)=>(k(),g("div",ne,["reasoning"===e.featureName&&"string"==typeof e.content?(k(),g("div",re,[f("pre",ie,E(e.content),1)])):"tool_calls"===e.featureName&&Array.isArray(e.content)?(k(),g("div",de,[(k(!0),g(C,null,w(e.content,(e,a)=>(k(),g("div",{key:a,class:"tool-call-item"},[f("div",ue,[f("span",ce,E(e.name||e.function?.name||"Unknown Tool"),1),f("span",pe,E(e.type||"function"),1)]),f("div",me,[f("pre",null,E(t(e.arguments||e.function?.arguments)),1)])]))),128))])):"search_results"===e.featureName&&Array.isArray(e.content)?(k(),g("div",ve,[(k(!0),g(C,null,w(e.content,(e,t)=>(k(),g("div",{key:t,class:"search-result-item"},[f("div",ge,E(e.title||`Result ${t+1}`),1),f("div",fe,E(e.snippet||e.content),1),e.url?(k(),g("div",ye,[f("a",{href:e.url,target:"_blank",rel:"noopener"},E(e.url),9,he)])):x("",!0)]))),128))])):"images"===e.featureName&&Array.isArray(e.content)?(k(),g("div",be,[f("div",ke,[(k(!0),g(C,null,w(e.content,(e,t)=>(k(),g("div",{key:t,class:"image-item"},[e.url||e.image_url?(k(),g("img",{key:0,src:e.url||e.image_url,alt:e.alt||`Image ${t+1}`,onClick:e=>{}},null,8,xe)):x("",!0),e.caption?(k(),g("div",_e,E(e.caption),1)):x("",!0)]))),128))])])):Array.isArray(e.content)?(k(),g("div",Ce,[(k(!0),g(C,null,w(e.content,(e,a)=>(k(),g("div",{key:a,class:"array-item"},["object"==typeof e?(k(),g("div",we,[f("pre",null,E(t(e)),1)])):(k(),g("div",$e,E(e),1))]))),128))])):"object"==typeof e.content?(k(),g("div",Ee,[f("pre",null,E(t(e.content)),1)])):(k(),g("div",Fe,E(e.content),1))]))}}),[["__scopeId","data-v-44637274"]]),Me={key:0,class:"feature-display-container"},Ie={class:"feature-header"},je={key:0,class:"feature-icon"},Pe={class:"feature-label"},Ae={key:1,class:"feature-static"},Re={class:"feature-header"},Oe={key:0,class:"feature-icon"},ze={class:"feature-label"},Se=n(p({__name:"FeatureDisplay",props:{features:{},provider:{}},setup(e){const t=e,a=m(()=>t.provider&&s.getResponseFeatures(t.provider)||{});function l(e){return a.value[e]}function o(e){return e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}return(e,t)=>{const a=h("a-collapse-panel"),s=h("a-collapse");return e.features&&e.features.size>0?(k(),g("div",Me,[(k(!0),g(C,null,w(e.features,([e,t])=>(k(),g("div",{key:e,class:M(["feature-item",[`position-${l(e)?.displayConfig.position||"after-content"}`]])},[!1!==l(e)?.displayConfig.collapsible?(k(),_(s,{key:0,"default-active-key":l(e)?.displayConfig.defaultCollapsed?[]:[e],ghost:""},{default:b(()=>[(k(),_(a,{key:e},{header:b(()=>[f("div",Ie,[l(e)?.displayConfig.icon?(k(),g("span",je,E(l(e)?.displayConfig.icon),1)):x("",!0),f("span",Pe,E(l(e)?.displayConfig.label||o(e)),1)])]),default:b(()=>[f("div",{class:M(["feature-content",[`styling-${l(e)?.displayConfig.styling||"standard"}`]]),style:L({maxHeight:l(e)?.displayConfig.maxHeight||"none"})},[y(Le,{"feature-name":e,content:t,config:l(e)},null,8,["feature-name","content","config"])],6)]),_:2},1024))]),_:2},1032,["default-active-key"])):(k(),g("div",Ae,[f("div",Re,[l(e)?.displayConfig.icon?(k(),g("span",Oe,E(l(e)?.displayConfig.icon),1)):x("",!0),f("span",ze,E(l(e)?.displayConfig.label||o(e)),1)]),f("div",{class:M(["feature-content",[`styling-${l(e)?.displayConfig.styling||"standard"}`]]),style:L({maxHeight:l(e)?.displayConfig.maxHeight||"none"})},[y(Le,{"feature-name":e,content:t,config:l(e)},null,8,["feature-name","content","config"])],6)]))],2))),128))])):x("",!0)}}}),[["__scopeId","data-v-12f66427"]]),Te={class:"response-display"},De={key:0,class:"loading-state"},Ne={key:1,class:"error-state"},Ve={class:"error-details"},We={key:2,class:"response-content"},Ue={class:"metadata-content"},qe={class:"metadata-grid"},He={class:"metadata-item"},Be={class:"value"},Je={key:0,class:"metadata-item"},Ge={class:"value"},Ye={key:1,class:"metadata-item"},Ke={class:"value"},Xe={class:"cost-amount"},Qe={class:"cost-amount"},Ze={class:"cost-amount"},et={class:"metadata-item"},tt={class:"value env-costs"},at={class:"env-item"},st={class:"env-item"},lt={class:"env-item"},ot={class:"raw-response"},nt={class:"raw-response"},rt={key:3,class:"empty-state"},it=n(p({__name:"ResponseDisplay",props:{response:{},isLoading:{type:Boolean},error:{}},setup(e){const t=e,a=r(),l=u(300),o=u(!1),n=u(600),d=m(()=>!(!t.response?.features||!t.response.model)&&p("before-content").size>0),c=m(()=>!(!t.response?.features||!t.response.model)&&p("after-content").size>0);function p(e){if(!t.response?.features||!t.response.model)return new Map;const a=s.getResponseFeatures(t.response.model.provider);if(!a)return new Map;const l=new Map;for(const[s,o]of t.response.features){const t=a[s];t?.displayConfig.position===e&&l.set(s,o)}return l}function v(e){o.value=!0;const t=e.clientY,a=l.value;function s(e){const s=e.clientY-t,o=a+s,r=n.value-100-10;l.value=Math.max(100,Math.min(o,r))}document.addEventListener("mousemove",s),document.addEventListener("mouseup",function e(){o.value=!1,document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",e)})}function C(){const e=document.querySelector(".response-content");e&&(n.value=e.clientHeight,l.value=Math.min(300,.6*n.value))}function w(e){return e<1e-4?e.toFixed(6):e<.01?e.toFixed(4):e.toFixed(3)}function F(e){if(!e)return"No raw response data";try{return JSON.stringify(e,null,2)}catch{return String(e)}}function P(e){if(!e)return"No error details available";try{return JSON.stringify(e,null,2)}catch{return String(e)}}function A(e,s){if(!a.environmentalCostsEnabled)return"??";if(!t.response?.model)return"-";if(!i.hasDataForModel(t.response.model.provider,t.response.model.modelId))return"-";const l=s||0;if(0===l)return"-";const o=i.calculateEnvironmentalCostUnsafe(t.response.model.provider,t.response.model.modelId,l)[e];if(0===o)return"-";switch(e){case"carbon":return o<.001?"<1Î¼g":o<1?`${(1e3*o).toFixed(0)}Î¼g`:o<1e3?`${o.toFixed(1)}mg`:`${(o/1e3).toFixed(1)}g`;case"water":return o<.001?"<1nL":o<1?`${(1e3*o).toFixed(0)}nL`:o<1e3?`${o.toFixed(1)}Î¼L`:`${(o/1e3).toFixed(1)}mL`;case"energy":return o<.001?"<1Î¼Wh":o<1?`${(1e3*o).toFixed(0)}Î¼Wh`:o<1e3?`${o.toFixed(1)}mWh`:`${(o/1e3).toFixed(1)}Wh`;default:return"-"}}return I(()=>{C(),window.addEventListener("resize",C)}),j(()=>{window.removeEventListener("resize",C)}),(e,t)=>{const a=h("a-spin"),s=h("a-alert"),n=h("a-collapse-panel"),r=h("a-collapse");return k(),g("div",Te,[e.isLoading?(k(),g("div",De,[y(a,{size:"large"},{tip:b(()=>t[0]||(t[0]=[$("Generating response...")])),_:1})])):e.error?(k(),g("div",Ne,[y(s,{type:"error",message:e.error.message||"API Error",description:e.error.details,"show-icon":""},null,8,["message","description"]),e.error.response?(k(),_(r,{key:0,ghost:"",style:{"margin-top":"16px"}},{default:b(()=>[y(n,{key:"details",header:"Full API Request/Response"},{default:b(()=>[f("pre",Ve,E(P(e.error.response)),1)]),_:1})]),_:1})):x("",!0)])):e.response?(k(),g("div",We,[d.value?(k(),_(Se,{key:0,features:p("before-content"),provider:e.response.model?.provider,class:"features-before"},null,8,["features","provider"])):x("",!0),f("div",{class:"response-text",style:L({height:l.value+"px"})},[y(oe,{text:e.response.content,"logprobs-data":e.response.logprobs},null,8,["text","logprobs-data"])],4),c.value?(k(),_(Se,{key:1,features:p("after-content"),provider:e.response.model?.provider,class:"features-after"},null,8,["features","provider"])):x("",!0),f("div",{class:M(["response-divider",{dragging:o.value}]),onMousedown:v},t[1]||(t[1]=[f("div",{class:"divider-handle"},null,-1)]),34),f("div",{class:"response-metadata",style:L({height:`calc(100% - ${l.value}px - 10px)`})},[t[9]||(t[9]=f("h3",{class:"metadata-header"},"Response Details",-1)),f("div",Ue,[f("div",qe,[f("div",He,[t[2]||(t[2]=f("span",{class:"label"},"Latency:",-1)),f("span",Be,E(e.response.latency)+"ms",1)]),e.response.tokens?(k(),g("div",Je,[t[3]||(t[3]=f("span",{class:"label"},"Token Usage:",-1)),f("span",Ge,E(e.response.tokens.prompt_tokens||"?")+" input + "+E(e.response.tokens.completion_tokens||"?")+" output = "+E(e.response.tokens.total_tokens||"?")+" total tokens ",1)])):x("",!0),e.response.cost?(k(),g("div",Ye,[t[7]||(t[7]=f("span",{class:"label"},"Cost Estimate:",-1)),f("span",Ke,[f("span",Xe,"$"+E(w(e.response.cost.input)),1),t[4]||(t[4]=$(" input + ")),f("span",Qe,"$"+E(w(e.response.cost.output)),1),t[5]||(t[5]=$(" output = ")),f("span",Ze,"$"+E(w(e.response.cost.total)),1),t[6]||(t[6]=$(" total "))])])):x("",!0),f("div",et,[t[8]||(t[8]=f("span",{class:"label"},"Environmental:",-1)),f("span",tt,[f("span",at,"COâ‚‚ ðŸ­: "+E(A("carbon",e.response.tokens?.total_tokens))+"Â Â ",1),f("span",st,"Water ðŸ’§: "+E(A("water",e.response.tokens?.total_tokens))+"Â Â ",1),f("span",lt,"Energy âš¡: "+E(A("energy",e.response.tokens?.total_tokens)),1)])])]),y(r,{ghost:"",style:{"margin-top":"16px"}},{default:b(()=>[y(n,{key:"raw",header:"Raw API Response"},{default:b(()=>[f("pre",ot,E(F(e.response.raw)),1)]),_:1})]),_:1}),e.response.debug?(k(),_(r,{key:0,ghost:"",style:{"margin-top":"8px"}},{default:b(()=>[y(n,{key:"debug",header:"API Request Details"},{default:b(()=>[f("pre",nt,E(F(e.response.debug)),1)]),_:1})]),_:1})):x("",!0)])],4)])):(k(),g("div",rt,t[10]||(t[10]=[f("div",{class:"empty-content"},[f("div",{class:"empty-icon"},"ðŸ’¬"),f("p",null,"Response will appear here after running a prompt")],-1)])))])}}}),[["__scopeId","data-v-cb42b946"]]),dt={class:"playground-view","data-testid":"page-playground"},ut={class:"page-header"},ct={class:"header-actions"},pt={key:0,class:"cost-estimate"},mt={class:"cost-tooltip"},vt={class:"playground-content"},gt={class:"left-panel"},ft={class:"panel-section"},yt={key:0,class:"model-info"},ht={class:"info-header"},bt={class:"model-name"},kt={class:"provider-badge"},xt={key:0,class:"info-details"},_t={class:"detail-item"},Ct={class:"value"},wt={class:"detail-item"},$t={class:"value"},Et={class:"dollar-amount"},Ft={class:"detail-item"},Lt={class:"value"},Mt={class:"dollar-amount"},It={class:"detail-item"},jt={class:"value"},Pt={class:"detail-item"},At={class:"value"},Rt={class:"detail-item"},Ot={class:"value"},zt={class:"panel-section"},St={class:"action-buttons"},Tt={key:0,class:"panel-section"},Dt={class:"template-buttons"},Nt={class:"center-panel"},Vt={class:"prompt-section"},Wt={class:"section-header"},Ut={class:"character-count"},qt={key:0,class:"response-section"},Ht={class:"section-header"},Bt={key:0,class:"response-meta"},Jt={class:"response-container"},Gt={key:0,class:"right-panel"},Yt={class:"design-list"},Kt=["onClick"],Xt={class:"design-name"},Qt={class:"design-description"},Zt={class:"design-preview"},ea=n(p({__name:"PlaygroundView",setup(n){const p=e(),v=t(),_=r(),F=u(null),L=u(""),M=u({}),j=u(!1),S=u(!1),T=u(!1),{isExecuting:D,lastResponse:N,lastError:V,executePrompt:W}=function(){const e=u(!1),t=u(null),a=u(null),n=c([]);return{isExecuting:e,lastResponse:t,lastError:a,executionHistory:n,executePrompt:async function(r){if(e.value)throw new Error("Execution already in progress");e.value=!0,t.value=null,a.value=null;const i={timestamp:new Date,model:`${r.model.provider}:${r.model.modelId}`,prompt:r.prompt,parameters:{...r.parameters}};let d;try{const e={id:`${r.model.provider}:${r.model.modelId}`,name:r.model.displayName,provider:r.model.provider,model:r.model.modelId,params:r.parameters,created_at:new Date},a=s.getResponseModes(r.model.provider),n=a.text||Object.values(a)[0],u=r.getApiKey(r.model.provider),c=r.getBaseUrl(r.model.provider);d=l.buildAPIRequest(e,r.prompt,u,c,n);const p=Date.now(),m=await fetch(d.url,{method:d.method,headers:d.headers,body:JSON.stringify(d.body)}),v=Date.now()-p,g=await m.text();let f;try{f=JSON.parse(g)}catch{f=g}if(!m.ok){const e=l.extractErrorMessage(f),t={request:{url:d.url,method:d.method,headers:z(d.headers),body:d.body},response:{status:m.status,statusText:m.statusText,headers:Object.fromEntries(m.headers.entries()),body:f}},a=new Error(`API error (${m.status}): ${e}`);throw a.fullResponse=t,a}if(l.isErrorResponse(f)){const e=l.extractErrorMessage(f),t={request:{url:d.url,method:d.method,headers:z(d.headers),body:d.body},response:{status:m.status,statusText:m.statusText,headers:Object.fromEntries(m.headers.entries()),body:f}},a=new Error(`Provider error: ${e}`);throw a.fullResponse=t,a}const y=l.extractResponseContent(r.model.provider,f),h=l.extractUsageInfo(r.model.provider,f);let b;const k=s.getLogprobsResponsePath(r.model.provider);if(k){const e=function(e,t){if(!e||!t)return;const a=t.replace(/\[(\d+)\]/g,".$1").split(".");let s=e;for(const l of a){if(null==s)return;s=s[l]}return s}(f,k);Array.isArray(e)&&(b=e.map(e=>({token:e.token,logprob:e.logprob,bytes:e.bytes,top_logprobs:e.top_logprobs})))}const x=l.extractResponseFeatures(r.model.provider,f,r.parameters);let _;if(r.model.capabilities&&h.prompt_tokens&&h.completion_tokens){const e=(r.model.capabilities.inputCostPerToken||0)*h.prompt_tokens,t=(r.model.capabilities.outputCostPerToken||0)*h.completion_tokens;_={input:e,output:t,total:e+t}}const C={content:y||"",latency:v,tokens:h,cost:_,logprobs:b,features:x,raw:f,debug:{request:{url:d.url,method:d.method,headers:z(d.headers),body:d.body},response:{status:m.status,statusText:m.statusText,headers:Object.fromEntries(m.headers.entries())}},model:r.model};t.value=C,i.response=C,o.info("Playground execution successful",{model:r.model.modelId,latency:v,tokens:h.total_tokens})}catch(u){const e={message:u instanceof Error?u.message:String(u),details:u instanceof Error?u.stack:void 0,response:u.fullResponse||{request:{url:d?.url||"unknown",method:d?.method||"unknown",headers:z(d?.headers||{}),body:d?.body||"unknown"},response:{status:"unknown",statusText:"Network or parsing error",headers:{},body:u instanceof Error?u.message:String(u)}}};a.value=e,i.error=e,o.error("Playground execution failed",{model:r.model.modelId,error:e.message,fullResponse:u.fullResponse})}finally{e.value=!1,n.unshift(i),n.length>10&&n.pop()}},clearResults:function(){t.value=null,a.value=null},clearHistory:function(){n.splice(0,n.length)}}}(),U=[{name:"Creative",prompt:"Write a creative short story about:"},{name:"Analysis",prompt:"Analyze the following text and provide insights:"},{name:"Explain",prompt:"Explain this concept in simple terms:"},{name:"Summarize",prompt:"Summarize the following content:"}],q=m(()=>F.value&&L.value.trim().length>0&&!D.value),H=m(()=>L.value?Math.ceil(L.value.length/4):0),J=m(()=>F.value?a.getOutputTokenLimit(F.value.provider,F.value.modelId,M.value):256);function G(e){M.value={...e}}function Y(){j.value=!0}function K(){L.value=""}function X(e){F.value=e,S.value=!1,M.value={}}function Q(e){return e<.01?e.toFixed(4):e<1?e.toFixed(3):e.toFixed(2)}function Z(e){if(!F.value||!_.environmentalCostsEnabled)return"??";if(!i.hasDataForModel(F.value.provider,F.value.modelId))return"-";const t=i.calculateEnvironmentalCostUnsafe(F.value.provider,F.value.modelId,1e3)[e];if(0===t)return"-";switch(e){case"carbon":return t<.001?"<1Î¼g":t<1?`${(1e3*t).toFixed(0)}Î¼g`:t<1e3?`${t.toFixed(1)}mg`:`${(t/1e3).toFixed(1)}g`;case"water":return t<.001?"<1nL":t<1?`${(1e3*t).toFixed(0)}nL`:t<1e3?`${t.toFixed(1)}Î¼L`:`${(t/1e3).toFixed(1)}mL`;case"energy":return t<.001?"<1Î¼Wh":t<1?`${(1e3*t).toFixed(0)}Î¼Wh`:t<1e3?`${t.toFixed(1)}mWh`:`${(t/1e3).toFixed(1)}Wh`;default:return"-"}}async function ee(){q.value&&F.value&&(T.value=!0,await W({model:F.value,prompt:L.value,parameters:M.value,getApiKey:e=>_.getApiKey(e),getBaseUrl:e=>_.getBaseUrl(e)}))}return I(async()=>{p.enabledModels.length>0&&(F.value=p.enabledModels[0])}),(e,t)=>{const a=h("a-tooltip"),s=h("a-button"),l=h("a-modal");return k(),g("div",dt,[f("div",ut,[t[8]||(t[8]=f("div",{class:"header-content"},[f("h1",null,"LLM Playground"),f("p",{class:"description"},"Test prompts and explore model responses interactively")],-1)),f("div",ct,[F.value&&L.value?(k(),g("div",pt,[y(a,{placement:"bottom"},{title:b(()=>[f("div",mt,[t[5]||(t[5]=f("div",null,"Cost estimate based on:",-1)),f("div",null,"â€¢ Input: "+E(H.value)+" tokens",1),f("div",null,"â€¢ Output: 10 - "+E(J.value)+" tokens",1),t[6]||(t[6]=f("div",null,"â€¢ Min assumes 10 token response",-1)),t[7]||(t[7]=f("div",null,"â€¢ Max assumes full response limit",-1))])]),default:b(()=>[y(P(d),{class:"info-icon"})]),_:1}),y(R,{model:F.value,mode:"range","input-tokens":H.value,"min-output-tokens":10,"max-output-tokens":J.value,layout:"inline",size:"medium"},null,8,["model","input-tokens","max-output-tokens"])])):x("",!0),y(s,{type:"primary",onClick:ee,disabled:!q.value,loading:P(D)},{default:b(()=>[$(E(P(D)?"Running...":"Run"),1)]),_:1},8,["disabled","loading"])])]),f("div",vt,[f("div",gt,[f("div",ft,[t[18]||(t[18]=f("h3",null,"Select Model",-1)),y(s,{type:"primary",size:"large",style:{width:"100%"},onClick:t[0]||(t[0]=e=>S.value=!0)},{default:b(()=>t[9]||(t[9]=[$(" Select Model ")])),_:1,__:[9]}),F.value?(k(),g("div",yt,[f("div",ht,[f("span",bt,E(F.value.displayName),1),f("span",kt,E(F.value.provider),1)]),F.value.capabilities?(k(),g("div",xt,[f("div",_t,[t[10]||(t[10]=f("span",{class:"label"},"Context:",-1)),f("span",Ct,E((o=F.value.capabilities.contextWindow,o?o>=1e6?(o/1e6).toFixed(1)+"M":o>=1e3?(o/1e3).toFixed(0)+"k":o.toString():"N/A"))+" tokens",1)]),f("div",wt,[t[12]||(t[12]=f("span",{class:"label"},"Input:",-1)),f("span",$t,[f("span",Et,"$"+E(Q(1e3*(F.value.capabilities.inputCostPerToken||0))),1),t[11]||(t[11]=$("/1k"))])]),f("div",Ft,[t[14]||(t[14]=f("span",{class:"label"},"Output:",-1)),f("span",Lt,[f("span",Mt,"$"+E(Q(1e3*(F.value.capabilities.outputCostPerToken||0))),1),t[13]||(t[13]=$("/1k"))])]),f("div",It,[t[15]||(t[15]=f("span",{class:"label"},"COâ‚‚: ðŸ­",-1)),f("span",jt,E(Z("carbon")),1)]),f("div",Pt,[t[16]||(t[16]=f("span",{class:"label"},"Water: ðŸ’§",-1)),f("span",At,E(Z("water")),1)]),f("div",Rt,[t[17]||(t[17]=f("span",{class:"label"},"Energy: âš¡",-1)),f("span",Ot,E(Z("energy")),1)])])):x("",!0)])):x("",!0)]),f("div",zt,[t[21]||(t[21]=f("h3",null,"Actions",-1)),f("div",St,[y(s,{type:"default",onClick:Y,disabled:!P(v).designs.length,block:""},{default:b(()=>t[19]||(t[19]=[$(" Load from Design ")])),_:1,__:[19]},8,["disabled"]),y(s,{type:"default",onClick:K,disabled:!L.value,block:""},{default:b(()=>t[20]||(t[20]=[$(" Clear Prompt ")])),_:1,__:[20]},8,["disabled"])])]),F.value?(k(),g("div",Tt,[t[22]||(t[22]=f("h3",null,"Quick Templates",-1)),f("div",Dt,[(k(),g(C,null,w(U,e=>y(s,{key:e.name,size:"small",onClick:t=>function(e){L.value=e}(e.prompt)},{default:b(()=>[$(E(e.name),1)]),_:2},1032,["onClick"])),64))])])):x("",!0)]),f("div",Nt,[f("div",Vt,[f("div",Wt,[t[23]||(t[23]=f("h3",null,"Prompt",-1)),f("span",Ut,E(L.value.length)+" characters",1)]),y(A,{modelValue:L.value,"onUpdate:modelValue":t[1]||(t[1]=e=>L.value=e),rows:6,placeholder:"Enter your prompt here...","data-testid":"playground-prompt-editor"},null,8,["modelValue"])]),T.value?(k(),g("div",qt,[f("div",Ht,[t[24]||(t[24]=f("h3",null,"Response",-1)),P(N)?(k(),g("div",Bt,[f("span",null,E(P(N).latency)+"ms",1),f("span",null,E(P(N).tokens?.total_tokens||"?")+" tokens",1)])):x("",!0)]),f("div",Jt,[y(it,{response:P(N),"is-loading":P(D),error:P(V)},null,8,["response","is-loading","error"])])])):x("",!0)]),F.value?(k(),g("div",Gt,[y(B,{model:F.value,modelValue:M.value,"onUpdate:modelValue":t[2]||(t[2]=e=>M.value=e),onChange:G},null,8,["model","modelValue"])])):x("",!0)]),y(l,{open:j.value,"onUpdate:open":t[3]||(t[3]=e=>j.value=e),title:"Load from Design",width:"800px",footer:null},{default:b(()=>[f("div",Yt,[(k(!0),g(C,null,w(P(v).designs,e=>(k(),g("div",{key:e.id,class:"design-item",onClick:t=>function(e){L.value=e.promptTemplate,j.value=!1}(e)},[f("div",Xt,E(e.name),1),f("div",Qt,E(e.description||"No description"),1),f("div",Zt,E(e.promptTemplate.substring(0,100))+"...",1)],8,Kt))),128))])]),_:1},8,["open"]),y(O,{open:S.value,mode:"playground",title:"Select Model",onClose:t[4]||(t[4]=e=>S.value=!1),onSelectModel:X},null,8,["open"])]);var o}}}),[["__scopeId","data-v-038b5eec"]]);export{ea as default};
