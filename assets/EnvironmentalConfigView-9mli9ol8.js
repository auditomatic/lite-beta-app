import{d as e,f as a,c as o,o as l,w as t,a6 as n,_ as s,a1 as i,F as r,a8 as d,aa as c,a0 as u,q as v,ad as m,ah as p,B as f,Y as b}from"./vendor-AtAbR8ZE.js";import{l as C,x as g,_ as k}from"./index-B_4MOQZM.js";import"./db-CL8uhZCz.js";const y={class:"environmental-config-view","data-testid":"page-environmental-config",role:"main"},h={class:"config-content"},w={class:"config-layout"},P={class:"provider-panel"},T={class:"panel-header"},_={key:0,class:"loading-state"},x={key:1,class:"provider-list"},S=["onClick","data-testid","data-provider","aria-label"],E={class:"provider-info"},F={class:"provider-name"},U={class:"provider-meta"},I={class:"model-panel"},L={class:"panel-header"},O={key:0,class:"model-list"},W={class:"model-info"},A={class:"model-costs"},M={class:"cost-item"},j={class:"cost-item"},V={class:"cost-item"},D=["onClick","data-testid","data-model","aria-label"],$={class:"model-info"},N={class:"model-name"},H={class:"model-costs"},R={class:"cost-item"},B={class:"cost-item"},q={class:"cost-item"},z={key:1,class:"empty-state"},J={class:"config-panel"},Y={class:"panel-header"},G={class:"config-actions"},K=["disabled"],Q={key:0,class:"config-form"},X={class:"form-section"},Z={key:0,class:"defaults-description"},ee={class:"form-group"},ae={class:"form-group"},oe={class:"form-group"},le={class:"form-group"},te={class:"form-group"},ne={class:"form-group"},se={class:"form-section"},ie={class:"preview-grid"},re={class:"preview-item"},de={class:"preview-costs"},ce={class:"preview-item"},ue={class:"preview-costs"},ve={key:0,class:"validation-errors"},me={key:1,class:"empty-state"},pe={key:2,class:"empty-state"},fe={class:"form-group"},be={class:"modal-actions"},Ce={class:"form-group"},ge={class:"modal-actions"},ke=k(e({__name:"EnvironmentalConfigView",setup(e){const k=a([]),ke=a(!0),ye=a(null),he=a(null),we=a({carbonCostPerToken:0,waterCostPerToken:0,energyCostPerToken:0,confidence:"medium"}),Pe=a(null),Te=a(!1),_e=a(!1),xe=a(!1),Se=a(""),Ee=a(""),Fe=o(()=>{const e=[];return we.value.carbonCostPerToken<0&&e.push("Carbon cost cannot be negative"),we.value.waterCostPerToken<0&&e.push("Water cost cannot be negative"),we.value.energyCostPerToken<0&&e.push("Energy cost cannot be negative"),we.value.carbonCostPerToken>.01&&e.push("Carbon cost seems very high (>0.01g per token)"),we.value.waterCostPerToken>.1&&e.push("Water cost seems very high (>0.1mL per token)"),we.value.energyCostPerToken>.01&&e.push("Energy cost seems very high (>0.01Wh per token)"),e});function Ue(e){ye.value=e,he.value=null,Te.value=!1}function Ie(e){if(ye.value){if(he.value=e,"__defaults__"===e)ye.value.defaultCosts&&(we.value={...ye.value.defaultCosts,confidence:"low",source:"Provider fallback defaults"},Pe.value={...we.value});else{const a=ye.value.models[e];we.value={...a},Pe.value={...a}}Te.value=!1}}function Le(){Te.value=!0}function Oe(){ye.value&&he.value&&("__defaults__"===he.value?(ye.value.defaultCosts={carbonCostPerToken:we.value.carbonCostPerToken,waterCostPerToken:we.value.waterCostPerToken,energyCostPerToken:we.value.energyCostPerToken},C.info("Provider defaults saved",{provider:ye.value.provider,defaults:ye.value.defaultCosts})):(ye.value.models[he.value]={...we.value},C.info("Model configuration saved",{provider:ye.value.provider,model:he.value,config:we.value})),Pe.value={...we.value},Te.value=!1)}function We(){const e={providers:k.value,exportedAt:(new Date).toISOString(),format:"auditomatic-environmental-config-v1"},a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download="environmental-config.json",l.click(),URL.revokeObjectURL(o)}function Ae(){if(!Se.value.trim())return;const e={provider:Se.value.trim(),providers:[Se.value.trim()],infrastructure:{pue:1.2,carbonIntensity:.4,waterUsage:3,region:"unknown"},models:{},metadata:{lastUpdated:(new Date).toISOString().split("T")[0],dataSource:"Manual configuration",confidence:"low"}};k.value.push(e),Se.value="",_e.value=!1}function Me(){if(!ye.value||!Ee.value.trim())return;ye.value.models[Ee.value.trim()]={carbonCostPerToken:5e-4,waterCostPerToken:.004,energyCostPerToken:.0015,confidence:"low",source:"Manual configuration"},Ee.value="",xe.value=!1}return l(()=>{!async function(){try{ke.value=!0,await g.initialize();const a=["openai","anthropic","openrouter","xai"],o=[];for(const l of a)try{const e=await fetch(`/config/providers/environment/${l}.json`);if(e.ok){const a=await e.json();o.push(a)}}catch(e){C.warn("Failed to load provider config",{error:e,providerName:l})}k.value=o,k.value.length>0&&Ue(k.value[0])}catch(e){C.error("Failed to load environmental data",e)}finally{ke.value=!1}}()}),t(Te,e=>{e&&C.info("Unsaved changes detected")}),(e,a)=>(b(),n("div",y,[a[37]||(a[37]=s("div",{class:"config-header"},[s("h1",{class:"page-title"},"Environmental Cost Configuration"),s("p",{class:"page-description"}," Manage per-token environmental costs (carbon, water, energy) for AI models. Configure provider settings and model-specific environmental data. ")],-1)),s("div",h,[s("div",w,[s("div",P,[s("div",T,[a[17]||(a[17]=s("h3",null,"Providers",-1)),s("button",{class:"add-button",onClick:a[0]||(a[0]=e=>_e.value=!0),"data-testid":"btn-add-provider","aria-label":"Add new environmental provider"}," + Add Provider ")]),ke.value?(b(),n("div",_," Loading environmental data... ")):(b(),n("div",x,[(b(!0),n(r,null,d(k.value,e=>(b(),n("div",{key:e.provider,class:c(["provider-item",{active:ye.value?.provider===e.provider}]),onClick:a=>Ue(e),"data-testid":`provider-item-${e.provider}`,"data-provider":e.provider,"aria-label":`Select ${e.provider} provider`,role:"button",tabindex:"0"},[s("div",E,[s("div",F,u(e.provider),1),s("div",U,u(Object.keys(e.models).length)+" models",1)]),s("div",{class:c(["provider-confidence",`confidence-${e.metadata.confidence}`])},u(e.metadata.confidence),3)],10,S))),128))]))]),s("div",I,[s("div",L,[a[18]||(a[18]=s("h3",null,"Models",-1)),ye.value?(b(),n("button",{key:0,class:"add-button",onClick:a[1]||(a[1]=e=>xe.value=!0),"data-testid":"btn-add-model","aria-label":"Add new model to provider"}," + Add Model ")):i("",!0)]),ye.value?(b(),n("div",O,[ye.value.defaultCosts?(b(),n("div",{key:0,class:c(["model-item default-item",{active:"__defaults__"===he.value}]),onClick:a[2]||(a[2]=e=>Ie("__defaults__"))},[s("div",W,[a[19]||(a[19]=s("div",{class:"model-name"},"ðŸ”§ Provider Defaults",-1)),s("div",A,[s("span",M,"C: "+u((1e3*ye.value.defaultCosts.carbonCostPerToken).toFixed(1))+"mg",1),s("span",j,"W: "+u(ye.value.defaultCosts.waterCostPerToken.toFixed(1))+"mL",1),s("span",V,"E: "+u((1e3*ye.value.defaultCosts.energyCostPerToken).toFixed(1))+"mWh",1)])]),a[20]||(a[20]=s("div",{class:"model-confidence confidence-low"}," fallback ",-1))],2)):i("",!0),(b(!0),n(r,null,d(ye.value.models,(e,a)=>(b(),n("div",{key:a,class:c(["model-item",{active:he.value===a}]),onClick:e=>Ie(a),"data-testid":`model-item-${a}`,"data-model":a,"aria-label":`Select ${a} model`,role:"button",tabindex:"0"},[s("div",$,[s("div",N,u(a),1),s("div",H,[s("span",R,"C: "+u((1e3*e.carbonCostPerToken).toFixed(1))+"mg",1),s("span",B,"W: "+u(e.waterCostPerToken.toFixed(1))+"mL",1),s("span",q,"E: "+u((1e3*e.energyCostPerToken).toFixed(1))+"mWh",1)])]),s("div",{class:c(["model-confidence",`confidence-${e.confidence}`])},u(e.confidence),3)],10,D))),128))])):(b(),n("div",z," Select a provider to view models "))]),s("div",J,[s("div",Y,[a[21]||(a[21]=s("h3",null,"Configuration",-1)),s("div",G,[ye.value&&he.value?(b(),n("button",{key:0,class:"save-button",disabled:!Te.value,onClick:Oe,"data-testid":"btn-save-environmental-config","aria-label":"Save environmental configuration changes"}," Save Changes ",8,K)):i("",!0),s("button",{class:"export-button",onClick:We,"data-testid":"btn-export-config","aria-label":"Export environmental configuration"}," Export Config ")])]),ye.value&&he.value?(b(),n("div",Q,[s("div",X,[s("h4",null,u("__defaults__"===he.value?"Provider Default Costs":"Model Environmental Costs"),1),"__defaults__"===he.value?(b(),n("p",Z," These costs are used as fallbacks when specific model data is not available. ")):i("",!0),s("div",ee,[a[22]||(a[22]=s("label",null,"Carbon Cost per Token (grams COâ‚‚e)",-1)),v(s("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>we.value.carbonCostPerToken=e),type:"number",step:"0.00001",class:"form-input",onInput:Le,"data-testid":"input-carbon-cost","aria-label":"Carbon cost per token in grams CO2e"},null,544),[[m,we.value.carbonCostPerToken,void 0,{number:!0}]])]),s("div",ae,[a[23]||(a[23]=s("label",null,"Water Cost per Token (mL)",-1)),v(s("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>we.value.waterCostPerToken=e),type:"number",step:"0.0001",class:"form-input",onInput:Le,"data-testid":"input-water-cost","aria-label":"Water cost per token in milliliters"},null,544),[[m,we.value.waterCostPerToken,void 0,{number:!0}]])]),s("div",oe,[a[24]||(a[24]=s("label",null,"Energy Cost per Token (Wh)",-1)),v(s("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>we.value.energyCostPerToken=e),type:"number",step:"0.00001",class:"form-input",onInput:Le,"data-testid":"input-energy-cost","aria-label":"Energy cost per token in watt-hours"},null,544),[[m,we.value.energyCostPerToken,void 0,{number:!0}]])]),s("div",le,[a[26]||(a[26]=s("label",null,"Confidence Level",-1)),v(s("select",{"onUpdate:modelValue":a[6]||(a[6]=e=>we.value.confidence=e),class:"form-select",onChange:Le,"data-testid":"select-confidence-level","aria-label":"Select confidence level for environmental data"},a[25]||(a[25]=[s("option",{value:"high"},"High",-1),s("option",{value:"medium"},"Medium",-1),s("option",{value:"low"},"Low",-1)]),544),[[p,we.value.confidence]])]),s("div",te,[a[27]||(a[27]=s("label",null,"Data Source",-1)),v(s("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>we.value.source=e),type:"text",class:"form-input",placeholder:"e.g., How Hungry is AI? 2025 Study",onInput:Le},null,544),[[m,we.value.source]])]),s("div",ne,[a[28]||(a[28]=s("label",null,"Notes",-1)),v(s("textarea",{"onUpdate:modelValue":a[8]||(a[8]=e=>we.value.notes=e),class:"form-textarea",rows:"3",onInput:Le},null,544),[[m,we.value.notes]])])]),s("div",se,[a[31]||(a[31]=s("h4",null,"Cost Preview",-1)),s("div",ie,[s("div",re,[a[29]||(a[29]=s("label",null,"1,000 tokens",-1)),s("div",de,[s("div",null,u((1e3*we.value.carbonCostPerToken).toFixed(3))+"g COâ‚‚e",1),s("div",null,u((1e3*we.value.waterCostPerToken).toFixed(1))+"mL Hâ‚‚O",1),s("div",null,u((1e3*we.value.energyCostPerToken).toFixed(3))+"Wh",1)])]),s("div",ce,[a[30]||(a[30]=s("label",null,"10,000 tokens",-1)),s("div",ue,[s("div",null,u((1e4*we.value.carbonCostPerToken).toFixed(2))+"g COâ‚‚e",1),s("div",null,u((1e4*we.value.waterCostPerToken).toFixed(0))+"mL Hâ‚‚O",1),s("div",null,u((1e4*we.value.energyCostPerToken).toFixed(2))+"Wh",1)])])])]),Fe.value.length>0?(b(),n("div",ve,[a[32]||(a[32]=s("h4",null,"Validation Errors",-1)),s("ul",null,[(b(!0),n(r,null,d(Fe.value,e=>(b(),n("li",{key:e,class:"error-item"},u(e),1))),128))])])):i("",!0)])):ye.value?(b(),n("div",me," Select a model to configure environmental costs ")):(b(),n("div",pe," Select a provider and model to configure environmental costs "))])])]),_e.value?(b(),n("div",{key:0,class:"modal-overlay",onClick:a[12]||(a[12]=e=>_e.value=!1)},[s("div",{class:"modal-content",onClick:a[11]||(a[11]=f(()=>{},["stop"]))},[a[34]||(a[34]=s("h3",null,"Add New Provider",-1)),s("div",fe,[a[33]||(a[33]=s("label",null,"Provider Name",-1)),v(s("input",{"onUpdate:modelValue":a[9]||(a[9]=e=>Se.value=e),type:"text",class:"form-input","data-testid":"input-new-provider-name","aria-label":"Enter new provider name"},null,512),[[m,Se.value]])]),s("div",be,[s("button",{onClick:Ae,class:"save-button","data-testid":"btn-confirm-add-provider","aria-label":"Confirm add provider"},"Add Provider"),s("button",{onClick:a[10]||(a[10]=e=>_e.value=!1),class:"cancel-button","data-testid":"btn-cancel-add-provider","aria-label":"Cancel add provider"},"Cancel")])])])):i("",!0),xe.value?(b(),n("div",{key:1,class:"modal-overlay",onClick:a[16]||(a[16]=e=>xe.value=!1)},[s("div",{class:"modal-content",onClick:a[15]||(a[15]=f(()=>{},["stop"]))},[a[36]||(a[36]=s("h3",null,"Add New Model",-1)),s("div",Ce,[a[35]||(a[35]=s("label",null,"Model ID",-1)),v(s("input",{"onUpdate:modelValue":a[13]||(a[13]=e=>Ee.value=e),type:"text",class:"form-input","data-testid":"input-new-model-id","aria-label":"Enter new model ID"},null,512),[[m,Ee.value]])]),s("div",ge,[s("button",{onClick:Me,class:"save-button","data-testid":"btn-confirm-add-model","aria-label":"Confirm add model"},"Add Model"),s("button",{onClick:a[14]||(a[14]=e=>xe.value=!1),class:"cancel-button","data-testid":"btn-cancel-add-model","aria-label":"Cancel add model"},"Cancel")])])])):i("",!0)]))}}),[["__scopeId","data-v-f7c98918"]]);export{ke as default};
