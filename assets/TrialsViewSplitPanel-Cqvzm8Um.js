var e=Object.defineProperty,t=(t,a,l)=>((t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l)(t,"symbol"!=typeof a?a+"":a,l);import{k as a,S as l,f as n,c as r,W as s,V as i,d as o,w as c,o as u,b as d,aa as p,a0 as m,$ as f,X as v,u as g,Y as h,_ as y,F as b,ab as w,Z as _,G as k,a3 as x,a2 as C,af as S,M as T,N as I,H as O,aj as E,ai as P,ak as $,al as M,B as R,g as N,s as F,h as A,a6 as D,q as j,A as L,ae as U,am as z,ag as q,an as V,r as H,ah as B,ad as W,a1 as G}from"./vendor-B8IWC-3k.js";import{I as K,c as J,i as Y,h as Q,l as X,V as Z,O as ee,R as te,W as ae,_ as le,X as ne,Y as re,Z as se,k as ie,n as oe,$ as ce,G as ue,q as de,a0 as pe,m as me,a1 as fe,S as ve,N as ge,a2 as he,F as ye,a3 as be,p as we,g as _e,e as ke,D as xe,C as Ce,z as Se,a4 as Te,E as Ie,A as Oe,a5 as Ee}from"./index-C6frMIbt.js";import{F as Pe}from"./FilterOutlined-Dq23FTEt.js";import{D as $e,C as Me}from"./DollarOutlined-BRPJ2-CY.js";import{F as Re,T as Ne}from"./TrialCreationModalNew-Dy1qtcIc.js";import{r as Fe,C as Ae}from"./api-key-redactor-DmVO6vBk.js";import{l as De}from"./db-CL8uhZCz.js";import{_ as je}from"./BaseModal.vue_vue_type_style_index_0_lang-Ba6DaieS.js";import"./useEnvironmentalCost-D5DspU9W.js";import"./token-calculation.service-CRZmWNbv.js";import"./variable.service-_lbnscns.js";import"./cost-formatting-Bv_drrqY.js";import"./GenericModelSelectorModal-E71KLBpB.js";import"./ModelCostDisplay-BBgVSnoX.js";var Le={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"};function Ue(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){ze(e,t,a[t])})}return e}function ze(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var qe=function(e,t){var l=Ue({},e,t.attrs);return a(K,Ue({},l,{icon:Le}),null)};qe.displayName="ExportOutlined",qe.inheritAttrs=!1;var Ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"}},{tag:"path",attrs:{d:"M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"}}]},name:"field-time",theme:"outlined"};function He(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){Be(e,t,a[t])})}return e}function Be(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var We=function(e,t){var l=He({},e,t.attrs);return a(K,He({},l,{icon:Ve}),null)};We.displayName="FieldTimeOutlined",We.inheritAttrs=!1;var Ge={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function Ke(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){Je(e,t,a[t])})}return e}function Je(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ye=function(e,t){var l=Ke({},e,t.attrs);return a(K,Ke({},l,{icon:Ge}),null)};Ye.displayName="InboxOutlined",Ye.inheritAttrs=!1;var Qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};function Xe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){Ze(e,t,a[t])})}return e}function Ze(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var et=function(e,t){var l=Xe({},e,t.attrs);return a(K,Xe({},l,{icon:Qe}),null)};et.displayName="PauseCircleOutlined",et.inheritAttrs=!1;var tt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"};function at(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){lt(e,t,a[t])})}return e}function lt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var nt=function(e,t){var l=at({},e,t.attrs);return a(K,at({},l,{icon:tt}),null)};nt.displayName="RobotOutlined",nt.inheritAttrs=!1;var rt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};function st(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){it(e,t,a[t])})}return e}function it(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ot=function(e,t){var l=st({},e,t.attrs);return a(K,st({},l,{icon:rt}),null)};ot.displayName="StopOutlined",ot.inheritAttrs=!1;var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M848 359.3H627.7L825.8 109c4.1-5.3.4-13-6.3-13H436c-2.8 0-5.5 1.5-6.9 4L170 547.5c-3.1 5.3.7 12 6.9 12h174.4l-89.4 357.6c-1.9 7.8 7.5 13.3 13.3 7.7L853.5 373c5.2-4.9 1.7-13.7-5.5-13.7zM378.2 732.5l60.3-241H281.1l189.6-327.4h224.6L487 427.4h211L378.2 732.5z"}}]},name:"thunderbolt",theme:"outlined"};function ut(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){dt(e,t,a[t])})}return e}function dt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var pt=function(e,t){var l=ut({},e,t.attrs);return a(K,ut({},l,{icon:ct}),null)};pt.displayName="ThunderboltOutlined",pt.inheritAttrs=!1;const mt="auditomatic.trial-split-view",ft=l("trial-split-view",()=>{const e=s(),t=i(),a=J(),l=n(null),o=n("medium"),c=n(""),u=n("all"),d=n(-1),p=r(()=>l.value&&a.trials.find(e=>e.id===l.value)||null),m=r(()=>{switch(o.value){case"wide":return 400;case"medium":return 250;case"collapsed":return 100}}),f=r(()=>"collapsed"===o.value),v=r(()=>{let e=a.trials;if("all"!==u.value&&(e=e.filter(e=>e.status===u.value)),c.value){const t=c.value.toLowerCase();e=e.filter(e=>!!e.name.toLowerCase().includes(t)||(!(!Y(e)||!e.templateName.toLowerCase().includes(t))||!(!Q(e)||!e.datasetName.toLowerCase().includes(t))))}return[...e].sort((e,t)=>{const a=e.completed||e.started||e.created;return(t.completed||t.started||t.created).getTime()-a.getTime()})}),g=r(()=>({running:v.value.filter(e=>"running"===e.status),recent:v.value.filter(e=>"running"!==e.status)})),h=r(()=>v.value.length),y=r(()=>{const e={all:a.trials.length,running:0,completed:0,failed:0,draft:0,paused:0};return a.trials.forEach(t=>{const a=t.status;a in e&&e[a]++}),e});function b(t){l.value=t,d.value=-1,t?e.push({name:"trials",params:{trialId:t}}):e.push({name:"trials"}),X.debug("Trial selected",{trialId:t})}function w(){try{const e={panelMode:o.value,statusFilter:u.value,searchQuery:c.value};localStorage.setItem(`${mt}.preferences`,JSON.stringify(e))}catch(e){X.warn("Failed to save split view preferences",{error:e})}}return function(){try{const e=localStorage.getItem(`${mt}.preferences`);if(e){const t=JSON.parse(e);t.panelMode&&(o.value=t.panelMode),t.statusFilter&&(u.value=t.statusFilter),t.searchQuery&&(c.value=t.searchQuery)}}catch(e){X.warn("Failed to load split view preferences",{error:e})}}(),{selectedTrialId:r(()=>l.value),selectedTrial:r(()=>p.value),panelMode:r(()=>o.value),effectiveWidth:r(()=>m.value),isCollapsed:r(()=>f.value),searchQuery:r(()=>c.value),statusFilter:r(()=>u.value),keyboardFocusIndex:r(()=>d.value),filteredTrials:r(()=>v.value),groupedTrials:r(()=>g.value),totalFilteredCount:r(()=>h.value),statusCounts:r(()=>y.value),selectTrial:b,setSearchQuery:function(e){c.value=e,w()},setStatusFilter:function(e){u.value=e,w()},navigateByKeyboard:function(e){const t=[...g.value.running,...g.value.recent];0!==t.length&&(d.value="down"===e?Math.min(d.value+1,t.length-1):Math.max(d.value-1,0),d.value>=0&&d.value<t.length&&b(t[d.value].id))},togglePanelMode:function(){switch(o.value){case"wide":o.value="medium";break;case"medium":o.value="collapsed";break;case"collapsed":o.value="wide"}w()},setPanelMode:function(e){o.value=e,w()},savePreferences:w,clearPreferences:function(){try{localStorage.removeItem(`${mt}.preferences`),o.value="medium",u.value="all",c.value=""}catch(e){X.warn("Failed to clear split view preferences",{error:e})}},syncWithRoute:function(){const e=t.params.trialId;e&&e!==l.value?l.value=e:e||(l.value=null)}}}),vt=["data-collapsed"],gt={class:"list-toolbar"},ht={class:"list-title"},yt={key:1},bt={key:0,class:"list-actions"},wt={key:0,class:"list-search"},_t={key:1,class:"status-tabs"},kt=["onClick"],xt={class:"tab-icon"},Ct={class:"tab-label"},St={class:"tab-count"},Tt={key:0,class:"list-section"},It=["onClick","data-index"],Ot={key:0,class:"collapsed-content"},Et={class:"collapsed-info"},Pt={class:"collapsed-count"},$t={key:1,class:"item-content"},Mt={class:"item-header"},Rt={class:"item-name"},Nt={class:"item-meta"},Ft={class:"meta-text"},At={class:"meta-text"},Dt={class:"meta-text"},jt={key:1,class:"list-section"},Lt=["onClick","data-index"],Ut={key:0,class:"collapsed-content"},zt={class:"collapsed-info"},qt={class:"collapsed-count"},Vt={key:1,class:"item-content"},Ht={class:"item-header"},Bt={class:"item-name"},Wt={class:"item-meta"},Gt={class:"meta-text"},Kt={class:"meta-text"},Jt={class:"meta-text"},Yt={key:2,class:"empty-list"},Qt=le(o({__name:"TrialListPanel",props:{collapsed:{type:Boolean,default:!1}},emits:["create-trial"],setup(e){const t=ft(),l=J(),s=n(),i=n(),o=n(t.searchQuery),S=r(()=>t.selectedTrialId),T=r(()=>t.statusFilter),I=r(()=>t.groupedTrials),O=r(()=>t.totalFilteredCount),E=r(()=>t.keyboardFocusIndex),P=r(()=>t.statusCounts),$=r(()=>[{key:"all",label:"All",icon:"📊",count:P.value.all},{key:"running",label:"Active",icon:"🟢",count:P.value.running+P.value.paused},{key:"completed",label:"Done",icon:"✅",count:P.value.completed}]);function M(e){t.selectTrial(e)}function R(e){return 0===e.progress.total?0:Math.round(e.progress.completed/e.progress.total*100)}function N(e){const t=(new Date).getTime()-e.getTime(),a=Math.floor(t/6e4),l=Math.floor(a/60),n=Math.floor(l/24);return a<1?"now":a<60?`${a}m`:l<24?`${l}h`:n<7?`${n}d`:e.toLocaleDateString()}function F(e){"ArrowDown"===e.key||"j"===e.key?(e.preventDefault(),t.navigateByKeyboard("down"),A()):"ArrowUp"!==e.key&&"k"!==e.key||(e.preventDefault(),t.navigateByKeyboard("up"),A())}function A(){const e=i.value?.querySelectorAll(".list-item"),t=E.value;e&&t>=0&&e[t]&&e[t].scrollIntoView({behavior:"smooth",block:"nearest"})}function D({key:e}){t.setStatusFilter(e)}async function j(){await l.initialize()}c(o,e=>{t.setSearchQuery(e)});const L=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),s.value?.focus())};return u(()=>{document.addEventListener("keydown",L)}),d(()=>{document.removeEventListener("keydown",L)}),(e,l)=>{const n=h("a-badge"),r=h("a-button"),c=h("a-tooltip"),u=h("a-menu-item"),d=h("a-menu-divider"),P=h("a-menu"),A=h("a-dropdown"),L=h("a-input"),U=h("a-progress"),z=h("a-tag");return _(),p("div",{class:"trial-list-panel","data-collapsed":e.collapsed},[m("div",gt,[m("div",ht,[e.collapsed?f("",!0):(_(),v(g(Z),{key:0})),e.collapsed?f("",!0):(_(),p("span",yt,"Trials")),a(n,{count:O.value,showZero:!0,style:{"margin-left":"8px"}},null,8,["count"])]),e.collapsed?f("",!0):(_(),p("div",bt,[a(r,{type:"primary",size:"small",onClick:l[0]||(l[0]=t=>e.$emit("create-trial"))},{icon:y(()=>[a(g(ee))]),default:y(()=>[l[3]||(l[3]=k(" New Trial "))]),_:1,__:[3]}),a(c,{title:"Refresh"},{default:y(()=>[a(r,{type:"text",size:"small",onClick:j},{icon:y(()=>[a(g(te))]),_:1})]),_:1}),a(A,null,{overlay:y(()=>[a(P,{onClick:D},{default:y(()=>[a(u,{key:"all"},{default:y(()=>l[4]||(l[4]=[k("All Trials")])),_:1,__:[4]}),a(d),a(u,{key:"running"},{default:y(()=>l[5]||(l[5]=[m("span",{class:"status-dot running"},null,-1),k(" Running Only ")])),_:1,__:[5]}),a(u,{key:"completed"},{default:y(()=>l[6]||(l[6]=[m("span",{class:"status-dot completed"},null,-1),k(" Completed Only ")])),_:1,__:[6]}),a(u,{key:"failed"},{default:y(()=>l[7]||(l[7]=[m("span",{class:"status-dot failed"},null,-1),k(" Failed Only ")])),_:1,__:[7]}),a(u,{key:"paused"},{default:y(()=>l[8]||(l[8]=[m("span",{class:"status-dot paused"},null,-1),k(" Paused Only ")])),_:1,__:[8]}),a(u,{key:"draft"},{default:y(()=>l[9]||(l[9]=[m("span",{class:"status-dot draft"},null,-1),k(" Draft Only ")])),_:1,__:[9]})]),_:1})]),default:y(()=>[a(r,{type:"text",size:"small"},{icon:y(()=>[a(g(Pe))]),_:1})]),_:1})]))]),e.collapsed?f("",!0):(_(),p("div",wt,[a(L,{placeholder:"Filter trials...",size:"small",value:o.value,"onUpdate:value":l[1]||(l[1]=e=>o.value=e),onKeydown:F,ref_key:"searchInputRef",ref:s},{prefix:y(()=>[a(g(ae))]),_:1},8,["value"])])),e.collapsed?f("",!0):(_(),p("div",_t,[(_(!0),p(b,null,w($.value,e=>(_(),p("div",{key:e.key,class:x(["status-tab",{active:T.value===e.key}]),onClick:a=>{return l=e.key,void t.setStatusFilter(l);var l}},[m("span",xt,C(e.icon),1),m("span",Ct,C(e.label),1),m("span",St,C(e.count),1)],10,kt))),128))])),m("div",{class:"trial-list",ref_key:"trialListRef",ref:i},[I.value.running.length>0?(_(),p("div",Tt,[l[14]||(l[14]=m("div",{class:"section-header"},"RUNNING",-1)),(_(!0),p(b,null,w(I.value.running,(t,n)=>(_(),p("div",{key:t.id,class:x(["list-item running-item",{active:S.value===t.id,"keyboard-focus":E.value===n}]),onClick:e=>M(t.id),"data-index":n},[l[13]||(l[13]=m("div",{class:"item-indicator running"},null,-1)),e.collapsed?(_(),p("div",Ot,[a(c,{title:`${t.name} - ${t.progress.completed}/${t.progress.total} tasks`},{default:y(()=>[m("div",Et,[m("span",Pt,C(t.progress.completed),1),a(U,{type:"circle",percent:R(t),width:20,showInfo:!1,strokeWidth:3},null,8,["percent"])])]),_:2},1032,["title"])])):(_(),p("div",$t,[m("div",Mt,[m("span",Rt,C(t.name),1),a(z,{color:"blue",size:"small"},{default:y(()=>l[10]||(l[10]=[k("RUNNING")])),_:1,__:[10]}),a(U,{percent:R(t),showInfo:!1,strokeWidth:3,style:{width:"80px"}},null,8,["percent"])]),m("div",Nt,[m("span",Ft,C(t.progress.completed)+"/"+C(t.progress.total)+" tasks",1),l[11]||(l[11]=m("span",{class:"meta-separator"},"•",-1)),m("span",At,C(N(t.completed||t.started||t.created)),1),l[12]||(l[12]=m("span",{class:"meta-separator"},"•",-1)),m("span",Dt,"$"+C((t.estimatedCost||0).toFixed(2)),1)])]))],10,It))),128))])):f("",!0),I.value.recent.length>0?(_(),p("div",jt,[l[17]||(l[17]=m("div",{class:"section-header"},"RECENT",-1)),(_(!0),p(b,null,w(I.value.recent,(t,n)=>{return _(),p("div",{key:t.id,class:x(["list-item",{active:S.value===t.id,"keyboard-focus":E.value===I.value.running.length+n}]),onClick:e=>M(t.id),"data-index":I.value.running.length+n},[m("div",{class:x(["item-indicator",t.status])},null,2),e.collapsed?(_(),p("div",Ut,[a(c,{title:`${t.name} - ${t.status} - ${t.progress.completed} tasks`},{default:y(()=>[m("div",zt,[m("span",qt,C(t.progress.completed),1)])]),_:2},1032,["title"])])):(_(),p("div",Vt,[m("div",Ht,[m("span",Bt,C(t.name),1),a(z,{color:(r=t.status,{running:"blue",completed:"green",failed:"red",paused:"orange",draft:"default"}[r]||"default"),size:"small"},{default:y(()=>[k(C(t.status),1)]),_:2},1032,["color"])]),m("div",Wt,[m("span",Gt,C(t.progress.completed)+" tasks",1),l[15]||(l[15]=m("span",{class:"meta-separator"},"•",-1)),m("span",Kt,C(N(t.completed||t.started||t.created)),1),l[16]||(l[16]=m("span",{class:"meta-separator"},"•",-1)),m("span",Jt,"$"+C((t.estimatedCost||0).toFixed(2)),1)])]))],10,Lt);var r}),128))])):f("",!0),0===O.value?(_(),p("div",Yt,[a(g(Ye),{style:{"font-size":"32px",color:"#ccc"}}),l[19]||(l[19]=m("p",null,"No trials found",-1)),a(r,{type:"primary",onClick:l[2]||(l[2]=t=>e.$emit("create-trial"))},{default:y(()=>l[18]||(l[18]=[k(" Create New Trial ")])),_:1,__:[18]})])):f("",!0)],512)],8,vt)}}}),[["__scopeId","data-v-cba73fd3"]]),Xt={class:"trial-header"},Zt={class:"header-top-row"},ea={class:"header-left"},ta={class:"trial-title"},aa={class:"trial-meta"},la={class:"progress-inline"},na={class:"progress-bar-small"},ra={class:"progress-text-inline"},sa={class:"inline-stats"},ia={class:"stat-item"},oa={class:"stat-item"},ca={class:"stat-item"},ua={key:0,class:"stat-item"},da=le(o({__name:"TrialHeader",props:{trial:{}},setup(e){const t=e,l=r(()=>t.trial.name.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}/g,"").replace(/\s*\(Copy\)(\s*\(Copy\))*$/g,"").trim()),n=r(()=>({running:"blue",completed:"green",failed:"red",paused:"orange",draft:"default"}[t.trial.status]||"default")),s=r(()=>0===t.trial.progress.total?0:Math.round(t.trial.progress.completed/t.trial.progress.total*100)),i=r(()=>{if(0===t.trial.progress.total)return 0;const e=t.trial.progress.completed-(t.trial.progress.networkErrors||0);return Math.round(e/t.trial.progress.total*100)}),o=r(()=>{if(!t.trial.created)return"N/A";const e=new Date(t.trial.started||t.trial.created).getTime(),a=(t.trial.completed?new Date(t.trial.completed).getTime():Date.now())-e,l=Math.floor(a/36e5),n=Math.floor(a%36e5/6e4);return l>0?`${l}h ${n}m`:`${n}m`}),c=r(()=>"3.6s"),u=r(()=>{if(!t.trial.started)return"calculating...";const e=Date.now()-new Date(t.trial.started).getTime(),a=t.trial.progress.completed;if(0===a)return"calculating...";const l=e/a*(t.trial.progress.total-a),n=Math.floor(l/6e4),r=Math.floor(l%6e4/1e3);if(n>60){return`${Math.floor(n/60)}h ${n%60}m`}return`${n}m ${r}s`});return(e,t)=>{const r=h("a-tag");return _(),p("div",Xt,[m("div",Zt,[m("div",ea,[m("h2",ta,C(l.value),1),m("div",aa,[a(r,{color:n.value,class:"status-tag"},{default:y(()=>[k(C(e.trial.status.toUpperCase()),1)]),_:1},8,["color"]),m("div",la,[m("div",na,[m("div",{class:"progress-fill",style:S({width:s.value+"%"})},null,4)]),m("span",ra,C(e.trial.progress.completed)+"/"+C(e.trial.progress.total)+" ("+C(i.value)+"%) ",1)]),m("div",sa,[m("span",ia,[a(g(ne)),t[0]||(t[0]=m("span",null,"Duration:",-1)),m("strong",null,C(o.value),1)]),m("span",oa,[a(g(pt)),t[1]||(t[1]=m("span",null,"Latency:",-1)),m("strong",null,C(c.value),1)]),m("span",ca,[a(g($e)),t[2]||(t[2]=m("span",null,"Cost:",-1)),m("strong",null,"$"+C((e.trial.estimatedCost||0).toFixed(2)),1)]),"running"===e.trial.status||"paused"===e.trial.status?(_(),p("span",ua,[a(g(We)),t[3]||(t[3]=m("span",null,"Remaining:",-1)),m("strong",null,"~"+C(u.value),1)])):f("",!0)])])])])])}}}),[["__scopeId","data-v-5e979bc9"]]),pa={class:"trial-actions"},ma=le(o({__name:"TrialActions",props:{trial:{},isResuming:{type:Boolean}},emits:["pause-trial","resume-trial","cancel-trial","export-data","export-python","duplicate-trial","edit-trial","delete-trial"],setup:e=>(e,t)=>{const l=h("a-button"),n=h("a-menu-item"),r=h("a-menu"),s=h("a-dropdown");return _(),p("div",pa,["running"===e.trial.status?(_(),p(b,{key:0},[a(l,{onClick:t[0]||(t[0]=t=>e.$emit("pause-trial")),size:"large",class:"action-button"},{icon:y(()=>[a(g(et))]),default:y(()=>[t[9]||(t[9]=k(" Pause "))]),_:1,__:[9]}),a(l,{onClick:t[1]||(t[1]=t=>e.$emit("cancel-trial")),danger:"",size:"large",class:"action-button"},{icon:y(()=>[a(g(ot))]),default:y(()=>[t[10]||(t[10]=k(" Cancel "))]),_:1,__:[10]})],64)):"paused"===e.trial.status?(_(),p(b,{key:1},[a(l,{type:"primary",onClick:t[2]||(t[2]=t=>e.$emit("resume-trial")),disabled:e.isResuming,size:"large",class:"action-button"},{icon:y(()=>[e.isResuming?(_(),v(g(re),{key:0,spin:""})):(_(),v(g(se),{key:1}))]),default:y(()=>[k(" "+C(e.isResuming?"Resuming...":"Resume"),1)]),_:1},8,["disabled"]),a(l,{onClick:t[3]||(t[3]=t=>e.$emit("cancel-trial")),danger:"",size:"large",class:"action-button"},{icon:y(()=>[a(g(ot))]),default:y(()=>[t[11]||(t[11]=k(" Cancel "))]),_:1,__:[11]})],64)):f("",!0),a(s,null,{overlay:y(()=>[a(r,null,{default:y(()=>[a(n,{onClick:t[4]||(t[4]=t=>e.$emit("export-data"))},{default:y(()=>[a(g(Re)),t[13]||(t[13]=k(" Export Data "))]),_:1,__:[13]}),a(n,{onClick:t[5]||(t[5]=t=>e.$emit("export-python"))},{default:y(()=>[a(g(Me)),t[14]||(t[14]=k(" Export Python Script "))]),_:1,__:[14]})]),_:1})]),default:y(()=>[a(l,{size:"large",class:"action-button"},{icon:y(()=>[a(g(oe))]),default:y(()=>[t[12]||(t[12]=k(" Export ")),a(g(ie))]),_:1,__:[12]})]),_:1}),a(l,{onClick:t[6]||(t[6]=t=>e.$emit("duplicate-trial")),size:"large",class:"action-button"},{icon:y(()=>[a(g(ce))]),default:y(()=>[t[15]||(t[15]=k(" Duplicate "))]),_:1,__:[15]}),"draft"===e.trial.status?(_(),v(l,{key:2,onClick:t[7]||(t[7]=t=>e.$emit("edit-trial")),size:"large",class:"action-button"},{icon:y(()=>[a(g(ue))]),default:y(()=>[t[16]||(t[16]=k(" Edit "))]),_:1,__:[16]})):f("",!0),a(l,{onClick:t[8]||(t[8]=t=>e.$emit("delete-trial")),danger:"",size:"large",class:"action-button"},{icon:y(()=>[a(g(de))]),default:y(()=>[t[17]||(t[17]=k(" Delete "))]),_:1,__:[17]})])}}),[["__scopeId","data-v-7a87e1d1"]]);const fa="undefined"!=typeof window&&"undefined"!=typeof document;"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const va=Object.prototype.toString,ga=()=>{};function ha(e){return Array.isArray(e)?e:[e]}function ya(e,t=200,a=!1,l=!0,n=!1){return function(e,t){return function(...a){return new Promise((l,n)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(l).catch(n)})}}(function(...e){let t,a,l,n,r,s,i=0,o=!0,c=ga;O(e[0])||"object"!=typeof e[0]?[l,n=!0,r=!0,s=!1]=e:({delay:l,trailing:n=!0,leading:r=!0,rejectOnCancel:s=!1}=e[0]);const u=()=>{t&&(clearTimeout(t),t=void 0,c(),c=ga)};return e=>{const d=E(l),p=Date.now()-i,m=()=>a=e();return u(),d<=0?(i=Date.now(),m()):(p>d&&(r||!o)?(i=Date.now(),m()):n&&(a=new Promise((e,a)=>{c=s?a:e,t=setTimeout(()=>{i=Date.now(),o=!0,e(m()),u()},Math.max(0,d-p))})),r||t||(t=setTimeout(()=>o=!0,d)),o=!1,a)}}(t,a,l,n),e)}const ba=fa?window:void 0;function wa(...e){const t=[],a=()=>{t.forEach(e=>e()),t.length=0},l=r(()=>{const t=ha(E(e[0])).filter(e=>null!=e);return t.every(e=>"string"!=typeof e)?t:void 0}),n=(s=([e,l,n,r])=>{if(a(),!(null==e?void 0:e.length)||!(null==l?void 0:l.length)||!(null==n?void 0:n.length))return;const s=(i=r,"[object Object]"===va.call(i)?{...r}:r);var i;t.push(...e.flatMap(e=>l.flatMap(t=>n.map(a=>((e,t,a,l)=>(e.addEventListener(t,a,l),()=>e.removeEventListener(t,a,l)))(e,t,a,s)))))},i={flush:"post"},c(()=>{var t,a;return[null!=(a=null==(t=l.value)?void 0:t.map(e=>function(e){var t;const a=E(e);return null!=(t=null==a?void 0:a.$el)?t:a}(e)))?a:[ba].filter(e=>null!=e),ha(E(l.value?e[1]:e[0])),ha(g(l.value?e[2]:e[1])),E(l.value?e[3]:e[2])]},s,{...i,immediate:!0}));var s,i;var o;return o=a,T()&&I(o),()=>{n(),a()}}const _a={class:"virtual-table"},ka={class:"virtual-table"},xa=["data-row-index","data-row-id","onClick"],Ca=le(o({__name:"VirtualTable",props:{columns:{},dataSource:{},rowHeight:{default:48},rowKey:{type:[String,Function],default:"id"},overscan:{default:5},showHeader:{type:Boolean,default:!0},getRowClass:{},minHeight:{default:"300px"},maxHeight:{default:"calc(100vh - 250px)"}},emits:["row-click"],setup(e,{expose:t,emit:a}){$(e=>({"1f3b711c":e.minHeight,"7b519df8":e.maxHeight}));const l=e,s=a,i=n(),o=n(),v=n(0),h=n(0),y=n(0);let T=null;const I=r(()=>l.dataSource.length*l.rowHeight),O=r(()=>{const e=Math.floor(v.value/l.rowHeight),t=Math.ceil((v.value+h.value)/l.rowHeight);return{start:Math.max(0,e-l.overscan),end:Math.min(l.dataSource.length,t+l.overscan)}}),E=r(()=>O.value.start),M=r(()=>l.dataSource.slice(O.value.start,O.value.end)),R=r(()=>E.value*l.rowHeight);function N(e){return"function"==typeof l.rowKey?l.rowKey(e):e[l.rowKey]}function F(e,t){const a=t.key.split(".");let l=e;for(const n of a){if(!l||"object"!=typeof l)return;l=l[n]}return l}function A(e){const t={};return e.width&&(t.width="number"==typeof e.width?`${e.width}px`:e.width),e.align&&(t.textAlign=e.align),t}const D=ya(e=>{null!==T&&cancelAnimationFrame(T),T=requestAnimationFrame(()=>{const t=e.target;v.value=t.scrollTop,T=null})},16);let j=null;function L(){if(i.value){const e=i.value.querySelector(".virtual-content");h.value=e?e.clientHeight:i.value.clientHeight}o.value&&(y.value=o.value.offsetHeight)}function U(){if(i.value){const e=i.value.querySelector(".virtual-content");e&&(e.scrollTop=0)}}return u(()=>{L(),i.value&&(j=new ResizeObserver(()=>{L()}),j.observe(i.value))}),d(()=>{j&&j.disconnect(),null!==T&&cancelAnimationFrame(T)}),c(()=>l.dataSource.length,()=>{v.value>I.value&&U()}),t({scrollToRow:function(e){if(i.value){const t=i.value.querySelector(".virtual-content");if(t){const a=e*l.rowHeight;t.scrollTop=a}}},scrollToTop:U}),(e,t)=>(_(),p("div",{class:"virtual-table-container",ref_key:"containerRef",ref:i,"data-testid":"virtual-table",role:"table","aria-label":"Data table with virtual scrolling"},[e.showHeader?(_(),p("div",{key:0,class:"virtual-header",ref_key:"headerRef",ref:o},[m("table",_a,[m("thead",null,[m("tr",null,[(_(!0),p(b,null,w(e.columns,e=>(_(),p("th",{key:e.key,style:S(A(e)),class:x(e.className)},C(e.title),7))),128))])])])],512)):f("",!0),m("div",{class:"virtual-content",style:S({height:`calc(100% - ${y.value}px)`}),onScrollPassive:t[0]||(t[0]=(...e)=>g(D)&&g(D)(...e))},[m("div",{class:"virtual-spacer",style:S({height:I.value+"px"})},[m("div",{class:"virtual-viewport",style:S({transform:`translateY(${R.value}px)`})},[m("table",ka,[m("tbody",null,[(_(!0),p(b,null,w(M.value,(t,a)=>(_(),p("tr",{key:N(t),"data-row-index":E.value+a,"data-row-id":N(t),class:x(e.getRowClass?e.getRowClass(t):""),"data-testid":"table-row",role:"row",onClick:e=>function(e){s("row-click",e)}(t)},[(_(!0),p(b,null,w(e.columns,a=>(_(),p("td",{key:a.key,style:S(A(a)),class:x(a.className)},[P(e.$slots,"cell",{column:a,record:t,value:F(t,a)},()=>[k(C(F(t,a)),1)],!0)],6))),128))],10,xa))),128))])])],4)],4)],36)],512))}}),[["__scopeId","data-v-124032b7"]]);const Sa=new class{constructor(){t(this,"metrics",[]),t(this,"recording",!1),t(this,"recordingStartTime",null),t(this,"overlayElement",null),t(this,"rafId",null),t(this,"lastFrameTime",0),t(this,"fpsHistory",[]),t(this,"componentRenderCounts",{}),t(this,"measurementMap",new Map)}calculateFPS(){const e=performance.now();if(0===this.lastFrameTime)return this.lastFrameTime=e,60;const t=1e3/(e-this.lastFrameTime);return this.lastFrameTime=e,this.fpsHistory.push(t),this.fpsHistory.length>60&&this.fpsHistory.shift(),this.fpsHistory.reduce((e,t)=>e+t,0)/this.fpsHistory.length}getMemoryUsage(){if("memory"in performance&&performance.memory){return performance.memory.usedJSHeapSize/1048576}return 0}getDOMNodeCount(){return document.querySelectorAll("*").length}start(e){this.measurementMap.set(e,performance.now())}end(e){const t=this.measurementMap.get(e);if(!t)return console.warn(`No start time found for label: ${e}`),0;const a=performance.now()-t;return this.measurementMap.delete(e),a}measure(e,t){const a=performance.now(),l=t(),n=performance.now()-a;if(this.recording){this.getCurrentMetrics().renderTime=n}return l}trackComponentRender(e){this.componentRenderCounts[e]=(this.componentRenderCounts[e]||0)+1}getCurrentMetrics(){return{fps:this.calculateFPS(),renderTime:0,updateTime:0,memoryUsage:this.getMemoryUsage(),domNodes:this.getDOMNodeCount(),componentRenders:{...this.componentRenderCounts}}}showOverlay(e){e&&!this.overlayElement?(this.createOverlay(),this.startOverlayUpdate()):!e&&this.overlayElement&&this.destroyOverlay()}createOverlay(){this.overlayElement=document.createElement("div"),this.overlayElement.id="performance-overlay",this.overlayElement.style.cssText="\n      position: fixed;\n      top: 10px;\n      right: 10px;\n      background: rgba(0, 0, 0, 0.8);\n      color: #0f0;\n      font-family: monospace;\n      font-size: 12px;\n      padding: 10px;\n      border-radius: 5px;\n      z-index: 999999;\n      pointer-events: none;\n      min-width: 200px;\n    ",document.body.appendChild(this.overlayElement)}destroyOverlay(){this.overlayElement&&(document.body.removeChild(this.overlayElement),this.overlayElement=null),null!==this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null)}updateOverlay(){if(!this.overlayElement)return;const e=this.getCurrentMetrics(),t=e.memoryUsage>100?"#f00":e.memoryUsage>50?"#ff0":"#0f0",a=e.fps<30?"#f00":e.fps<55?"#ff0":"#0f0",l=e.domNodes>5e3?"#f00":e.domNodes>2e3?"#ff0":"#0f0";this.overlayElement.innerHTML=`\n      <div style="margin-bottom: 5px; font-weight: bold;">Performance Monitor</div>\n      <div>FPS: <span style="color: ${a}">${e.fps.toFixed(1)}</span></div>\n      <div>Memory: <span style="color: ${t}">${e.memoryUsage.toFixed(1)} MB</span></div>\n      <div>DOM Nodes: <span style="color: ${l}">${e.domNodes}</span></div>\n      ${e.renderTime>0?`<div>Render: ${e.renderTime.toFixed(1)}ms</div>`:""}\n      ${e.updateTime>0?`<div>Update: ${e.updateTime.toFixed(1)}ms</div>`:""}\n    `}startOverlayUpdate(){const e=()=>{this.updateOverlay(),this.rafId=requestAnimationFrame(e)};e()}startRecording(){this.recording=!0,this.recordingStartTime=new Date,this.metrics=[],this.componentRenderCounts={};const e=setInterval(()=>{this.recording?this.metrics.push(this.getCurrentMetrics()):clearInterval(e)},100)}stopRecording(){if(!this.recording||!this.recordingStartTime)throw new Error("No recording in progress");this.recording=!1;const e=new Date,t={avgFps:this.metrics.reduce((e,t)=>e+t.fps,0)/this.metrics.length||0,avgRenderTime:this.metrics.reduce((e,t)=>e+t.renderTime,0)/this.metrics.length||0,avgUpdateTime:this.metrics.reduce((e,t)=>e+t.updateTime,0)/this.metrics.length||0,peakMemoryUsage:Math.max(...this.metrics.map(e=>e.memoryUsage)),totalRenders:Object.values(this.componentRenderCounts).reduce((e,t)=>e+t,0)},a={startTime:this.recordingStartTime,endTime:e,duration:e.getTime()-this.recordingStartTime.getTime(),metrics:this.metrics,summary:t};return this.recordingStartTime=null,this.metrics=[],a}exportReport(e){const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download=`performance-report-${e.startTime.toISOString()}.json`,l.click(),URL.revokeObjectURL(a)}logWarning(e,t){console.warn(`[Performance Warning] ${e}`,t)}checkPerformance(){const e=this.getCurrentMetrics();e.fps<30&&this.logWarning(`Low FPS detected: ${e.fps.toFixed(1)}`,{fps:e.fps}),e.memoryUsage>100&&this.logWarning(`High memory usage: ${e.memoryUsage.toFixed(1)} MB`,{memoryUsage:e.memoryUsage}),e.domNodes>5e3&&this.logWarning(`Excessive DOM nodes: ${e.domNodes}`,{domNodes:e.domNodes})}},Ta=le(o({__name:"VirtualDataTable",props:{columns:{},dataSource:{},loading:{type:Boolean,default:!1},rowKey:{},rowHeight:{type:[Number,Function],default:60},overscan:{default:10},pagination:{type:[Boolean,Object],default:!1},scroll:{},size:{default:"small"},customRow:{},onRow:{},rowClassName:{},className:{},style:{},forceVirtual:{type:Boolean,default:!1}},emits:["row-click","cell-click"],setup(e,{emit:t}){const a=e,l=t,n=r(()=>!!a.forceVirtual||a.dataSource.length>100&&(Sa.trackComponentRender("VirtualDataTable"),!0)),s=r(()=>a.columns.map(e=>({key:e.key||("string"==typeof e.dataIndex?e.dataIndex:e.dataIndex?.[0])||"",title:e.title,width:e.width,align:e.align,className:e.className}))),i=r(()=>{if("function"==typeof a.rowHeight)return a.rowHeight;return{small:48,middle:60,large:72}[a.size||"small"]||a.rowHeight});function o(e){if(l("row-click",e),a.customRow){const t=a.customRow(e);t&&"object"==typeof t&&"onClick"in t&&t.onClick()}}function c(e){if("function"==typeof a.rowClassName){const t=a.dataSource.indexOf(e);return a.rowClassName(e,t)}return a.rowClassName||""}const u=r(()=>{const e={};return a.customRow&&(e.customRow=a.customRow),a.onRow&&(e.onRow=a.onRow),a.rowClassName&&(e.rowClassName=a.rowClassName),e});return(e,t)=>(_(),p("div",{class:x(["virtual-data-table",{"virtual-enabled":n.value}])},[n.value?(_(),v(Ca,{key:0,columns:s.value,"data-source":e.dataSource,"row-height":"function"==typeof i.value?void 0:i.value,"row-key":e.rowKey,overscan:e.overscan,"show-header":!0,"get-row-class":c,"min-height":e.scroll?.y?`${e.scroll.y}px`:"400px","max-height":e.scroll?.y?`${e.scroll.y}px`:"calc(100vh - 300px)",onRowClick:o},{cell:y(({column:t,record:a,value:l})=>[P(e.$slots,"bodyCell",{column:e.columns.find(e=>e.key===t.key||e.dataIndex===t.key),record:a,text:l,value:l,index:e.dataSource.indexOf(a)},()=>[k(C(l),1)],!0)]),_:3},8,["columns","data-source","row-height","row-key","overscan","min-height","max-height"])):(_(),v(g(pe),M({key:1},u.value,{columns:e.columns,"data-source":e.dataSource,loading:e.loading,pagination:e.pagination,scroll:e.scroll,size:e.size,"row-key":e.rowKey,"custom-row":e.customRow,"row-class-name":e.rowClassName,class:e.className,style:e.style}),{bodyCell:y(({column:t,record:a,text:l,value:n,index:r})=>[P(e.$slots,"bodyCell",{column:t,record:a,text:l,value:n,index:r},void 0,!0)]),_:3},16,["columns","data-source","loading","pagination","scroll","size","row-key","custom-row","row-class-name","class","style"]))],2))}}),[["__scopeId","data-v-2264c400"]]),Ia={class:"api-call-modal"},Oa={class:"modal-header"},Ea={class:"modal-content"},Pa={class:"section"},$a={class:"info-grid"},Ma={class:"info-item"},Ra={class:"call-id"},Na={class:"info-item"},Fa={class:"info-item"},Aa={class:"info-item"},Da={key:0,class:"info-item"},ja={key:1,class:"info-item"},La={key:2,class:"info-item"},Ua={class:"section"},za={class:"variables-detail"},qa={class:"variable-value"},Va={key:0,class:"attributes-section"},Ha={class:"attribute-items"},Ba={class:"section"},Wa={class:"prompt-display"},Ga={key:0,class:"section"},Ka={key:0,class:"response-info"},Ja={class:"info-grid"},Ya={class:"info-item"},Qa={class:"info-item"},Xa={key:1,class:"result-content"},Za={key:0,class:"error-result"},el={class:"error-message"},tl={key:0,class:"error-raw"},al={class:"error-response"},ll={key:1,class:"content-result"},nl={class:"content-display"},rl={class:"section"},sl={class:"raw-data"},il={key:1,class:"section"},ol={class:"raw-data"},cl={class:"modal-footer"},ul=le(o({__name:"APICallDetailModal",props:{apiCall:{},trial:{}},emits:["close"],setup(e){const t=e,l=r(()=>{if(!t.apiCall.request)return"No request data";let e;t.trial&&t.trial.configurationSnapshots[t.apiCall.configurationIndex]&&(e=t.trial.configurationSnapshots[t.apiCall.configurationIndex].provider);const a=Fe(t.apiCall.request,e);return JSON.stringify(a,null,2)});function n(){return t.trial&&t.trial.configurationSnapshots[t.apiCall.configurationIndex]&&t.trial.configurationSnapshots[t.apiCall.configurationIndex].name||`Configuration ${t.apiCall.configurationIndex+1}`}function s(e){const t="string"==typeof e?new Date(e):e;return isNaN(t.getTime())?"Invalid date":t.toLocaleString()}async function i(){const e={id:t.apiCall.id,status:t.apiCall.status,configuration:n(),variables:t.apiCall.variables,variableAttributes:t.apiCall.variableAttributes,prompt:t.apiCall.prompt,request:JSON.parse(l.value),response:t.apiCall.response,result:t.apiCall.result,created:t.apiCall.created,completed:t.apiCall.completed},a=JSON.stringify(e,null,2);try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(a),void me.success("Details copied to clipboard!");const e=document.createElement("textarea");e.value=a,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();const t=document.execCommand("copy");if(document.body.removeChild(e),!t)throw new Error("execCommand failed");me.success("Details copied to clipboard!")}catch(r){X.error("Failed to copy to clipboard",r),prompt("Copy this text manually:",a)}}return(e,t)=>{const r=h("a-button");return _(),p("div",{class:"modal-overlay",onClick:t[2]||(t[2]=R(t=>e.$emit("close"),["self"]))},[m("div",Ia,[m("div",Oa,[t[3]||(t[3]=m("h2",null,"API Call Details",-1)),m("button",{class:"close-btn",onClick:t[0]||(t[0]=t=>e.$emit("close")),"data-testid":"btn-close-api-call-modal","aria-label":"Close API call details"},"×")]),m("div",Ea,[m("div",Pa,[t[11]||(t[11]=m("h3",null,"Overview",-1)),m("div",$a,[m("div",Ma,[t[4]||(t[4]=m("label",null,"Call ID:",-1)),m("span",Ra,C(e.apiCall.id),1)]),m("div",Na,[t[5]||(t[5]=m("label",null,"Status:",-1)),m("span",{class:x(["status-badge",e.apiCall.status])},C(e.apiCall.status),3)]),m("div",Fa,[t[6]||(t[6]=m("label",null,"Configuration:",-1)),m("span",null,C(n()),1)]),m("div",Aa,[t[7]||(t[7]=m("label",null,"Created:",-1)),m("span",null,C(s(e.apiCall.created)),1)]),e.apiCall.completed?(_(),p("div",Da,[t[8]||(t[8]=m("label",null,"Completed:",-1)),m("span",null,C(s(e.apiCall.completed)),1)])):f("",!0),e.apiCall.completed?(_(),p("div",ja,[t[9]||(t[9]=m("label",null,"Duration:",-1)),m("span",null,C((o=e.apiCall.completed.getTime()-e.apiCall.created.getTime(),o<1e3?`${o}ms`:`${(o/1e3).toFixed(1)}s`)),1)])):f("",!0),e.apiCall.response?.latencyMs?(_(),p("div",La,[t[10]||(t[10]=m("label",null,"API Latency:",-1)),m("span",null,C(e.apiCall.response.latencyMs)+"ms",1)])):f("",!0)])]),m("div",Ua,[t[13]||(t[13]=m("h3",null,"Variables",-1)),m("div",za,[(_(!0),p(b,null,w(Object.entries(e.apiCall.variables),([e,t])=>(_(),p("div",{key:e,class:"variable-item"},[m("label",null,C(e)+":",1),m("span",qa,C(t),1)]))),128))]),e.apiCall.variableAttributes&&Object.keys(e.apiCall.variableAttributes).length>0?(_(),p("div",Va,[t[12]||(t[12]=m("h4",null,"Variable Attributes",-1)),(_(!0),p(b,null,w(Object.entries(e.apiCall.variableAttributes),([e,t])=>(_(),p("div",{key:e,class:"attribute-group"},[m("h5",null,C(e),1),m("div",Ha,[(_(!0),p(b,null,w(Object.entries(t),([e,t])=>(_(),p("div",{key:e,class:"attribute-item"},[m("label",null,C(e)+":",1),m("span",null,C(t),1)]))),128))])]))),128))])):f("",!0)]),m("div",Ba,[t[14]||(t[14]=m("h3",null,"Resolved Prompt",-1)),m("div",Wa,C(e.apiCall.prompt),1)]),e.apiCall.response||e.apiCall.result?(_(),p("div",Ga,[t[20]||(t[20]=m("h3",null,"Response",-1)),e.apiCall.response?(_(),p("div",Ka,[m("div",Ja,[m("div",Ya,[t[15]||(t[15]=m("label",null,"HTTP Status:",-1)),m("span",null,C(e.apiCall.response.status),1)]),m("div",Qa,[t[16]||(t[16]=m("label",null,"Latency:",-1)),m("span",null,C(e.apiCall.response.latencyMs)+"ms",1)])])])):f("",!0),e.apiCall.result?(_(),p("div",Xa,[!1===e.apiCall.result.success?(_(),p("div",Za,[t[18]||(t[18]=m("h4",null,"Error",-1)),m("div",el,C(e.apiCall.result.error),1),e.apiCall.response?(_(),p("div",tl,[t[17]||(t[17]=m("h5",null,"Raw Response:",-1)),m("pre",al,C(JSON.stringify(e.apiCall.response,null,2)),1)])):f("",!0)])):f("",!0),e.apiCall.result.content?(_(),p("div",ll,[t[19]||(t[19]=m("h4",null,"Content",-1)),m("div",nl,C(e.apiCall.result.content),1)])):f("",!0)])):f("",!0)])):f("",!0),m("div",rl,[t[21]||(t[21]=m("h3",null,"Raw Request",-1)),m("pre",sl,C(l.value),1)]),e.apiCall.response?(_(),p("div",il,[t[22]||(t[22]=m("h3",null,"Raw Response",-1)),m("pre",ol,C(JSON.stringify(e.apiCall.response,null,2)),1)])):f("",!0)]),m("div",cl,[a(r,{onClick:t[1]||(t[1]=t=>e.$emit("close")),size:"large",class:"footer-button","data-testid":"btn-close-modal-footer","aria-label":"Close modal"},{default:y(()=>t[23]||(t[23]=[k(" Close ")])),_:1,__:[23]}),a(r,{type:"primary",onClick:i,size:"large",class:"footer-button footer-button-primary","data-testid":"btn-copy-api-call-details","aria-label":"Copy API call details to clipboard"},{default:y(()=>t[24]||(t[24]=[k(" Copy Details ")])),_:1,__:[24]})])])]);var o}}}),[["__scopeId","data-v-d0b393dd"]]),dl={VIRTUAL_SCROLLING:{key:"VIRTUAL_SCROLLING",name:"Virtual Scrolling",description:"Enable virtual scrolling for large data tables",defaultValue:!1,experimental:!0},WEB_WORKERS:{key:"WEB_WORKERS",name:"Web Workers",description:"Offload expensive calculations to web workers",defaultValue:!1,experimental:!0},OPTIMIZED_SORTING:{key:"OPTIMIZED_SORTING",name:"Optimized Sorting",description:"Use optimized sorting algorithms with memoization",defaultValue:!1},SHALLOW_REACTIVITY:{key:"SHALLOW_REACTIVITY",name:"Shallow Reactivity",description:"Use shallowRef for large arrays to reduce reactivity overhead",defaultValue:!1},DEBOUNCED_UPDATES:{key:"DEBOUNCED_UPDATES",name:"Debounced Updates",description:"Batch and debounce rapid data updates",defaultValue:!1},DIFFERENTIAL_UPDATES:{key:"DIFFERENTIAL_UPDATES",name:"Differential Updates",description:"Only update changed data instead of full replacement",defaultValue:!1,experimental:!0,dependencies:["DEBOUNCED_UPDATES"]},DATA_WINDOWING:{key:"DATA_WINDOWING",name:"Data Windowing",description:"Keep only visible data in memory with progressive loading",defaultValue:!1,experimental:!0,dependencies:["VIRTUAL_SCROLLING"]},PERFORMANCE_MONITORING:{key:"PERFORMANCE_MONITORING",name:"Performance Monitoring",description:"Enable performance monitoring overlay and metrics",defaultValue:!1}};const pl=new class{constructor(){t(this,"flags"),t(this,"overrides",{});const e={};Object.values(dl).forEach(t=>{e[t.key]=t.defaultValue}),this.flags=n(e),this.loadOverrides(),this.applyURLParams()}isEnabled(e){if(e in this.overrides)return this.overrides[e];if(!(e in dl))return X.warn(`Unknown feature flag: ${e}`),!1;const t=dl[e];if(t.dependencies)for(const a of t.dependencies)if(!this.isEnabled(a))return!1;return this.flags.value[e]??!1}useFlag(e){return r(()=>this.isEnabled(e))}enable(e,t=!0){e in dl?(this.flags.value[e]=!0,this.overrides[e]=!0,t&&this.saveOverrides(),X.info(`Feature enabled: ${e}`)):X.warn(`Unknown feature flag: ${e}`)}disable(e,t=!0){e in dl?(this.flags.value[e]=!1,this.overrides[e]=!1,t&&this.saveOverrides(),X.info(`Feature disabled: ${e}`)):X.warn(`Unknown feature flag: ${e}`)}toggle(e,t=!0){this.isEnabled(e)?this.disable(e,t):this.enable(e,t)}resetToDefaults(){Object.values(dl).forEach(e=>{this.flags.value[e.key]=e.defaultValue}),this.overrides={},this.saveOverrides(),X.info("Feature flags reset to defaults")}enableExperimental(){Object.values(dl).forEach(e=>{e.experimental&&this.enable(e.key,!1)}),this.saveOverrides(),X.info("All experimental features enabled")}getState(){const e={};return Object.keys(dl).forEach(t=>{e[t]=this.isEnabled(t)}),e}getFlagInfo(e){return dl[e]}getAllFlags(){return Object.values(dl)}loadOverrides(){try{const e=localStorage.getItem("auditomatic_feature_flags");e&&(this.overrides=JSON.parse(e),Object.entries(this.overrides).forEach(([e,t])=>{e in this.flags.value&&(this.flags.value[e]=t)}),X.info("Loaded feature flag overrides",this.overrides))}catch(e){X.error("Failed to load feature flag overrides",e)}}saveOverrides(){try{localStorage.setItem("auditomatic_feature_flags",JSON.stringify(this.overrides))}catch(e){X.error("Failed to save feature flag overrides",e)}}applyURLParams(){new URLSearchParams(window.location.search).forEach((e,t)=>{if(t.startsWith("feature_")){const a=t.substring(8).toUpperCase(),l="true"===e||"1"===e;a in dl&&(this.overrides[a]=l,this.flags.value[a]=l,X.info(`Feature flag set from URL: ${a} = ${l}`))}})}enablePerformanceOptimizations(e="basic"){const t=["VIRTUAL_SCROLLING","WEB_WORKERS","DIFFERENTIAL_UPDATES"],a=["DATA_WINDOWING"];"basic"!==e&&"advanced"!==e&&"all"!==e||["OPTIMIZED_SORTING","SHALLOW_REACTIVITY","DEBOUNCED_UPDATES","PERFORMANCE_MONITORING"].forEach(e=>this.enable(e,!1)),"advanced"!==e&&"all"!==e||t.forEach(e=>this.enable(e,!1)),"all"===e&&a.forEach(e=>this.enable(e,!1)),this.saveOverrides(),X.info(`Performance optimizations enabled: ${e}`)}},ml=new Map;function fl(e,t={}){const a=n(0),l=pl.isEnabled("OPTIMIZED_SORTING"),s=r(()=>{a.value;const n=e.value;if(!n||0===n.length)return[];const r=t.compareFunction||((e,t)=>e<t?-1:e>t?1:0);t.trackPerformance&&Sa.start("optimizedSort");try{const e=t.cacheKey||(l?function(e,t){const a=e[0],l=e[e.length-1],n=e[Math.floor(e.length/2)];return`${e.length}-${JSON.stringify(a)?.slice(0,20)}-${JSON.stringify(n)?.slice(0,20)}-${JSON.stringify(l)?.slice(0,20)}-${t?.toString().slice(0,50)}`}(n,r):null);if(l&&e&&ml.has(e)){const a=ml.get(e);if(a.length===n.length){if(t.trackPerformance){const e=Sa.end("optimizedSort");X.debug(`Sort cache hit: ${e}ms`)}return a}}const a=l?function(e,t,a){return e.length<32?function(e,t,a){const l=a?e:[...e];for(let n=1;n<l.length;n++){const e=l[n];let a=n-1;for(;a>=0&&t(l[a],e)>0;)l[a+1]=l[a],a--;l[a+1]=e}return l}(e,t,a):function(e,t){for(let a=1;a<e.length;a++)if(t(e[a-1],e[a])>0)return!1;return!0}(e,t)?a?e:[...e]:(a?e:[...e]).sort(t)}(n,r,!1):[...n].sort(r);if(l&&e&&(ml.set(e,a),function(){if(ml.size>100){const e=Math.floor(ml.size/2),t=Array.from(ml.keys());for(let a=0;a<e;a++)ml.delete(t[a])}}()),t.trackPerformance){const e=Sa.end("optimizedSort");e>16&&Sa.logWarning(`Slow sort: ${e}ms for ${n.length} items`)}return a}catch(s){return t.trackPerformance&&Sa.end("optimizedSort"),X.error("Sort error:",s),[...n]}});return{sorted:s,resort:function(){a.value++},clearCache:function(){if(t.cacheKey)ml.delete(t.cacheKey);else if(e.value){const t=`${e.value.length}-`;Array.from(ml.keys()).filter(e=>e.startsWith(t)).forEach(e=>ml.delete(e))}a.value++}}}const vl={class:"results-table-container"},gl={class:"filters-bar"},hl={key:0,class:"queue-position"},yl={key:1},bl={key:0,class:"repeat-index"},wl={key:1,class:"text-secondary"},_l={key:3,class:"variables-compact"},kl={key:0,class:"text-secondary"},xl={key:1,class:"text-secondary"},Cl={key:2,class:"text-error"},Sl={key:3,class:"response-content"},Tl={key:0},Il={key:1},Ol={key:2},El={key:4,class:"text-secondary"},Pl={key:0,class:"parsed-response-content"},$l={key:1,class:"text-secondary"},Ml={key:0,class:"length-value"},Rl={key:1,class:"text-secondary"},Nl={key:0},Fl={key:1,class:"text-secondary"},Al="trial-results-visible-columns",Dl=le(o({__name:"TrialResultsTable",props:{trial:{},apiCalls:{},loading:{type:Boolean}},setup(e){const t=e,l=n(""),s=n(""),i=n(""),o=function(e,t=300){const a=n(e.value);let l;const r=c(e,e=>{clearTimeout(l),l=window.setTimeout(()=>{a.value=e},t)});return N()&&d(()=>{clearTimeout(l),r()}),a}(i,300),x=n(!1),S=n(null),T=n(["parsedResponse"]),I=r(()=>{const e=t.trial.repeatConfig?.callsPerPrompt?96:80;return pl.isEnabled("SHALLOW_REACTIVITY")?e:e+16}),O=(e,t="medium")=>{const a=$.value/1920,l="high"===t?Math.max(.8,Math.min(1.2,a)):"low"===t?Math.max(.6,Math.min(1,a)):Math.max(.7,Math.min(1.1,a));return Math.round(e*l)},E=r(()=>{const e=[{title:"Status",key:"status",dataIndex:"status",width:O(120,"high"),fixed:$.value>1200?"left":void 0},{title:"Configuration",key:"config",dataIndex:"configurationIndex",width:O(200,"medium")}];return fe(t.trial)&&e.push({title:"Repeat",key:"repeat",dataIndex:"repeatIndex",width:O(100,"low")}),e.push({title:"Variables",key:"variables",dataIndex:"variables",width:O(300,"medium")},{title:"Response",key:"response",dataIndex:"result",width:O(400,"high")},{title:"Parsed Response",key:"parsedResponse",dataIndex:"result",width:O(300,"medium")},{title:"Length",key:"length",dataIndex:"result",width:O(120,"low"),align:"right"},{title:"Latency",key:"latency",dataIndex:"response",width:O(120,"low"),align:"right"}),e}),P=r(()=>E.value.filter(e=>!T.value.includes(e.key))),$=n(window.innerWidth),M=n(window.innerHeight);wa(window,"resize",()=>{$.value=window.innerWidth,M.value=window.innerHeight});const j=r(()=>{const e=P.value.reduce((e,t)=>e+("number"==typeof t.width?t.width:parseInt(t.width||"200")),0),t=Math.max(400,M.value-350);return{x:Math.min(e,2*$.value),y:t}}),L=F([]),U=F([]);let z=0,q="";A(()=>{const e=t.apiCalls||[];if(e.length!==z)return z=e.length,void(U.value=e);let a=`${e.length}`;const l=Math.min(5,e.length),n=Math.max(1,Math.floor(e.length/l));for(let t=0;t<e.length;t+=n){const l=e[t];l&&(a+=`|${l.id}-${l.status}-${l.result?.success}-${l.response?.latencyMs}`)}a!==q&&(q=a,U.value=e)});const{sorted:V}=function(e,t={}){const a=e=>{switch(e){case"pending":return 1;case"running":return 2;case"completed":case"failed":return 3;default:return 4}};return fl(e,{...t,compareFunction:(e,t)=>{const l=a(e.status),n=a(t.status);if(l!==n)return l-n;const r=e.created instanceof Date?e.created.getTime():new Date(e.created).getTime(),s=t.created instanceof Date?t.created.getTime():new Date(t.created).getTime();return"pending"===e.status?r-s:s-r},cacheKey:`apiCall-${e.value.length}-${e.value[0]?.id||""}-${e.value[e.value.length-1]?.id||""}`})}(U,{trackPerformance:pl.isEnabled("PERFORMANCE_MONITORING")}),H=r(()=>pl.isEnabled("OPTIMIZED_SORTING")?V.value:U.value);let B="";A(()=>{const e=H.value.slice(0,3).map(e=>`${e.id}-${e.status}`).join(","),a=`${l.value}|${s.value}|${o.value}|${H.value.length}|${e}`;if(a===B)return;B=a,pl.isEnabled("PERFORMANCE_MONITORING")&&Sa.start("filterApiCalls");let n=H.value;if(l.value&&(n=n.filter(e=>e.status===l.value)),""!==s.value&&(n=n.filter(e=>e.configurationIndex===Number(s.value))),o.value){const e=o.value.toLowerCase();n=n.filter(t=>{if(JSON.stringify(t.variables).toLowerCase().includes(e))return!0;if(t.result?.content){if(String(t.result.content).toLowerCase().includes(e))return!0}return!1})}if(L.value=n,pl.isEnabled("PERFORMANCE_MONITORING")){const e=Sa.end("filterApiCalls");e>16&&Sa.logWarning(`Slow filter operation: ${e}ms for ${t.apiCalls.length} items`)}});const W=r(()=>L.value);function G(e){const a=t.trial.configurationSnapshots[e];return a?.name||`Config ${e+1}`}return u(()=>{const e=localStorage.getItem(Al);if(e)try{T.value=JSON.parse(e)}catch(t){console.error("Failed to load column preferences:",t),T.value=["parsedResponse"]}}),(e,t)=>{const n=h("a-select-option"),r=h("a-select"),o=h("a-input-search"),c=h("a-space"),u=h("a-button"),d=h("a-checkbox"),O=h("a-menu-item"),$=h("a-menu"),M=h("a-dropdown"),N=h("a-tag"),F=h("a-tooltip");return _(),p("div",vl,[m("div",gl,[a(c,{size:"large",style:{flex:"1"}},{default:y(()=>[a(r,{value:l.value,"onUpdate:value":t[0]||(t[0]=e=>l.value=e),placeholder:"All Statuses",style:{width:"200px"},size:"large","allow-clear":"","data-testid":"select-status-filter","aria-label":"Filter results by status"},{default:y(()=>[a(n,{value:""},{default:y(()=>t[7]||(t[7]=[k("All Statuses")])),_:1,__:[7]}),a(n,{value:"completed"},{default:y(()=>t[8]||(t[8]=[k("Completed")])),_:1,__:[8]}),a(n,{value:"failed"},{default:y(()=>t[9]||(t[9]=[k("Failed")])),_:1,__:[9]}),a(n,{value:"running"},{default:y(()=>t[10]||(t[10]=[k("Running")])),_:1,__:[10]}),a(n,{value:"pending"},{default:y(()=>t[11]||(t[11]=[k("Pending")])),_:1,__:[11]})]),_:1},8,["value"]),a(r,{value:s.value,"onUpdate:value":t[1]||(t[1]=e=>s.value=e),placeholder:"All Configurations",style:{width:"250px"},size:"large","allow-clear":"","data-testid":"select-config-filter","aria-label":"Filter results by configuration"},{default:y(()=>[a(n,{value:""},{default:y(()=>t[12]||(t[12]=[k("All Configurations")])),_:1,__:[12]}),(_(!0),p(b,null,w(e.trial.configurationSnapshots,(e,t)=>(_(),v(n,{key:`config-${e.name||t}`,value:t},{default:y(()=>[k(C(e.name||`Config ${t+1}`),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),a(o,{value:i.value,"onUpdate:value":t[2]||(t[2]=e=>i.value=e),placeholder:"Search variables or response...",style:{width:"400px",flex:"1"},size:"large","allow-clear":"","data-testid":"input-search-results","aria-label":"Search in variables or response content"},null,8,["value"])]),_:1}),a(c,null,{default:y(()=>[a(M,{trigger:["click"]},{overlay:y(()=>[a($,{class:"column-visibility-menu"},{default:y(()=>[(_(!0),p(b,null,w(E.value,e=>(_(),v(O,{key:e.key,onClick:t=>function(e){const t=T.value.indexOf(e);t>-1?T.value.splice(t,1):T.value.push(e),localStorage.setItem(Al,JSON.stringify(T.value))}(e.key)},{default:y(()=>[a(d,{checked:!T.value.includes(e.key),onClick:t[3]||(t[3]=R(()=>{},["prevent"]))},{default:y(()=>[k(C(e.title),1)]),_:2},1032,["checked"])]),_:2},1032,["onClick"]))),128))]),_:1})]),default:y(()=>[a(u,{size:"large","data-testid":"btn-column-visibility","aria-label":"Toggle column visibility"},{icon:y(()=>[a(g(ve))]),_:1})]),_:1}),a(u,{size:"large",type:"primary",onClick:t[4]||(t[4]=e=>x.value=!0),"data-testid":"btn-export-results-data","aria-label":"Export trial results data"},{icon:y(()=>[a(g(qe))]),default:y(()=>[t[13]||(t[13]=k(" Export Data "))]),_:1,__:[13]})]),_:1})]),a(Ta,{columns:P.value,"data-source":W.value,loading:e.loading,pagination:!1,scroll:j.value,size:"middle","row-key":"id",class:"results-table","custom-row":e=>({onClick:()=>{return t=e,void(S.value=t);var t},class:"clickable-row"}),"row-height":I.value,overscan:10,"force-virtual":!0},{bodyCell:y(({column:e,record:l})=>{return["status"===e.key?(_(),p(b,{key:0},[a(N,{color:(n=l.status,{completed:"success",failed:"error",running:"processing",pending:"default"}[n]||"default")},{default:y(()=>[k(C(l.status.toUpperCase()),1)]),_:2},1032,["color"]),"pending"===l.status&&l.queuePosition?(_(),p("span",hl," #"+C(l.queuePosition)+" in queue ",1)):f("",!0)],64)):f("",!0),"config"===e.key?(_(),p("code",yl,C(G(l.configurationIndex)),1)):f("",!0),"repeat"===e.key?(_(),p(b,{key:2},[void 0!==l.repeatIndex?(_(),p("span",bl," #"+C(l.repeatIndex+1),1)):(_(),p("span",wl,"-"))],64)):f("",!0),"variables"===e.key?(_(),p("div",_l,[(_(!0),p(b,null,w(l.variables,(e,t)=>(_(),v(F,{key:t},{title:y(()=>[k(C(t)+": "+C(e),1)]),default:y(()=>[a(N,null,{default:y(()=>{return[k(C(t)+": "+C((a=String(e),l=20,a.length<=l?a:a.substring(0,l)+"...")),1)];var a,l}),_:2},1024)]),_:2},1024))),128))])):f("",!0),"response"===e.key?(_(),p(b,{key:4},["pending"===l.status?(_(),p("div",kl," Waiting... ")):"running"===l.status?(_(),p("div",xl,[a(g(re)),t[14]||(t[14]=k(" Processing... "))])):"failed"===l.status?(_(),p("div",Cl,C(l.result?.error||"API call failed"),1)):l.result?.content?(_(),p("div",Sl,[l.result.parsedContent&&l.result.parsedContent!==l.result.content?T.value.includes("parsedResponse")?(_(),p("span",Il,[t[15]||(t[15]=m("span",{class:"parsed-label"},"Parsed:",-1)),k(" "+C(String(l.result.parsedContent))+" ",1),t[16]||(t[16]=m("br",null,null,-1)),t[17]||(t[17]=m("span",{class:"raw-label"},"Raw:",-1)),k(" "+C(String(l.result.content)),1)])):(_(),p("span",Ol,C(String(l.result.content)),1)):(_(),p("span",Tl,C(String(l.result.content)),1))])):(_(),p("div",El," No content "))],64)):f("",!0),"parsedResponse"===e.key?(_(),p(b,{key:5},[l.result?.parsedContent&&l.result.parsedContent!==l.result.content?(_(),p("div",Pl,[m("span",null,C(String(l.result.parsedContent)),1)])):(_(),p("div",$l," - "))],64)):f("",!0),"length"===e.key?(_(),p(b,{key:6},[l.result?.content?(_(),p("span",Ml,C(String(l.result.content).length),1)):(_(),p("span",Rl,"-"))],64)):f("",!0),"latency"===e.key?(_(),p(b,{key:7},[l.response?.latencyMs?(_(),p("span",Nl,C(l.response.latencyMs)+"ms ",1)):(_(),p("span",Fl,"-"))],64)):f("",!0)];var n}),_:1},8,["columns","data-source","loading","scroll","custom-row","row-height"]),x.value?(_(),v(D(()=>ge(()=>Promise.resolve().then(()=>Qs),void 0,import.meta.url)),{key:0,trial:e.trial,"api-calls":W.value,onClose:t[5]||(t[5]=e=>x.value=!1)},null,40,["trial","api-calls"])):f("",!0),S.value?(_(),v(ul,{key:1,"api-call":S.value,trial:e.trial,onClose:t[6]||(t[6]=e=>S.value=null)},null,8,["api-call","trial"])):f("",!0)])}}}),[["__scopeId","data-v-c3fdc337"]]),jl={class:"stats-grid"},Ll={class:"stat-item"},Ul={class:"stat-value"},zl={class:"stat-item"},ql={class:"stat-value"},Vl={class:"stat-item"},Hl={class:"stat-value"},Bl={class:"stat-item"},Wl={class:"stat-value"},Gl={class:"detail-sections"},Kl={class:"detail-row"},Jl={class:"detail-value"},Yl={class:"detail-value"},Ql={class:"detail-value"},Xl={key:0,class:"detail-row"},Zl={key:0,class:"separator"},en={key:1,class:"detail-row"},tn={class:"detail-value error"},an={key:2,class:"detail-row"},ln={key:0,class:"separator"},nn={key:3,class:"detail-row"},rn={class:"detail-value"},sn={key:4,class:"detail-row"},on={key:5,class:"detail-section"},cn={class:"template-preview"},un={key:0,class:"action-buttons"},dn=le(o({__name:"TrialDetailView",props:{trial:{},compact:{type:Boolean}},setup(e){const t=e,l=s(),i=J(),o=n(!1),c=r(()=>Y(t.trial)?t.trial.templateName:t.trial.spreadsheetName),u=r(()=>he(t.trial));function d(e,t){const a=t.getTime()-e.getTime(),l=Math.floor(a/36e5),n=Math.floor(a%36e5/6e4);return l>0?`${l}h ${n}m`:`${n}m`}async function S(){if(o.value)X.warn("Trial start already in progress",{trialId:t.trial.id});else{o.value=!0;try{const e=await i.executeTrialWithConfirmation(t.trial.id);if(e.needsConfirmation&&e.runningTrial){if(!(await new Promise(t=>{be.confirm({title:"Another Trial is Running",content:`"${e.runningTrial.name}" is currently running. Starting this trial will pause it. Continue?`,onOk:()=>t(!0),onCancel:()=>t(!1)})})))return;await i.executeTrialWithConfirmation(t.trial.id,!0)}X.info("Trial started",{trialId:t.trial.id})}catch(e){X.error("Failed to start trial",e),be.error({title:"Failed to start trial",content:e instanceof Error?e.message:"Unknown error"})}finally{o.value=!1}}}function T(){l.push({name:"trials",query:{tab:"create",duplicate:t.trial.id,edit:"true"}})}return(e,l)=>{const n=h("a-button");return _(),p("div",{class:x(["trial-detail-view",{compact:e.compact}])},[m("div",jl,[m("div",Ll,[a(g(ne),{class:"stat-icon-inline"}),l[0]||(l[0]=m("span",{class:"stat-label"},"Duration:",-1)),m("span",Ul,C(d(e.trial.created,e.trial.completed||new Date)),1)]),m("div",zl,[a(g($e),{class:"stat-icon-inline"}),l[1]||(l[1]=m("span",{class:"stat-label"},"Cost:",-1)),m("span",ql,"$"+C((e.trial.estimatedCost||0).toFixed(2)),1)]),m("div",Vl,[a(g(nt),{class:"stat-icon-inline"}),l[2]||(l[2]=m("span",{class:"stat-label"},"Models:",-1)),m("span",Hl,C(e.trial.configurationSnapshots?.length||0),1)]),m("div",Bl,[a(g(ye),{class:"stat-icon-inline"}),l[3]||(l[3]=m("span",{class:"stat-label"},"Design:",-1)),m("span",Wl,C(c.value),1)])]),m("div",Gl,[m("div",Kl,[l[4]||(l[4]=m("span",{class:"detail-label"},"Created:",-1)),m("span",Jl,C(new Date(e.trial.created).toLocaleString()),1),l[5]||(l[5]=m("span",{class:"detail-label"},"Repeats:",-1)),m("span",Yl,C(e.trial.repeatConfig?.callsPerPrompt||1)+"x",1),l[6]||(l[6]=m("span",{class:"detail-label"},"Variables:",-1)),m("span",Ql,C((Y(t.trial)&&t.trial.variableSnapshots.length>0?t.trial.variableSnapshots[0].originalListName:Q(t.trial)?t.trial.datasetName:null)||"None"),1)]),e.trial.configurationSnapshots?.length>0?(_(),p("div",Xl,[l[7]||(l[7]=m("span",{class:"detail-label"},"Models:",-1)),(_(!0),p(b,null,w(e.trial.configurationSnapshots,(t,l)=>(_(),p("span",{key:`trial-config-${t.name}-${l}`,class:"model-inline"},[a(g(nt)),k(" "+C(t.name)+" ("+C(t.provider)+", temp: "+C(t.parameters?.temperature||.7)+") ",1),l<e.trial.configurationSnapshots.length-1?(_(),p("span",Zl,"•")):f("",!0)]))),128))])):f("",!0),e.trial.progress.networkErrors>0?(_(),p("div",en,[l[8]||(l[8]=m("span",{class:"detail-label"},"Issues:",-1)),m("span",tn,C(e.trial.progress.networkErrors)+" network errors occurred",1)])):f("",!0),g(Y)(e.trial)&&e.trial.variableSnapshots&&e.trial.variableSnapshots.length>0?(_(),p("div",an,[l[9]||(l[9]=m("span",{class:"detail-label"},"Variables Used:",-1)),(_(!0),p(b,null,w(e.trial.variableSnapshots,(t,a)=>(_(),p("span",{key:t.variableName,class:"detail-value"},[m("strong",null,C(t.variableName),1),k(" from "+C(t.originalListName)+" ("+C(t.data.itemCount)+" values) ",1),a<e.trial.variableSnapshots.length-1?(_(),p("span",ln,"•")):f("",!0)]))),128))])):f("",!0),g(Q)(e.trial)?(_(),p("div",nn,[l[10]||(l[10]=m("span",{class:"detail-label"},"Dataset:",-1)),m("span",rn,C(e.trial.datasetName)+" ("+C(e.trial.totalRows)+" rows)",1)])):f("",!0),"failed"===e.trial.status?(_(),p("div",sn,l[11]||(l[11]=[m("span",{class:"detail-label"},"Status:",-1),m("span",{class:"detail-value error"},"Trial failed - check task details for more information",-1)]))):f("",!0),u.value?(_(),p("div",on,[m("h4",null,[a(g(ye)),l[12]||(l[12]=k(" Prompt Template"))]),m("div",cn,[m("pre",null,C(u.value),1)])])):f("",!0)]),"draft"===e.trial.status?(_(),p("div",un,[o.value?(_(),v(n,{key:0,type:"primary",disabled:!0},{icon:y(()=>[a(g(re),{spin:""})]),default:y(()=>[l[13]||(l[13]=k(" Starting... "))]),_:1,__:[13]})):(_(),v(n,{key:1,type:"primary",onClick:S,disabled:o.value},{icon:y(()=>[a(g(se))]),default:y(()=>[l[14]||(l[14]=k(" Start Trial "))]),_:1,__:[14]},8,["disabled"])),a(n,{onClick:T},{icon:y(()=>[a(g(ue))]),default:y(()=>[l[15]||(l[15]=k(" Edit Configuration "))]),_:1,__:[15]})])):f("",!0)],2)}}}),[["__scopeId","data-v-7ef29e11"]]),pn=l("taskMonitoring",()=>{const e=F([]),t=F([]);let a=null,l=null;const n=r(()=>{let t=0,a=0,l=0,n=0,r=0;for(const s of e.value)switch(s.status){case"pending":t++;break;case"running":a++;break;case"completed":l++;break;case"failed":n++;break;case"cancelled":r++}return{pending:t,running:a,completed:l,failed:n,cancelled:r,total:e.value.length}}),s=r(()=>{const e=t.value.filter(e=>"running"===e.status);return 0===e.length?null:(e.sort((e,t)=>(e.started?.getTime()||0)-(t.started?.getTime()||0)),e[0])}),i=r(()=>{const a=new Map,l=we.getAllGroups();for(const e of l)a.set(e,{provider:e,pending:0,running:0,completed:0,failed:0});for(const n of e.value){const e=t.value.find(e=>e.id===n.trialId);if(!e)continue;const l=e.configurationSnapshots[n.configurationIndex];if(!l)continue;const r=we.getProviderGroup(l.provider),s=a.get(r);if(s)switch(n.status){case"pending":s.pending++;break;case"running":s.running++;break;case"completed":s.completed++;break;case"failed":s.failed++}}return Array.from(a.values()).filter(e=>e.pending>0||e.running>0||e.completed>0||e.failed>0)});let o=0;return{allApiCalls:e,trials:t,globalStats:n,providerStats:i,activeTrial:s,getTrialStats:function(a){const l=e.value.filter(e=>e.trialId===a);let n=0,r=0,s=0,i=0;for(const e of l)switch(e.status){case"pending":n++;break;case"running":r++;break;case"completed":s++;break;case"failed":i++}let o=0;if(n>0){const l=t.value.find(e=>e.id===a);l&&l.created&&(o=e.value.filter(e=>{if("pending"!==e.status||e.trialId===a)return!1;const n=t.value.find(t=>t.id===e.trialId);return n&&n.created&&n.created<l.created}).length)}return{pending:n,running:r,completed:s,failed:i,total:l.length,queuePosition:o}},initialize:function(){o++,a||l?X.debug("Task monitoring store already initialized",{count:o}):(a=De(async()=>{const e=(await _e.trials.where("status").anyOf(["running","paused"]).toArray()).map(e=>e.id);if(0===e.length)return[];return(await _e.apiCalls.where("trialId").anyOf(e).toArray()).map(e=>({id:e.id,trialId:e.trialId,status:e.status,configurationIndex:e.configurationIndex}))}).subscribe({next:t=>{e.value=t},error:e=>{X.error("Error in API calls subscription",e)}}),l=De(()=>_e.trials.toArray()).subscribe({next:e=>{t.value=e},error:e=>{X.error("Error in trials subscription",e)}}))},destroy:function(){o--,o>0?X.debug("Task monitoring store still has references",{count:o}):(a&&(a.unsubscribe(),a=null),l&&(l.unsubscribe(),l=null),X.debug("Task monitoring store destroyed"))}}});const mn={class:"header-left"},fn={class:"queue-title"},vn={key:0,class:"mini-dashboard"},gn={class:"mini-stat"},hn={class:"mini-value"},yn={class:"mini-stat"},bn={class:"mini-value"},wn={class:"mini-stat"},_n={class:"mini-value"},kn={class:"mini-stat error"},xn={class:"mini-value"},Cn={class:"mini-stat active-trial"},Sn={class:"leader-status"},Tn={class:"expandable-content"},In={key:0,class:"active-trial-banner"},On={class:"active-text"},En={class:"queue-stats-grid"},Pn={class:"stat-card"},$n={class:"stat-value"},Mn={class:"stat-card"},Rn={class:"stat-value"},Nn={class:"stat-card"},Fn={class:"stat-value"},An={class:"stat-card"},Dn={class:"stat-value"},jn={key:1,class:"provider-section"},Ln={class:"section-subtitle"},Un={class:"provider-list"},zn={class:"provider-header"},qn={class:"provider-name"},Vn={key:0,class:"provider-status"},Hn={class:"provider-counts"},Bn={key:1,class:"provider-status"},Wn={class:"concurrency-gauge"},Gn={class:"gauge-label"},Kn={class:"gauge-value"},Jn={class:"gauge-info"},Yn={key:2,class:"trial-queue-section"},Qn={class:"trial-queue-stats"},Xn={class:"trial-stat"},Zn={class:"trial-stat-value"},er=le(o({__name:"QueueStatusPanel",props:{trialId:{},trial:{},compact:{type:Boolean,default:!1}},setup(e){const t=e,l=n(!1);function s(){l.value=!l.value}const{isLeader:i,queueStats:o,providerStats:c}=function(){const e=pn(),t=ke();return u(()=>{e.initialize()}),d(()=>{e.destroy()}),{isLeader:n(!0),leaderId:n("browser-native"),queueStats:r(()=>({pending:e.globalStats.pending,reserved:0,executing:e.globalStats.running,completed:e.globalStats.completed,failed:e.globalStats.failed,buried:e.globalStats.cancelled,total:e.globalStats.total})),providerStats:r(()=>e.providerStats.map(e=>{let a=t.getGroupConcurrency(e.provider);if(void 0===a){const t=we.getProvidersInGroup(e.provider);a=1;for(const e of t)e.execution?.defaultConcurrency&&(a=Math.max(a,e.execution.defaultConcurrency))}const l=a>0?Math.round(e.running/a*100):0;return{provider:e.provider,pending:e.pending,executing:e.running,rateLimit:{tokens:a-e.running,requestsPerSecond:a,burstSize:a,utilization:l}}})),rateLimits:n({}),getTrialQueueInfo:function(t){return r(()=>{const a=e.getTrialStats(t);return{position:a.queuePosition,pending:a.pending,executing:a.running,completed:a.completed}})},getTaskInfo:async function(e){},refreshStats:async function(){},refreshRateLimits:async function(){},destroy:function(){e.destroy()}}}(),S=pn(),T=r(()=>t.trialId?null:S.activeTrial);u(()=>{t.trialId||S.initialize()}),d(()=>{t.trialId||S.destroy()});const I=r(()=>t.trialId||""),O=t.trialId?function(e){const t=pn(),a=n([]),l=r(()=>{const a=t.getTrialStats(e.value);return{pending:a.pending,reserved:0,executing:a.running,completed:a.completed,failed:a.failed,buried:0,queuePosition:a.queuePosition}});return u(()=>{t.initialize()}),{tasks:a,stats:l,destroy:function(){}}}(I):null,E=r(()=>O?O.stats.value:{pending:0,executing:0,queuePosition:0}),P=r(()=>{if(t.trialId&&E.value){const e=t.trial?.progress||{completed:0,failed:0};return{pending:E.value.pending||0,executing:E.value.executing||0,completed:e.completed||0,failed:e.failed||0}}return o.value}),$=r(()=>{if(!t.trialId||!t.trial)return c.value;const e=new Set;return t.trial.configurationSnapshots&&t.trial.configurationSnapshots.forEach(t=>{if(t.provider){const a=we.getProviderGroup(t.provider);e.add(t.provider),e.add(a)}}),c.value.filter(t=>e.has(t.provider)).map(e=>({...e,pending:0,executing:0,rateLimit:e.rateLimit}))});return(e,t)=>{const n=h("router-link"),r=h("a-tag"),o=h("a-progress");return _(),p("div",{class:x(["queue-status-panel",{collapsed:l.value}])},[m("div",{class:"queue-header",onClick:s},[m("div",mn,[a(g(Ae),{class:x(["collapse-icon",{rotated:!l.value}])},null,8,["class"]),m("h3",fn,[a(g(xe)),k(" "+C(e.trialId?"Trial Progress":"Global Task Queue (All Trials)"),1)]),l.value?(_(),p("div",vn,[m("span",gn,[m("span",hn,C(P.value.pending),1),t[0]||(t[0]=k(" pending "))]),t[6]||(t[6]=m("span",{class:"mini-divider"},"|",-1)),m("span",yn,[m("span",bn,C(P.value.executing),1),t[1]||(t[1]=k(" running "))]),t[7]||(t[7]=m("span",{class:"mini-divider"},"|",-1)),m("span",wn,[m("span",_n,C(P.value.completed),1),t[2]||(t[2]=k(" done "))]),P.value.failed>0?(_(),p(b,{key:0},[t[4]||(t[4]=m("span",{class:"mini-divider"},"|",-1)),m("span",kn,[m("span",xn,C(P.value.failed),1),t[3]||(t[3]=k(" failed "))])],64)):f("",!0),T.value&&!e.trialId?(_(),p(b,{key:1},[t[5]||(t[5]=m("span",{class:"mini-divider"},"|",-1)),m("span",Cn,[a(g(se)),k(" "+C(T.value.name),1)])],64)):f("",!0)])):f("",!0)]),m("div",Sn,[g(i)?(_(),p(b,{key:0},[a(g(Ce),{class:"leader-icon active"}),t[8]||(t[8]=m("span",{class:"leader-text"},"Queue Processor (Leader)",-1))],64)):(_(),p(b,{key:1},[a(g(Se),{class:"leader-icon"}),t[9]||(t[9]=m("span",{class:"leader-text"},"Observer",-1))],64))])]),j(m("div",Tn,[!e.trialId&&T.value?(_(),p("div",In,[a(g(se),{class:"active-icon"}),m("span",On,"Active Trial: "+C(T.value.name),1),a(n,{to:`/trials/${T.value.id}`,class:"active-link"},{default:y(()=>[t[10]||(t[10]=k(" View ")),a(g(Te))]),_:1,__:[10]},8,["to"])])):f("",!0),m("div",En,[m("div",Pn,[m("div",$n,C(P.value.pending),1),t[11]||(t[11]=m("div",{class:"stat-label"},"Pending",-1))]),m("div",Mn,[m("div",Rn,C(P.value.executing),1),t[12]||(t[12]=m("div",{class:"stat-label"},"Executing",-1))]),m("div",Nn,[m("div",Fn,C(P.value.completed),1),t[13]||(t[13]=m("div",{class:"stat-label"},"Completed",-1))]),m("div",An,[m("div",Dn,C(P.value.failed),1),t[14]||(t[14]=m("div",{class:"stat-label"},"Failed",-1))])]),$.value.length>0?(_(),p("div",jn,[m("h4",Ln,C(e.trialId?"Trial Provider Status":"Provider Status"),1),m("div",Un,[(_(!0),p(b,null,w($.value,l=>{return _(),p("div",{key:l.provider,class:"provider-item"},[m("div",zn,[m("span",qn,C(l.provider),1),e.trialId?(_(),p("div",Bn,[a(r,{color:"blue",size:"small"},{default:y(()=>t[15]||(t[15]=[k("Used by this trial")])),_:1,__:[15]})])):(_(),p("div",Vn,[m("div",Hn,[l.pending>0?(_(),v(r,{key:0,color:"blue"},{default:y(()=>[k(C(l.pending)+" pending ",1)]),_:2},1024)):f("",!0),l.executing>0?(_(),v(r,{key:1,color:"green"},{default:y(()=>[k(C(l.executing)+" running ",1)]),_:2},1024)):f("",!0)])]))]),m("div",Wn,[m("div",Gn,[t[16]||(t[16]=m("span",null,"Concurrency",-1)),m("span",Kn,C(l.rateLimit.utilization)+"% slots used ",1)]),a(o,{percent:l.rateLimit.utilization,"stroke-color":(n=l.rateLimit.utilization,n<50?"#52c41a":n<80?"#faad14":"#f5222d"),"show-info":!1,size:"small"},null,8,["percent","stroke-color"]),m("div",Jn,C(l.rateLimit.requestsPerSecond)+" max concurrent ",1)])]);var n}),128))])])):f("",!0),e.trialId?(_(),p("div",Yn,[t[18]||(t[18]=m("h4",{class:"section-subtitle"},"Additional Info",-1)),m("div",Qn,[m("div",Xn,[t[17]||(t[17]=m("span",{class:"trial-stat-label"},"Queue Position:",-1)),m("span",Zn,C(E.value.queuePosition||"Processing"),1)])])])):f("",!0)],512),[[L,!l.value]])],2)}}}),[["__scopeId","data-v-f7f4d7f6"]]);function tr(e,t){const a=new Set,l=new Set,n=new Set;e.forEach(e=>{e.variables&&Object.keys(e.variables).forEach(e=>a.add(e)),e.variableAttributes&&Object.values(e.variableAttributes).forEach(e=>{e&&Object.keys(e).forEach(e=>l.add(e))})});const r=Array.from(a).sort(),s=Array.from(l).sort(),i=Array.from(n).sort(),o=[];t&&(Y(t)||Q(t))&&t.extractPattern&&o.push("extracted_value");const c=["success","refused",...o,...i];return{categorical:[...r,...s,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens","extracted_value",...o].sort(),extracted:c}}function ar(e,t,a){switch(t){case"model":if(a&&e.configurationIndex<a.configurationSnapshots.length){return a.configurationSnapshots[e.configurationIndex].modelId||"Unknown"}return"Unknown";case"status":return e.status;case"response_time":return e.response?.latencyMs||0;case"total_tokens":if(e.response?.body?.usage){const t=e.response.body.usage;return t.total_tokens||t.prompt_tokens+t.completion_tokens||0}return 0;case"prompt_tokens":return e.response?.body?.usage?.prompt_tokens||e.response?.body?.usage?.input_tokens||0;case"completion_tokens":return e.response?.body?.usage?.completion_tokens||e.response?.body?.usage?.output_tokens||0;case"error_type":return e.result?.errorType||(!1===e.result?.success?"api_error":"success");case"success":return e.result?.success?1:0;case"refused":return e.result?.refused?1:0;case"extracted_value":if(e.result?.success&&void 0!==e.result?.content){const t=String(e.result.content),a=parseFloat(t);return isNaN(a)||t.trim()!==String(a)?t:a}return null}if(void 0!==e.variables?.[t])return e.variables[t];if(e.variableAttributes)for(const l of Object.keys(e.variableAttributes)){const a=e.variableAttributes[l];if(a&&void 0!==a[t])return a[t]}return null}const lr={count:{label:"Count",calculate:e=>e.length,format:e=>e.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?t.reduce((e,t)=>e+t,0):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},mean:{label:"Mean",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?t.reduce((e,t)=>e+t,0)/t.length:null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},median:{label:"Median",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);if(0===t.length)return null;const a=[...t].sort((e,t)=>e-t),l=Math.floor(a.length/2);return a.length%2==0?(a[l-1]+a[l])/2:a[l]},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},mode:{label:"Mode",calculate:e=>{if(0===e.length)return null;const t=new Map;e.forEach(e=>t.set(e,(t.get(e)||0)+1));let a=0,l=null;return t.forEach((e,t)=>{e>a&&(a=e,l=t)}),{value:l,count:a,total:e.length}},format:e=>e?`${e.value} (${e.count}/${e.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);if(t.length<=1)return null;const a=t.reduce((e,t)=>e+t,0)/t.length;return t.reduce((e,t)=>e+Math.pow(t-a,2),0)/(t.length-1)},format:e=>e?.toFixed(3)||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:e=>{const t=lr.variance.calculate(e);return null!==t?Math.sqrt(t):null},format:e=>e?.toFixed(3)||"-",needsNumeric:!0},min:{label:"Min",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?Math.min(...t):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},max:{label:"Max",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?Math.max(...t):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(e,t)=>{const a=t.filter(e=>e.result?.success).length;return t.length>0?a/t.length:0},format:e=>`${Math.round(100*e)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(e,t)=>{const a=t.filter(e=>e.result?.refused).length;return t.length>0?a/t.length:0},format:e=>`${Math.round(100*e)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(e,t)=>{const a=t.filter(e=>e.response?.latencyMs).map(e=>e.response.latencyMs);return a.length>0?a.reduce((e,t)=>e+t,0)/a.length:null},format:e=>e?`${Math.round(e)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function nr(e,t){if(!e||null===e.value)return"-";return lr[t].format(e.value)}const rr={"blue-subtle":{name:"Blue (Subtle)",colors:["rgba(59, 130, 246, 0.1)","rgba(59, 130, 246, 0.3)","rgba(59, 130, 246, 0.7)"]},"green-red":{name:"Green-Red",colors:["#dc2626","#fbbf24","#10b981"]},"blue-yellow":{name:"Blue-Yellow",colors:["#1e40af","#3b82f6","#fbbf24"]},"purple-orange":{name:"Purple-Orange",colors:["#7c3aed","#a855f7","#ff9500"]},grayscale:{name:"Grayscale",colors:["#f3f4f6","#9ca3af","#374151"]},viridis:{name:"Viridis",colors:["#440154","#482878","#3e4989","#31688e","#26828e","#1f9e89","#35b779","#6ece58","#b5de2b","#fde725"]},inferno:{name:"Inferno",colors:["#000004","#1b0c41","#4a0c6b","#781c6d","#a52c60","#cf4446","#ed6925","#fb9b06","#f7d13d","#fcffa4"]},magma:{name:"Magma",colors:["#000004","#180f3d","#440f76","#721f81","#9e2f7f","#cd4071","#f1605d","#fd9668","#feca8d","#fcfdbf"]},plasma:{name:"Plasma",colors:["#0d0887","#46039f","#7201a8","#9c179e","#bd3786","#d8576b","#ed7953","#fb9f3a","#fdca26","#f0f921"]}};function sr(e,t){if(0===t.length)return"transparent";if(1===t.length)return t[0];e=Math.max(0,Math.min(1,e));const a=1/(t.length-1),l=Math.floor(e/a),n=e%a/a;return ir(t[Math.min(l,t.length-1)],t[Math.min(l+1,t.length-1)],n)}function ir(e,t,a){if(e.startsWith("rgba")&&t.startsWith("rgba")){const l=e=>{const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]*)\)/);return t?{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:t[4]?parseFloat(t[4]):1}:null},n=l(e),r=l(t);if(n&&r){return`rgba(${Math.round(n.r+(r.r-n.r)*a)}, ${Math.round(n.g+(r.g-n.g)*a)}, ${Math.round(n.b+(r.b-n.b)*a)}, ${(n.a+(r.a-n.a)*a).toFixed(2)})`}}if(e.startsWith("rgba")||t.startsWith("rgba"))return a<.5?e:t;const l=e.replace("#",""),n=t.replace("#",""),r=parseInt(l.substr(0,2),16),s=parseInt(l.substr(2,2),16),i=parseInt(l.substr(4,2),16),o=parseInt(n.substr(0,2),16),c=parseInt(n.substr(2,2),16),u=parseInt(n.substr(4,2),16),d=Math.round(r+(o-r)*a),p=Math.round(s+(c-s)*a),m=Math.round(i+(u-i)*a);return`#${d.toString(16).padStart(2,"0")}${p.toString(16).padStart(2,"0")}${m.toString(16).padStart(2,"0")}`}function or(e){let t,a,l;if(e.startsWith("rgba")){const n=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]*)\)/);if(!n)return!1;t=parseInt(n[1]),a=parseInt(n[2]),l=parseInt(n[3])}else{const n="#"===e.charAt(0)?e.substring(1,7):e;t=parseInt(n.substring(0,2),16),a=parseInt(n.substring(2,4),16),l=parseInt(n.substring(4,6),16)}const n=[t/255,a/255,l/255].map(e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*n[0]+.7152*n[1]+.0722*n[2]<=.179}function cr(e){return or(e)?"#FFFFFF":"#000000"}function ur(e,t,a){const{colorScales:l,interpolateColor:n,getContrastColor:s}={colorScales:rr,interpolateColor:sr,interpolateBetweenColors:ir,colorIsDarkAdvanced:or,getContrastColor:cr};function i(e){if("number"==typeof e)return e;if("string"==typeof e){const t=parseFloat(e);return isNaN(t)?null:t}return null}return{getCellStyle:function(r,o,c){if(!r||null===r.value||"number"!=typeof r.value)return{};const u=l[t.value];if(!u)return{};const d=function(t,l,n){const r=i(t.value);if(null===r)return.5;if("global"===a.value){const t=e.value.rows.flatMap(e=>e.cells).filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(t.length>0){const e=Math.min(...t),a=Math.max(...t);if(a!==e)return(r-e)/(a-e)}}else if("column"===a.value){const t=e.value.rows.map(e=>e.cells[n]).filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(t.length>0){const e=Math.min(...t),a=Math.max(...t);if(a!==e)return(r-e)/(a-e)}}else if("row"===a.value){const t=e.value.rows.find(e=>e.label===l);if(t){const e=t.cells.filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(e.length>0){const t=Math.min(...e),a=Math.max(...e);if(a!==t)return(r-t)/(a-t)}}}return.5}(r,o,c),p=n(d,u.colors);return{backgroundColor:`${p} !important`,color:`${s(p)} !important`,fontSize:"15px !important",fontWeight:"600 !important"}},getSummaryStyle:function(a){if(!a||null===a.value||"number"!=typeof a.value)return{};const r=l[t.value];if(!r)return{};let o=.5;const c=e.value.rows.flatMap(e=>e.cells).filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(c.length>0){const e=Math.min(...c),t=Math.max(...c),l=i(a.value);null!==l&&(o=t!==e?(l-e)/(t-e):.5)}const u=n(o,r.colors);return{backgroundColor:`${u} !important`,color:`${s(u)} !important`,fontSize:"15px !important",fontWeight:"600 !important"}},styleKey:r(()=>`${t.value}-${a.value}`)}}const dr={class:"pivot-config"},pr={class:"config-row"},mr={class:"config-group"},fr=["value","aria-label"],vr={label:"Categorical"},gr=["value"],hr={class:"config-group"},yr=["value","aria-label"],br={label:"Categorical"},wr=["value"],_r={class:"config-group"},kr=["value","aria-label"],xr={label:"Extracted Values"},Cr=["value"],Sr={label:"Numeric Fields"},Tr=["value"],Ir={class:"config-group"},Or=["value","aria-label"],Er=le(o({__name:"PivotConfiguration",props:{config:{},availableFields:{}},emits:["update-config"],setup(e,{emit:t}){const a=t;function l(e,t){a("update-config",e,t)}function n(e){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[e]||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}return(e,t)=>(_(),p("div",dr,[m("div",pr,[m("div",mr,[t[4]||(t[4]=m("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),m("select",{id:"pivot-row-field",value:e.config.rowField,"aria-label":"Group rows by "+n(e.config.rowField),onChange:t[0]||(t[0]=e=>l("rowField",e.target.value))},[m("optgroup",vr,[(_(!0),p(b,null,w(e.availableFields.categorical,e=>(_(),p("option",{key:e,value:e},C(n(e)),9,gr))),128))])],40,fr)]),m("div",hr,[t[5]||(t[5]=m("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),m("select",{id:"pivot-column-field",value:e.config.columnField,"aria-label":"Group columns by "+n(e.config.columnField),onChange:t[1]||(t[1]=e=>l("columnField",e.target.value))},[m("optgroup",br,[(_(!0),p(b,null,w(e.availableFields.categorical,e=>(_(),p("option",{key:e,value:e},C(n(e)),9,wr))),128))])],40,yr)]),m("div",_r,[t[6]||(t[6]=m("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),m("select",{id:"pivot-value-field",value:e.config.valueField,"aria-label":"Aggregate "+e.config.valueField+" values",onChange:t[2]||(t[2]=e=>l("valueField",e.target.value))},[m("optgroup",xr,[(_(!0),p(b,null,w(e.availableFields.extracted,e=>(_(),p("option",{key:e,value:e},C(e),9,Cr))),128))]),m("optgroup",Sr,[(_(!0),p(b,null,w(e.availableFields.numeric,e=>(_(),p("option",{key:e,value:e},C(n(e)),9,Tr))),128))])],40,kr)]),m("div",Ir,[t[8]||(t[8]=m("label",{for:"pivot-aggregation"},"Aggregation:",-1)),m("select",{id:"pivot-aggregation",value:e.config.aggregation,"aria-label":"Aggregation method: "+e.config.aggregation,onChange:t[3]||(t[3]=e=>l("aggregation",e.target.value))},t[7]||(t[7]=[U('<optgroup label="Statistical" data-v-efb8a7c2><option value="mean" data-v-efb8a7c2>Mean</option><option value="median" data-v-efb8a7c2>Median</option><option value="variance" data-v-efb8a7c2>Variance</option><option value="std_dev" data-v-efb8a7c2>Std Dev</option><option value="min" data-v-efb8a7c2>Min</option><option value="max" data-v-efb8a7c2>Max</option></optgroup><optgroup label="Frequency" data-v-efb8a7c2><option value="count" data-v-efb8a7c2>Count</option><option value="mode" data-v-efb8a7c2>Mode</option></optgroup><optgroup label="Performance" data-v-efb8a7c2><option value="success_rate" data-v-efb8a7c2>Success Rate</option><option value="refusal_rate" data-v-efb8a7c2>Refusal Rate</option><option value="avg_time" data-v-efb8a7c2>Avg Time</option></optgroup>',3)]),40,Or)])])]))}}),[["__scopeId","data-v-efb8a7c2"]]),Pr={class:"heatmap-controls"},$r={class:"color-scale-selector"},Mr=["value","aria-label"],Rr={class:"gradient-mode-selector"},Nr={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},Fr=["aria-pressed"],Ar=["aria-pressed"],Dr=["aria-pressed"],jr=["title","aria-label"],Lr=le(o({__name:"PivotHeatmapControls",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(e,{emit:t}){const a=t;function l(e){const t=e.target.value;a("update-color-scale",t)}function n(e){a("update-gradient-mode",e)}return(e,t)=>(_(),p("div",Pr,[m("div",$r,[t[5]||(t[5]=m("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),m("select",{id:"heatmap-color-scale",value:e.selectedColorScale,"aria-label":"Color scale: "+e.selectedColorScale,onChange:l},t[4]||(t[4]=[U('<option value="blue-subtle" data-v-4b4f9d62>Blue (Subtle)</option><option value="green-red" data-v-4b4f9d62>Green-Red (Success)</option><option value="blue-yellow" data-v-4b4f9d62>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-4b4f9d62>Purple-Orange (General)</option><option value="viridis" data-v-4b4f9d62>Viridis</option><option value="inferno" data-v-4b4f9d62>Inferno</option><option value="magma" data-v-4b4f9d62>Magma</option><option value="plasma" data-v-4b4f9d62>Plasma</option><option value="grayscale" data-v-4b4f9d62>Grayscale</option>',9)]),40,Mr)]),m("div",Rr,[t[6]||(t[6]=m("label",null,"Gradient Mode:",-1)),m("div",Nr,[m("button",{type:"button",class:x(["toggle-btn",{active:"global"===e.gradientMode}]),"aria-pressed":"global"===e.gradientMode,onClick:t[0]||(t[0]=e=>n("global"))}," Global ",10,Fr),m("button",{type:"button",class:x(["toggle-btn",{active:"column"===e.gradientMode}]),"aria-pressed":"column"===e.gradientMode,onClick:t[1]||(t[1]=e=>n("column"))}," Per Column ",10,Ar),m("button",{type:"button",class:x(["toggle-btn",{active:"row"===e.gradientMode}]),"aria-pressed":"row"===e.gradientMode,onClick:t[2]||(t[2]=e=>n("row"))}," Per Row ",10,Dr)])]),m("button",{type:"button",class:"fullscreen-btn",title:e.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":e.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:t[3]||(t[3]=t=>e.$emit("toggle-fullscreen"))},C(e.isFullscreen?"⊟":"⊞"),9,jr)]))}}),[["__scopeId","data-v-4b4f9d62"]]),Ur={class:"filters-row"},zr={key:0,class:"filter-group"},qr=["value"],Vr=["for"],Hr=["id","onUpdate:modelValue","aria-label"],Br={value:""},Wr=["value"],Gr={key:1,class:"filter-group"},Kr=["value"],Jr={class:"table-view"},Yr={key:0,class:"empty-state","data-testid":"empty-data-message"},Qr={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},Xr={key:2,class:"pivot-table-container"},Zr={class:"pivot-table-grid responsive-table",role:"table"},es={role:"row"},ts={class:"corner-cell",role:"columnheader"},as={key:0,class:"total-header",role:"columnheader"},ls={class:"row-header",role:"rowheader"},ns=["data-testid","title","aria-label","role","onClick","onKeydown"],rs={key:0,class:"cell-content"},ss=["title"],is={class:"cell-value"},os={class:"error-message"},cs={key:1},us=le(o({__name:"PivotTableCore",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0}},emits:["config-change","cell-click"],setup(e,{emit:t}){const l=e,s=t,i=n(!1),o=n("viridis"),u=n("global"),v=n({rowField:l.config?.rowField||"",columnField:l.config?.columnField||"",valueField:l.config?.valueField||"",aggregation:l.config?.aggregation||"mean"});c(()=>l.config,e=>{e&&Object.assign(v.value,e)},{deep:!0});const h=n({}),y=n([]),k=r(()=>Object.values(h.value).some(e=>""!==e)),T=F(tr(l.apiCalls,l.trial));let I=0;c(()=>l.apiCalls,e=>{if(0===e.length||0===I||e.length-I>=10){const t=y.value.length>0||k.value?y.value:e;T.value=tr(t,l.trial),I=e.length}},{immediate:!0});const O=F({});let E=0;c(()=>l.apiCalls.length,e=>{(0===e||0===E||e-E>=5)&&((()=>{if(0===l.apiCalls.length)return void(O.value={});const e={};l.apiCalls.forEach(t=>{if(l.trial&&t.configurationIndex<l.trial.configurationSnapshots.length){const a=l.trial.configurationSnapshots[t.configurationIndex].modelId||"Unknown";e.model||(e.model=new Set),e.model.add(a)}t.status&&(e.status||(e.status=new Set),e.status.add(t.status)),t.variables&&Object.entries(t.variables).forEach(([t,a])=>{a&&String(a).trim()&&(e[t]||(e[t]=new Set),e[t].add(String(a)))})});const t={};Object.entries(e).forEach(([e,a])=>{t[e]=Array.from(a).sort()}),O.value=t})(),E=e)},{immediate:!0});const P=r(()=>{const{model:e,status:t,...a}=O.value;return a});function $(){y.value=l.apiCalls.filter(e=>{if(h.value.model&&""!==h.value.model){if(!l.trial||e.configurationIndex>=l.trial.configurationSnapshots.length)return!1;if((l.trial.configurationSnapshots[e.configurationIndex].modelId||"Unknown")!==h.value.model)return!1}if(h.value.status&&""!==h.value.status&&e.status!==h.value.status)return!1;for(const[t,a]of Object.entries(h.value))if(a&&""!==a&&"model"!==t&&"status"!==t){const l=e.variables?.[t];if(l!==a)return!1}return!0})}function M(){h.value={},$()}c(()=>l.apiCalls,()=>{k.value?$():y.value=l.apiCalls},{immediate:!0});const N=r(()=>{const e=y.value.length>0||k.value?y.value:l.apiCalls;return 0===e.length?{rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}:function(e,t,a){const l=new Map,n=new Set,r=new Set;e.forEach(e=>{const s=String(ar(e,t.rowField,a)||"Unknown"),i=String(ar(e,t.columnField,a)||"Unknown");n.add(s),r.add(i),l.has(s)||l.set(s,new Map),l.get(s).has(i)||l.get(s).set(i,[]),l.get(s).get(i).push(e)});const s=e=>e.every(e=>!isNaN(Number(e))&&""!==e.trim())?e.sort((e,t)=>Number(e)-Number(t)):e.sort(),i=s(Array.from(n)),o=s(Array.from(r)),c=lr[t.aggregation];function u(e){const l=e.map(e=>ar(e,t.valueField,a));if(!c||"function"!=typeof c.calculate)return X.error("Invalid aggregation function:",t.aggregation,c),{value:null,count:e.length,apiCalls:e,rawValues:l,error:"Invalid aggregation function"};const n={nonNumeric:0,nullUndefined:0};return c.needsNumeric&&(n.nonNumeric=l.filter(e=>"number"!=typeof e).length),n.nullUndefined=l.filter(e=>null==e).length,{value:c.usesApiCalls?c.calculate(l,e):c.calculate(l),count:e.length,apiCalls:e,rawValues:l,excludedCounts:n}}const d=i.map(e=>{const t=[],a=[];return o.forEach(n=>{const r=l.get(e)?.get(n)||[];t.push(r.length>0?u(r):null),a.push(...r)}),{label:e,cells:t,total:u(a)}}),p=o.map(e=>{const t=[];return i.forEach(a=>{const n=l.get(a)?.get(e)||[];t.push(...n)}),u(t)});return{rows:d,columns:o,totals:p,grandTotal:u(e)}}(e,v.value,l.trial)}),A=r(()=>N.value.rows),{getCellStyle:D,getSummaryStyle:L,styleKey:U}=ur(N,o,u);function H(e){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[e]||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function B(e,t,a){if(!a)return`${e} × ${t}: No data`;let l=`${e} × ${t}: ${nr(a,v.value.aggregation)} (${a.count} calls)`;if(a.excludedCounts){const e=[];a.excludedCounts.nonNumeric>0&&e.push(`${a.excludedCounts.nonNumeric} non-numeric responses excluded`),a.excludedCounts.nullUndefined>0&&e.push(`${a.excludedCounts.nullUndefined} null/empty responses`),e.length>0&&(l+=` | ${e.join(", ")}`)}return a.error&&(l+=` - ERROR: ${a.error}`),l}function W(e,t,a){if(!a)return`${e} by ${t}: No data`;const l=nr(a,v.value.aggregation);return a.error?`${e} by ${t}: ${l} with data integrity error: ${a.error}`:`${e} by ${t}: ${l} from ${a.count} API calls`}function G(e,t){"rowField"!==e&&"columnField"!==e&&"valueField"!==e&&"aggregation"!==e||(v.value[e]=t),s("config-change",{...v.value})}function K(e,t,a){a&&s("cell-click",{row:e,column:t,cell:a})}function J(){i.value=!i.value,i.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return d(()=>{i.value&&(document.body.style.overflow="")}),c([T,()=>l.apiCalls.length],([e])=>{if(l.apiCalls.length>0&&(!v.value.rowField||""===v.value.rowField)&&e.categorical.length>0){if(v.value.rowField=e.categorical.find(e=>"model"!==e&&"status"!==e&&"error_type"!==e)||e.categorical[0]||"model",v.value.columnField=v.value.columnField||"model",v.value.valueField=v.value.valueField||"extracted_value",!v.value.aggregation||""===v.value.aggregation){const e=l.apiCalls.slice(0,3).map(e=>ar(e,v.value.valueField,l.trial)).filter(e=>null!=e),t=e.length>0&&e.every(e=>"number"==typeof e);v.value.aggregation=t?"mean":"mode"}s("config-change",{...v.value})}},{immediate:!0}),(e,t)=>(_(),p("div",{class:x(["pivot-table-core",{fullscreen:i.value}])},[z([T.value,v.value],()=>(_(),p("div",null,[a(Er,{config:v.value,"available-fields":T.value,onUpdateConfig:G},null,8,["config","available-fields"])])),t,0),a(Lr,{"selected-color-scale":o.value,"gradient-mode":u.value,"is-fullscreen":i.value,onUpdateColorScale:t[1]||(t[1]=e=>o.value=e),onUpdateGradientMode:t[2]||(t[2]=e=>u.value=e),onToggleFullscreen:J},null,8,["selected-color-scale","gradient-mode","is-fullscreen"]),Object.keys(O.value).length>0?z([O.value,h.value],()=>(_(),p("div",{key:0,class:"data-filters"},[m("div",Ur,[O.value.model&&O.value.model.length>1?(_(),p("div",zr,[t[7]||(t[7]=m("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),j(m("select",{id:"filter-model","onUpdate:modelValue":t[3]||(t[3]=e=>h.value.model=e),class:"filter-select","aria-label":"Filter by model",onChange:$},[t[6]||(t[6]=m("option",{value:""},"All Models",-1)),(_(!0),p(b,null,w(O.value.model,e=>(_(),p("option",{key:e,value:e},C(e),9,qr))),128))],544),[[V,h.value.model]])])):f("",!0),(_(!0),p(b,null,w(P.value,(e,t)=>(_(),p("div",{key:t,class:"filter-group"},[m("label",{for:`filter-${t}`,class:"filter-label"},C(H(String(t)))+": ",9,Vr),j(m("select",{id:`filter-${t}`,"onUpdate:modelValue":e=>h.value[t]=e,class:"filter-select","aria-label":`Filter by ${H(String(t))}`,onChange:$},[m("option",Br,"All "+C(H(String(t))),1),(_(!0),p(b,null,w(e,e=>(_(),p("option",{key:e,value:e},C(e),9,Wr))),128))],40,Hr),[[V,h.value[t]]])]))),128)),O.value.status&&O.value.status.length>1?(_(),p("div",Gr,[t[9]||(t[9]=m("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),j(m("select",{id:"filter-status","onUpdate:modelValue":t[4]||(t[4]=e=>h.value.status=e),class:"filter-select","aria-label":"Filter by status",onChange:$},[t[8]||(t[8]=m("option",{value:""},"All Statuses",-1)),(_(!0),p(b,null,w(O.value.status,e=>(_(),p("option",{key:e,value:e},C(e),9,Kr))),128))],544),[[V,h.value.status]])])):f("",!0),k.value?(_(),p("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:M}," Clear Filters ")):f("",!0)])])),t,5):f("",!0),m("div",Jr,[0===l.apiCalls.length?(_(),p("div",Yr,t[10]||(t[10]=[m("p",null,"No data available for pivot table analysis.",-1)]))):v.value.aggregation in g(lr)?(_(),p("div",Xr,[m("table",Zr,[m("thead",null,[m("tr",es,[m("th",ts,C(H(v.value.rowField)||"Items")+" / "+C(H(v.value.columnField)||"Aggregated"),1),(_(!0),p(b,null,w(N.value.columns,e=>(_(),p("th",{key:e,class:"column-header",role:"columnheader"},C(e),1))),128)),v.value.columnField&&e.showTotals?(_(),p("th",as," Total ")):f("",!0)])]),m("tbody",null,[(_(!0),p(b,null,w(A.value,t=>(_(),p("tr",{key:`${t.label}-${g(U)}`,class:"data-row",role:"row"},[m("td",ls,C(t.label),1),(_(!0),p(b,null,w(t.cells,(e,a)=>(_(),p("td",{key:`${a}-${g(U)}`,class:x(["data-cell",{"error-cell":e?.error}]),"data-testid":e?.error?"pivot-cell-error":"pivot-cell",style:S(g(D)(e,t.label,a)),title:B(t.label,N.value.columns[a],e),"aria-label":W(t.label,N.value.columns[a],e),role:e?.error?"alert":"cell",tabindex:"0",onClick:l=>K(t.label,N.value.columns[a],e),onKeydown:[q(l=>K(t.label,N.value.columns[a],e),["enter"]),q(R(l=>K(t.label,N.value.columns[a],e),["prevent"]),["space"])]},[e?.error?(_(),p("div",rs,[m("span",{class:"error-indicator",title:e.error},"⚠️",8,ss),m("span",is,C(e?g(nr)(e,v.value.aggregation):"-"),1),m("div",os,C(e.error),1)])):(_(),p("span",cs,C(e?g(nr)(e,v.value.aggregation):"-"),1))],46,ns))),128)),v.value.columnField&&e.showTotals?(_(),p("td",{key:0,class:"total-cell",style:S(g(L)(t.total)),role:"cell"},C(g(nr)(t.total,v.value.aggregation)),5)):f("",!0)]))),128)),v.value.rowField&&e.showTotals?(_(),p("tr",{key:`totals-${g(U)}`,class:"total-row",role:"row"},[t[12]||(t[12]=m("td",{class:"row-header",role:"rowheader"},"Total",-1)),(_(!0),p(b,null,w(N.value.totals,(e,t)=>(_(),p("td",{key:`total-${t}-${g(U)}`,class:"total-cell",style:S(g(L)(e)),role:"cell"},C(g(nr)(e,v.value.aggregation)),5))),128)),v.value.columnField?(_(),p("td",{key:0,class:"grand-total-cell",style:S(g(L)(N.value.grandTotal)),role:"cell"},C(g(nr)(N.value.grandTotal,v.value.aggregation)),5)):f("",!0)])):f("",!0)])])])):(_(),p("div",Qr,[m("p",null,"Invalid aggregation function: "+C(v.value.aggregation),1),t[11]||(t[11]=m("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),[["__scopeId","data-v-6da58b58"]]),ds={class:"summary-row"},ps={key:0,class:"filter-row"},ms=["title"],fs=["title"],vs=le(o({__name:"PivotCellDetailModal",props:{row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(e){const t=e,l=H({}),n=r(()=>{const e=new Set;return t.apiCalls.forEach(t=>{t.variables&&Object.keys(t.variables).forEach(t=>e.add(t)),t.attributedVariables&&Object.entries(t.attributedVariables).forEach(([t,a])=>{a&&"object"==typeof a&&Object.keys(a).forEach(a=>{e.add(`${t}.${a}`)})})}),Array.from(e).sort()}),s=r(()=>n.value.map(e=>({title:e,dataIndex:`var_${e}`,key:`var_${e}`,width:150,ellipsis:!0,sorter:(t,a)=>{const l=t[`var_${e}`]||"",n=a[`var_${e}`]||"";return l.localeCompare(n)}}))),i=[{title:"Status",dataIndex:"status",key:"status",width:100,fixed:"left",sorter:(e,t)=>e.status.localeCompare(t.status)},{title:"Model",dataIndex:"model",key:"model",width:150,ellipsis:!0,sorter:(e,t)=>e.model.localeCompare(t.model)}],o=[{title:"Response",dataIndex:"response",key:"response",width:300,ellipsis:!0},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150,ellipsis:!0,sorter:(e,t)=>(e.extracted||"").localeCompare(t.extracted||"")},{title:"Duration",dataIndex:"duration",key:"duration",width:100,sorter:(e,t)=>(parseInt(e.duration)||0)-(parseInt(t.duration)||0)},{title:"Cost",dataIndex:"cost",key:"cost",width:100,sorter:(e,t)=>(e.cost||0)-(t.cost||0)}],c=r(()=>[...i,...s.value,...o]),u=r(()=>`${t.row} × ${t.column} - ${t.apiCalls.length} API Calls`),d=r(()=>t.apiCalls.map(e=>{const t={id:e.id,status:e.status,model:e.model||"-",response:e.result?.content||e.result?.error||"-",extracted:e.extracted||"-",duration:e.duration?`${e.duration}ms`:"-",cost:e.cost||0};return n.value.forEach(a=>{if(a.includes(".")){const[l,n]=a.split("."),r=e.attributedVariables?.[l]?.[n];t[`var_${a}`]=void 0!==r?String(r):"-"}else t[`var_${a}`]=e.variables?.[a]||"-"}),t})),g=r(()=>Object.values(l).some(e=>void 0!==e&&""!==e)),x=r(()=>g.value?d.value.filter(e=>Object.entries(l).every(([t,a])=>!a||e[t]===a)):d.value),S=r(()=>{const e=t.apiCalls.filter(e=>"completed"===e.status).length;return Math.round(e/t.apiCalls.length*100)}),T=r(()=>{const e=t.apiCalls.filter(e=>e.duration).map(e=>e.duration);return 0===e.length?0:Math.round(e.reduce((e,t)=>e+t,0)/e.length)}),I=r(()=>t.apiCalls.filter(e=>e.cost).map(e=>e.cost).reduce((e,t)=>e+t,0).toFixed(4));function O(e){switch(e){case"completed":return"success";case"failed":return"error";case"pending":return"warning";case"running":return"processing";default:return"default"}}function E(e){const t=new Set;return d.value.forEach(a=>{const l=a[e];l&&"-"!==l&&t.add(l)}),Array.from(t).sort()}function P(){}function $(){Object.keys(l).forEach(e=>{delete l[e]})}return(e,t)=>{const n=h("a-select-option"),r=h("a-select"),i=h("a-button"),o=h("a-tag"),d=h("a-table"),M=h("a-modal");return _(),v(M,{open:!0,width:"98vw",footer:null,title:u.value,onCancel:t[0]||(t[0]=t=>e.$emit("close")),"body-style":{padding:"16px",height:"90vh",display:"flex",flexDirection:"column"},class:"pivot-cell-detail-modal"},{default:y(()=>[m("div",ds,[m("span",null,[t[1]||(t[1]=m("b",null,"Total:",-1)),k(" "+C(e.apiCalls.length),1)]),m("span",null,[t[2]||(t[2]=m("b",null,"Success Rate:",-1)),k(" "+C(S.value)+"%",1)]),m("span",null,[t[3]||(t[3]=m("b",null,"Avg Duration:",-1)),k(" "+C(T.value)+"ms",1)]),m("span",null,[t[4]||(t[4]=m("b",null,"Total Cost:",-1)),k(" $"+C(I.value),1)])]),s.value.length>0?(_(),p("div",ps,[(_(!0),p(b,null,w(s.value,e=>(_(),p("div",{key:e.key,class:"variable-filter"},[a(r,{value:l[e.key],"onUpdate:value":t=>l[e.key]=t,placeholder:`Filter ${e.title}`,allowClear:"",style:{width:"150px"},size:"small",onChange:P},{default:y(()=>[(_(!0),p(b,null,w(E(e.key),e=>(_(),v(n,{key:e,value:e},{default:y(()=>[k(C(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])]))),128)),g.value?(_(),v(i,{key:0,size:"small",onClick:$},{default:y(()=>t[5]||(t[5]=[k("Clear Filters")])),_:1,__:[5]})):f("",!0)])):f("",!0),a(d,{columns:c.value,"data-source":x.value,scroll:{x:1500,y:"calc(90vh - 140px)"},pagination:!1,size:"small","row-key":e=>e.id,class:"api-calls-table"},{bodyCell:y(({column:e,record:t})=>{return["status"===e.key?(_(),v(o,{key:0,color:O(t.status),style:{margin:"0"}},{default:y(()=>[k(C(t.status),1)]),_:2},1032,["color"])):"response"===e.key?(_(),p("span",{key:1,class:"response-cell",title:t.response},C((a=t.response,l=100,a?a.length<=l?a:a.slice(0,l)+"...":"")),9,ms)):"cost"===e.key?(_(),p(b,{key:2},[k(C(0===t.cost?"-":`$${t.cost.toFixed(4)}`),1)],64)):e.key.startsWith("var_")?(_(),p("span",{key:3,class:"variable-cell",title:t[e.key]},C(t[e.key]||"-"),9,fs)):f("",!0)];var a,l}),_:1},8,["columns","data-source","row-key"])]),_:1},8,["title"])}}}),[["__scopeId","data-v-d1eba3c3"]]),gs={class:"trial-tab-content"},hs={class:"tab-content status-tab-content"},ys={class:"status-scroll-container"},bs={key:0,class:"queue-status-section"},ws={class:"tab-content task-view-tab"},_s={class:"tab-content pivot-tab-content"},ks={class:"pivot-scroll-container"},xs={class:"pivot-container"},Cs={key:1,class:"empty-state"},Ss=le(o({__name:"TrialTabContent",props:{trial:{},apiCalls:{},loading:{type:Boolean}},setup(e){const t=e,l=n("status"),s=n({rowField:"",columnField:"model",valueField:"success",aggregation:"mean"}),i=n(!1),o=n({row:"",column:"",apiCalls:[],value:0}),c=r(()=>[...t.apiCalls].sort((e,t)=>{if("running"===e.status&&"running"!==t.status)return-1;if("running"!==e.status&&"running"===t.status)return 1;const a=e.completed||e.created||new Date(0);return(t.completed||t.created||new Date(0)).getTime()-a.getTime()})),u=e=>{s.value=e},d=e=>{if(!e.cell)return;const t=e.cell.apiCalls||[];0!==t.length&&(o.value={row:e.row,column:e.column,apiCalls:t,value:e.cell.value},i.value=!0)};return(e,t)=>{const n=h("a-tab-pane"),r=h("a-tabs");return _(),p("div",gs,[a(r,{activeKey:l.value,"onUpdate:activeKey":t[0]||(t[0]=e=>l.value=e),class:"detail-tabs","tab-bar-style":{marginBottom:0}},{default:y(()=>[a(n,{key:"status",tab:"Status"},{default:y(()=>[m("div",hs,[m("div",ys,[a(dn,{trial:e.trial,compact:!1},null,8,["trial"]),"running"===e.trial.status||"paused"===e.trial.status?(_(),p("div",bs,[t[2]||(t[2]=m("h3",{class:"section-title"},"Queue Status",-1)),a(er,{"trial-id":e.trial.id,trial:e.trial,compact:!1},null,8,["trial-id","trial"])])):f("",!0)])])]),_:1}),a(n,{key:"tasks",tab:"Task View"},{default:y(()=>[m("div",ws,[a(Dl,{trial:e.trial,"api-calls":c.value,loading:e.loading},null,8,["trial","api-calls","loading"])])]),_:1}),a(n,{key:"pivot",tab:"Pivot Table"},{default:y(()=>[m("div",_s,[m("div",ks,[m("div",xs,[e.apiCalls.length>0?(_(),v(us,{key:0,"api-calls":e.apiCalls,trial:e.trial,config:s.value,"show-totals":!0,onConfigChange:u,onCellClick:d},null,8,["api-calls","trial","config"])):(_(),p("div",Cs,t[3]||(t[3]=[m("p",null,"No data available for pivot table analysis.",-1)])))])])])]),_:1})]),_:1},8,["activeKey"]),i.value?(_(),v(vs,{key:0,row:o.value.row,column:o.value.column,"api-calls":o.value.apiCalls,trial:e.trial,value:o.value.value,onClose:t[1]||(t[1]=e=>i.value=!1)},null,8,["row","column","api-calls","trial","value"])):f("",!0)])}}}),[["__scopeId","data-v-6cc8ebfb"]]),Ts={class:"modal-content"},Is={class:"modal-header"},Os={class:"modal-body"},Es={class:"section"},Ps={class:"format-options"},$s=["data-testid","aria-label"],Ms=["value","data-testid","aria-label"],Rs={class:"format-label"},Ns={class:"format-name"},Fs={class:"section"},As={class:"field-groups"},Ds=["data-testid"],js={class:"field-list"},Ls=["data-testid","aria-label"],Us=["value","data-testid","aria-label"],zs={class:"field-label"},qs={class:"field-name"},Vs={class:"field-desc"},Hs={class:"section"},Bs={class:"preview-info"},Ws={class:"preview-count"},Gs={class:"preview-fields"},Ks={class:"preview-size"},Js={class:"modal-footer"},Ys=le(o({__name:"ExportDataModal",props:{trial:{},apiCalls:{}},emits:["close"],setup(e){const t=e,l=[{id:"csv",name:"CSV",description:"Comma-separated values (Excel compatible)"},{id:"tsv",name:"TSV",description:"Tab-separated values"},{id:"excel",name:"Excel",description:"Microsoft Excel (.xlsx)"},{id:"json",name:"JSON",description:"JavaScript Object Notation"},{id:"jsonl",name:"JSONL",description:"JSON Lines (one object per line)"}],s=[{name:"Basic Info",fields:[{id:"id",name:"ID",description:"API call identifier",default:!0},{id:"trial_id",name:"Trial ID",description:"Parent trial identifier",default:!0},{id:"trial_name",name:"Trial Name",description:"Human-readable trial name",default:!0},{id:"status",name:"Status",description:"Call status (completed, failed, etc.)",default:!0},{id:"created",name:"Created",description:"When the call was initiated",default:!0},{id:"completed",name:"Completed",description:"When the call finished",default:!0}]},{name:"Configuration",fields:[{id:"configuration_index",name:"Config Index",description:"Configuration array index",default:!1},{id:"configuration_name",name:"Config Name",description:"Human-readable config name",default:!1},{id:"provider",name:"Provider",description:"LLM service provider",default:!0},{id:"model",name:"Model",description:"Model identifier",default:!0},{id:"parameters",name:"Parameters",description:"Model parameters as separate columns (temperature, max_tokens, etc.)",default:!0}]},{name:"Content",fields:[{id:"prompt",name:"Prompt",description:"Input prompt text",default:!0},{id:"variables",name:"Variables",description:"Variable substitutions (flattened as separate columns)",default:!0},{id:"result_content",name:"Result Content",description:"LLM response content",default:!0},{id:"result_error",name:"Result Error",description:"Error message if failed",default:!0}]},{name:"Performance",fields:[{id:"response_latency_ms",name:"Latency (ms)",description:"Response time",default:!0},{id:"duration_ms",name:"Duration (ms)",description:"Total processing time",default:!1},{id:"result_success",name:"Success",description:"Whether call succeeded",default:!0}]},{name:"Technical Details",fields:[{id:"request_url",name:"Request URL",description:"API endpoint URL",default:!0},{id:"request_method",name:"Request Method",description:"HTTP method",default:!1},{id:"request_headers",name:"Request Headers",description:"HTTP request headers",default:!1},{id:"request_body",name:"Request Body",description:"Full request payload",default:!1},{id:"response_status",name:"Response Status",description:"HTTP status code",default:!0},{id:"response_headers",name:"Response Headers",description:"HTTP response headers",default:!1},{id:"response_body",name:"Response Body",description:"Full response payload",default:!1}]},{name:"Error Handling",fields:[{id:"network_error_count",name:"Network Errors",description:"Number of network failures",default:!1},{id:"retry_count",name:"Retry Count",description:"Number of retry attempts",default:!1}]}],i=n("csv"),o=n([]),c=s.flatMap(e=>e.fields);o.value=c.filter(e=>e.default).map(e=>e.id);const u=r(()=>{const e=50*o.value.length,a=t.apiCalls.length*e;return a<1024?`${a}B`:a<1048576?`${(a/1024).toFixed(1)}KB`:`${(a/1048576).toFixed(1)}MB`});function d(){o.value=c.map(e=>e.id)}function f(){o.value=c.filter(e=>e.default).map(e=>e.id)}function v(){o.value=[]}function g(e){const t=new Set(["model","messages","prompt","stream","user"]),a={};for(const[l,n]of Object.entries(e))t.has(l)||(a[l]=n);return a}function x(e,t=""){const a={};for(const[l,n]of Object.entries(e)){const e=t?`${t}.${l}`:l;null===n||"object"!=typeof n||Array.isArray(n)?a[e]=Array.isArray(n)?JSON.stringify(n):n:Object.assign(a,x(n,e))}return a}function S(){const e=new Set,a=[];if(Q(t.trial)){const{columns:l}=t.trial.datasetSnapshot;a.push(...l),l.forEach(t=>e.add(t))}o.value.includes("variables")&&t.apiCalls.forEach(t=>{t.variables&&"object"==typeof t.variables&&Object.keys(t.variables).forEach(t=>{e.has(t)||(e.add(t),a.push(t))})});const l=new Set,n=[];return o.value.includes("parameters")&&t.apiCalls.forEach(e=>{if(e.request?.body){const t=x(g(e.request.body));Object.keys(t).forEach(e=>{l.has(e)||(l.add(e),n.push(e))})}}),t.apiCalls.map((e,l)=>{const r={};var s,i;if(Q(t.trial)&&(r.Row=l+1),o.value.includes("id")&&(r.ID=e.id),o.value.includes("trial_id")&&(r["Trial ID"]=e.trialId),o.value.includes("trial_name")&&(r["Trial Name"]=t.trial.name),o.value.includes("status")&&(r.Status=e.status),o.value.includes("created")&&(r.Created=e.created?new Date(e.created).toISOString():""),o.value.includes("completed")&&(r.Completed=e.completed?new Date(e.completed).toISOString():""),o.value.includes("configuration_index")&&(r["Configuration Index"]=e.configurationIndex),o.value.includes("configuration_name")&&(r["Configuration Name"]=(s=e.configurationIndex,t.trial.configurationSnapshots[s]&&t.trial.configurationSnapshots[s].name||`Config ${s+1}`)),o.value.includes("provider")&&(r.Provider=t.trial.configurationSnapshots?.[e.configurationIndex]?.provider||(i=e,i.request?.url?.includes("openai.com")?"OpenAI":i.request?.url?.includes("anthropic.com")?"Anthropic":i.request?.url?.includes("openrouter.ai")?"OpenRouter":i.request?.url?.includes("localhost:11434")?"Ollama":"Unknown")),o.value.includes("model")&&(r.Model=t.trial.configurationSnapshots?.[e.configurationIndex]?.modelId||function(e){return e.request?.body?.model?e.request.body.model:"Unknown"}(e)),o.value.includes("prompt")&&(r.Prompt=e.prompt),o.value.includes("variables"))for(const t of a)r[t]=e.variables?.[t]||"";if(o.value.includes("result_content")&&(r["Result Content"]=e.result?.content||""),o.value.includes("result_error")&&(r["Result Error"]=e.result?.error||""),o.value.includes("response_latency_ms")&&(r["Response Latency (ms)"]=e.response?.latencyMs||""),o.value.includes("duration_ms")){const t=e.created?new Date(e.created).getTime():0,a=e.completed?new Date(e.completed).getTime():0;r["Duration (ms)"]=t&&a?a-t:""}if(o.value.includes("result_success")&&(r["Result Success"]=e.result?.success||!1),o.value.includes("request_url")&&(r["Request URL"]=e.request?.url||""),o.value.includes("request_method")&&(r["Request Method"]=e.request?.method||""),o.value.includes("request_headers")&&(r["Request Headers"]=JSON.stringify(e.request?.headers||{})),o.value.includes("request_body")&&(r["Request Body"]=JSON.stringify(e.request?.body||{})),o.value.includes("response_status")&&(r["Response Status"]=e.response?.status||""),o.value.includes("response_headers")&&(r["Response Headers"]=JSON.stringify(e.response?.headers||{})),o.value.includes("response_body")&&(r["Response Body"]=JSON.stringify(e.response?.body||{})),o.value.includes("network_error_count")&&(r["Network Error Count"]=0),o.value.includes("retry_count")&&(r["Retry Count"]=0),o.value.includes("parameters")&&n.length>0)if(e.request?.body){const t=g(e.request.body),a=x(t);l<3&&X.debug("Export parameters debug",{callId:e.id,requestBody:e.request.body,extractedParams:t,flatParams:a,parameterOrder:n});for(const e of n){r[`param.${e}`]=void 0!==a[e]?a[e]:""}}else for(const t of n){r[`param.${t}`]=""}return void 0!==e.repeatIndex&&(r.Repeat=e.repeatIndex+1,r["Repeat Group"]=e.repeatGroupId),r})}async function T(){const e=S(),a=(new Date).toISOString().split("T")[0],l=`${t.trial.name}_${i.value}_${a}`;try{switch(i.value){case"csv":!function(e,t){if(0===e.length)return;const a=Object.keys(e[0]||{}),l=[a.join(","),...e.map(e=>a.map(t=>`"${String(e[t]??"").replace(/"/g,'""')}"`).join(","))].join("\n");I(l,`${t}.csv`,"text/csv")}(e,l);break;case"tsv":!function(e,t){if(0===e.length)return;const a=Object.keys(e[0]||{}),l=[a.join("\t"),...e.map(e=>a.map(t=>String(e[t]||"").replace(/\t/g," ")).join("\t"))].join("\n");I(l,`${t}.tsv`,"text/tab-separated-values")}(e,l);break;case"excel":await async function(e,t){const a=await ge(()=>import("./xlsx-C4WhbwXR.js"),[],import.meta.url),l=a.utils.book_new(),n=a.utils.json_to_sheet(e),r=Object.keys(e[0]||{}),s=r.map(e=>({wch:Math.min(Math.max(e.length,10),50)}));n["!cols"]=s,a.utils.book_append_sheet(l,n,"Trial Results"),a.writeFile(l,`${t}.xlsx`)}(e,l);break;case"json":!function(e,t){const a=JSON.stringify(e,null,2);I(a,`${t}.json`,"application/json")}(e,l);break;case"jsonl":!function(e,t){const a=e.map(e=>JSON.stringify(e)).join("\n");I(a,`${t}.jsonl`,"application/jsonl")}(e,l)}}catch(n){X.error("Export failed",n),me.error("Export failed: "+(n instanceof Error?n.message:"Unknown error"))}}function I(e,t,a){let l=e;"text/csv"!==a&&"text/tab-separated-values"!==a||(l="\ufeff"+e);const n=new Blob([l],{type:`${a};charset=utf-8`}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}return(e,t)=>{const n=h("a-button");return _(),p("div",{class:"modal-overlay",onClick:t[4]||(t[4]=R(t=>e.$emit("close"),["self"]))},[m("div",Ts,[m("div",Is,[t[5]||(t[5]=m("h3",null,"Export Trial Data",-1)),m("button",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"close-btn","data-testid":"btn-close-export-modal","aria-label":"Close export modal"},"×")]),m("div",Os,[m("div",Es,[t[6]||(t[6]=m("h4",null,"Export Format",-1)),m("div",Ps,[(_(),p(b,null,w(l,e=>m("label",{key:e.id,class:"format-option","data-testid":`label-format-${e.id}`,"aria-label":`Export as ${e.name} format`},[j(m("input",{type:"radio",value:e.id,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),class:"format-radio","data-testid":`radio-format-${e.id}`,"aria-label":`Select ${e.name} format`},null,8,Ms),[[B,i.value]]),m("span",Rs,[m("span",Ns,C(e.name),1)])],8,$s)),64))])]),m("div",Fs,[m("h4",null,[t[7]||(t[7]=k(" Fields to Export ")),m("div",{class:"field-controls"},[m("button",{onClick:d,class:"control-btn","data-testid":"btn-select-all-fields","aria-label":"Select all export fields"},"Select All"),m("button",{onClick:f,class:"control-btn","data-testid":"btn-select-default-fields","aria-label":"Select default export fields"},"Defaults"),m("button",{onClick:v,class:"control-btn","data-testid":"btn-select-no-fields","aria-label":"Deselect all export fields"},"Select None")])]),m("div",As,[(_(),p(b,null,w(s,e=>m("div",{key:e.name,class:"field-group","data-testid":`field-group-${e.name.toLowerCase().replace(/\s+/g,"-")}`},[m("h5",null,C(e.name),1),m("div",js,[(_(!0),p(b,null,w(e.fields,e=>(_(),p("label",{key:e.id,class:"field-option","data-testid":`label-field-${e.id}`,"aria-label":`Include ${e.name} in export`},[j(m("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value=e),class:"field-checkbox","data-testid":`checkbox-field-${e.id}`,"aria-label":`Select ${e.name} field for export`},null,8,Us),[[W,o.value]]),m("span",zs,[m("span",qs,C(e.name),1),m("span",Vs,C(e.description),1)])],8,Ls))),128))])],8,Ds)),64))])]),m("div",Hs,[t[8]||(t[8]=m("h4",null,"Export Preview",-1)),m("div",Bs,[m("span",Ws,C(e.apiCalls.length)+" records",1),m("span",Gs,C(o.value.length)+" fields",1),m("span",Ks,"~"+C(u.value),1)])])]),m("div",Js,[a(n,{onClick:t[3]||(t[3]=t=>e.$emit("close")),size:"large",class:"footer-button","data-testid":"btn-cancel-export","aria-label":"Cancel export"},{default:y(()=>t[9]||(t[9]=[k(" Cancel ")])),_:1,__:[9]}),a(n,{type:"primary",onClick:T,disabled:0===o.value.length,size:"large",class:"footer-button footer-button-primary","data-testid":"btn-confirm-export","data-format":i.value,"aria-label":`Export data as ${i.value.toUpperCase()}`},{default:y(()=>[k(" Export "+C(i.value.toUpperCase()),1)]),_:1},8,["disabled","data-format","aria-label"])])])])}}}),[["__scopeId","data-v-4705d0fc"]]),Qs=Object.freeze(Object.defineProperty({__proto__:null,default:Ys},Symbol.toStringTag,{value:"Module"}));function Xs(e,t={}){const{embedded:a=!1,providedApiCalls:l}=t,r=F(l||[]),s=n(!0),i=n(null);let o=null;return c(e,(e,t)=>{e!==t&&(o&&(o.unsubscribe(),o=null),a&&!l&&e?(async e=>{s.value=!0,i.value=null;try{if(l)return r.value=l,void(s.value=!1);o=De(()=>_e.apiCalls.where("trialId").equals(e).toArray()).subscribe({next:e=>{r.value=e,s.value=!1},error:t=>{X.error("Error loading API calls",t,{component:"useTrialApiCalls",trialId:e}),i.value=t instanceof Error?t:new Error("Failed to load API calls"),s.value=!1}})}catch(t){X.error("Error setting up API calls subscription",t,{component:"useTrialApiCalls",trialId:e}),i.value=t instanceof Error?t:new Error("Failed to setup API calls subscription"),s.value=!1}})(e):s.value=!1)},{immediate:!0}),d(()=>{o&&o.unsubscribe()}),{apiCalls:r,loading:s,error:i}}const Zs={class:"trial-details-panel"},ei={key:0,class:"empty-details"},ti={class:"empty-illustration"},ai={key:1,class:"trial-details"},li={class:"details-header-fixed"},ni={class:"details-content-tabbed"},ri=le(o({__name:"TrialDetailsPanel",emits:["create-trial"],setup(e){const t=ft(),l=J(),i=s(),o=n(!1),c=n(null),u=n([]),d=n(!1),w=r(()=>t.selectedTrial),x=r(()=>w.value?.id||void 0),{apiCalls:C,loading:S}=Xs(x,{embedded:!0});async function T(){if(w.value)try{await l.pauseTrial(w.value.id),X.info("Trial paused",{trialId:w.value.id})}catch(e){X.error("Failed to pause trial",e),be.error({title:"Failed to pause trial",content:e instanceof Error?e.message:"Unknown error"})}}async function I(){if(w.value&&!d.value){d.value=!0;try{const e=await l.getRunningTrials();e.length>0?be.confirm({title:"Another trial is already running",content:`The trial "${e[0].name}" is currently running. Resuming this trial will pause it. Do you want to continue?`,okText:"Yes, resume this trial",cancelText:"No, keep current trial",onOk:async()=>{try{await l.resumeTrial(w.value.id),X.info("Trial resumed",{trialId:w.value.id})}catch(e){X.error("Failed to resume trial",e),be.error({title:"Failed to resume trial",content:e instanceof Error?e.message:"Unknown error"})}finally{d.value=!1}},onCancel:()=>{d.value=!1}}):(await l.resumeTrial(w.value.id),X.info("Trial resumed",{trialId:w.value.id}),d.value=!1)}catch(e){X.error("Failed to check running trials",e),be.error({title:"Failed to resume trial",content:e instanceof Error?e.message:"Unknown error"}),d.value=!1}}}async function O(){w.value&&be.confirm({title:"Cancel Trial?",content:"Are you sure you want to cancel this trial? This action cannot be undone.",okText:"Cancel Trial",okType:"danger",cancelText:"Keep Running",onOk:async()=>{try{await l.cancelTrial(w.value.id),X.info("Trial cancelled",{trialId:w.value.id})}catch(e){X.error("Failed to cancel trial",e),be.error({title:"Failed to cancel trial",content:e instanceof Error?e.message:"Unknown error"})}}})}async function E(){await async function(){if(!w.value)return;try{const{PythonExportService:e}=await ge(async()=>{const{PythonExportService:e}=await Promise.resolve().then(()=>ui);return{PythonExportService:e}},void 0,import.meta.url),t=e.validateTrialForExport(w.value);if(!t.valid)return void be.error({title:"Cannot export trial",content:t.errors.join("\n")});const a=await e.generatePythonScript(w.value,{mode:"simple"}),l=new Blob([a],{type:"text/x-python"}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=`auditomatic_${w.value.name.replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.py`,r.click(),URL.revokeObjectURL(n),X.info("Trial exported",{trialId:w.value.id})}catch(e){X.error("Failed to export trial",e),be.error({title:"Failed to export trial",content:e instanceof Error?e.message:"Unknown error"})}}()}async function P(){if(!w.value)return;const e=await _e.apiCalls.where("trialId").equals(w.value.id).toArray();o.value=!0,c.value=w.value,u.value=e}function $(){w.value&&i.push({name:"trials",query:{tab:"create",duplicate:w.value.id}})}function M(){w.value&&i.push({name:"trials",query:{tab:"create",duplicate:w.value.id,edit:"true"}})}async function R(){w.value&&be.confirm({title:"Delete Trial?",content:`Are you sure you want to delete "${w.value.name}"? This action cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{try{await l.deleteTrial(w.value.id),t.selectTrial(null),X.info("Trial deleted",{trialId:w.value.id})}catch(e){X.error("Failed to delete trial",e),be.error({title:"Failed to delete trial",content:e instanceof Error?e.message:"Unknown error"})}}})}return(e,t)=>{const l=h("a-button");return _(),p(b,null,[m("div",Zs,[w.value?(_(),p("div",ai,[m("div",li,[a(da,{trial:w.value},null,8,["trial"]),a(ma,{trial:w.value,"is-resuming":d.value,onPauseTrial:T,onResumeTrial:I,onCancelTrial:O,onExportData:P,onExportPython:E,onDuplicateTrial:$,onEditTrial:M,onDeleteTrial:R},null,8,["trial","is-resuming"])]),m("div",ni,[a(Ss,{trial:w.value,"api-calls":g(C),loading:g(S)},null,8,["trial","api-calls","loading"])])])):(_(),p("div",ei,[m("div",ti,[a(g(Ie),{style:{"font-size":"64px",color:"var(--color-primary-alpha)"}})]),t[3]||(t[3]=m("h3",null,"Select a trial to view details",-1)),t[4]||(t[4]=m("p",null,"Choose from the list or create a new one",-1)),a(l,{type:"primary",class:"create-trial-button-large",onClick:t[0]||(t[0]=t=>e.$emit("create-trial"))},{icon:y(()=>[a(g(ee))]),default:y(()=>[t[2]||(t[2]=k(" Create New Trial "))]),_:1,__:[2]})]))]),o.value?(_(),v(Ys,{key:0,trial:c.value,"api-calls":u.value,onClose:t[1]||(t[1]=e=>o.value=!1)},null,8,["trial","api-calls"])):f("",!0)],64)}}}),[["__scopeId","data-v-4dbb5d84"]]);class si{static generate(e){const t=this.extractData(e);return this.generateScript(t,e.name)}static extractData(e){const t=e.configurationSnapshots.map(e=>({provider:e.provider,modelId:e.modelId,displayName:e.name,parameters:e.parameters})),a=new Set(t.map(e=>e.provider)),l={};for(const n of a){const e=we.getProvider(n);e&&(l[n]=this.buildProviderConfig(n,e))}if(Q(e)){const{columns:a,rows:n}=e.datasetSnapshot;return{trialType:"spreadsheet",experiment:{promptTemplate:e.promptPattern,dataset:{columns:a,rows:n}},models:t,providerConfigs:l}}if(Y(e)){const a={};return e.variableSnapshots.forEach(e=>{"simple"===e.category&&e.data.values?a[e.variableName]=e.data.values:"attributed"===e.category&&e.data.items&&(a[e.variableName]=e.data.items.map(e=>e.value))}),{trialType:"template",experiment:{promptTemplate:e.template,variables:a},models:t,providerConfigs:l}}throw new Error("Unknown trial type for export")}static buildProviderConfig(e,t){const a=t.requestTransform||{},l=t.auth||{type:"none"};let n="direct";"messages"===a.promptKey&&a.wrapPrompt?n="messages":"input"===a.promptKey&&(n="input");let r,s,i="root";"ollama-chat"===e?(i="options",r={max_tokens:"num_predict",max_completion_tokens:"num_predict"}):"ollama-generate"===e&&(i="mixed",s={root:["model","prompt","stream","format","raw"],options:["temperature","num_predict","top_k","top_p"]},r={max_tokens:"num_predict",max_completion_tokens:"num_predict"});const o=Object.values(t.responseModes||{})[0],c=this.parseResponsePath(o?.responseTransform?.contentPath),u=o?.responseTransform?.fallbackPaths?.map(e=>this.parseResponsePath(e)),d=t.api.baseUrl+(t.api.endpoints.chat||t.api.endpoints.generate||"");return{name:t.name,endpoint:d,auth:{type:l.type,header:l.header,prefix:"bearer"===l.type?"Bearer":void 0},headers:t.headers,request:{modelPrefixStrip:!0,promptFormat:n,messageRole:a.messageRole,paramLocation:i,paramRenames:r,mixedParams:s},response:{successPath:c,fallbackPaths:u,errorPath:["error","message"]}}}static parseResponsePath(e){return e?e.split(/[\.\[\]]/).filter(Boolean).map(e=>{const t=parseInt(e);return isNaN(t)?e:t}):["content"]}static generateScript(e,t){const a=(new Date).toISOString(),l=JSON.stringify(e.models,null,4),n=JSON.stringify(e.providerConfigs,null,4),r="template"===e.trialType?`"variables": ${JSON.stringify(e.experiment.variables,null,4)}`:`"dataset": ${JSON.stringify(e.experiment.dataset,null,4)}`;return`#!/usr/bin/env python3\n"""\nAI Model Testing Script - Simple Mode\n=====================================\nGenerated by Auditomatic Lite v${Oe.short} on ${a}\n\nThis script reproduces your experiment by generating API calls from variables.\nPerfect for understanding, modifying, and extending your experiments.\n\nOriginal trial: ${t}\n"""\n\nimport os\nimport json\nimport time\nimport requests\nimport pandas as pd\nfrom datetime import datetime\nfrom typing import Dict, List, Any, Optional\n\n# === CONFIGURATION ===\n\n# API Keys - Add your keys here or set as environment variables\nAPI_KEYS = {\n${Object.keys(e.providerConfigs).map(e=>{const t=e.split("-")[0].toUpperCase();return`    "${e}": os.environ.get("${t}_API_KEY", ""),`}).join("\n")}\n}\n\n# Your experiment design\nEXPERIMENT = {\n    "trial_type": "${e.trialType}",\n    "prompt_template": "${e.experiment.promptTemplate.replace(/"/g,'\\"')}",\n    ${r}\n}\n\n# Models to test\nMODELS = ${l}\n\n# Provider configurations (how to talk to each API)\nPROVIDER_CONFIGS = ${n}\n\n# Output settings\nOUTPUT_FORMAT = "csv"  # Options: csv, excel, json, parquet, html, markdown, stata, pickle\n\n# === IMPLEMENTATION ===\n\ndef make_api_call(provider_id: str, model: str, prompt: str, params: dict) -> dict:\n    """\n    Universal API caller that handles all provider quirks.\n    \n    Returns dict with 'success', 'content', 'error', and timing info.\n    """\n    config = PROVIDER_CONFIGS[provider_id]\n    \n    # Build headers\n    headers = {"Content-Type": "application/json"}\n    \n    # Add authentication\n    auth = config["auth"]\n    if auth["type"] == "bearer":\n        api_key = API_KEYS.get(provider_id, "")\n        if not api_key:\n            return {"success": False, "error": f"No API key for {provider_id}"}\n        headers[auth["header"]] = f"{auth['prefix']} {api_key}"\n    elif auth["type"] == "header":\n        api_key = API_KEYS.get(provider_id, "")\n        if not api_key:\n            return {"success": False, "error": f"No API key for {provider_id}"}\n        headers[auth["header"]] = api_key\n    \n    # Add provider-specific headers\n    if config.get("headers"):\n        headers.update(config["headers"])\n    \n    # Build request body\n    request = config["request"]\n    \n    # Strip provider prefix from model\n    if request.get("modelPrefixStrip"):\n        model = model.split(":", 1)[-1]\n    \n    body = {"model": model}\n    \n    # Format prompt\n    if request["promptFormat"] == "messages":\n        body["messages"] = [{"role": request.get("messageRole", "user"), "content": prompt}]\n    elif request["promptFormat"] == "direct":\n        body["prompt"] = prompt\n    elif request["promptFormat"] == "input":\n        body["input"] = prompt\n    \n    # Handle parameters\n    processed_params = params.copy()\n    \n    # Apply renames\n    if request.get("paramRenames"):\n        for old_key, new_key in request["paramRenames"].items():\n            if old_key in processed_params:\n                processed_params[new_key] = processed_params.pop(old_key)\n    \n    # Place parameters\n    if request["paramLocation"] == "root":\n        body.update(processed_params)\n    elif request["paramLocation"] == "options":\n        body["options"] = processed_params\n    elif request.get("mixedParams"):\n        mixed = request["mixedParams"]\n        for key, value in processed_params.items():\n            if key in mixed.get("root", []):\n                body[key] = value\n            else:\n                if "options" not in body:\n                    body["options"] = {}\n                body["options"][key] = value\n    \n    # Make request\n    start_time = time.time()\n    try:\n        response = requests.post(\n            config["endpoint"],\n            headers=headers,\n            json=body,\n            timeout=30\n        )\n        latency_ms = (time.time() - start_time) * 1000\n        \n        if response.ok:\n            data = response.json()\n            content = extract_from_path(data, config["response"]["successPath"])\n            \n            # Try fallback paths\n            if content is None and config["response"].get("fallbackPaths"):\n                for path in config["response"]["fallbackPaths"]:\n                    content = extract_from_path(data, path)\n                    if content is not None:\n                        break\n            \n            return {\n                "success": True,\n                "content": content or "",\n                "latency_ms": latency_ms,\n                "status_code": response.status_code\n            }\n        else:\n            return {\n                "success": False,\n                "error": f"HTTP {response.status_code}: {response.text[:200]}",\n                "latency_ms": latency_ms,\n                "status_code": response.status_code\n            }\n            \n    except Exception as e:\n        return {\n            "success": False,\n            "error": str(e),\n            "latency_ms": (time.time() - start_time) * 1000\n        }\n\ndef extract_from_path(data: Any, path: List[Any]) -> Optional[str]:\n    """Extract value from nested data using a path like ['choices', 0, 'message', 'content']"""\n    try:\n        current = data\n        for key in path:\n            if isinstance(current, dict):\n                current = current[key]\n            elif isinstance(current, list):\n                current = current[int(key)]\n            else:\n                return None\n        return str(current) if current is not None else None\n    except (KeyError, IndexError, TypeError):\n        return None\n\ndef generate_prompts():\n    """Generate all prompts from template and variables"""\n    template = EXPERIMENT["prompt_template"]\n    trial_type = EXPERIMENT["trial_type"]\n    \n    if trial_type == "spreadsheet":\n        # Spreadsheet trials: row-by-row execution\n        dataset = EXPERIMENT["dataset"]\n        \n        for row in dataset["rows"]:\n            # Replace variables in template with values from this row\n            prompt = template\n            var_dict = {}\n            \n            for col, value in row.items():\n                var_dict[col] = str(value) if value is not None else ""\n                prompt = prompt.replace(f"{{{{{col}}}}}", var_dict[col])\n            \n            yield prompt, var_dict\n    else:\n        # Template trials: cartesian product execution\n        variables = EXPERIMENT["variables"]\n        \n        # Get variable names from template\n        import re\n        var_names = re.findall(r'{{(\\w+)}}', template)\n        \n        # Generate all combinations\n        from itertools import product\n        \n        var_lists = [variables[var] for var in var_names if var in variables]\n        if not var_lists:\n            yield template, {}\n            return\n            \n        for values in product(*var_lists):\n            var_dict = dict(zip(var_names, values))\n            \n            # Replace variables in template\n            prompt = template\n            for var, val in var_dict.items():\n                prompt = prompt.replace(f"{{{{{var}}}}}", str(val))\n            \n            yield prompt, var_dict\n\ndef run_experiment():\n    """Run the full experiment"""\n    results = []\n    total_calls = len(MODELS) * len(list(generate_prompts()))\n    current = 0\n    \n    print(f"Running experiment with {len(MODELS)} models and {total_calls} total API calls")\n    print("=" * 60)\n    \n    for model_config in MODELS:\n        print(f"\\nTesting {model_config['displayName']}...")\n        \n        for prompt, variables in generate_prompts():\n            current += 1\n            print(f"[{current}/{total_calls}] {prompt[:50]}...", end=" ")\n            \n            # Make API call\n            result = make_api_call(\n                model_config["provider"],\n                model_config["modelId"],\n                prompt,\n                model_config["parameters"]\n            )\n            \n            # Collect results\n            results.append({\n                "timestamp": datetime.now(),\n                "provider": model_config["provider"],\n                "model": model_config["modelId"],\n                "model_name": model_config["displayName"],\n                "prompt": prompt,\n                "response": result.get("content", ""),\n                "success": result.get("success", False),\n                "error": result.get("error", ""),\n                "latency_ms": result.get("latency_ms", 0),\n                "status_code": result.get("status_code", 0),\n                **variables  # Add variables as columns\n            })\n            \n            # Show result\n            if result["success"]:\n                print(f"✓ {result['content'][:30]}")\n            else:\n                print(f"✗ {result['error'][:30]}")\n            \n            # Rate limiting\n            time.sleep(0.1)\n    \n    return results\n\ndef save_results(results: List[Dict[str, Any]], format: str = OUTPUT_FORMAT):\n    """Save results using pandas in the specified format"""\n    df = pd.DataFrame(results)\n    \n    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")\n    base_filename = f"experiment_results_{timestamp}"\n    \n    if format == "csv":\n        filename = f"{base_filename}.csv"\n        df.to_csv(filename, index=False)\n    elif format == "excel":\n        filename = f"{base_filename}.xlsx"\n        df.to_excel(filename, index=False)\n    elif format == "json":\n        filename = f"{base_filename}.json"\n        df.to_json(filename, orient="records", indent=2)\n    elif format == "parquet":\n        filename = f"{base_filename}.parquet"\n        df.to_parquet(filename)\n    elif format == "html":\n        filename = f"{base_filename}.html"\n        df.to_html(filename, index=False)\n    elif format == "markdown":\n        filename = f"{base_filename}.md"\n        with open(filename, "w") as f:\n            f.write(df.to_markdown(index=False))\n    elif format == "stata":\n        filename = f"{base_filename}.dta"\n        df.to_stata(filename)\n    elif format == "pickle":\n        filename = f"{base_filename}.pkl"\n        df.to_pickle(filename)\n    else:\n        filename = f"{base_filename}.csv"\n        df.to_csv(filename, index=False)\n    \n    print(f"\\nResults saved to {filename}")\n    return filename\n\ndef main():\n    """Main entry point"""\n    # Check for API keys\n    missing_keys = []\n    for model in MODELS:\n        provider = model["provider"]\n        if provider not in API_KEYS or not API_KEYS[provider]:\n            missing_keys.append(provider)\n    \n    if missing_keys:\n        print("WARNING: Missing API keys for:", ", ".join(set(missing_keys)))\n        print("Set them in the API_KEYS dict or as environment variables.")\n        response = input("\\nContinue anyway? (y/N): ")\n        if response.lower() != 'y':\n            return\n    \n    # Run experiment\n    results = run_experiment()\n    \n    # Save results\n    if results:\n        save_results(results)\n        \n        # Basic summary\n        df = pd.DataFrame(results)\n        print(f"\\nSummary:")\n        print(f"Total calls: {len(df)}")\n        print(f"Successful: {df['success'].sum()}")\n        print(f"Failed: {(~df['success']).sum()}")\n        if 'latency_ms' in df.columns:\n            print(f"Avg latency: {df['latency_ms'].mean():.1f}ms")\n    else:\n        print("\\nNo results to save")\n\nif __name__ == "__main__":\n    main()\n`}}class ii{static generate(e){return this.generateDisabledScript(e.name)}static generateDisabledScript(e){return`#!/usr/bin/env python3\n"""\nLiteral Mode Export - Currently Disabled\n=======================================\nGenerated by Auditomatic Lite on ${(new Date).toISOString()}\n\nThis export mode is temporarily disabled during V2 migration.\nLiteral mode will be restored in the next release with support for:\n- Template trials (cartesian product execution)  \n- Spreadsheet trials (row-by-row execution)\n- Pre-computed exact API calls for reproduction\n\nOriginal trial: ${e}\n\nFor now, please use Simple Mode export which provides full functionality.\n"""\n\nprint("❌ Literal mode export is temporarily disabled during V2 migration.")\nprint("✅ Please use Simple Mode export for full trial reproduction functionality.")\nprint("📅 Literal mode will be restored in the next release.")\n`}}class oi{static generate(e){return this.generateDisabledScript(e.name)}static generateDisabledScript(e){return`#!/usr/bin/env python3\n"""\nNative Mode Export - Currently Disabled\n=======================================\nGenerated by Auditomatic Lite on ${(new Date).toISOString()}\n\nThis export mode is temporarily disabled during V2 migration.\nNative mode will be restored in the next release with support for:\n- Template trials (cartesian product execution)\n- Spreadsheet trials (row-by-row execution)  \n- Official Python SDKs (openai, anthropic, ollama)\n- Clean production-ready code\n\nOriginal trial: ${e}\n\nFor now, please use Simple Mode export which provides full functionality.\nRequired packages when restored: pip install openai anthropic ollama\n"""\n\nprint("❌ Native mode export is temporarily disabled during V2 migration.")\nprint("✅ Please use Simple Mode export for full trial reproduction functionality.")\nprint("📅 Native mode will be restored in the next release.")\nprint("📦 When restored, install with: pip install openai anthropic ollama")\n`}}class ci{static async generatePythonScript(e,t){try{const a=t||this.getDefaultOptions(),l=this.validateTrialForExport(e);if(!l.valid)throw new Error(`Trial validation failed: ${l.errors.join(", ")}`);switch(a.mode){case"simple":return si.generate(e);case"literal":return ii.generate(e);case"native":return oi.generate(e);default:throw new Error(`Unknown export mode: ${a.mode}`)}}catch(a){throw new Error(`Failed to generate Python export: ${a instanceof Error?a.message:String(a)}`)}}static async downloadPythonScript(e,t){const a=await this.generatePythonScript(e,t),l=t||this.getDefaultOptions(),n=new Blob([a],{type:"text/x-python"}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=this.generateFilename(e,l.mode),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}static validateTrialForExport(e){const t=[];return Y(e)?(e.template||t.push("Template trial missing template text"),e.variableSnapshots||t.push("Template trial missing variable snapshots"),e.totalCombinations||t.push("Template trial missing combination count")):Q(e)?(e.promptPattern||t.push("Spreadsheet trial missing prompt pattern"),e.datasetSnapshot||t.push("Spreadsheet trial missing dataset snapshot"),e.datasetSnapshot?.rows?.length||t.push("Spreadsheet trial missing dataset rows"),e.totalRows||t.push("Spreadsheet trial missing row count")):t.push("Unknown trial type for export"),e.configurationSnapshots&&0!==e.configurationSnapshots.length?e.configurationSnapshots.forEach((e,a)=>{e.provider||t.push(`Configuration ${a+1} missing provider`),e.modelId||t.push(`Configuration ${a+1} missing model`),e.parameters||t.push(`Configuration ${a+1} missing parameters`)}):t.push("Trial missing model configurations"),{valid:0===t.length,errors:t}}static getExportSummary(e){const t=new Set(e.configurationSnapshots.map(e=>e.provider)),a=Ee(e);return{apiCallCount:e.configurationSnapshots.length*a,providersUsed:Array.from(t),variableCombinations:a,configurations:e.configurationSnapshots.length}}static getDefaultOptions(){return{mode:"simple"}}static generateFilename(e,t){const a=e.name||`trial_${e.id}`,l=(new Date).toISOString().split("T")[0];return`${a.toLowerCase().replace(/[^a-z0-9]/g,"_")}_${t}_${l}.py`}}const ui=Object.freeze(Object.defineProperty({__proto__:null,PythonExportService:ci},Symbol.toStringTag,{value:"Module"})),di={class:"trial-info"},pi={class:"trial-stats"},mi={class:"export-section"},fi={class:"mode-content"},vi={class:"mode-content"},gi={class:"mode-content"},hi={class:"export-section"},yi={class:"preview-content"},bi={class:"preview-info"},wi=o({__name:"PythonExportModal",props:{trial:{}},emits:["close","exported"],setup(e,{emit:t}){const l=e,s=t,i=n("simple"),o=n(!1),c=r(()=>l.trial.progress.total),u=r(()=>l.trial.configurationSnapshots?.length||0),d=r(()=>{if(Y(l.trial))return l.trial.totalCombinations||0;if(Q(l.trial)){return(l.trial.datasetSnapshot?.rows?.length||0)*(l.trial.configurationSnapshots?.length||0)}return 0}),p=r(()=>{const e=.05*d.value+.3*u.value;return Math.round(15+e)}),f=r(()=>{const e=l.trial.name.toLowerCase().replace(/\s+/g,"_"),t=(new Date).toISOString().split("T")[0];return`${e}_${i.value}_${t}.py`}),g=r(()=>{if("simple"===i.value){return 300+(d.value+10*u.value)}if("native"===i.value){return 250+(d.value+8*u.value)}return 200+15*c.value});async function b(){o.value=!0;try{const e={mode:i.value};await ci.downloadPythonScript(l.trial,e),s("exported",f.value),s("close")}catch(e){X.error("Export failed",e),alert("Export failed: "+(e instanceof Error?e.message:"Unknown error"))}finally{o.value=!1}}return(e,t)=>{const l=h("a-button"),n=h("a-tag"),r=h("a-radio"),s=h("a-radio-group"),w=h("a-typography-text");return _(),v(je,{"model-value":!0,title:"Export Python Script",size:"full","onUpdate:modelValue":t[2]||(t[2]=t=>e.$emit("close"))},{footer:y(()=>[a(l,{onClick:t[0]||(t[0]=t=>e.$emit("close")),size:"large","data-testid":"btn-cancel-python-export","aria-label":"Cancel Python export"},{default:y(()=>t[3]||(t[3]=[k(" Cancel ")])),_:1,__:[3]}),a(l,{type:"primary",onClick:b,loading:o.value,size:"large","data-testid":"btn-confirm-python-export","data-mode":i.value,"aria-label":`Export Python script in ${i.value} mode`},{default:y(()=>t[4]||(t[4]=[k(" Export Script ")])),_:1,__:[4]},8,["loading","data-mode","aria-label"])]),default:y(()=>[m("div",di,[m("h3",null,C(e.trial.name),1),m("div",pi,[a(n,null,{default:y(()=>[k(C(c.value)+" API calls",1)]),_:1}),a(n,null,{default:y(()=>[k(C(u.value)+" configurations",1)]),_:1}),a(n,null,{default:y(()=>[k(C(d.value)+" variable combinations",1)]),_:1})])]),m("div",mi,[t[13]||(t[13]=m("h4",null,"Export Mode",-1)),a(s,{value:i.value,"onUpdate:value":t[1]||(t[1]=e=>i.value=e),class:"mode-options","data-testid":"radiogroup-export-mode","aria-label":"Select Python export mode"},{default:y(()=>[a(r,{value:"simple",class:"mode-radio","data-testid":"radio-mode-simple","aria-label":"Simple script mode"},{default:y(()=>[m("div",fi,[t[5]||(t[5]=m("div",{class:"mode-title"},"Simple Script",-1)),t[6]||(t[6]=m("div",{class:"mode-description"}," Educational script with variables as lists. Easy to understand, modify, and extend. Perfect for learning how AI APIs work. ",-1)),a(n,{color:"blue",size:"small"},{default:y(()=>[k("~"+C(p.value)+"KB",1)]),_:1})])]),_:1}),a(r,{value:"literal",class:"mode-radio disabled-mode","data-testid":"radio-mode-literal","aria-label":"Literal reproduction mode",disabled:""},{default:y(()=>[m("div",vi,[t[8]||(t[8]=m("div",{class:"mode-title"},"Literal Reproduction (Coming Soon)",-1)),t[9]||(t[9]=m("div",{class:"mode-description"}," Exact API calls pre-computed. Currently being updated for V2 trials. Will be available in the next release. ",-1)),a(n,{color:"orange",size:"small"},{default:y(()=>t[7]||(t[7]=[k("V2 Migration")])),_:1,__:[7]})])]),_:1}),a(r,{value:"native",class:"mode-radio disabled-mode","data-testid":"radio-mode-native","aria-label":"Native libraries mode",disabled:""},{default:y(()=>[m("div",gi,[t[11]||(t[11]=m("div",{class:"mode-title"},"Native Libraries (Coming Soon)",-1)),t[12]||(t[12]=m("div",{class:"mode-description"}," Uses official Python SDKs (openai, anthropic, ollama). Currently being updated for V2 trials. Will be available in the next release. ",-1)),a(n,{color:"orange",size:"small"},{default:y(()=>t[10]||(t[10]=[k("V2 Migration")])),_:1,__:[10]})])]),_:1})]),_:1},8,["value"])]),t[15]||(t[15]=m("div",{class:"export-section"},[m("h4",null,"Output Format"),m("div",{class:"format-info"},[m("p",null,"Both scripts save results using pandas in your choice of format:"),m("ul",null,[m("li",null,[m("strong",null,"CSV"),k(" - Universal format, opens in Excel/Google Sheets")]),m("li",null,[m("strong",null,"Excel"),k(" - Native Excel format")]),m("li",null,[m("strong",null,"JSON"),k(" - For programmatic access")]),m("li",null,[m("strong",null,"Parquet"),k(" - Efficient compressed format")]),m("li",null,[m("strong",null,"HTML"),k(" - For web viewing")]),m("li",null,[m("strong",null,"Markdown"),k(" - For documentation")]),m("li",null,[m("strong",null,"Stata"),k(" - For statistical analysis")]),m("li",null,[m("strong",null,"Pickle"),k(" - Python native format")])])])],-1)),m("div",hi,[t[14]||(t[14]=m("h4",null,"Script Preview",-1)),m("div",yi,[a(w,{code:"",class:"preview-filename"},{default:y(()=>[k(C(f.value),1)]),_:1}),m("div",bi,[a(n,{size:"small"},{default:y(()=>[k(C(g.value)+" lines",1)]),_:1}),a(n,{size:"small"},{default:y(()=>[k(C(i.value)+" mode",1)]),_:1})])])])]),_:1,__:[15]})}}}),_i=le(o({__name:"ResizableDivider",props:{minSize:{default:300},maxSize:{default:600},currentWidth:{default:380},disabled:{type:Boolean,default:!1}},emits:["resize","resizeStart","resizeEnd","reset"],setup(e,{emit:t}){const a=e,l=t,r=n(!1);return(e,t)=>(_(),p("div",{class:x(["resizable-divider",{resizing:r.value,disabled:e.disabled}]),onMousedown:t[0]||(t[0]=t=>!e.disabled&&function(e){e.preventDefault(),r.value=!0;const t=e.clientX,n=a.currentWidth;l("resizeStart");const s=e=>{if(!r.value)return;const s=e.clientX-t,i=n+s,o=Math.max(a.minSize,Math.min(a.maxSize,i));l("resize",o)},i=()=>{r.value=!1,l("resizeEnd"),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",i),document.body.style.userSelect="",document.body.style.cursor=""};document.body.style.userSelect="none",document.body.style.cursor="col-resize",document.addEventListener("mousemove",s),document.addEventListener("mouseup",i)}(t)),onDblclick:t[1]||(t[1]=t=>!e.disabled&&e.$emit("reset"))},t[2]||(t[2]=[m("div",{class:"divider-handle"},[m("div",{class:"handle-bar"})],-1)]),34))}}),[["__scopeId","data-v-d9082894"]]),ki={class:"trials-view-split","data-testid":"page-trials"},xi={class:"trials-layout"},Ci={class:"trials-content"},Si="auditomatic.trial-sider-width",Ti=le(o({__name:"TrialsViewSplitPanel",setup(e){const t=J(),l=ke(),o=ft(),b=i(),w=s(),x=n(!1),C=n(!1),T=n(null),I=n(null),O=n(!1),E=n(),P=n(),$=n(250),M=localStorage.getItem(Si);M&&($.value=parseInt(M,10));const R=r(()=>l.hasAnyApiKeys||l.isProviderEnabled("ollama-chat")||l.isProviderEnabled("ollama-generate"));function N(e){$.value=e,localStorage.setItem(Si,e.toString())}function F(){$.value=250,localStorage.setItem(Si,"250")}function A(){x.value=!1,E.value=void 0,I.value=null,O.value=!1}function D(e){X.info("Trial created",{trialId:e}),A(),o.selectTrial(e)}async function j(e){X.info("Trial created and started",{trialId:e}),A(),await new Promise(e=>setTimeout(e,100)),o.selectTrial(e)}function L(e){X.info("Opening export for trial",{trialId:e.id}),T.value=e,C.value=!0}function U(e){X.info("Python script exported",{filename:e})}function z(){const e=b.query;if(e.duplicate&&"string"==typeof e.duplicate){const a=t.trials.find(t=>t.id===e.duplicate);a&&(I.value=a,O.value="true"===e.edit,x.value=!0)}else e.designId&&"string"==typeof e.designId?(E.value=e.designId,x.value=!0):e.promptSource&&e.promptId&&(P.value={type:e.promptSource,id:e.promptId},x.value=!0);(e.duplicate||e.designId||e.edit||e.promptSource)&&w.replace({query:{}})}const q=e=>{if((e.metaKey||e.ctrlKey)&&"k"===e.key){e.preventDefault();const t=document.querySelector(".trial-list-search input");t?.focus()}};return c(()=>b.query,()=>{z()}),c(()=>b.params.trialId,()=>{o.syncWithRoute()},{immediate:!0}),u(async()=>{if(document.addEventListener("keydown",q),await t.initialize(),await new Promise(e=>setTimeout(e,50)),z(),o.syncWithRoute(),!o.selectedTrialId){const e=t.trials.find(e=>"running"===e.status);e&&o.selectTrial(e.id)}}),d(()=>{document.removeEventListener("keydown",q)}),(e,t)=>{const l=h("a-button"),n=h("a-alert");return _(),p("div",ki,[R.value?f("",!0):(_(),v(n,{key:0,type:"warning",message:"No LLM providers configured",description:"Add keys for external APIs (local Ollama does not need keys) or enable Ollama provider.","show-icon":"",class:"provider-warning"},{action:y(()=>[a(g(G),{to:"/settings"},{default:y(()=>[a(l,{size:"small",type:"primary"},{default:y(()=>t[3]||(t[3]=[k(" Go to Settings ")])),_:1,__:[3]})]),_:1})]),_:1})),m("div",xi,[m("div",{class:"trials-sider",style:S({width:$.value+"px"})},[a(Qt,{collapsed:$.value<100,onCreateTrial:t[0]||(t[0]=e=>x.value=!0)},null,8,["collapsed"])],4),a(_i,{"min-size":50,"max-size":600,"current-width":$.value,onResize:N,onReset:F},null,8,["current-width"]),m("div",Ci,[a(ri,{onCreateTrial:t[1]||(t[1]=e=>x.value=!0)})])]),x.value?(_(),v(Ne,{key:1,initialDesignId:E.value,initialPromptSource:P.value,trialToDuplicate:I.value||void 0,isEditMode:O.value,onClose:A,onCreated:D,onCreatedAndStarted:j,onExportTrial:L},null,8,["initialDesignId","initialPromptSource","trialToDuplicate","isEditMode"])):f("",!0),C.value&&T.value?(_(),v(wi,{key:2,trial:T.value,onClose:t[2]||(t[2]=e=>{C.value=!1,T.value=null}),onExported:U},null,8,["trial"])):f("",!0)])}}}),[["__scopeId","data-v-1b13d29a"]]);export{Ti as default};
