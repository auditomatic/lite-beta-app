import{_ as e}from"./BaseModal.vue_vue_type_style_index_0_lang-RDmgKwPS.js";import{k as a,d as t,aa as s,Z as i,$ as l,a0 as n,ag as o,f as r,c as d,w as c,o as u,b as p,a3 as g,X as v,F as m,Y as f,_ as h,a2 as y,ad as b,ab as C,G as k,u as w,H as T,al as _,n as I,l as x}from"./vendor-BKA9Ybw0.js";import{I as S,_ as D,a as M,r as P,s as $,u as E,K as O,G as N,c as z,d as j,b as F,p as A,i as V,l as B,E as L,W as H,f as U}from"./index-BTLG4nFQ.js";import{u as J}from"./useEnvironmentalCost-CT3V4Ddp.js";import{a as q}from"./cost-formatting-Bv_drrqY.js";import{G as R}from"./GenericModelSelectorModal-Dq0pxL0X.js";var K={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"};function Y(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?Object(arguments[a]):{},s=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.forEach(function(a){W(e,a,t[a])})}return e}function W(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var G=function(e,t){var s=Y({},e,t.attrs);return a(S,Y({},s,{icon:K}),null)};G.displayName="FileExcelOutlined",G.inheritAttrs=!1;const Z={class:"modal-footer"},Q={key:0,class:"footer-left"},X={class:"footer-actions"},ee=D(t({__name:"ModalFooter",setup:e=>(e,a)=>(i(),s("div",Z,[e.$slots.left?(i(),s("div",Q,[o(e.$slots,"left",{},void 0,!0)])):l("",!0),n("div",X,[o(e.$slots,"default",{},void 0,!0)])]))}),[["__scopeId","data-v-1215184f"]]),ae={key:0,class:"preview-controls"},te={key:0,class:"cycle-info"},se=["innerHTML"],ie={key:1,class:"variable-legend"},le={class:"variable-value"},ne=D(t({__name:"TemplatePreview",props:{design:{},template:{},variables:{},tabularData:{},cycling:{type:Boolean,default:!0},cyclingPaused:{type:Boolean,default:!1},cyclingSpeed:{default:1e3},showControls:{default:"none"},displayMode:{default:"block"},showLegend:{type:Boolean,default:!1},maxHeight:{default:"300px"},previewMode:{type:Boolean,default:!1}},emits:["update:cyclingPaused","update:previewMode"],setup(e,{emit:t}){const o=e,T=t,_=M(),I=r(0);let x=null;const S=["variable-highlight-blue","variable-highlight-green","variable-highlight-purple","variable-highlight-orange","variable-highlight-pink","variable-highlight-teal"],D=d(()=>o.design?o.design.promptTemplate:o.template||""),E=d(()=>{if(o.tabularData&&o.tabularData.length>0)return o.tabularData.map(e=>{const a={};return Object.keys(e).forEach(t=>{let s=t.replace(/[^a-zA-Z0-9_]/g,"_");/^[a-zA-Z]/.test(s)||(s="col_"+s),s=s.replace(/_+/g,"_"),s=s.replace(/_+$/,""),a[s]=String(e[t]||"")}),a});if("aligned"===o.design?.executionMode&&o.design?.variableBindings?.__tabular__){const e=o.design.variableBindings.__tabular__;if("list"===e.type&&e.listId){const a=_.lists.find(a=>a.id===e.listId);if("tabular"===a?.category&&a.tabularData)return a.tabularData.rows.map(e=>{const t={};return a.tabularData.columns.forEach(a=>{t[a]=String(e[a]||"")}),t})}}const e=[];if(o.design?.variableBindings){for(const[t,s]of Object.entries(o.design.variableBindings))if("direct"===s.type&&s.values)e.push({name:t,values:[...s.values]});else if("list"===s.type&&s.listId){const a=_.lists.find(e=>e.id===s.listId);a&&("simple"===a.category&&a.values?e.push({name:t,values:[...a.values]}):"attributed"===a.category&&a.items&&e.push({name:t,values:a.items.map(e=>e.value)}))}}else if(o.variables)for(const[t,s]of Object.entries(o.variables))s.length>0&&e.push({name:t,values:[...s]});if(0===e.length)return[];const a=e.map(e=>e.values);return a.reduce((e,a)=>e.flatMap(e=>a.map(a=>[...e,a])),[[]]).map(a=>{const t={};return e.forEach((e,s)=>{t[e.name]=a[s]}),t})}),O=d(()=>E.value.length),N=d(()=>0===E.value.length?{}:E.value[I.value%E.value.length]),z=d(()=>{let e=D.value;"inline"===o.displayMode&&(e=e.replace(/\s+/g," ").trim());let a=F(e);if(E.value.length>0&&(o.cycling||o.previewMode)){const e=N.value;Object.keys(e).forEach((t,s)=>{const i=e[t];if(void 0!==i){const e=new RegExp(`\\{\\{\\s*${l=t,l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\s*\\}\\}`,"g"),n=`<span class="${j(s)}">${F(i)}</span>`;a=a.replace(e,n)}var l})}return a});function j(e){return S[e%S.length]}function F(e){const a=document.createElement("div");return a.textContent=e,a.innerHTML}function A(){T("update:cyclingPaused",!o.cyclingPaused)}function V(){T("update:previewMode",!o.previewMode)}function B(){!o.cycling||o.cyclingPaused||E.value.length<=1||(L(),x=setInterval(()=>{I.value=(I.value+1)%E.value.length},o.cyclingSpeed))}function L(){x&&(clearInterval(x),x=null)}return c([()=>o.cycling,()=>o.cyclingPaused],()=>{o.cycling&&!o.cyclingPaused?B():L()},{immediate:!0}),c(()=>o.template,()=>{I.value=0}),u(()=>{o.cycling&&!o.cyclingPaused&&B()}),p(()=>{L()}),(e,t)=>{const o=f("a-button");return i(),s("div",{class:g(["template-preview",[`preview-${e.displayMode}`,{"preview-cycling":e.cycling&&!e.cyclingPaused}]])},["none"!==e.showControls?(i(),s("div",ae,["pause-play"===e.showControls?(i(),s(m,{key:0},[a(o,{onClick:A,size:"small",type:e.cyclingPaused?"default":"primary",disabled:!e.cycling||O.value<=1},{default:h(()=>[k(y(e.cyclingPaused?"Start":"Pause")+" Variable Substitution ",1)]),_:1},8,["type","disabled"]),e.cycling&&O.value>1?(i(),s("span",te,y(I.value+1)+" / "+y(O.value),1)):l("",!0)],64)):"editor-mode"===e.showControls?(i(),v(o,{key:1,type:e.previewMode?"default":"primary",onClick:V},{default:h(()=>[e.previewMode?(i(),v(w($),{key:1})):(i(),v(w(P),{key:0})),k(" "+y(e.previewMode?"Return to Editor":"Preview Filled-In Prompts"),1)]),_:1},8,["type"])):l("",!0)])):l("",!0),n("div",{class:"preview-content",innerHTML:z.value,style:b({maxHeight:e.maxHeight})},null,12,se),e.showLegend&&N.value&&Object.keys(N.value).length>0?(i(),s("div",ie,[(i(!0),s(m,null,C(N.value,(e,a,t)=>(i(),s("div",{key:a,class:"legend-item"},[n("span",{class:g(j(t))},y(a),3),n("span",le,y(e),1)]))),128))])):l("",!0)],2)}}}),[["__scopeId","data-v-e1f62fa2"]]),oe={class:"design-selection-step"},re={class:"step-body"},de={class:"design-selector","data-testid":"design-selector"},ce={key:0,class:"no-designs-state"},ue={class:"no-designs-content"},pe={key:1,class:"design-list","data-testid":"design-list"},ge=["data-design-id","data-design-name","onClick"],ve={class:"design-header"},me={class:"design-title-section"},fe={class:"design-name"},he={key:0,class:"design-inline-description"},ye={class:"design-date"},be={class:"design-stats"},Ce={class:"stat-item"},ke={class:"stat-value"},we={class:"stat-item"},Te={class:"stat-value"},_e={class:"stat-item"},Ie={class:"stat-value"},xe={class:"design-selector","data-testid":"spreadsheet-design-selector"},Se={key:0,class:"no-designs-state"},De={class:"no-designs-content"},Me={key:1,class:"design-list","data-testid":"spreadsheet-design-list"},Pe=["data-design-id","data-design-name","onClick"],$e={class:"design-header"},Ee={class:"design-title-section"},Oe={class:"design-name"},Ne={key:0,class:"design-inline-description"},ze={class:"design-date"},je={class:"design-stats"},Fe={class:"stat-item"},Ae={class:"stat-value"},Ve={class:"stat-item"},Be={class:"stat-value"},Le={class:"stat-item"},He={class:"stat-value"},Ue=D(t({__name:"DesignSelectionStep",props:{designSearch:{},filteredDesigns:{},classicDesigns:{},spreadsheetDesigns:{},countVariables:{type:Function},formatLastEditDate:{type:Function},getOutputTypeColor:{type:Function},getCombinationCount:{type:Function}},emits:["select","create-new","create-spreadsheet"],setup(e){const t=e,o=E(),d=r("classic"),{designSearch:c,classicDesigns:u,spreadsheetDesigns:p,countVariables:g,formatLastEditDate:v,getOutputTypeColor:b,getCombinationCount:_}=t;return(e,t)=>{const r=f("a-input"),I=f("a-button"),x=f("a-tag"),S=f("a-tab-pane"),D=f("a-tabs");return i(),s("div",oe,[n("div",re,[a(D,{activeKey:d.value,"onUpdate:activeKey":t[6]||(t[6]=e=>d.value=e),type:"card",class:"design-tabs"},{default:h(()=>[a(S,{key:"classic",tab:"Classic Designs (permutes through all variable combinations)"},{default:h(()=>[n("div",de,[a(r,{value:w(c),"onUpdate:value":t[0]||(t[0]=e=>T(c)?c.value=e:null),placeholder:"Search classic designs...",size:"large",class:"design-search","data-testid":"input-design-search",allowClear:""},{prefix:h(()=>[a(w(O))]),_:1},8,["value"]),0===w(u).length?(i(),s("div",ce,[n("div",ue,[t[8]||(t[8]=n("p",null,"No classic designs found",-1)),a(I,{onClick:t[1]||(t[1]=()=>w(o).initialize())},{default:h(()=>t[7]||(t[7]=[k("Refresh Designs")])),_:1,__:[7]})])])):(i(),s("div",pe,[(i(!0),s(m,null,C(w(u),o=>(i(),s("div",{key:o.id,class:"design-item","data-testid":"design-item","data-design-id":o.id,"data-design-name":o.name,onClick:a=>e.$emit("select",o)},[n("div",ve,[n("div",me,[n("h4",fe,[k(y(o.name)+" ",1),o.description?(i(),s("span",he,"- "+y(o.description),1)):l("",!0)])]),n("span",ye,y(w(v)(o.updated)),1)]),a(ne,{design:o,cycling:!0,"show-controls":"none","display-mode":"inline","max-height":"none",class:"design-description"},null,8,["design"]),n("div",be,[a(x,{size:"small",color:w(b)(o.outputType),class:"output-type-tag"},{default:h(()=>[k(y(o.outputType||"text"),1)]),_:2},1032,["color"]),n("span",Ce,[n("span",ke,y(w(g)(o)),1),t[9]||(t[9]=n("span",{class:"stat-label"},"vars",-1))]),t[12]||(t[12]=n("span",{class:"stat-divider"},"•",-1)),n("span",we,[n("span",Te,y(w(_)(o)),1),t[10]||(t[10]=n("span",{class:"stat-label"},"combos",-1))]),t[13]||(t[13]=n("span",{class:"stat-divider"},"•",-1)),n("span",_e,[n("span",Ie,y(o.tokenEstimate?.avgTokens||"?"),1),t[11]||(t[11]=n("span",{class:"stat-label"},"tokens",-1))])])],8,ge))),128)),n("div",{class:"design-card design-card-create","data-testid":"btn-create-design",onClick:t[2]||(t[2]=a=>e.$emit("create-new"))},[a(w(N),{style:{"font-size":"24px"}}),t[14]||(t[14]=n("span",null,"Create New Design",-1))])]))])]),_:1}),a(S,{key:"spreadsheet",tab:"Spreadsheet Designs (one API call per row)"},{default:h(()=>[n("div",xe,[a(r,{value:w(c),"onUpdate:value":t[3]||(t[3]=e=>T(c)?c.value=e:null),placeholder:"Search spreadsheet designs...",size:"large",class:"design-search","data-testid":"input-spreadsheet-search",allowClear:""},{prefix:h(()=>[a(w(O))]),_:1},8,["value"]),0===w(p).length?(i(),s("div",Se,[n("div",De,[t[16]||(t[16]=n("p",null,"No spreadsheet designs found",-1)),a(I,{type:"primary",onClick:t[4]||(t[4]=a=>e.$emit("create-spreadsheet"))},{default:h(()=>[a(w(G)),t[15]||(t[15]=k(" Create Spreadsheet Design "))]),_:1,__:[15]})])])):(i(),s("div",Me,[(i(!0),s(m,null,C(w(p),o=>(i(),s("div",{key:o.id,class:"design-item","data-testid":"spreadsheet-design-item","data-design-id":o.id,"data-design-name":o.name,onClick:a=>e.$emit("select",o)},[n("div",$e,[n("div",Ee,[n("h4",Oe,[k(y(o.name)+" ",1),o.description?(i(),s("span",Ne,"- "+y(o.description),1)):l("",!0)])]),n("span",ze,y(w(v)(o.updated)),1)]),a(ne,{design:o,cycling:!0,"show-controls":"none","display-mode":"inline","max-height":"none",class:"design-description"},null,8,["design"]),n("div",je,[a(x,{size:"small",color:"orange",class:"output-type-tag"},{default:h(()=>t[17]||(t[17]=[k(" spreadsheet ")])),_:1,__:[17]}),n("span",Fe,[n("span",Ae,y(w(g)(o)),1),t[18]||(t[18]=n("span",{class:"stat-label"},"vars",-1))]),t[21]||(t[21]=n("span",{class:"stat-divider"},"•",-1)),n("span",Ve,[n("span",Be,y(w(_)(o)),1),t[19]||(t[19]=n("span",{class:"stat-label"},"rows",-1))]),t[22]||(t[22]=n("span",{class:"stat-divider"},"•",-1)),n("span",Le,[n("span",He,y(o.tokenEstimate?.avgTokens||"?"),1),t[20]||(t[20]=n("span",{class:"stat-label"},"tokens",-1))])])],8,Pe))),128)),n("div",{class:"design-card design-card-create","data-testid":"btn-create-spreadsheet-design",onClick:t[5]||(t[5]=a=>e.$emit("create-spreadsheet"))},[a(w(G),{style:{"font-size":"24px"}}),t[23]||(t[23]=n("span",null,"Create Spreadsheet Design",-1))])]))])]),_:1})]),_:1},8,["activeKey"])])])}}}),[["__scopeId","data-v-345415fb"]]),Je={class:"trial-metadata-form"},qe={class:"form-section"},Re={class:"trial-name-section"},Ke={class:"repeat-section"},Ye={class:"form-stats"},We={class:"stat-item"},Ge={class:"stat-value"},Ze={class:"stat-item"},Qe={class:"stat-value"},Xe=D(t({__name:"TrialMetadataForm",props:{modelValue:{},totalCombinations:{}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,o=t;function r(e){o("update:modelValue",{...l.modelValue,trialName:e})}function d(e){o("update:modelValue",{...l.modelValue,repeatCount:e||1})}return(e,t)=>{const l=f("a-input"),o=f("a-input-number");return i(),s("div",Je,[n("div",qe,[n("div",Re,[t[0]||(t[0]=n("label",{class:"form-label"},"Trial Name:",-1)),a(l,{value:e.modelValue.trialName,"onUpdate:value":r,placeholder:"Enter trial name",class:"trial-name-input","data-testid":"input-trial-name",size:"large"},null,8,["value"])]),n("div",Ke,[t[1]||(t[1]=n("label",{class:"form-label"},"Repeat Each Prompt:",-1)),a(o,{value:e.modelValue.repeatCount,"onUpdate:value":d,min:1,max:10,size:"large",class:"repeat-count-input"},null,8,["value"]),t[2]||(t[2]=n("span",{class:"repeat-suffix"},"times",-1))])]),n("div",Ye,[n("div",We,[t[3]||(t[3]=n("span",{class:"stat-label"},"Total Combinations:",-1)),n("span",Ge,y(e.totalCombinations),1)]),n("div",Ze,[t[4]||(t[4]=n("span",{class:"stat-label"},"API Calls per Model:",-1)),n("span",Qe,y(e.totalCombinations*e.modelValue.repeatCount),1)])])])}}}),[["__scopeId","data-v-50707609"]]),ea={class:"model-configuration-section"},aa={class:"quick-add-row"},ta={class:"quick-add-section"},sa={class:"quick-add-buttons"},ia={key:0,class:"quick-cost"},la={key:0,class:"config-table","data-testid":"model-config-table"},na=["data-config-index","data-provider","data-model"],oa={class:"col-model"},ra={class:"model-name"},da={class:"model-provider"},ca={class:"col-params"},ua={class:"params-text"},pa={class:"col-calls"},ga={class:"calls-breakdown"},va={class:"calls-value"},ma={class:"col-cost"},fa={class:"cost-breakdown"},ha={key:0,class:"cost-value"},ya={key:1,class:"env-cost"},ba={class:"col-total"},Ca={class:"cost-breakdown"},ka={key:0,class:"cost-value total-cost"},wa={key:1,class:"env-cost"},Ta={class:"col-actions"},_a={key:0,class:"table-summary-row"},Ia={class:"col-model"},xa={class:"summary-label"},Sa={class:"col-calls"},Da={class:"summary-calls"},Ma={class:"col-total"},Pa={key:0,class:"summary-cost"},$a={key:1,class:"empty-config-state"},Ea=D(t({__name:"ModelConfigurationSection",props:{configurations:{},design:{},totalCombinations:{},repeatCount:{}},emits:["show-model-selector","add","remove"],setup(e,{emit:t}){const o=e,r=t,c=z(),u=j(),p=F(),{hasDataForModel:g}=J(),b=d(()=>u.financialCostsEnabled),T=d(()=>u.environmentalCostsEnabled),x=d(()=>o.totalCombinations*o.configurations.length*o.repeatCount),S=d(()=>{let e=0;for(const a of o.configurations)e+=E(a)*o.totalCombinations*o.repeatCount;return e}),D=d(()=>{const e=e=>u.hasApiKey(e),a=(e,a)=>!!c.enabledModels.find(t=>t.provider===e&&t.modelId===a&&t.enabled),t=[],s=new Set,i=[...p.trials].sort((e,a)=>new Date(a.created).getTime()-new Date(e.created).getTime());for(const c of i){if(t.length>=5)break;for(const i of c.configurationSnapshots||[]){if(t.length>=5)break;const l=`${i.provider}:${i.modelId}:${JSON.stringify(i.parameters)}`;if(!s.has(l)&&e(i.provider)&&a(i.provider,i.modelId)){const e=A.getParametersForModel(i.provider,i.modelId);if(!e)continue;if(Object.keys(i.parameters).some(a=>!(a in e)))continue;s.add(l),t.push({provider:i.provider,modelId:i.modelId,displayName:i.modelId,parameters:i.parameters,outputType:"text"})}}}const l=(e,a)=>{const t=A.getParametersForModel(e,a),s={},i=(e,a)=>{Object.entries(e).forEach(([e,t])=>{"object"===t.type&&t.properties?(a[e]={},i(t.properties,a[e])):void 0!==t.default&&(a[e]=t.default)})};i(t,s),s.temperature||!s.options||s.options.temperature||(s.options?s.options.temperature=0:s.temperature=0);const l=(e,a)=>{for(const[t,s]of Object.entries(e))"object"===s.type&&s.properties?(a[t]||(a[t]={}),l(s.properties,a[t])):s.is_output_length&&void 0===a[t]&&(a[t]=128)};return l(t,s),s},n=[{provider:"openai-chat",modelId:"gpt-4.1-nano",displayName:"gpt-4.1-nano",parameters:l("openai-chat","gpt-4.1-nano"),outputType:"text"},{provider:"anthropic",modelId:"claude-3-haiku-20240307",displayName:"claude-3-haiku-20240307",parameters:l("anthropic","claude-3-haiku-20240307"),outputType:"text"}],o=new Set(t.map(e=>`${e.provider}:${e.modelId}:${JSON.stringify(e.parameters)}`));for(const c of n){const s=`${c.provider}:${c.modelId}:${JSON.stringify(c.parameters)}`;!o.has(s)&&e(c.provider)&&a(c.provider,c.modelId)&&t.push(c)}const r=[],d=new Set;for(const c of t){const e=`${c.provider}:${c.modelId}`;d.has(e)||(d.add(e),r.push(c))}return r.slice(0,7)});function M(e,a=""){const t=[];for(const[s,i]of Object.entries(e))if(null!=i){const e=a?`${a}.${s}`:s;if("object"!=typeof i||Array.isArray(i)){const a=Array.isArray(i)?JSON.stringify(i):i;t.push(`${e}=${a}`)}else{const a=M(i,e);a&&"Default settings"!==a&&t.push(...a.split(", "))}}return t.length>0?t.join(", "):a?"":"Default settings"}function P(e){return o.configurations.some(a=>a.provider===e.provider&&a.modelId===e.modelId&&JSON.stringify(a.parameters)===JSON.stringify(e.parameters))}function $(e){const a=c.enabledModels.find(a=>a.provider===e.provider&&a.modelId===e.modelId);if(!a||!o.design)return 0;const t=o.design.tokenEstimate?.avgTokens||0,s=A.getParametersForModel(e.provider,e.modelId);let i=0;for(const[l,n]of Object.entries(s))if(n.is_output_length&&e.parameters[l]){i=e.parameters[l];break}if(0===t||0===i)return 0;return((a.capabilities?.inputCostPerToken||0)*t+(a.capabilities?.outputCostPerToken||0)*i)*o.totalCombinations*o.repeatCount}function E(e){const a=c.enabledModels.find(a=>a.provider===e.provider&&a.modelId===e.modelId);if(!a||!o.design)return 0;const t=o.design.tokenEstimate?.avgTokens||0,s=A.getParametersForModel(e.provider,e.modelId);let i=0;for(const[l,n]of Object.entries(s))if(n.is_output_length&&e.parameters[l]){i=e.parameters[l];break}if(0===t||0===i)return 0;return(a.capabilities?.inputCostPerToken||0)*t+(a.capabilities?.outputCostPerToken||0)*i}function O(e){return E(e)*o.totalCombinations*o.repeatCount}function V(e){return g(e.provider,e.modelId)}function B(e,a){return"per-call"===a?"<1mg CO₂e":"~10mg CO₂e"}return(e,t)=>{const o=f("a-button");return i(),s("div",ea,[n("div",aa,[a(o,{onClick:t[0]||(t[0]=a=>e.$emit("show-model-selector")),type:"primary",size:"large",class:"big-add-model-btn","data-testid":"btn-add-model","aria-label":"Add Model Configuration"},{default:h(()=>[a(w(N)),t[1]||(t[1]=k(" Add Model "))]),_:1,__:[1]}),t[3]||(t[3]=n("div",{class:"separator-bar"},null,-1)),n("div",ta,[t[2]||(t[2]=n("div",{class:"quick-add-label"},"Quick add recent/popular models (with default temperature=0, max response length = 128):",-1)),n("div",sa,[(i(!0),s(m,null,C(D.value,e=>(i(),v(o,{key:`${e.provider}:${e.modelId}:${JSON.stringify(e.parameters)}`,onClick:a=>function(e){P(e)||(r("add",{name:e.displayName,provider:e.provider,modelId:e.modelId,parameters:e.parameters}),I(()=>{const e=document.querySelector(".ant-modal-body");e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})}))}(e),size:"small",class:"quick-preset-btn",disabled:P(e),"data-testid":"quick-add-model","data-provider":e.provider,"data-model":e.modelId,"aria-label":`Quick add ${e.displayName} model`},{default:h(()=>[k(y(e.displayName)+" ",1),b.value?(i(),s("span",ia,y(w(q)($(e))),1)):l("",!0)]),_:2},1032,["onClick","disabled","data-provider","data-model","aria-label"]))),128))])])]),e.configurations.length>0?(i(),s("div",la,[t[8]||(t[8]=_('<div class="table-header" data-v-03f1a70b><div class="col-model" data-v-03f1a70b>Model</div><div class="col-params" data-v-03f1a70b>Parameters</div><div class="col-calls" data-v-03f1a70b>API Calls</div><div class="col-cost" data-v-03f1a70b>Cost per Call</div><div class="col-total" data-v-03f1a70b>Total Cost</div><div class="col-actions" data-v-03f1a70b>Actions</div></div>',1)),(i(!0),s(m,null,C(e.configurations,(r,d)=>(i(),s("div",{key:`model-config-${r.provider}-${r.modelId}-${d}`,class:"table-row","data-testid":"model-config-row","data-config-index":d,"data-provider":r.provider,"data-model":r.modelId},[n("div",oa,[n("div",ra,y(r.provider)+":"+y(r.modelId),1),n("div",da,y(r.provider),1)]),n("div",ca,[n("span",ua,y(M(r.parameters)),1)]),n("div",pa,[n("span",ga,y(e.totalCombinations)+" × "+y(e.repeatCount)+" = ",1),n("span",va,y(e.totalCombinations*e.repeatCount),1)]),n("div",ma,[n("div",fa,[b.value?(i(),s("span",ha,y(w(q)(E(r))),1)):l("",!0),T.value&&V(r)?(i(),s("small",ya,y(B(0,"per-call")),1)):l("",!0)])]),n("div",ba,[n("div",Ca,[b.value?(i(),s("span",ka,y(w(q)(O(r))),1)):l("",!0),T.value&&V(r)?(i(),s("small",wa,y(B(0,"total")),1)):l("",!0)])]),n("div",Ta,[a(o,{type:"text",size:"small",danger:"",onClick:a=>e.$emit("remove",d),class:"remove-btn","data-testid":"remove-model-config","data-config-index":d,"aria-label":`Remove ${r.provider} ${r.modelId} configuration`},{default:h(()=>t[4]||(t[4]=[k("Remove")])),_:2,__:[4]},1032,["onClick","data-config-index","aria-label"])])],8,na))),128)),e.configurations.length>1?(i(),s("div",_a,[n("div",Ia,[n("div",xa,"TOTAL ("+y(e.configurations.length)+" models)",1)]),t[5]||(t[5]=n("div",{class:"col-params"},null,-1)),n("div",Sa,[n("span",Da,y(x.value),1)]),t[6]||(t[6]=n("div",{class:"col-cost"},null,-1)),n("div",Ma,[b.value?(i(),s("span",Pa,y(w(q)(S.value)),1)):l("",!0)]),t[7]||(t[7]=n("div",{class:"col-actions"},null,-1))])):l("",!0)])):(i(),s("div",$a,t[9]||(t[9]=[n("p",null,"No models configured yet. Add at least one model to continue.",-1)])))])}}}),[["__scopeId","data-v-03f1a70b"]]);const Oa={key:0,class:"trial-creation-form"},Na={class:"streamlined-content"},za={class:"content-section"},ja={class:"section-header"},Fa={class:"section-body"},Aa={key:1,class:"selected-design-with-template"},Va={class:"unified-header"},Ba={class:"combinations-count"},La={class:"header-controls"},Ha={class:"design-stats"},Ua={class:"stat-item"},Ja={class:"stat-value"},qa={class:"stat-item"},Ra={class:"stat-value"},Ka={class:"stat-item"},Ya={class:"stat-value"},Wa={key:0,class:"content-section","data-testid":"trial-config-section"},Ga={class:"section-body"},Za={class:"model-section"},Qa={class:"tab-footer"},Xa={class:"footer-actions"},et={class:"streamlined-content"},at={class:"content-section"},tt={class:"section-header"},st={class:"section-body"},it={key:1,class:"selected-design-with-template"},lt={class:"unified-header"},nt={class:"combinations-count"},ot={class:"header-controls"},rt={class:"design-stats"},dt={class:"stat-item"},ct={class:"stat-value"},ut={class:"stat-item"},pt={class:"stat-value"},gt={class:"stat-item"},vt={class:"stat-value"},mt={key:0,class:"content-section","data-testid":"trial-config-section"},ft={class:"section-body"},ht={class:"model-section"},yt=D(t({__name:"TrialCreationModalNew",props:{initialDesignId:{},trialToDuplicate:{},isEditMode:{type:Boolean},isTabMode:{type:Boolean}},emits:["close","created","created-and-started","export-trial"],setup(t,{emit:o}){const g=t,m=o,b=F(),C=d(()=>({type:g.isEditMode?"edit":g.trialToDuplicate?"duplicate":"create",initialDesignId:g.initialDesignId,sourceTrial:g.trialToDuplicate||void 0})),T=M(),_=function(e){const a=E(),t=M(),s=z(),i=F(),l=j(),n=r(null),o=r(""),c=r(1),u=r([]),p=r(!1),g=r(!1),v=r(!1),m=r(!1),f=d(()=>{if(!n.value)return 0;let e=1;for(const a of Object.values(n.value.variableBindings))if("direct"===a.type)e*=a.values?.length||1;else if(a.listId){const s=t.lists.find(e=>e.id===a.listId);e*=s?.itemCount||1}return e}),h=d(()=>f.value*u.value.length*c.value),y=d(()=>{let e=0;for(const a of u.value)e+=w(a)*f.value*c.value;return e}),b=d(()=>null!==n.value&&u.value.length>0);function C(e){n.value=e,o.value=k(e),v.value=!0}function k(e){return e||n.value?`${e?.name||n.value?.name||"Trial"} - ${(new Date).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}`:"New Trial"}function w(e){const a=s.enabledModels.find(a=>a.provider===e.provider&&a.modelId===e.modelId);if(!a)return 0;const t=n.value?.tokenEstimate?.avgTokens||0,i=A.getParametersForModel(e.provider,e.modelId);let l=0;for(const[s,n]of Object.entries(i))if(n.is_output_length&&e.parameters[s]){l=e.parameters[s];break}return 0===t||0===l?0:(a.capabilities?.inputCostPerToken||0)*t+(a.capabilities?.outputCostPerToken||0)*l}return{selectedDesign:n,trialName:o,repeatCount:c,configurations:u,creating:p,showModelSelector:g,liveUpdatePaused:v,showPlaceholders:m,totalCombinations:f,totalExperiments:h,totalCost:y,canProceed:b,selectDesign:C,generateTrialName:k,addConfiguration:function(e){u.value.push(e)},removeConfiguration:function(e){u.value.splice(e,1)},getConfigCostPerCall:w,createDraftTrial:async function(){if(n.value&&0!==u.value.length){p.value="draft";try{const e=await i.createTrial({name:o.value||k(),designId:n.value.id,configurations:u.value.map(e=>({name:e.name,provider:e.provider,modelId:e.modelId,parameters:JSON.parse(JSON.stringify(e.parameters||{}))})),repeatConfig:c.value>1?{callsPerPrompt:c.value,strategy:"sequential"}:void 0});return V.success("Trial created as draft!"),e}catch(e){throw B.error("Failed to create draft trial",e),V.error("Failed to create draft trial"),e}finally{p.value=!1}}},createAndStartTrial:async function(){if(n.value&&0!==u.value.length){p.value="start";try{const e=await i.createTrial({name:o.value||k(),designId:n.value.id,configurations:u.value.map(e=>({name:e.name,provider:e.provider,modelId:e.modelId,parameters:JSON.parse(JSON.stringify(e.parameters||{}))})),repeatConfig:c.value>1?{callsPerPrompt:c.value,strategy:"sequential"}:void 0});V.success("Trial created!");const a=await i.getRunningTrials();return a.length>0?{trialId:e,runningTrial:a[0]}:(V.success("Starting execution..."),await i.executeTrial(e),{trialId:e})}catch(e){throw B.error("Failed to create trial",e),V.error("Failed to create trial"),e}finally{p.value=!1}}},createAndExportTrial:async function(){if(n.value&&0!==u.value.length){p.value="export";try{const e=await i.createTrial({name:o.value||k(),designId:n.value.id,configurations:u.value.map(e=>({name:e.name,provider:e.provider,modelId:e.modelId,parameters:JSON.parse(JSON.stringify(e.parameters||{}))})),repeatConfig:c.value>1?{callsPerPrompt:c.value,strategy:"sequential"}:void 0}),a=await i.getTrial(e);if(!a)throw new Error("Trial not found after creation");return V.success("Trial created! Opening export options..."),a}catch(e){throw B.error("Failed to create trial for export",e),V.error("Failed to create trial for export"),e}finally{p.value=!1}}},initialize:async function(){await Promise.all([a.initialize(),t.initialize(),i.initialize()]);const s=e.value;if(s.initialDesignId){const e=a.designs.find(e=>e.id===s.initialDesignId);e&&C(e)}if(s.sourceTrial){const e=s.sourceTrial,t=a.designs.find(a=>a.id===e.designSnapshot.originalId);t&&(n.value=t,o.value="edit"===s.type?e.name:`Copy of ${e.name}`,e.repeatConfig?.callsPerPrompt&&(c.value=e.repeatConfig.callsPerPrompt),e.configurationSnapshots&&e.configurationSnapshots.length>0&&(u.value=e.configurationSnapshots.map(e=>({name:e.name||e.modelId,provider:e.provider,modelId:e.modelId,parameters:e.parameters||{}}))),v.value=!0)}},designsStore:a,variableListsStore:t,modelsStore:s,settingsStore:l}}(C),I=function(){const e=E(),a=M(),t=r(""),s=r(0);let i=null;const l=d(()=>{const a=e.designs;if(!t.value)return a;const s=t.value.toLowerCase();return a.filter(e=>e.name.toLowerCase().includes(s)||e.promptTemplate.toLowerCase().includes(s))}),n=d(()=>l.value.filter(e=>!e.executionMode||"cartesian"===e.executionMode)),o=d(()=>l.value.filter(e=>"aligned"===e.executionMode));function c(e){return e.replace(/\n+/g," ").replace(/\s+/g," ").trim()}function g(e){if(!e.variableBindings)return[{}];const t=[];for(const[i,l]of Object.entries(e.variableBindings))if("direct"===l.type&&l.values)t.push({name:i,values:[...l.values]});else if("list"===l.type&&l.listId){const e=a.lists.find(e=>e.id===l.listId);if(e){let a=[];a="simple"===e.category&&e.values?e.values:"attributed"===e.category&&e.items?e.items.map(e=>e.value):[`${i}_sample`],t.push({name:i,values:a})}}if(0===t.length)return[{}];const s=[...t.map(e=>e.values).reduce((e,a)=>e.flatMap(e=>a.map(a=>[...e,a])),[[]])];for(let a=s.length-1;a>0;a--){const e=Math.floor(Math.random()*(a+1));[s[a],s[e]]=[s[e],s[a]]}return s.map(e=>{const a={};return t.forEach((t,s)=>{a[t.name]=e[s]}),a})}function v(e){const a=document.createElement("div");return a.textContent=e,a.innerHTML}function m(){i||(i=setInterval(()=>{s.value++},1e3))}function f(){i&&(clearInterval(i),i=null)}return u(()=>{m()}),p(()=>{f()}),{designSearch:t,previewCycleIndex:s,filteredDesigns:l,classicDesigns:n,spreadsheetDesigns:o,countVariables:function(e){return Object.keys(e.variableBindings).length},truncateTemplate:c,formatLastEditDate:function(e){const a=new Date,t=a.getTime()-e.getTime(),s=Math.floor(t/864e5);if(0===s)return"Today";if(1===s)return"Yesterday";if(s<7)return`${s} days ago`;if(s<30){const e=Math.floor(s/7);return`${e} week${e>1?"s":""} ago`}return e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:e.getFullYear()!==a.getFullYear()?"numeric":void 0})},getOutputTypeColor:function(e){return{text:"blue",number:"green",boolean:"purple",json:"orange"}[e]||"default"},getCombinationCount:function(e){if(!e.variableBindings)return"1";let t=1;for(const s of Object.values(e.variableBindings))if("direct"===s.type&&s.values)t*=s.values.length;else if("list"===s.type&&s.listId){const e=a.lists.find(e=>e.id===s.listId);t*=e?.itemCount||1}return t>1e3?`${(t/1e3).toFixed(1)}k`:t.toString()},generateVariableCombinations:g,getPreviewTemplateHTML:function(e){const a=g(e);if(a.length<=1)return v(c(e.promptTemplate));const t=a[s.value%a.length],i=["variable-highlight-blue","variable-highlight-green","variable-highlight-purple","variable-highlight-orange","variable-highlight-pink","variable-highlight-teal"];let l=e.promptTemplate;Object.keys(e.variableBindings||{}).forEach((e,a)=>{if(void 0!==t[e]){const s=new RegExp(`\\{\\{\\s*${e}\\s*\\}\\}`,"g"),n=`<span class="${i[a%i.length]}">${v(String(t[e]))}</span>`;l=l.replace(s,n)}});let n=v(l);return i.forEach(e=>{n=n.replace(new RegExp(`&lt;span class="${e}"&gt;`,"g"),`<span class="${e}">`).replace(/&lt;\/span&gt;/g,"</span>")}),c(n)},escapeHtml:v,startCycling:m,stopCycling:f}}(),S=r(!0),D=d(()=>_.selectedDesign.value),P=d({get:()=>_.trialName.value,set:e=>{_.trialName.value=e}}),$=d({get:()=>_.repeatCount.value,set:e=>{_.repeatCount.value=e}}),O=d(()=>_.configurations.value),N=d({get:()=>_.showModelSelector.value,set:e=>{_.showModelSelector.value=e}}),J=d(()=>_.creating.value),q=d(()=>_.totalCombinations.value),{countVariables:K,getOutputTypeColor:Y}=I,W=d(()=>g.isEditMode&&g.trialToDuplicate?`Edit Trial: ${g.trialToDuplicate.name}`:g.trialToDuplicate?`Duplicate Trial: ${g.trialToDuplicate.name}`:"Create New Trial"),G=d(()=>_.canProceed.value);async function Z(e){0===T.lists.length&&await T.initialize();const a={...e,variableBindings:Object.entries(e.variableBindings).reduce((e,[a,t])=>(e[a]={type:t.type,values:t.values?[...t.values]:void 0,listId:t.listId,listName:t.listName,source:t.source?{...t.source}:void 0},e),{}),tokenEstimate:e.tokenEstimate?{...e.tokenEstimate}:void 0,refusalWords:e.refusalWords?[...e.refusalWords]:void 0};_.selectDesign(a),S.value=!0,I.stopCycling()}async function Q(e){try{const a=await U.designs.get(e);a&&_.selectDesign(a)}catch(a){B.error("Failed to load design",a),H.error({title:"Failed to load design",content:a instanceof Error?a.message:"Unknown error"})}}function X(){_.selectedDesign.value=null,_.configurations.value=[]}async function ae(){m("close"),window.location.href="#/designs"}async function te(){m("close"),window.location.href="#/spreadsheet"}function se(e){_.trialName.value=e.trialName,_.repeatCount.value=e.repeatCount}function ie(e){_.addConfiguration(e)}function le(e){_.removeConfiguration(e)}function oe(e){ie(e),_.showModelSelector.value=!1}async function re(){try{const e=await _.createDraftTrial();e&&(m("created",e),m("close"))}catch(e){}}async function de(){try{const e=await _.createAndExportTrial();e&&(m("export-trial",e),m("close"))}catch(e){}}async function ce(){try{const e=await _.createAndStartTrial();e&&(e.runningTrial?H.confirm({title:"Another trial is already running",content:x("div",{style:"font-size: 14px; line-height: 1.6;"},[x("p",{style:"font-weight: 600; margin-bottom: 12px;"},`The trial "${e.runningTrial.name}" is currently executing.`),x("p",{style:"margin-bottom: 16px;"},"You can only run one trial at a time. Here are your options:"),x("ul",{style:"margin: 0 0 16px 20px; padding: 0;"},[x("li",{style:"margin-bottom: 8px;"},[x("strong","Start new trial: "),"This will automatically pause the current trial. You can resume it later from the Trials page."]),x("li",{style:"margin-bottom: 8px;"},[x("strong","Create as draft: "),"Save this trial configuration without starting it. You can run it later when the current trial completes."]),x("li",[x("strong","Keep current trial: "),"Cancel this action and let the current trial continue running."])]),x("div",{style:"background: #f0f2f5; padding: 12px; border-radius: 6px; margin-top: 16px;"},[x("p",{style:"margin: 0; font-size: 13px; color: #666;"},[x("strong","💡 Tip: "),"Paused trials retain their progress and can be resumed anytime. All completed API calls are saved."])])]),width:600,okText:"Start new trial (pause current)",cancelText:"Keep current trial running",onOk:async()=>{try{await b.executeTrial(e.trialId),m("created-and-started",e.trialId),m("close")}catch(a){B.error("Failed to start trial after confirmation",a),V.error("Failed to start trial")}},onCancel:async()=>{try{await b.deleteTrial(e.trialId)}catch(a){B.error("Failed to delete trial after cancellation",a)}}}):(m("created-and-started",e.trialId),m("close")))}catch(e){}}function ue(){S.value=!S.value,S.value?I.stopCycling():I.startCycling()}return u(async()=>{await _.initialize(),0===T.lists.length&&await T.initialize()}),c(()=>g.trialToDuplicate,()=>{g.trialToDuplicate&&async function(){if(g.trialToDuplicate)try{g.trialToDuplicate.designSnapshot?.originalId&&await Q(g.trialToDuplicate.designSnapshot.originalId),g.isEditMode?_.trialName.value=g.trialToDuplicate.name:_.trialName.value=`${g.trialToDuplicate.name} (Copy)`,_.repeatCount.value=g.trialToDuplicate.repeatConfig?.callsPerPrompt||1,_.configurations.value=g.trialToDuplicate.configurationSnapshots||[]}catch(e){B.error("Failed to initialize duplication",e),H.error({title:"Failed to load trial data",content:e instanceof Error?e.message:"Unknown error"})}}()},{immediate:!0}),c(()=>g.initialDesignId,()=>{g.initialDesignId&&!g.trialToDuplicate&&async function(){g.initialDesignId&&await Q(g.initialDesignId)}()},{immediate:!0}),(t,o)=>{const r=f("a-button"),d=f("a-tag");return t.isTabMode?(i(),s("div",Oa,[n("div",Na,[n("section",za,[n("div",ja,[o[8]||(o[8]=n("h3",null,"What are you testing?",-1)),D.value?(i(),v(r,{key:0,onClick:X,size:"small",class:"back-button",style:{"margin-left":"2em"}},{default:h(()=>o[7]||(o[7]=[k(" ← Back to Select Design ")])),_:1,__:[7]})):l("",!0)]),n("div",Fa,[D.value?(i(),s("div",Aa,[n("div",Va,[n("h4",null,y(D.value.name),1),n("span",Ba,y(q.value)+" combinations",1),n("div",La,[a(r,{onClick:ue,size:"small",type:S.value?"default":"primary",class:"pause-btn"},{default:h(()=>[k(y(S.value?"Start Variable Substitution":"Pause Variable Substitution"),1)]),_:1},8,["type"])])]),a(ne,{design:D.value,cycling:!0,"cycling-paused":S.value,"show-controls":"none","display-mode":"inline","max-height":"none",class:"step2-preview","onUpdate:cyclingPaused":o[0]||(o[0]=e=>S.value=e)},null,8,["design","cycling-paused"]),n("div",Ha,[a(d,{size:"small",color:w(Y)(D.value.outputType),class:"output-type-tag"},{default:h(()=>[k(y(D.value.outputType||"text"),1)]),_:1},8,["color"]),n("span",Ua,[n("span",Ja,y(w(K)(D.value)),1),o[9]||(o[9]=n("span",{class:"stat-label"},"vars",-1))]),o[12]||(o[12]=n("span",{class:"stat-divider"},"•",-1)),n("span",qa,[n("span",Ra,y(q.value),1),o[10]||(o[10]=n("span",{class:"stat-label"},"combos",-1))]),o[13]||(o[13]=n("span",{class:"stat-divider"},"•",-1)),n("span",Ka,[n("span",Ya,y(D.value.tokenEstimate?.avgTokens||"?"),1),o[11]||(o[11]=n("span",{class:"stat-label"},"tokens",-1))])])])):(i(),v(Ue,{key:0,"design-search":w(I).designSearch,"filtered-designs":w(I).filteredDesigns,"classic-designs":w(I).classicDesigns,"spreadsheet-designs":w(I).spreadsheetDesigns,"count-variables":w(I).countVariables,"format-last-edit-date":w(I).formatLastEditDate,"get-output-type-color":w(I).getOutputTypeColor,"get-combination-count":w(I).getCombinationCount,onSelect:Z,onCreateNew:ae,onCreateSpreadsheet:te},null,8,["design-search","filtered-designs","classic-designs","spreadsheet-designs","count-variables","format-last-edit-date","get-output-type-color","get-combination-count"]))])]),D.value?(i(),s("section",Wa,[o[15]||(o[15]=n("h3",null,"Trial Configuration",-1)),n("div",Ga,[a(Xe,{"model-value":{trialName:P.value,repeatCount:$.value},"total-combinations":q.value,"onUpdate:modelValue":se},null,8,["model-value","total-combinations"]),n("div",Za,[o[14]||(o[14]=n("h4",null,"Model Configuration",-1)),a(Ea,{configurations:O.value,design:D.value,"total-combinations":q.value,"repeat-count":$.value,onShowModelSelector:o[1]||(o[1]=e=>N.value=!0),onAdd:ie,onRemove:le},null,8,["configurations","design","total-combinations","repeat-count"])])])])):l("",!0)]),n("div",Qa,[n("div",Xa,[a(r,{size:"large",onClick:re,loading:"draft"===J.value,disabled:!G.value,"data-testid":"btn-create-draft-tab","aria-label":"Create trial as draft"},{default:h(()=>o[16]||(o[16]=[k(" Create as Draft ")])),_:1,__:[16]},8,["loading","disabled"]),a(r,{size:"large",onClick:de,loading:"export"===J.value,disabled:!G.value,"data-testid":"btn-export-python-tab","aria-label":"Export trial to Python"},{default:h(()=>o[17]||(o[17]=[k(" Export to Python ")])),_:1,__:[17]},8,["loading","disabled"]),a(r,{type:"primary",size:"large",onClick:ce,loading:"start"===J.value,disabled:!G.value,"data-testid":"btn-create-and-start-tab","aria-label":"Create and start trial execution"},{default:h(()=>[a(w(L)),o[18]||(o[18]=k(" Create and Start "))]),_:1,__:[18]},8,["loading","disabled"])])]),a(R,{open:N.value&&!!D.value,mode:"trial",design:D.value||void 0,"existing-configurations":O.value,onClose:o[2]||(o[2]=e=>N.value=!1),onAddConfiguration:oe},null,8,["open","design","existing-configurations"])])):(i(),v(e,{key:1,"model-value":!0,title:W.value,size:"full","data-testid":"modal-trial-creation","onUpdate:modelValue":o[6]||(o[6]=e=>t.$emit("close"))},{footer:h(()=>[a(ee,null,{default:h(()=>[a(r,{size:"large",onClick:re,loading:"draft"===J.value,disabled:!G.value,"data-testid":"btn-create-draft","aria-label":"Create trial as draft"},{default:h(()=>o[28]||(o[28]=[k(" Create as Draft ")])),_:1,__:[28]},8,["loading","disabled"]),a(r,{size:"large",onClick:de,loading:"export"===J.value,disabled:!G.value,"data-testid":"btn-export-python","aria-label":"Export trial to Python"},{default:h(()=>o[29]||(o[29]=[k(" Export to Python ")])),_:1,__:[29]},8,["loading","disabled"]),a(r,{type:"primary",size:"large",onClick:ce,loading:"start"===J.value,disabled:!G.value,"data-testid":"btn-create-and-start","aria-label":"Create and start trial execution"},{default:h(()=>[a(w(L)),o[30]||(o[30]=k(" Create and Start "))]),_:1,__:[30]},8,["loading","disabled"])]),_:1})]),default:h(()=>[n("div",et,[n("section",at,[n("div",tt,[o[20]||(o[20]=n("h3",null,"What are you testing?",-1)),D.value?(i(),v(r,{key:0,onClick:X,size:"small",class:"back-button",style:{"margin-left":"2em"}},{default:h(()=>o[19]||(o[19]=[k(" ← Back to Select Design ")])),_:1,__:[19]})):l("",!0)]),n("div",st,[D.value?(i(),s("div",it,[n("div",lt,[n("h4",null,y(D.value.name),1),n("span",nt,y(q.value)+" combinations",1),n("div",ot,[a(r,{onClick:ue,size:"small",type:S.value?"default":"primary",class:"pause-btn"},{default:h(()=>[k(y(S.value?"Start Variable Substitution":"Pause Variable Substitution"),1)]),_:1},8,["type"])])]),a(ne,{design:D.value,cycling:!0,"cycling-paused":S.value,"show-controls":"none","display-mode":"inline","max-height":"none",class:"step2-preview","onUpdate:cyclingPaused":o[3]||(o[3]=e=>S.value=e)},null,8,["design","cycling-paused"]),n("div",rt,[a(d,{size:"small",color:w(Y)(D.value.outputType),class:"output-type-tag"},{default:h(()=>[k(y(D.value.outputType||"text"),1)]),_:1},8,["color"]),n("span",dt,[n("span",ct,y(w(K)(D.value)),1),o[21]||(o[21]=n("span",{class:"stat-label"},"vars",-1))]),o[24]||(o[24]=n("span",{class:"stat-divider"},"•",-1)),n("span",ut,[n("span",pt,y(q.value),1),o[22]||(o[22]=n("span",{class:"stat-label"},"combos",-1))]),o[25]||(o[25]=n("span",{class:"stat-divider"},"•",-1)),n("span",gt,[n("span",vt,y(D.value.tokenEstimate?.avgTokens||"?"),1),o[23]||(o[23]=n("span",{class:"stat-label"},"tokens",-1))])])])):(i(),v(Ue,{key:0,"design-search":w(I).designSearch,"filtered-designs":w(I).filteredDesigns,"classic-designs":w(I).classicDesigns,"spreadsheet-designs":w(I).spreadsheetDesigns,"count-variables":w(I).countVariables,"format-last-edit-date":w(I).formatLastEditDate,"get-output-type-color":w(I).getOutputTypeColor,"get-combination-count":w(I).getCombinationCount,onSelect:Z,onCreateNew:ae,onCreateSpreadsheet:te},null,8,["design-search","filtered-designs","classic-designs","spreadsheet-designs","count-variables","format-last-edit-date","get-output-type-color","get-combination-count"]))])]),D.value?(i(),s("section",mt,[o[27]||(o[27]=n("h3",null,"Trial Configuration",-1)),n("div",ft,[a(Xe,{"model-value":{trialName:P.value,repeatCount:$.value},"total-combinations":q.value,"onUpdate:modelValue":se},null,8,["model-value","total-combinations"]),n("div",ht,[o[26]||(o[26]=n("h4",null,"Model Configuration",-1)),a(Ea,{configurations:O.value,design:D.value,"total-combinations":q.value,"repeat-count":$.value,onShowModelSelector:o[4]||(o[4]=e=>N.value=!0),onAdd:ie,onRemove:le},null,8,["configurations","design","total-combinations","repeat-count"])])])])):l("",!0)]),a(R,{open:N.value&&!!D.value,mode:"trial",design:D.value||void 0,"existing-configurations":O.value,onClose:o[5]||(o[5]=e=>N.value=!1),onAddConfiguration:oe},null,8,["open","design","existing-configurations"])]),_:1},8,["title"]))}}}),[["__scopeId","data-v-e3a62538"]]);export{G as F,yt as T,ne as a};
