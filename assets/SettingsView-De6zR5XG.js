import{i as se,an as Ae,am as Me,a4 as Q,r as I,c as ae,p as _,w as ue,n as ye,ae as ce,B as V,j as g,k as t,b as j,q as Z,y as L,aa as te,z as T,D as ie,v as le,t as G,x as F,F as re,A as de,ao as Pe,ap as Te,m,N as Re,a as A,_ as ne,u as me,ab as P,aq as Ee,ar as ee,o as Ue,ad as B,d as X,as as Ie}from"./index-CL-lquVN.js";const De={class:"secure-api-keys-section"},Fe={class:"section-header"},Ke={class:"security-overview"},_e={class:"security-status"},Le={class:"status-text"},Oe={class:"global-security-settings"},Ve={class:"default-mode-display"},Ne={class:"current-default"},Be={class:"mode-icon"},qe={class:"mode-text"},ze={class:"mode-description"},je={key:0,class:"setup-prompt"},Ge={class:"security-dashboard"},Je={class:"dashboard-cards"},We={class:"security-card encrypted"},He={class:"card-value"},Ye={class:"security-card session"},Ze={class:"card-value"},Qe={class:"security-card plaintext"},Xe={class:"card-value"},et={key:0,class:"unlock-prompt"},tt={key:0,class:"no-providers"},st={key:1,class:"providers-grid"},nt={class:"provider-header"},ot={class:"provider-status"},it={class:"provider-info"},at={class:"endpoints-count"},lt={key:0,class:"base-url"},rt={class:"security-mode-section"},ut={class:"api-key-section"},dt=["for"],ct={key:0,class:"secure-key-input"},mt={class:"input-group"},pt={key:0,class:"locked-message"},yt={key:1,class:"legacy-key-input"},vt={class:"input-group"},ft={class:"key-actions"},gt={class:"security-info"},bt={key:0,class:"security-note encrypted"},kt={key:1,class:"security-note session"},St={key:2,class:"security-note plaintext"},wt=se({__name:"SecureApiKeysSection",props:{onStatusMessage:{type:Function}},setup(H){const S=Ae(),n=Me(),u=Q({}),p=Q({}),C=Q({}),$=I(!1),c=I(!1),D=I(!1),v=I(!1),b=I(!1),w=I(""),r=I(null),k=I(null),R=I(null),E=ae(()=>{var f;if(!$.value)return[];const i=_.getAllGroups(),o=[];for(const h of i){if(h==="deterministic")continue;const N=_.getProvidersInGroup(h);if(N.length===0)continue;const W=N[0];if(!_.requiresApiKey(W.id))continue;const Y=S.providers.get(h),y=h.charAt(0).toUpperCase()+h.slice(1);o.push({id:h,name:y,hasApiKey:!!S.getApiKey(h)||e(h),enabled:(Y==null?void 0:Y.enabled)??!0,endpoints:N.map(z=>z.id),baseUrl:(Y==null?void 0:Y.baseUrl)||((f=W.api)==null?void 0:f.baseUrl)||""})}return o}),x=ae(()=>n.securityStatus.value),q=ae(()=>{const i=localStorage.getItem("v3-settings");if(!i)return{};try{const o=JSON.parse(i);return n.secureStorage.detectPlaintextKeys(o)}catch{return{}}});function O(){return n.hasSetupApiKeySecurity()?!1:(v.value=!0,!0)}function U(i){return n.getEffectiveProviderMode(i)}function J(i){switch(U(i)){case"encrypted":return"🔒 Encrypted";case"session":return"⚠️ Session";case"plaintext":return"📝 Plaintext";default:return"📝 Plaintext"}}function l(i){const o=U(i);return e(i)||!!S.getApiKey(i)?o==="encrypted"&&!n.isUnlocked.value?"Locked":"Configured":"Not configured"}function e(i){return n.hasApiKey(i)}function s(i){return U(i)==="encrypted"?n.hasApiKey(i)&&!n.isUnlocked.value:!1}function a(i){const o=e(i),f=s(i);return f&&o?"Click to unlock and view encrypted key":f&&!o?"Click to unlock and enter API key":o?"Key configured (hidden)":"Enter API key"}function d(){const{lockedProviderCount:i,sessionProviderCount:o,plaintextProviderCount:f}=x.value,h=i+o+f;return h===0?"none":f===h?"low":i>0?"high":"medium"}function M(){switch(d()){case"high":return"🔒";case"medium":return"⚠️";case"low":return"📝";default:return"❓"}}function K(){const{lockedProviderCount:i,sessionProviderCount:o,plaintextProviderCount:f}=x.value;if(i+o+f===0)return"No API keys configured";const N=[];return i>0&&N.push(`${i} encrypted`),o>0&&N.push(`${o} session-only`),f>0&&N.push(`${f} plaintext`),N.join(", ")}function oe(i){switch(i){case"encrypted":return"🔒";case"session":return"⚠️";case"plaintext":return"📝";default:return"📝"}}function ve(i){switch(i){case"encrypted":return"Encrypted";case"session":return"Session Only";case"plaintext":return"Plaintext";default:return"Plaintext"}}function fe(i){switch(i){case"encrypted":return"Keys protected with Auditomatic local store password";case"session":return"Keys stored in memory only";case"plaintext":return"Keys stored without encryption";default:return"Keys stored without encryption"}}function pe(i){C[i]=!C[i]}function ge(i){s(i)&&(b.value=!0)}async function be(i,o){if(o==="encrypted"&&!n.hasMasterPassword.value){v.value=!0;return}D.value=!0;try{const f=await n.setProviderSecurityMode(i,o);if(!f.success){V.error(`Failed to change security mode: ${f.error}`);return}u[i]="",p[i]="",V.success(`Security mode changed to ${o}`),await ce()}catch(f){const h=f instanceof Error?f.message:"Unknown error";V.error(`Failed to change security mode: ${h}`)}finally{D.value=!1}}async function ke(i){const o=p[i];if(!o||O())return;const f=U(i);if(f==="encrypted"&&!n.isUnlocked.value){b.value=!0,k.value=i,R.value=o;return}c.value=!0;try{const h=await n.setApiKey(i,o,f);h.success?(V.success("API key saved successfully"),p[i]=""):V.error(`Failed to save API key: ${h.error}`)}catch(h){const N=h instanceof Error?h.message:"Unknown error";V.error(`Failed to save API key: ${N}`)}finally{c.value=!1}}async function Se(i){const o=u[i];if(o){c.value=!0;try{S.setApiKey(i,o),V.success("API key saved successfully"),u[i]=""}finally{c.value=!1}}}async function we(i){try{await n.clearApiKey(i),S.setApiKey(i,""),u[i]="",p[i]="",V.success("API key cleared")}catch(o){const f=o instanceof Error?o.message:"Unknown error";V.error(`Failed to clear API key: ${f}`)}}function xe(){n.lock(),V.info("All encrypted keys have been locked")}async function he(i){var o,f,h;try{const N=await n.unlock(i.password,i.rememberSession);if(N.success){if(b.value=!1,(o=r.value)==null||o.handleUnlockSuccess(),V.success("API keys unlocked successfully"),k.value&&R.value){const W=k.value,Y=R.value;k.value=null,R.value=null,c.value=!0;try{const y=U(W),z=await n.setApiKey(W,Y,y);z.success?(V.success("API key saved successfully"),p[W]=""):V.error(`Failed to save API key: ${z.error}`)}finally{c.value=!1}}}else(f=r.value)==null||f.handleUnlockFailure(N.error||"Invalid password")}catch(N){const W=N instanceof Error?N.message:"Unknown error";(h=r.value)==null||h.handleUnlockFailure(W)}}function Ce(){Re.confirm({title:"Reset Auditomatic Local Store Password",content:"This will delete all encrypted API keys. You will need to re-enter them. Continue?",okText:"Yes, Reset",okType:"danger",onOk:async()=>{try{localStorage.removeItem("v3-security"),window.location.reload()}catch{V.error("Failed to reset password")}}})}async function $e(i){try{if(A.info("handleSetupSuccess called with:",i),i.mode==="encrypted"&&i.password){const h=await n.setupMasterPassword(i.password);if(!h.success){V.error(`Failed to setup Auditomatic local store password: ${h.error}`);return}A.info("Auditomatic local store password setup complete")}const o=n.setupGlobalSecurity(i.mode,i.password);if(!o.success){V.error(`Failed to setup security: ${o.error}`);return}A.info("Global security setup complete");const f=localStorage.getItem("v3-security");A.info("Verification - localStorage v3-security:",f),v.value=!1,V.success(`Security setup complete! Default mode: ${i.mode}`),await ce()}catch(o){const f=o instanceof Error?o.message:"Unknown error";A.error("Setup failed:",o),V.error(`Setup failed: ${f}`)}}return ue(()=>E.value,i=>{i.forEach(o=>{o.id in u||(u[o.id]=""),o.id in p||(p[o.id]=""),o.id in C||(C[o.id]=!1)})},{immediate:!0}),ye(async()=>{await _.waitForReady(),$.value=!0;const i=q.value;Object.keys(i).length>0&&!n.hasMasterPassword.value&&ce(()=>{V.info({content:`${Object.keys(i).length} API keys found in insecure storage. Consider setting up encryption for better security.`,duration:10})})}),(i,o)=>{const f=le("a-button"),h=le("a-select-option"),N=le("a-select"),W=le("a-input-password"),Y=le("a-tooltip");return m(),g("div",De,[t("div",Fe,[o[5]||(o[5]=t("h2",null,"API Keys",-1)),t("div",Ke,[t("div",_e,[t("span",{class:te(["security-indicator",d()])},T(M()),3),t("span",Le,T(K()),1)]),ie(n).isUnlocked.value?(m(),Z(f,{key:0,size:"small",onClick:xe},{default:G(()=>o[4]||(o[4]=[F(" Lock All ")])),_:1,__:[4]})):L("",!0)])]),o[27]||(o[27]=t("p",{class:"section-description"}," Configure API keys with multiple security options. Choose the right protection level for each provider. ",-1)),t("div",Oe,[o[8]||(o[8]=t("h3",null,"🔧 Default Security Mode",-1)),t("div",Ve,[t("div",Ne,[t("span",Be,T(oe(ie(n).getDefaultSecurityMode())),1),t("span",qe,T(ve(ie(n).getDefaultSecurityMode())),1),t("span",ze,T(fe(ie(n).getDefaultSecurityMode())),1)]),j(f,{onClick:o[0]||(o[0]=y=>v.value=!0)},{default:G(()=>o[6]||(o[6]=[F("Change Default")])),_:1,__:[6]})]),o[9]||(o[9]=t("p",{class:"default-explanation"}," New API keys will use this security mode by default. You can override for individual providers below. ",-1)),ie(n).hasSetupApiKeySecurity()?L("",!0):(m(),g("p",je,o[7]||(o[7]=[t("strong",null,"First time?",-1),F(' Click "Change Default" to set up your security preferences. ')])))]),t("div",Ge,[t("div",Je,[t("div",We,[o[10]||(o[10]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"🔒"),t("h4",null,"Encrypted")],-1)),t("div",He,T(x.value.lockedProviderCount),1),o[11]||(o[11]=t("div",{class:"card-label"},"Protected keys",-1))]),t("div",Ye,[o[12]||(o[12]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"⚠️"),t("h4",null,"Session Only")],-1)),t("div",Ze,T(x.value.sessionProviderCount),1),o[13]||(o[13]=t("div",{class:"card-label"},"Memory only",-1))]),t("div",Qe,[o[14]||(o[14]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"📝"),t("h4",null,"Plaintext")],-1)),t("div",Xe,T(x.value.plaintextProviderCount),1),o[15]||(o[15]=t("div",{class:"card-label"},"Unsecured keys",-1))])]),!ie(n).isUnlocked.value&&x.value.lockedProviderCount>0?(m(),g("div",et,[j(f,{type:"primary",onClick:o[1]||(o[1]=y=>b.value=!0)},{default:G(()=>[F(" Unlock "+T(x.value.lockedProviderCount)+" Encrypted Key"+T(x.value.lockedProviderCount===1?"":"s"),1)]),_:1})])):L("",!0)]),E.value.length===0?(m(),g("div",tt,o[16]||(o[16]=[t("p",null,"No providers requiring API keys are currently configured.",-1)]))):(m(),g("div",st,[(m(!0),g(re,null,de(E.value,y=>(m(),g("div",{key:y.id,class:"provider-card"},[t("div",nt,[t("h3",null,T(y.name),1),t("div",ot,[t("span",{class:te(["security-badge",U(y.id)])},T(J(y.id)),3),t("span",{class:te(["status",{"has-key":y.hasApiKey}])},T(l(y.id)),3)])]),t("div",it,[t("p",at,T(y.endpoints.length)+" endpoint(s) available",1),y.baseUrl?(m(),g("p",lt,"Base URL: "+T(y.baseUrl),1)):L("",!0)]),t("div",rt,[o[20]||(o[20]=t("label",null,"Security Mode:",-1)),j(N,{value:U(y.id),onChange:z=>be(y.id,z),class:"security-mode-select",disabled:D.value},{default:G(()=>[j(h,{value:"encrypted"},{default:G(()=>o[17]||(o[17]=[F(" 🔒 Encrypted (Auditomatic local store password required) ")])),_:1,__:[17]}),j(h,{value:"session"},{default:G(()=>o[18]||(o[18]=[F(" ⚠️ Session Only (Lost on browser close) ")])),_:1,__:[18]}),j(h,{value:"plaintext"},{default:G(()=>o[19]||(o[19]=[F(" 📝 Plaintext (Not recommended) ")])),_:1,__:[19]})]),_:2},1032,["value","onChange","disabled"])]),t("div",ut,[t("label",{for:`api-key-${y.id}`},"API Key:",8,dt),U(y.id)!=="plaintext"?(m(),g("div",ct,[t("div",mt,[j(W,{id:`api-key-${y.id}`,value:p[y.id],"onUpdate:value":z=>p[y.id]=z,type:C[y.id]?"text":"password",placeholder:a(y.id),class:"api-key-input",disabled:!1,onFocus:z=>ge(y.id)},null,8,["id","value","onUpdate:value","type","placeholder","onFocus"]),j(Y,{title:s(y.id)?"Unlock to manage key":C[y.id]?"Hide":"Show"},{default:G(()=>[j(f,{onClick:z=>pe(y.id),class:"toggle-visibility",disabled:s(y.id)},{default:G(()=>[F(T(C[y.id]?"🙈":"👁️"),1)]),_:2},1032,["onClick","disabled"])]),_:2},1032,["title"])]),s(y.id)?(m(),g("div",pt," 🔒 Key is encrypted and locked - click field to unlock ")):L("",!0)])):(m(),g("div",yt,[t("div",vt,[j(W,{id:`api-key-${y.id}`,value:u[y.id],"onUpdate:value":z=>u[y.id]=z,type:C[y.id]?"text":"password",placeholder:y.hasApiKey?"Key configured (hidden)":"Enter API key",class:"api-key-input"},null,8,["id","value","onUpdate:value","type","placeholder"]),j(f,{onClick:z=>pe(y.id),class:"toggle-visibility"},{default:G(()=>[F(T(C[y.id]?"🙈":"👁️"),1)]),_:2},1032,["onClick"])])])),t("div",ft,[U(y.id)!=="plaintext"?(m(),Z(f,{key:0,onClick:z=>ke(y.id),disabled:!p[y.id]||c.value,loading:c.value,type:"primary"},{default:G(()=>o[21]||(o[21]=[F(" Save ")])),_:2,__:[21]},1032,["onClick","disabled","loading"])):(m(),Z(f,{key:1,onClick:z=>Se(y.id),disabled:!u[y.id]||c.value,loading:c.value,type:"primary"},{default:G(()=>o[22]||(o[22]=[F(" Save ")])),_:2,__:[22]},1032,["onClick","disabled","loading"])),y.hasApiKey||e(y.id)?(m(),Z(f,{key:2,onClick:z=>we(y.id),disabled:c.value,class:"clear-button"},{default:G(()=>o[23]||(o[23]=[F(" Clear ")])),_:2,__:[23]},1032,["onClick","disabled"])):L("",!0)]),t("div",gt,[U(y.id)==="encrypted"?(m(),g("div",bt,o[24]||(o[24]=[F(" 🛡️ "),t("span",null,"Key will be encrypted with your Auditomatic local store password",-1)]))):U(y.id)==="session"?(m(),g("div",kt,o[25]||(o[25]=[F(" 🕐 "),t("span",null,"Key stored in memory only - lost on browser refresh",-1)]))):(m(),g("div",St,o[26]||(o[26]=[F(" ⚠️ "),t("span",null,"Key stored in plaintext - vulnerable to attacks",-1)])))])])]))),128))])),j(Pe,{open:v.value,"migration-keys":q.value,onClose:o[2]||(o[2]=y=>v.value=!1),onSuccess:$e},null,8,["open","migration-keys"]),j(Te,{open:b.value,"locked-provider-count":x.value.lockedProviderCount,"password-hint":w.value,ref_key:"unlockModalRef",ref:r,onUnlock:he,onReset:Ce,onClose:o[3]||(o[3]=y=>b.value=!1)},null,8,["open","locked-provider-count","password-hint"])])}}}),xt=ne(wt,[["__scopeId","data-v-24c4a9cb"]]),ht={class:"preferences-section"},Ct={class:"preferences-content"},$t={class:"preference-item"},At={class:"preference-item"},Mt={class:"checkbox-label"},Pt=se({__name:"PreferencesSection",props:{onStatusMessage:{type:Function}},setup(H){const S=me(),n=H,u=Q({theme:"system",enableEnvironmentalCosts:!1});ue(()=>S.settings.core.preferences.value,$=>{u.theme=$.theme,u.enableEnvironmentalCosts=$.enableEnvironmentalCosts},{immediate:!0});async function p(){var c,D;const $=await S.settings.core.setTheme(u.theme);$.ok?(c=n.onStatusMessage)==null||c.call(n,"Theme updated","success"):(D=n.onStatusMessage)==null||D.call(n,`Failed to update theme: ${$.error.message}`,"error")}async function C(){var c,D;const $=await S.settings.core.setEnvironmentalCosts(u.enableEnvironmentalCosts);$.ok?(c=n.onStatusMessage)==null||c.call(n,"Environmental costs setting updated","success"):(D=n.onStatusMessage)==null||D.call(n,`Failed to update setting: ${$.error.message}`,"error")}return($,c)=>(m(),g("div",ht,[c[5]||(c[5]=t("h2",null,"Preferences",-1)),c[6]||(c[6]=t("p",{class:"tab-description"},"Configure application behavior and appearance.",-1)),t("div",Ct,[t("div",$t,[c[3]||(c[3]=t("label",{for:"theme-select"},"Theme:",-1)),P(t("select",{id:"theme-select","onUpdate:modelValue":c[0]||(c[0]=D=>u.theme=D),onChange:p,class:"preference-select"},c[2]||(c[2]=[t("option",{value:"light"},"Light",-1),t("option",{value:"dark"},"Dark",-1),t("option",{value:"system"},"System",-1)]),544),[[Ee,u.theme]])]),t("div",At,[t("label",Mt,[P(t("input",{type:"checkbox","onUpdate:modelValue":c[1]||(c[1]=D=>u.enableEnvironmentalCosts=D),onChange:C,class:"preference-checkbox"},null,544),[[ee,u.enableEnvironmentalCosts]]),c[4]||(c[4]=F(" Show environmental cost estimates "))])])])]))}}),Tt=ne(Pt,[["__scopeId","data-v-5569800c"]]),Rt={class:"performance-recorder"},Et={class:"recorder-controls"},Ut=["disabled"],It=["disabled"],Dt=["disabled"],Ft={class:"recorder-status"},Kt={key:0,class:"status recording"},_t={key:1,class:"status ready"},Lt={key:2,class:"status idle"},Ot={key:0,class:"export-result"},Vt=se({__name:"PerformanceRecorder",setup(H){const S=I(!1),n=I(!1),u=I([]),p=I(""),C=I(0),$=I(0),c=ae(()=>u.value.length>0);let D=null,v=null,b=null;function w(){S.value?k():r()}function r(){if(S.value=!0,C.value=Date.now(),$.value=0,u.value=[],D=window.setInterval(R,100),v=window.setInterval(()=>{$.value=Math.floor((Date.now()-C.value)/1e3)},1e3),"PerformanceObserver"in window)try{b=new PerformanceObserver(e=>{const s=e.getEntries(),a={};if(s.forEach(d=>{d.entryType==="paint"&&(a[d.name.replace("-","")]=d.startTime),d.entryType==="largest-contentful-paint"&&(a.largestContentfulPaint=d.startTime)}),u.value.length>0){const d=u.value[u.value.length-1];d.paint={...d.paint,...a}}}),b.observe({entryTypes:["paint","largest-contentful-paint"]})}catch{A.warn("Performance Observer not fully supported")}A.info("🔴 Performance recording started")}function k(){S.value=!1,D&&(clearInterval(D),D=null),v&&(clearInterval(v),v=null),b&&(b.disconnect(),b=null),A.info(`🟡 Performance recording stopped. Collected ${u.value.length} samples`)}function R(){try{const e={timestamp:Date.now(),timing:E(),network:x(),userAgent:navigator.userAgent,url:window.location.href,customMetrics:q()};if("memory"in performance){const s=performance.memory;e.memory={used:s.usedJSHeapSize,total:s.totalJSHeapSize,limit:s.jsHeapSizeLimit}}u.value.push(e)}catch(e){A.warn("Failed to collect performance sample:",e)}}function E(){const e=performance.getEntriesByType("navigation")[0];return e?{navigation:e.loadEventEnd-e.navigationStart,domContentLoaded:e.domContentLoadedEventEnd-e.navigationStart,loadComplete:e.loadEventEnd-e.navigationStart}:{navigation:performance.now(),domContentLoaded:0,loadComplete:0}}function x(){const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return e?{downlink:e.downlink,effectiveType:e.effectiveType,rtt:e.rtt}:{}}function q(){const e={};e.domNodes=document.querySelectorAll("*").length,e.scripts=document.querySelectorAll("script").length,e.stylesheets=document.querySelectorAll('link[rel="stylesheet"]').length,window.__VUE__&&(e.vueVersion=window.__VUE__.version),window.React&&(e.reactVersion=window.React.version);const s=Array.from(document.querySelectorAll("script[src]"));return e.scriptSources=s.length,e}function O(){const e=[];if(u.value.length===0)return e;const s=u.value,a=s[s.length-1];if(a.memory){const d=a.memory.used/1048576,M=a.memory.limit/(1024*1024),K=d/M*100;K>80?e.push({type:"memory",severity:"critical",description:`Memory usage is ${K.toFixed(1)}% of limit`,value:d,recommendation:"Clear caches, reduce data in memory, check for memory leaks"}):K>60&&e.push({type:"memory",severity:"high",description:`Memory usage is ${K.toFixed(1)}% of limit`,value:d,recommendation:"Monitor memory usage, consider data pagination"})}return a.timing.navigation>3e3&&e.push({type:"timing",severity:"high",description:"Slow page load time",value:a.timing.navigation,recommendation:"Optimize bundle size, lazy load components, check network"}),a.network.rtt&&a.network.rtt>200&&e.push({type:"network",severity:"medium",description:"High network latency",value:a.network.rtt,recommendation:"Check network connection, consider CDN, reduce API calls"}),e}function U(){var e,s;n.value=!0;try{const a=O(),d={recordingInfo:{startTime:new Date(C.value).toISOString(),duration:$.value,sampleCount:u.value.length,url:window.location.href,userAgent:navigator.userAgent},performanceSummary:{avgMemoryUsage:u.value.filter(M=>M.memory).reduce((M,K)=>M+K.memory.used/(1024*1024),0)/u.value.filter(M=>M.memory).length,totalDOMNodes:(e=u.value[u.value.length-1])==null?void 0:e.customMetrics.domNodes,networkInfo:(s=u.value[u.value.length-1])==null?void 0:s.network},issues:a,topBottlenecks:a.sort((M,K)=>J(K.severity)-J(M.severity)).slice(0,5),detailedSamples:u.value.slice(-10),recommendations:[...new Set(a.map(M=>M.recommendation))]};p.value=JSON.stringify(d,null,2),A.info("📊 Performance data exported")}catch(a){A.error("Failed to export performance data:",a),p.value=`Export Error: ${a}`}finally{n.value=!1}}function J(e){return{critical:4,high:3,medium:2,low:1}[e]||0}function l(){u.value=[],p.value="",$.value=0,A.info("🗑️ Performance data cleared")}return Ue(()=>{S.value&&k()}),(e,s)=>(m(),g("div",Rt,[t("div",Et,[t("button",{onClick:w,class:te(["record-btn",{recording:S.value}]),disabled:n.value},T(S.value?"Stop Recording":"Start Recording"),11,Ut),t("button",{onClick:U,disabled:!c.value||n.value,class:"export-btn"},T(n.value?"Exporting...":"Export Logs"),9,It),t("button",{onClick:l,disabled:!c.value||S.value,class:"clear-btn"}," Clear ",8,Dt)]),t("div",Ft,[S.value?(m(),g("div",Kt," 🔴 Recording... ("+T($.value)+"s) ",1)):c.value?(m(),g("div",_t," ✅ "+T(u.value.length)+" samples recorded ",1)):(m(),g("div",Lt," ⏸️ Ready to record "))]),p.value?(m(),g("div",Ot,[s[1]||(s[1]=t("h3",null,"Performance Data Ready",-1)),P(t("textarea",{"onUpdate:modelValue":s[0]||(s[0]=a=>p.value=a),readonly:"",rows:"10",placeholder:"Exported performance data will appear here..."},null,512),[[B,p.value]]),s[2]||(s[2]=t("div",{class:"copy-instructions"}," Copy this data and paste it to Claude for analysis ",-1))])):L("",!0)]))}}),Nt=ne(Vt,[["__scopeId","data-v-029cb5af"]]),Bt={class:"advanced-section"},qt={key:0},zt={key:1},jt={class:"sub-tabs"},Gt=["onClick"],Jt={class:"sub-tab-content"},Wt={key:0,class:"provider-settings"},Ht={key:0,class:"no-providers"},Yt={key:0},Zt={key:1},Qt={key:1,class:"provider-cards"},Xt={key:0,class:"provider-advanced-card"},es={class:"setting-group"},ts=["onUpdate:modelValue","onChange"],ss={class:"setting-group"},ns=["onUpdate:modelValue","onChange"],os={class:"setting-group"},is=["onUpdate:modelValue","onChange"],as={class:"setting-group"},ls=["onUpdate:modelValue","onChange"],rs={key:1,class:"execution-settings"},us={class:"settings-grid"},ds={class:"setting-group"},cs={class:"setting-group"},ms={class:"setting-group"},ps={class:"setting-group"},ys={class:"setting-group"},vs={class:"setting-group"},fs={class:"setting-group"},gs={key:2,class:"discovery-settings"},bs={class:"settings-grid"},ks={class:"setting-group"},Ss={class:"setting-group"},ws={class:"setting-group"},xs={class:"setting-group"},hs={key:3,class:"coordination-settings"},Cs={class:"settings-grid"},$s={class:"setting-group"},As={class:"setting-group"},Ms={class:"setting-group"},Ps={class:"setting-group"},Ts={key:4,class:"performance-settings"},Rs={class:"settings-grid"},Es={class:"setting-group"},Us={class:"setting-group"},Is={class:"setting-group"},Ds={class:"setting-group"},Fs={key:5,class:"system-settings"},Ks=se({__name:"AdvancedSection",props:{onStatusMessage:{type:Function}},setup(H){const S=me(),n=H,u=[{id:"providers",label:"Provider Settings"},{id:"execution",label:"Execution"},{id:"discovery",label:"Discovery"},{id:"coordination",label:"Multi-Tab"},{id:"performance",label:"Performance"},{id:"system",label:"System"}],p=I("providers"),C=I(!1),$=ae(()=>{const l=c.value;return l.length>0&&l.every(e=>v[e.id]&&typeof v[e.id].concurrency=="number")}),c=ae(()=>{try{const l=_.getAllGroups();A.info("Available group IDs from registry:",l);const e=l.map(s=>{const a=_.getProvidersInGroup(s),d=a.some(M=>_.requiresApiKey(M.id));return{id:s,name:s.charAt(0).toUpperCase()+s.slice(1),requiresApiKey:d,endpoints:a.map(M=>({id:M.id,name:M.name}))}});return A.info("Computed availableProviders:",e),e}catch(l){return A.error("Failed to get available provider groups:",l),[]}}),v=Q((()=>{try{const l=_.getAllGroups();A.info("Initializing provider settings for groups:",l);const e={};return l.forEach(s=>{e[s]={concurrency:2,requestTimeout:30,maxRetries:3,backoffMultiplier:2}}),A.info("Initial provider settings:",e),e}catch(l){return A.error("Failed to initialize provider settings:",l),{}}})());ue(c,async l=>{await _.waitForReady(),A.info("Initializing settings for",l.length,"provider groups"),l.forEach(e=>{if(!v[e.id]){const s=_.getProvidersInGroup(e.id),a=s[0],d=(a==null?void 0:a.execution)||{};A.info(`Initializing settings for provider group ${e.id}:`,{endpoints:s.map(M=>M.id),execution:d}),v[e.id]={concurrency:d.defaultConcurrency||2,requestTimeout:Math.floor((d.timeout||3e4)/1e3),maxRetries:d.maxRetries||3,backoffMultiplier:d.backoffMultiplier||2}}})},{immediate:!0});const b=Q({defaultConcurrency:1,defaultTimeout:120,defaultMaxRetries:3,defaultTemperature:.7,batchSize:1,maxConcurrentBatches:2,progressBufferMs:0}),w=Q({autoDiscoverOnStartup:!0,discoveryInterval:24,discoveryTimeout:60,skipFailedProviders:!1}),r=Q({leaderElectionTimeout:1e3,syncInterval:500,enableBroadcastChannel:!0,enableWebLocks:!0}),k=Q({virtualScrollThreshold:1e3,debounceDelay:300,enableRequestIdleCallback:!0,enableProgressiveRendering:!0});ye(async()=>{try{await _.waitForReady();const l=await S.settings.system.getAllSettings(),e=_.getAllGroups();A.info("Loading existing settings from provider registry for",e.length,"provider groups"),e.forEach(s=>{const a=_.getProviderExecutionOverrides(s);if(A.info(`Loading registry overrides for group ${s}:`,a),a&&v[s])a.concurrency!==void 0&&(v[s].concurrency=a.concurrency),a.timeout!==void 0&&(v[s].requestTimeout=Math.floor(a.timeout/1e3)),a.maxRetries!==void 0&&(v[s].maxRetries=a.maxRetries),a.backoffMultiplier!==void 0&&(v[s].backoffMultiplier=a.backoffMultiplier);else if(v[s]){const M=_.getProvidersInGroup(s)[0],K=(M==null?void 0:M.execution)||{};A.info(`No overrides for group ${s}, using provider defaults:`,K),v[s].concurrency=K.defaultConcurrency||2,v[s].requestTimeout=Math.floor((K.timeout||3e4)/1e3),v[s].maxRetries=K.maxRetries||3,v[s].backoffMultiplier=K.backoffMultiplier||2}}),l.execution&&Object.assign(b,l.execution),l.discovery&&Object.assign(w,l.discovery),l.coordination&&Object.assign(r,l.coordination),l.performance&&Object.assign(k,l.performance),C.value=!0}catch(l){A.error("Failed to initialize advanced settings:",l),C.value=!0}});async function R(l,e,s){var a,d;try{switch(await _.waitForReady(),e){case"concurrency":_.setProviderConcurrency(l,s);break;case"requestTimeout":_.setProviderTimeout(l,s*1e3);break;case"maxRetries":_.setProviderMaxRetries(l,s);break;case"backoffMultiplier":_.setProviderBackoffMultiplier(l,s);break;default:throw new Error(`Unknown setting: ${e}`)}(a=n.onStatusMessage)==null||a.call(n,`Updated ${e} for ${l}`,"success")}catch(M){(d=n.onStatusMessage)==null||d.call(n,`Failed to update ${e}: ${M.message}`,"error");const K=_.getProvider(l),oe=(K==null?void 0:K.execution)||{};switch(e){case"concurrency":v[l].concurrency=oe.defaultConcurrency||2;break;case"requestTimeout":v[l].requestTimeout=Math.floor((oe.timeout||3e4)/1e3);break;case"maxRetries":v[l].maxRetries=oe.maxRetries||3;break;case"backoffMultiplier":v[l].backoffMultiplier=oe.backoffMultiplier||2;break}}}async function E(l,e){var a,d;const s=await S.settings.system.setExecutionSetting(l,e);s.ok?(a=n.onStatusMessage)==null||a.call(n,`Updated ${l}`,"success"):(d=n.onStatusMessage)==null||d.call(n,`Failed to update ${l}: ${s.error.message}`,"error")}async function x(l,e){var a,d;const s=await S.settings.system.setDiscoverySetting(l,e);s.ok?(a=n.onStatusMessage)==null||a.call(n,`Updated ${l}`,"success"):(d=n.onStatusMessage)==null||d.call(n,`Failed to update ${l}: ${s.error.message}`,"error")}async function q(l,e){var a,d;const s=await S.settings.system.setCoordinationSetting(l,e);s.ok?(a=n.onStatusMessage)==null||a.call(n,`Updated ${l}`,"success"):(d=n.onStatusMessage)==null||d.call(n,`Failed to update ${l}: ${s.error.message}`,"error")}async function O(l,e){var a,d;const s=await S.settings.system.setPerformanceSetting(l,e);s.ok?(a=n.onStatusMessage)==null||a.call(n,`Updated ${l}`,"success"):(d=n.onStatusMessage)==null||d.call(n,`Failed to update ${l}: ${s.error.message}`,"error")}function U(){window.confirm(`WARNING: This will delete ALL data including:

• All trials and their results
• All API calls and responses
• All models and configurations
• All variable lists and datasets
• All settings and preferences

This action CANNOT be undone.

Are you absolutely sure?`)&&window.confirm(`FINAL WARNING: You are about to delete EVERYTHING.

Type "DELETE" to confirm.`)&&J()}async function J(){var l,e;try{await X.transaction("rw",X.tables,async()=>{await Promise.all(X.tables.map(s=>s.clear()))}),localStorage.clear(),sessionStorage.clear(),(l=n.onStatusMessage)==null||l.call(n,"Database and storage cleared successfully","success"),setTimeout(()=>{window.location.reload()},1500)}catch(s){A.error("Failed to clear database:",s),(e=n.onStatusMessage)==null||e.call(n,`Failed to clear database: ${s}`,"error")}}return(l,e)=>(m(),g("div",Bt,[C.value?(m(),g("div",zt,[e[95]||(e[95]=t("h2",null,"Advanced Settings",-1)),e[96]||(e[96]=t("p",{class:"tab-description"},"Configure advanced settings for providers, execution, and system performance.",-1)),t("div",jt,[(m(),g(re,null,de(u,s=>t("button",{key:s.id,class:te(["sub-tab",{active:p.value===s.id}]),onClick:a=>p.value=s.id},T(s.label),11,Gt)),64))]),t("div",Jt,[p.value==="providers"?(m(),g("div",Wt,[e[48]||(e[48]=t("h3",null,"Provider-Specific Settings",-1)),e[49]||(e[49]=t("p",{class:"section-description"},"Configure advanced settings for each provider",-1)),$.value?(m(),g("div",Qt,[(m(!0),g(re,null,de(c.value,s=>(m(),g(re,{key:s.id},[s&&v[s.id]?(m(),g("div",Xt,[t("h4",null,T(s.name)+" Group",1),e[47]||(e[47]=t("p",{class:"group-description"},"Settings apply to all endpoints in this provider group",-1)),t("div",es,[e[39]||(e[39]=t("label",null,"Concurrency Limit",-1)),P(t("input",{type:"number","onUpdate:modelValue":a=>v[s.id].concurrency=a,min:"1",max:"100",onChange:a=>{var d;return R(s.id,"concurrency",(d=v[s.id])==null?void 0:d.concurrency)}},null,40,ts),[[B,v[s.id].concurrency,void 0,{number:!0}]]),e[40]||(e[40]=t("span",{class:"hint"},"Max parallel requests (1-100)",-1))]),t("div",ss,[e[41]||(e[41]=t("label",null,"Request Timeout (seconds)",-1)),P(t("input",{type:"number","onUpdate:modelValue":a=>v[s.id].requestTimeout=a,min:"10",max:"600",onChange:a=>{var d;return R(s.id,"requestTimeout",(d=v[s.id])==null?void 0:d.requestTimeout)}},null,40,ns),[[B,v[s.id].requestTimeout,void 0,{number:!0}]]),e[42]||(e[42]=t("span",{class:"hint"},"Time before request fails (10-600s)",-1))]),t("div",os,[e[43]||(e[43]=t("label",null,"Max Retries",-1)),P(t("input",{type:"number","onUpdate:modelValue":a=>v[s.id].maxRetries=a,min:"0",max:"10",onChange:a=>{var d;return R(s.id,"maxRetries",(d=v[s.id])==null?void 0:d.maxRetries)}},null,40,is),[[B,v[s.id].maxRetries,void 0,{number:!0}]]),e[44]||(e[44]=t("span",{class:"hint"},"Retry attempts on failure (0-10)",-1))]),t("div",as,[e[45]||(e[45]=t("label",null,"Backoff Multiplier",-1)),P(t("input",{type:"number","onUpdate:modelValue":a=>v[s.id].backoffMultiplier=a,min:"1",max:"5",step:"0.1",onChange:a=>{var d;return R(s.id,"backoffMultiplier",(d=v[s.id])==null?void 0:d.backoffMultiplier)}},null,40,ls),[[B,v[s.id].backoffMultiplier,void 0,{number:!0}]]),e[46]||(e[46]=t("span",{class:"hint"},"Exponential backoff factor (1-5)",-1))])])):L("",!0)],64))),128))])):(m(),g("div",Ht,[c.value.length===0?(m(),g("p",Yt,"No providers are currently configured. Add API keys in the API Keys tab first.")):(m(),g("p",Zt,"Loading provider settings..."))]))])):L("",!0),p.value==="execution"?(m(),g("div",rs,[e[64]||(e[64]=t("h3",null,"Execution Settings",-1)),e[65]||(e[65]=t("p",{class:"section-description"},"Configure how trials are executed",-1)),t("div",us,[t("div",ds,[e[50]||(e[50]=t("label",null,"Default Trial Concurrency",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>b.defaultConcurrency=s),min:"1",max:"20",onChange:e[1]||(e[1]=s=>E("defaultConcurrency",b.defaultConcurrency))},null,544),[[B,b.defaultConcurrency,void 0,{number:!0}]]),e[51]||(e[51]=t("span",{class:"hint"},"Default parallel API calls per trial (1-20)",-1))]),t("div",cs,[e[52]||(e[52]=t("label",null,"Default Timeout (seconds)",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>b.defaultTimeout=s),min:"10",max:"600",onChange:e[3]||(e[3]=s=>E("defaultTimeout",b.defaultTimeout))},null,544),[[B,b.defaultTimeout,void 0,{number:!0}]]),e[53]||(e[53]=t("span",{class:"hint"},"Default timeout for all calls (10-600s)",-1))]),t("div",ms,[e[54]||(e[54]=t("label",null,"Default Max Retries",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>b.defaultMaxRetries=s),min:"0",max:"5",onChange:e[5]||(e[5]=s=>E("defaultMaxRetries",b.defaultMaxRetries))},null,544),[[B,b.defaultMaxRetries,void 0,{number:!0}]]),e[55]||(e[55]=t("span",{class:"hint"},"Default retry attempts (0-5)",-1))]),t("div",ps,[e[56]||(e[56]=t("label",null,"Default Temperature",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=s=>b.defaultTemperature=s),min:"0",max:"2",step:"0.1",onChange:e[7]||(e[7]=s=>E("defaultTemperature",b.defaultTemperature))},null,544),[[B,b.defaultTemperature,void 0,{number:!0}]]),e[57]||(e[57]=t("span",{class:"hint"},"Default model temperature (0-2)",-1))]),t("div",ys,[e[58]||(e[58]=t("label",null,"Batch Size",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[8]||(e[8]=s=>b.batchSize=s),min:"1",max:"1000",onChange:e[9]||(e[9]=s=>E("batchSize",b.batchSize))},null,544),[[B,b.batchSize,void 0,{number:!0}]]),e[59]||(e[59]=t("span",{class:"hint"},"API calls per batch (1-1000, lower = more responsive)",-1))]),t("div",vs,[e[60]||(e[60]=t("label",null,"Max Concurrent Batches",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[10]||(e[10]=s=>b.maxConcurrentBatches=s),min:"1",max:"20",onChange:e[11]||(e[11]=s=>E("maxConcurrentBatches",b.maxConcurrentBatches))},null,544),[[B,b.maxConcurrentBatches,void 0,{number:!0}]]),e[61]||(e[61]=t("span",{class:"hint"},"Batches processed simultaneously (1-20)",-1))]),t("div",fs,[e[62]||(e[62]=t("label",null,"Progress Buffer Delay (ms)",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[12]||(e[12]=s=>b.progressBufferMs=s),min:"0",max:"10000",step:"100",onChange:e[13]||(e[13]=s=>E("progressBufferMs",b.progressBufferMs))},null,544),[[B,b.progressBufferMs,void 0,{number:!0}]]),e[63]||(e[63]=t("span",{class:"hint"},"Delay before updating progress (0-10000ms, 0 = immediate)",-1))])])])):L("",!0),p.value==="discovery"?(m(),g("div",gs,[e[72]||(e[72]=t("h3",null,"Model Discovery Settings",-1)),e[73]||(e[73]=t("p",{class:"section-description"},"Configure automatic model discovery",-1)),t("div",bs,[t("div",ks,[t("label",null,[P(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>w.autoDiscoverOnStartup=s),onChange:e[15]||(e[15]=s=>x("autoDiscoverOnStartup",w.autoDiscoverOnStartup))},null,544),[[ee,w.autoDiscoverOnStartup]]),e[66]||(e[66]=F(" Auto-discover models on startup "))])]),t("div",Ss,[e[67]||(e[67]=t("label",null,"Discovery Interval (hours)",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[16]||(e[16]=s=>w.discoveryInterval=s),min:"1",max:"168",onChange:e[17]||(e[17]=s=>x("discoveryInterval",w.discoveryInterval))},null,544),[[B,w.discoveryInterval,void 0,{number:!0}]]),e[68]||(e[68]=t("span",{class:"hint"},"Time between auto-discovery runs (1-168h)",-1))]),t("div",ws,[e[69]||(e[69]=t("label",null,"Discovery Timeout (seconds)",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=s=>w.discoveryTimeout=s),min:"10",max:"300",onChange:e[19]||(e[19]=s=>x("discoveryTimeout",w.discoveryTimeout))},null,544),[[B,w.discoveryTimeout,void 0,{number:!0}]]),e[70]||(e[70]=t("span",{class:"hint"},"Max time for discovery operations (10-300s)",-1))]),t("div",xs,[t("label",null,[P(t("input",{type:"checkbox","onUpdate:modelValue":e[20]||(e[20]=s=>w.skipFailedProviders=s),onChange:e[21]||(e[21]=s=>x("skipFailedProviders",w.skipFailedProviders))},null,544),[[ee,w.skipFailedProviders]]),e[71]||(e[71]=F(" Skip providers that previously failed "))])])])])):L("",!0),p.value==="coordination"?(m(),g("div",hs,[e[80]||(e[80]=t("h3",null,"Multi-Tab Coordination",-1)),e[81]||(e[81]=t("p",{class:"section-description"},"Configure how multiple tabs work together",-1)),t("div",Cs,[t("div",$s,[e[74]||(e[74]=t("label",null,"Leader Election Timeout (ms)",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[22]||(e[22]=s=>r.leaderElectionTimeout=s),min:"100",max:"5000",onChange:e[23]||(e[23]=s=>q("leaderElectionTimeout",r.leaderElectionTimeout))},null,544),[[B,r.leaderElectionTimeout,void 0,{number:!0}]]),e[75]||(e[75]=t("span",{class:"hint"},"Time to elect new leader tab (100-5000ms)",-1))]),t("div",As,[e[76]||(e[76]=t("label",null,"Sync Interval (ms)",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[24]||(e[24]=s=>r.syncInterval=s),min:"100",max:"2000",onChange:e[25]||(e[25]=s=>q("syncInterval",r.syncInterval))},null,544),[[B,r.syncInterval,void 0,{number:!0}]]),e[77]||(e[77]=t("span",{class:"hint"},"Tab synchronization frequency (100-2000ms)",-1))]),t("div",Ms,[t("label",null,[P(t("input",{type:"checkbox","onUpdate:modelValue":e[26]||(e[26]=s=>r.enableBroadcastChannel=s),onChange:e[27]||(e[27]=s=>q("enableBroadcastChannel",r.enableBroadcastChannel))},null,544),[[ee,r.enableBroadcastChannel]]),e[78]||(e[78]=F(" Enable BroadcastChannel communication "))])]),t("div",Ps,[t("label",null,[P(t("input",{type:"checkbox","onUpdate:modelValue":e[28]||(e[28]=s=>r.enableWebLocks=s),onChange:e[29]||(e[29]=s=>q("enableWebLocks",r.enableWebLocks))},null,544),[[ee,r.enableWebLocks]]),e[79]||(e[79]=F(" Enable Web Locks API "))])])])])):L("",!0),p.value==="performance"?(m(),g("div",Ts,[e[88]||(e[88]=t("h3",null,"UI Performance",-1)),e[89]||(e[89]=t("p",{class:"section-description"},"Optimize UI performance for large datasets and debug performance issues",-1)),j(Nt),t("div",Rs,[t("div",Es,[e[82]||(e[82]=t("label",null,"Virtual Scrolling Threshold",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[30]||(e[30]=s=>k.virtualScrollThreshold=s),min:"50",max:"10000",onChange:e[31]||(e[31]=s=>O("virtualScrollThreshold",k.virtualScrollThreshold))},null,544),[[B,k.virtualScrollThreshold,void 0,{number:!0}]]),e[83]||(e[83]=t("span",{class:"hint"},"Enable virtual scrolling above this row count (50-10000)",-1))]),t("div",Us,[e[84]||(e[84]=t("label",null,"Debounce Delay (ms)",-1)),P(t("input",{type:"number","onUpdate:modelValue":e[32]||(e[32]=s=>k.debounceDelay=s),min:"100",max:"1000",onChange:e[33]||(e[33]=s=>O("debounceDelay",k.debounceDelay))},null,544),[[B,k.debounceDelay,void 0,{number:!0}]]),e[85]||(e[85]=t("span",{class:"hint"},"Search/filter debounce delay (100-1000ms)",-1))]),t("div",Is,[t("label",null,[P(t("input",{type:"checkbox","onUpdate:modelValue":e[34]||(e[34]=s=>k.enableRequestIdleCallback=s),onChange:e[35]||(e[35]=s=>O("enableRequestIdleCallback",k.enableRequestIdleCallback))},null,544),[[ee,k.enableRequestIdleCallback]]),e[86]||(e[86]=F(" Use requestIdleCallback for background tasks "))])]),t("div",Ds,[t("label",null,[P(t("input",{type:"checkbox","onUpdate:modelValue":e[36]||(e[36]=s=>k.enableProgressiveRendering=s),onChange:e[37]||(e[37]=s=>O("enableProgressiveRendering",k.enableProgressiveRendering))},null,544),[[ee,k.enableProgressiveRendering]]),e[87]||(e[87]=F(" Enable progressive rendering for large results "))])])])])):L("",!0),p.value==="system"?(m(),g("div",Fs,[e[93]||(e[93]=t("h3",null,"System Management",-1)),e[94]||(e[94]=t("p",{class:"section-description"},"Manage database and storage",-1)),t("div",{class:"danger-zone"},[e[92]||(e[92]=t("h4",null,"⚠️ Danger Zone",-1)),t("div",{class:"danger-actions"},[t("div",{class:"action-card"},[e[90]||(e[90]=t("h5",null,"Clear All Data",-1)),e[91]||(e[91]=t("p",null,"Delete all trials, models, settings, and API calls from the database. This action cannot be undone.",-1)),t("button",{class:"danger-button",onClick:U}," Delete Database & Store ")])])])])):L("",!0)])])):(m(),g("div",qt,e[38]||(e[38]=[t("p",null,"Loading settings...",-1)])))]))}}),_s=ne(Ks,[["__scopeId","data-v-1b6525d2"]]),Ls={class:"import-export-section"},Os={class:"import-export-content"},Vs={class:"import-section all-data"},Ns={class:"file-input-wrapper"},Bs={class:"import-section"},qs={class:"file-input-wrapper"},zs={class:"danger-section"},js=["disabled"],Gs=se({__name:"ImportExportSection",props:{onStatusMessage:{type:Function}},setup(H){const S=me(),n=H,u=I(),p=I(),C=I(!1);async function $(){var r,k;const w=await S.settings.core.exportSettings();if(w.ok){const R=new Blob([w.value],{type:"application/json"}),E=URL.createObjectURL(R),x=document.createElement("a");x.href=E,x.download=`auditomatic-settings-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(E),(r=n.onStatusMessage)==null||r.call(n,"Settings exported successfully","success")}else(k=n.onStatusMessage)==null||k.call(n,`Failed to export settings: ${w.error.message}`,"error")}async function c(w){var k,R,E,x;const r=(k=w.target.files)==null?void 0:k[0];if(r)try{const q=await r.text(),O=await S.settings.core.importSettings(q);O.ok?((R=n.onStatusMessage)==null||R.call(n,"Settings imported successfully","success"),u.value&&(u.value.value="")):(E=n.onStatusMessage)==null||E.call(n,`Failed to import settings: ${O.error.message}`,"error")}catch{(x=n.onStatusMessage)==null||x.call(n,"Failed to read file","error")}}async function D(){var r,k;if(!confirm("Are you sure you want to reset all settings? This cannot be undone."))return;C.value=!0;const w=await S.settings.core.resetSettings();C.value=!1,w.ok?(r=n.onStatusMessage)==null||r.call(n,"All settings have been reset","success"):(k=n.onStatusMessage)==null||k.call(n,`Failed to reset settings: ${w.error.message}`,"error")}async function v(){var w,r,k;try{(w=n.onStatusMessage)==null||w.call(n,"Exporting all data...","success");const R={version:2,exported:new Date().toISOString(),app:"auditomatic-lite",tables:{}};for(const J of X.tables){const l=J.name;R.tables[l]=await J.toArray()}const E=JSON.stringify(R,null,2),x=(E.length/(1024*1024)).toFixed(2),q=new Blob([E],{type:"application/json"}),O=URL.createObjectURL(q),U=document.createElement("a");U.href=O,U.download=`auditomatic-all-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(O),(r=n.onStatusMessage)==null||r.call(n,`All data exported successfully (${x} MB)`,"success")}catch(R){A.error("Failed to export all data:",R),(k=n.onStatusMessage)==null||k.call(n,`Failed to export data: ${R}`,"error")}}async function b(w){var R,E,x,q;const r=(R=w.target.files)==null?void 0:R[0];if(!r)return;if(!confirm(`WARNING: This will REPLACE ALL existing data with the imported data.

All current trials, models, settings, etc. will be deleted.

Are you absolutely sure?`)){p.value&&(p.value.value="");return}try{(E=n.onStatusMessage)==null||E.call(n,"Importing all data...","success");const O=await r.text(),U=JSON.parse(O);if(!U.version||!U.tables)throw new Error("Invalid data format");await X.transaction("rw",X.tables,async()=>{await Promise.all(X.tables.map(J=>J.clear()));for(const[J,l]of Object.entries(U.tables)){const e=X[J];e&&Array.isArray(l)&&l.length>0&&await e.bulkAdd(l)}}),(x=n.onStatusMessage)==null||x.call(n,"All data imported successfully","success"),p.value&&(p.value.value=""),setTimeout(()=>{window.location.reload()},1500)}catch(O){A.error("Failed to import all data:",O),(q=n.onStatusMessage)==null||q.call(n,`Failed to import data: ${O}`,"error"),p.value&&(p.value.value="")}}return(w,r)=>(m(),g("div",Ls,[r[13]||(r[13]=t("h2",null,"Import & Export",-1)),r[14]||(r[14]=t("p",{class:"tab-description"},"Backup and restore your settings. API keys are masked during export for security.",-1)),t("div",Os,[t("div",{class:"export-section all-data"},[r[2]||(r[2]=t("h3",null,"📦 Export All Data",-1)),t("button",{onClick:v,class:"btn btn-primary btn-large"}," Export Everything to JSON "),r[3]||(r[3]=t("p",{class:"help-text"},"Downloads ALL data: trials, models, settings, variable lists, datasets, API calls, etc.",-1))]),t("div",Vs,[r[4]||(r[4]=t("h3",null,"📥 Import All Data",-1)),t("div",Ns,[t("input",{ref_key:"allDataFileInput",ref:p,type:"file",accept:".json",onChange:b,class:"file-input"},null,544),t("button",{onClick:r[0]||(r[0]=()=>p.value&&p.value.click()),class:"btn btn-primary btn-large"}," Import Everything from JSON ")]),r[5]||(r[5]=t("p",{class:"help-text"},"⚠️ WARNING: This will REPLACE all existing data with the imported data",-1))]),r[12]||(r[12]=t("hr",{class:"section-divider"},null,-1)),t("div",{class:"export-section"},[r[6]||(r[6]=t("h3",null,"Export Settings Only",-1)),t("button",{onClick:$,class:"btn btn-secondary"}," Export Settings to JSON "),r[7]||(r[7]=t("p",{class:"help-text"},"Downloads a JSON file with your settings (API keys will be masked)",-1))]),t("div",Bs,[r[8]||(r[8]=t("h3",null,"Import Settings Only",-1)),t("div",qs,[t("input",{ref_key:"fileInput",ref:u,type:"file",accept:".json",onChange:c,class:"file-input"},null,544),t("button",{onClick:r[1]||(r[1]=()=>u.value&&u.value.click()),class:"btn btn-secondary"}," Choose File ")]),r[9]||(r[9]=t("p",{class:"help-text"},"Import settings from a previously exported JSON file",-1))]),t("div",zs,[r[10]||(r[10]=t("h3",null,"Reset Settings",-1)),t("button",{onClick:D,class:"btn btn-danger",disabled:C.value},T(C.value?"Resetting...":"Reset All Settings"),9,js),r[11]||(r[11]=t("p",{class:"help-text"},"⚠️ This will clear all API keys and reset preferences to defaults",-1))])])]))}}),Js=ne(Gs,[["__scopeId","data-v-7b20deaa"]]),Ws=se({__name:"StatusMessage",props:{text:{},type:{},duration:{default:5e3}},setup(H){const S=H,n=I(!1);let u=null;return ue(()=>S.text,p=>{p&&(n.value=!0,u&&clearTimeout(u),u=setTimeout(()=>{n.value=!1},S.duration))},{immediate:!0}),ue(n,p=>{!p&&u&&(clearTimeout(u),u=null)}),(p,C)=>(m(),Z(Ie,{name:"slide"},{default:G(()=>[n.value?(m(),g("div",{key:0,class:te(["status-message",p.type])},T(p.text),3)):L("",!0)]),_:1}))}}),Hs=ne(Ws,[["__scopeId","data-v-da279e0d"]]),Ys={class:"settings-view","data-testid":"page-settings"},Zs={class:"tabs"},Qs=["onClick"],Xs={class:"tab-content"},en=se({__name:"SettingsView",setup(H){const S=[{id:"api-keys",label:"API Keys"},{id:"preferences",label:"Preferences"},{id:"advanced",label:"Advanced"},{id:"import-export",label:"Import/Export"}],n=I("api-keys"),u=I(null);function p(C,$){u.value={text:C,type:$},setTimeout(()=>{var c;((c=u.value)==null?void 0:c.text)===C&&(u.value=null)},5500)}return(C,$)=>(m(),g("div",Ys,[$[0]||($[0]=t("h1",{class:"settings-title"},"Settings",-1)),t("div",Zs,[(m(),g(re,null,de(S,c=>t("button",{key:c.id,class:te(["tab",{active:n.value===c.id}]),onClick:D=>n.value=c.id},T(c.label),11,Qs)),64))]),t("div",Xs,[n.value==="api-keys"?(m(),Z(xt,{key:0,"on-status-message":p})):L("",!0),n.value==="preferences"?(m(),Z(Tt,{key:1,"on-status-message":p})):L("",!0),n.value==="advanced"?(m(),Z(_s,{key:2,"on-status-message":p})):L("",!0),n.value==="import-export"?(m(),Z(Js,{key:3,"on-status-message":p})):L("",!0)]),u.value?(m(),Z(Hs,{key:0,text:u.value.text,type:u.value.type},null,8,["text","type"])):L("",!0)]))}}),sn=ne(en,[["__scopeId","data-v-ea1dc301"]]);export{sn as default};
