import{_ as e}from"./BaseModal.vue_vue_type_style_index_0_lang-DjxfwE8g.js";import{k as a,d as t,a9 as s,Z as i,$ as l,a0 as n,ag as o,f as r,c as d,w as c,o as u,b as p,ac as v,X as g,F as m,Y as f,_ as b,a2 as h,ad as y,aa as C,G as k,u as w,H as _,al as T,n as I}from"./vendor-B9vlzAYn.js";import{I as S,_ as D,a as x,s as M,v as P,u as $,K as E,G as O,c as N,d as z,b as j,p as F,j as V,l as B,E as A,W as L,f as H}from"./index-mBQkrP6K.js";import{u as U}from"./useEnvironmentalCost-CuVfAX4z.js";import{a as J}from"./cost-formatting-Bv_drrqY.js";import{G as q}from"./GenericModelSelectorModal-BCtARSu3.js";var R={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"};function W(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?Object(arguments[a]):{},s=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.forEach(function(a){K(e,a,t[a])})}return e}function K(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var Y=function(e,t){var s=W({},e,t.attrs);return a(S,W({},s,{icon:R}),null)};Y.displayName="FileExcelOutlined",Y.inheritAttrs=!1;const G={class:"modal-footer"},Z={key:0,class:"footer-left"},Q={class:"footer-actions"},X=D(t({__name:"ModalFooter",setup:e=>(e,a)=>(i(),s("div",G,[e.$slots.left?(i(),s("div",Z,[o(e.$slots,"left",{},void 0,!0)])):l("",!0),n("div",Q,[o(e.$slots,"default",{},void 0,!0)])]))}),[["__scopeId","data-v-3a3879d0"]]),ee={key:0,class:"preview-controls"},ae={key:0,class:"cycle-info"},te=["innerHTML"],se={key:1,class:"variable-legend"},ie={class:"variable-value"},le=D(t({__name:"TemplatePreview",props:{design:{},template:{},variables:{},tabularData:{},cycling:{type:Boolean,default:!0},cyclingPaused:{type:Boolean,default:!1},cyclingSpeed:{default:1e3},showControls:{default:"none"},displayMode:{default:"block"},showLegend:{type:Boolean,default:!1},maxHeight:{default:"300px"},previewMode:{type:Boolean,default:!1}},emits:["update:cyclingPaused","update:previewMode"],setup(e,{emit:t}){const o=e,_=t,T=x(),I=r(0);let S=null;const D=["variable-highlight-blue","variable-highlight-green","variable-highlight-purple","variable-highlight-orange","variable-highlight-pink","variable-highlight-teal"],$=d(()=>o.design?o.design.promptTemplate:o.template||""),E=d(()=>{if(o.tabularData&&o.tabularData.length>0)return o.tabularData.map(e=>{const a={};return Object.keys(e).forEach(t=>{let s=t.replace(/[^a-zA-Z0-9_]/g,"_");/^[a-zA-Z]/.test(s)||(s="col_"+s),s=s.replace(/_+/g,"_"),s=s.replace(/_+$/,""),a[s]=String(e[t]||"")}),a});if("aligned"===o.design?.executionMode&&o.design?.variableBindings?.__tabular__){const e=o.design.variableBindings.__tabular__;if("list"===e.type&&e.listId){const a=T.lists.find(a=>a.id===e.listId);if("tabular"===a?.category&&a.tabularData)return a.tabularData.rows.map(e=>{const t={};return a.tabularData.columns.forEach(a=>{t[a]=String(e[a]||"")}),t})}}const e=[];if(o.design?.variableBindings){for(const[t,s]of Object.entries(o.design.variableBindings))if("direct"===s.type&&s.values)e.push({name:t,values:[...s.values]});else if("list"===s.type&&s.listId){const a=T.lists.find(e=>e.id===s.listId);a&&("simple"===a.category&&a.values?e.push({name:t,values:[...a.values]}):"attributed"===a.category&&a.items&&e.push({name:t,values:a.items.map(e=>e.value)}))}}else if(o.variables)for(const[t,s]of Object.entries(o.variables))s.length>0&&e.push({name:t,values:[...s]});if(0===e.length)return[];const a=e.map(e=>e.values);return a.reduce((e,a)=>e.flatMap(e=>a.map(a=>[...e,a])),[[]]).map(a=>{const t={};return e.forEach((e,s)=>{t[e.name]=a[s]}),t})}),O=d(()=>E.value.length),N=d(()=>0===E.value.length?{}:E.value[I.value%E.value.length]),z=d(()=>{let e=$.value;"inline"===o.displayMode&&(e=e.replace(/\s+/g," ").trim());let a=F(e);if(E.value.length>0&&(o.cycling||o.previewMode)){const e=N.value;Object.keys(e).forEach((t,s)=>{const i=e[t];if(void 0!==i){const e=new RegExp(`\\{\\{\\s*${l=t,l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\s*\\}\\}`,"g"),n=`<span class="${j(s)}">${F(i)}</span>`;a=a.replace(e,n)}var l})}return a});function j(e){return D[e%D.length]}function F(e){const a=document.createElement("div");return a.textContent=e,a.innerHTML}function V(){_("update:cyclingPaused",!o.cyclingPaused)}function B(){_("update:previewMode",!o.previewMode)}function A(){!o.cycling||o.cyclingPaused||E.value.length<=1||(L(),S=setInterval(()=>{I.value=(I.value+1)%E.value.length},o.cyclingSpeed))}function L(){S&&(clearInterval(S),S=null)}return c([()=>o.cycling,()=>o.cyclingPaused],()=>{o.cycling&&!o.cyclingPaused?A():L()},{immediate:!0}),c(()=>o.template,()=>{I.value=0}),u(()=>{o.cycling&&!o.cyclingPaused&&A()}),p(()=>{L()}),(e,t)=>{const o=f("a-button");return i(),s("div",{class:v(["template-preview",[`preview-${e.displayMode}`,{"preview-cycling":e.cycling&&!e.cyclingPaused}]])},["none"!==e.showControls?(i(),s("div",ee,["pause-play"===e.showControls?(i(),s(m,{key:0},[a(o,{onClick:V,size:"small",type:e.cyclingPaused?"default":"primary",disabled:!e.cycling||O.value<=1},{default:b(()=>[k(h(e.cyclingPaused?"Start":"Pause")+" Variable Substitution ",1)]),_:1},8,["type","disabled"]),e.cycling&&O.value>1?(i(),s("span",ae,h(I.value+1)+" / "+h(O.value),1)):l("",!0)],64)):"editor-mode"===e.showControls?(i(),g(o,{key:1,type:e.previewMode?"default":"primary",onClick:B},{default:b(()=>[e.previewMode?(i(),g(w(P),{key:1})):(i(),g(w(M),{key:0})),k(" "+h(e.previewMode?"Return to Editor":"Preview Filled-In Prompts"),1)]),_:1},8,["type"])):l("",!0)])):l("",!0),n("div",{class:"preview-content",innerHTML:z.value,style:y({maxHeight:e.maxHeight})},null,12,te),e.showLegend&&N.value&&Object.keys(N.value).length>0?(i(),s("div",se,[(i(!0),s(m,null,C(N.value,(e,a,t)=>(i(),s("div",{key:a,class:"legend-item"},[n("span",{class:v(j(t))},h(a),3),n("span",ie,h(e),1)]))),128))])):l("",!0)],2)}}}),[["__scopeId","data-v-e1f62fa2"]]),ne={class:"design-selection-step"},oe={class:"step-body"},re={class:"design-selector","data-testid":"design-selector"},de={key:0,class:"no-designs-state"},ce={class:"no-designs-content"},ue={key:1,class:"design-list","data-testid":"design-list"},pe=["data-design-id","data-design-name","onClick"],ve={class:"design-header"},ge={class:"design-title-section"},me={class:"design-name"},fe={key:0,class:"design-inline-description"},be={class:"design-date"},he={class:"design-stats"},ye={class:"stat-item"},Ce={class:"stat-value"},ke={class:"stat-item"},we={class:"stat-value"},_e={class:"stat-item"},Te={class:"stat-value"},Ie={class:"design-selector","data-testid":"spreadsheet-design-selector"},Se={key:0,class:"no-designs-state"},De={class:"no-designs-content"},xe={key:1,class:"design-list","data-testid":"spreadsheet-design-list"},Me=["data-design-id","data-design-name","onClick"],Pe={class:"design-header"},$e={class:"design-title-section"},Ee={class:"design-name"},Oe={key:0,class:"design-inline-description"},Ne={class:"design-date"},ze={class:"design-stats"},je={class:"stat-item"},Fe={class:"stat-value"},Ve={class:"stat-item"},Be={class:"stat-value"},Ae={class:"stat-item"},Le={class:"stat-value"},He=D(t({__name:"DesignSelectionStep",props:{designSearch:{},filteredDesigns:{},classicDesigns:{},spreadsheetDesigns:{},countVariables:{type:Function},formatLastEditDate:{type:Function},getOutputTypeColor:{type:Function},getCombinationCount:{type:Function}},emits:["select","create-new","create-spreadsheet"],setup(e){const t=e,o=$(),d=r("classic"),{designSearch:c,classicDesigns:u,spreadsheetDesigns:p,countVariables:v,formatLastEditDate:g,getOutputTypeColor:y,getCombinationCount:T}=t;return(e,t)=>{const r=f("a-input"),I=f("a-button"),S=f("a-tag"),D=f("a-tab-pane"),x=f("a-tabs");return i(),s("div",ne,[n("div",oe,[a(x,{activeKey:d.value,"onUpdate:activeKey":t[6]||(t[6]=e=>d.value=e),type:"card",class:"design-tabs"},{default:b(()=>[a(D,{key:"classic",tab:"Classic Designs (permutes through all variable combinations)"},{default:b(()=>[n("div",re,[a(r,{value:w(c),"onUpdate:value":t[0]||(t[0]=e=>_(c)?c.value=e:null),placeholder:"Search classic designs...",size:"large",class:"design-search","data-testid":"input-design-search",allowClear:""},{prefix:b(()=>[a(w(E))]),_:1},8,["value"]),0===w(u).length?(i(),s("div",de,[n("div",ce,[t[8]||(t[8]=n("p",null,"No classic designs found",-1)),a(I,{onClick:t[1]||(t[1]=()=>w(o).initialize())},{default:b(()=>t[7]||(t[7]=[k("Refresh Designs")])),_:1,__:[7]})])])):(i(),s("div",ue,[(i(!0),s(m,null,C(w(u),o=>(i(),s("div",{key:o.id,class:"design-item","data-testid":"design-item","data-design-id":o.id,"data-design-name":o.name,onClick:a=>e.$emit("select",o)},[n("div",ve,[n("div",ge,[n("h4",me,[k(h(o.name)+" ",1),o.description?(i(),s("span",fe,"- "+h(o.description),1)):l("",!0)])]),n("span",be,h(w(g)(o.updated)),1)]),a(le,{design:o,cycling:!0,"show-controls":"none","display-mode":"inline","max-height":"none",class:"design-description"},null,8,["design"]),n("div",he,[a(S,{size:"small",color:w(y)(o.outputType),class:"output-type-tag"},{default:b(()=>[k(h(o.outputType||"text"),1)]),_:2},1032,["color"]),n("span",ye,[n("span",Ce,h(w(v)(o)),1),t[9]||(t[9]=n("span",{class:"stat-label"},"vars",-1))]),t[12]||(t[12]=n("span",{class:"stat-divider"},"•",-1)),n("span",ke,[n("span",we,h(w(T)(o)),1),t[10]||(t[10]=n("span",{class:"stat-label"},"combos",-1))]),t[13]||(t[13]=n("span",{class:"stat-divider"},"•",-1)),n("span",_e,[n("span",Te,h(o.tokenEstimate?.avgTokens||"?"),1),t[11]||(t[11]=n("span",{class:"stat-label"},"tokens",-1))])])],8,pe))),128)),n("div",{class:"design-card design-card-create","data-testid":"btn-create-design",onClick:t[2]||(t[2]=a=>e.$emit("create-new"))},[a(w(O),{style:{"font-size":"24px"}}),t[14]||(t[14]=n("span",null,"Create New Design",-1))])]))])]),_:1}),a(D,{key:"spreadsheet",tab:"Spreadsheet Designs (one API call per row)"},{default:b(()=>[n("div",Ie,[a(r,{value:w(c),"onUpdate:value":t[3]||(t[3]=e=>_(c)?c.value=e:null),placeholder:"Search spreadsheet designs...",size:"large",class:"design-search","data-testid":"input-spreadsheet-search",allowClear:""},{prefix:b(()=>[a(w(E))]),_:1},8,["value"]),0===w(p).length?(i(),s("div",Se,[n("div",De,[t[16]||(t[16]=n("p",null,"No spreadsheet designs found",-1)),a(I,{type:"primary",onClick:t[4]||(t[4]=a=>e.$emit("create-spreadsheet"))},{default:b(()=>[a(w(Y)),t[15]||(t[15]=k(" Create Spreadsheet Design "))]),_:1,__:[15]})])])):(i(),s("div",xe,[(i(!0),s(m,null,C(w(p),o=>(i(),s("div",{key:o.id,class:"design-item","data-testid":"spreadsheet-design-item","data-design-id":o.id,"data-design-name":o.name,onClick:a=>e.$emit("select",o)},[n("div",Pe,[n("div",$e,[n("h4",Ee,[k(h(o.name)+" ",1),o.description?(i(),s("span",Oe,"- "+h(o.description),1)):l("",!0)])]),n("span",Ne,h(w(g)(o.updated)),1)]),a(le,{design:o,cycling:!0,"show-controls":"none","display-mode":"inline","max-height":"none",class:"design-description"},null,8,["design"]),n("div",ze,[a(S,{size:"small",color:"orange",class:"output-type-tag"},{default:b(()=>t[17]||(t[17]=[k(" spreadsheet ")])),_:1,__:[17]}),n("span",je,[n("span",Fe,h(w(v)(o)),1),t[18]||(t[18]=n("span",{class:"stat-label"},"vars",-1))]),t[21]||(t[21]=n("span",{class:"stat-divider"},"•",-1)),n("span",Ve,[n("span",Be,h(w(T)(o)),1),t[19]||(t[19]=n("span",{class:"stat-label"},"rows",-1))]),t[22]||(t[22]=n("span",{class:"stat-divider"},"•",-1)),n("span",Ae,[n("span",Le,h(o.tokenEstimate?.avgTokens||"?"),1),t[20]||(t[20]=n("span",{class:"stat-label"},"tokens",-1))])])],8,Me))),128)),n("div",{class:"design-card design-card-create","data-testid":"btn-create-spreadsheet-design",onClick:t[5]||(t[5]=a=>e.$emit("create-spreadsheet"))},[a(w(Y),{style:{"font-size":"24px"}}),t[23]||(t[23]=n("span",null,"Create Spreadsheet Design",-1))])]))])]),_:1})]),_:1},8,["activeKey"])])])}}}),[["__scopeId","data-v-345415fb"]]),Ue={class:"trial-metadata-form"},Je={class:"form-section"},qe={class:"trial-name-section"},Re={class:"repeat-section"},We={class:"form-stats"},Ke={class:"stat-item"},Ye={class:"stat-value"},Ge={class:"stat-item"},Ze={class:"stat-value"},Qe=D(t({__name:"TrialMetadataForm",props:{modelValue:{},totalCombinations:{}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,o=t;function r(e){o("update:modelValue",{...l.modelValue,trialName:e})}function d(e){o("update:modelValue",{...l.modelValue,repeatCount:e||1})}return(e,t)=>{const l=f("a-input"),o=f("a-input-number");return i(),s("div",Ue,[n("div",Je,[n("div",qe,[t[0]||(t[0]=n("label",{class:"form-label"},"Trial Name:",-1)),a(l,{value:e.modelValue.trialName,"onUpdate:value":r,placeholder:"Enter trial name",class:"trial-name-input","data-testid":"input-trial-name",size:"large"},null,8,["value"])]),n("div",Re,[t[1]||(t[1]=n("label",{class:"form-label"},"Repeat Each Prompt:",-1)),a(o,{value:e.modelValue.repeatCount,"onUpdate:value":d,min:1,max:10,size:"large",class:"repeat-count-input"},null,8,["value"]),t[2]||(t[2]=n("span",{class:"repeat-suffix"},"times",-1))])]),n("div",We,[n("div",Ke,[t[3]||(t[3]=n("span",{class:"stat-label"},"Total Combinations:",-1)),n("span",Ye,h(e.totalCombinations),1)]),n("div",Ge,[t[4]||(t[4]=n("span",{class:"stat-label"},"API Calls per Model:",-1)),n("span",Ze,h(e.totalCombinations*e.modelValue.repeatCount),1)])])])}}}),[["__scopeId","data-v-50707609"]]),Xe={class:"model-configuration-section"},ea={class:"quick-add-row"},aa={class:"quick-add-section"},ta={class:"quick-add-buttons"},sa={key:0,class:"quick-cost"},ia={key:0,class:"config-table","data-testid":"model-config-table"},la=["data-config-index","data-provider","data-model"],na={class:"col-model"},oa={class:"model-name"},ra={class:"model-provider"},da={class:"col-params"},ca={class:"params-text"},ua={class:"col-calls"},pa={class:"calls-breakdown"},va={class:"calls-value"},ga={class:"col-cost"},ma={class:"cost-breakdown"},fa={key:0,class:"cost-value"},ba={key:1,class:"env-cost"},ha={class:"col-total"},ya={class:"cost-breakdown"},Ca={key:0,class:"cost-value total-cost"},ka={key:1,class:"env-cost"},wa={class:"col-actions"},_a={key:0,class:"table-summary-row"},Ta={class:"col-model"},Ia={class:"summary-label"},Sa={class:"col-calls"},Da={class:"summary-calls"},xa={class:"col-total"},Ma={key:0,class:"summary-cost"},Pa={key:1,class:"empty-config-state"},$a=D(t({__name:"ModelConfigurationSection",props:{configurations:{},design:{},totalCombinations:{},repeatCount:{}},emits:["show-model-selector","add","remove"],setup(e,{emit:t}){const o=e,r=t,c=N(),u=z(),p=j(),{hasDataForModel:v}=U(),y=d(()=>u.financialCostsEnabled),_=d(()=>u.environmentalCostsEnabled),S=d(()=>o.totalCombinations*o.configurations.length*o.repeatCount),D=d(()=>{let e=0;for(const a of o.configurations)e+=E(a)*o.totalCombinations*o.repeatCount;return e}),x=d(()=>{const e=e=>u.hasApiKey(e),a=(e,a)=>!!c.enabledModels.find(t=>t.provider===e&&t.modelId===a&&t.enabled),t=[],s=new Set,i=[...p.trials].sort((e,a)=>new Date(a.created).getTime()-new Date(e.created).getTime());for(const c of i){if(t.length>=5)break;for(const i of c.configurationSnapshots||[]){if(t.length>=5)break;const l=`${i.provider}:${i.modelId}:${JSON.stringify(i.parameters)}`;if(!s.has(l)&&e(i.provider)&&a(i.provider,i.modelId)){const e=F.getParametersForModel(i.provider,i.modelId);if(!e)continue;if(Object.keys(i.parameters).some(a=>!(a in e)))continue;s.add(l),t.push({provider:i.provider,modelId:i.modelId,displayName:i.modelId,parameters:i.parameters,outputType:"text"})}}}const l=(e,a)=>{const t=F.getParametersForModel(e,a),s={},i=(e,a)=>{Object.entries(e).forEach(([e,t])=>{"object"===t.type&&t.properties?(a[e]={},i(t.properties,a[e])):void 0!==t.default&&(a[e]=t.default)})};i(t,s),s.temperature||!s.options||s.options.temperature||(s.options?s.options.temperature=0:s.temperature=0);const l=(e,a)=>{for(const[t,s]of Object.entries(e))"object"===s.type&&s.properties?(a[t]||(a[t]={}),l(s.properties,a[t])):s.is_output_length&&void 0===a[t]&&(a[t]=128)};return l(t,s),s},n=[{provider:"openai-chat",modelId:"gpt-4.1-nano",displayName:"gpt-4.1-nano",parameters:l("openai-chat","gpt-4.1-nano"),outputType:"text"},{provider:"anthropic",modelId:"claude-3-haiku-20240307",displayName:"claude-3-haiku-20240307",parameters:l("anthropic","claude-3-haiku-20240307"),outputType:"text"}],o=new Set(t.map(e=>`${e.provider}:${e.modelId}:${JSON.stringify(e.parameters)}`));for(const c of n){const s=`${c.provider}:${c.modelId}:${JSON.stringify(c.parameters)}`;!o.has(s)&&e(c.provider)&&a(c.provider,c.modelId)&&t.push(c)}const r=[],d=new Set;for(const c of t){const e=`${c.provider}:${c.modelId}`;d.has(e)||(d.add(e),r.push(c))}return r.slice(0,7)});function M(e){const a=[];for(const[t,s]of Object.entries(e))null!=s&&a.push(`${t}=${s}`);return a.join(", ")||"Default settings"}function P(e){return o.configurations.some(a=>a.provider===e.provider&&a.modelId===e.modelId&&JSON.stringify(a.parameters)===JSON.stringify(e.parameters))}function $(e){const a=c.enabledModels.find(a=>a.provider===e.provider&&a.modelId===e.modelId);if(!a||!o.design)return 0;const t=o.design.tokenEstimate?.avgTokens||0,s=F.getParametersForModel(e.provider,e.modelId);let i=0;for(const[l,n]of Object.entries(s))if(n.is_output_length&&e.parameters[l]){i=e.parameters[l];break}if(0===t||0===i)return 0;return((a.capabilities?.inputCostPerToken||0)*t+(a.capabilities?.outputCostPerToken||0)*i)*o.totalCombinations*o.repeatCount}function E(e){const a=c.enabledModels.find(a=>a.provider===e.provider&&a.modelId===e.modelId);if(!a||!o.design)return 0;const t=o.design.tokenEstimate?.avgTokens||0,s=F.getParametersForModel(e.provider,e.modelId);let i=0;for(const[l,n]of Object.entries(s))if(n.is_output_length&&e.parameters[l]){i=e.parameters[l];break}if(0===t||0===i)return 0;return(a.capabilities?.inputCostPerToken||0)*t+(a.capabilities?.outputCostPerToken||0)*i}function V(e){return E(e)*o.totalCombinations*o.repeatCount}function B(e){return v(e.provider,e.modelId)}function A(e,a){return"per-call"===a?"<1mg CO₂e":"~10mg CO₂e"}return(e,t)=>{const o=f("a-button");return i(),s("div",Xe,[n("div",ea,[a(o,{onClick:t[0]||(t[0]=a=>e.$emit("show-model-selector")),type:"primary",size:"large",class:"big-add-model-btn","data-testid":"btn-add-model","aria-label":"Add Model Configuration"},{default:b(()=>[a(w(O)),t[1]||(t[1]=k(" Add Model "))]),_:1,__:[1]}),t[3]||(t[3]=n("div",{class:"separator-bar"},null,-1)),n("div",aa,[t[2]||(t[2]=n("div",{class:"quick-add-label"},"Quick add recent/popular models (with default temperature=0, max response length = 128):",-1)),n("div",ta,[(i(!0),s(m,null,C(x.value,e=>(i(),g(o,{key:`${e.provider}:${e.modelId}:${JSON.stringify(e.parameters)}`,onClick:a=>function(e){P(e)||(r("add",{name:e.displayName,provider:e.provider,modelId:e.modelId,parameters:e.parameters}),I(()=>{const e=document.querySelector(".ant-modal-body");e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})}))}(e),size:"small",class:"quick-preset-btn",disabled:P(e),"data-testid":"quick-add-model","data-provider":e.provider,"data-model":e.modelId,"aria-label":`Quick add ${e.displayName} model`},{default:b(()=>[k(h(e.displayName)+" ",1),y.value?(i(),s("span",sa,h(w(J)($(e))),1)):l("",!0)]),_:2},1032,["onClick","disabled","data-provider","data-model","aria-label"]))),128))])])]),e.configurations.length>0?(i(),s("div",ia,[t[8]||(t[8]=T('<div class="table-header" data-v-324278fb><div class="col-model" data-v-324278fb>Model</div><div class="col-params" data-v-324278fb>Parameters</div><div class="col-calls" data-v-324278fb>API Calls</div><div class="col-cost" data-v-324278fb>Cost per Call</div><div class="col-total" data-v-324278fb>Total Cost</div><div class="col-actions" data-v-324278fb>Actions</div></div>',1)),(i(!0),s(m,null,C(e.configurations,(r,d)=>(i(),s("div",{key:`model-config-${r.provider}-${r.modelId}-${d}`,class:"table-row","data-testid":"model-config-row","data-config-index":d,"data-provider":r.provider,"data-model":r.modelId},[n("div",na,[n("div",oa,h(r.provider)+":"+h(r.modelId),1),n("div",ra,h(r.provider),1)]),n("div",da,[n("span",ca,h(M(r.parameters)),1)]),n("div",ua,[n("span",pa,h(e.totalCombinations)+" × "+h(e.repeatCount)+" = ",1),n("span",va,h(e.totalCombinations*e.repeatCount),1)]),n("div",ga,[n("div",ma,[y.value?(i(),s("span",fa,h(w(J)(E(r))),1)):l("",!0),_.value&&B(r)?(i(),s("small",ba,h(A(0,"per-call")),1)):l("",!0)])]),n("div",ha,[n("div",ya,[y.value?(i(),s("span",Ca,h(w(J)(V(r))),1)):l("",!0),_.value&&B(r)?(i(),s("small",ka,h(A(0,"total")),1)):l("",!0)])]),n("div",wa,[a(o,{type:"text",size:"small",danger:"",onClick:a=>e.$emit("remove",d),class:"remove-btn","data-testid":"remove-model-config","data-config-index":d,"aria-label":`Remove ${r.provider} ${r.modelId} configuration`},{default:b(()=>t[4]||(t[4]=[k("Remove")])),_:2,__:[4]},1032,["onClick","data-config-index","aria-label"])])],8,la))),128)),e.configurations.length>1?(i(),s("div",_a,[n("div",Ta,[n("div",Ia,"TOTAL ("+h(e.configurations.length)+" models)",1)]),t[5]||(t[5]=n("div",{class:"col-params"},null,-1)),n("div",Sa,[n("span",Da,h(S.value),1)]),t[6]||(t[6]=n("div",{class:"col-cost"},null,-1)),n("div",xa,[y.value?(i(),s("span",Ma,h(w(J)(D.value)),1)):l("",!0)]),t[7]||(t[7]=n("div",{class:"col-actions"},null,-1))])):l("",!0)])):(i(),s("div",Pa,t[9]||(t[9]=[n("p",null,"No models configured yet. Add at least one model to continue.",-1)])))])}}}),[["__scopeId","data-v-324278fb"]]);const Ea={key:0,class:"trial-creation-form"},Oa={class:"streamlined-content"},Na={class:"content-section"},za={class:"section-header"},ja={class:"section-body"},Fa={key:1,class:"selected-design-with-template"},Va={class:"unified-header"},Ba={class:"combinations-count"},Aa={class:"header-controls"},La={class:"design-stats"},Ha={class:"stat-item"},Ua={class:"stat-value"},Ja={class:"stat-item"},qa={class:"stat-value"},Ra={class:"stat-item"},Wa={class:"stat-value"},Ka={key:0,class:"content-section","data-testid":"trial-config-section"},Ya={class:"section-body"},Ga={class:"model-section"},Za={class:"tab-footer"},Qa={class:"footer-actions"},Xa={class:"streamlined-content"},et={class:"content-section"},at={class:"section-header"},tt={class:"section-body"},st={key:1,class:"selected-design-with-template"},it={class:"unified-header"},lt={class:"combinations-count"},nt={class:"header-controls"},ot={class:"design-stats"},rt={class:"stat-item"},dt={class:"stat-value"},ct={class:"stat-item"},ut={class:"stat-value"},pt={class:"stat-item"},vt={class:"stat-value"},gt={key:0,class:"content-section","data-testid":"trial-config-section"},mt={class:"section-body"},ft={class:"model-section"},bt=D(t({__name:"TrialCreationModalNew",props:{initialDesignId:{},trialToDuplicate:{},isEditMode:{type:Boolean},isTabMode:{type:Boolean}},emits:["close","created","created-and-started","export-trial"],setup(t,{emit:o}){const v=t,m=o,y=j(),C=d(()=>({type:v.isEditMode?"edit":v.trialToDuplicate?"duplicate":"create",initialDesignId:v.initialDesignId,sourceTrial:v.trialToDuplicate||void 0})),_=x(),T=function(e){const a=$(),t=x(),s=N(),i=j(),l=z(),n=r(null),o=r(""),c=r(1),u=r([]),p=r(!1),v=r(!1),g=r(!1),m=r(!1),f=d(()=>{if(!n.value)return 0;let e=1;for(const a of Object.values(n.value.variableBindings))if("direct"===a.type)e*=a.values?.length||1;else if(a.listId){const s=t.lists.find(e=>e.id===a.listId);e*=s?.itemCount||1}return e}),b=d(()=>f.value*u.value.length*c.value),h=d(()=>{let e=0;for(const a of u.value)e+=w(a)*f.value*c.value;return e}),y=d(()=>null!==n.value&&u.value.length>0);function C(e){n.value=e,o.value=k(e),g.value=!0}function k(e){return e||n.value?`${e?.name||n.value?.name||"Trial"} - ${(new Date).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}`:"New Trial"}function w(e){const a=s.enabledModels.find(a=>a.provider===e.provider&&a.modelId===e.modelId);if(!a)return 0;const t=n.value?.tokenEstimate?.avgTokens||0,i=F.getParametersForModel(e.provider,e.modelId);let l=0;for(const[s,n]of Object.entries(i))if(n.is_output_length&&e.parameters[s]){l=e.parameters[s];break}return 0===t||0===l?0:(a.capabilities?.inputCostPerToken||0)*t+(a.capabilities?.outputCostPerToken||0)*l}return{selectedDesign:n,trialName:o,repeatCount:c,configurations:u,creating:p,showModelSelector:v,liveUpdatePaused:g,showPlaceholders:m,totalCombinations:f,totalExperiments:b,totalCost:h,canProceed:y,selectDesign:C,generateTrialName:k,addConfiguration:function(e){u.value.push(e)},removeConfiguration:function(e){u.value.splice(e,1)},getConfigCostPerCall:w,createDraftTrial:async function(){if(n.value&&0!==u.value.length){p.value="draft";try{const e=await i.createTrial({name:o.value||k(),designId:n.value.id,configurations:u.value.map(e=>({name:e.name,provider:e.provider,modelId:e.modelId,parameters:JSON.parse(JSON.stringify(e.parameters||{}))})),repeatConfig:c.value>1?{callsPerPrompt:c.value,strategy:"sequential"}:void 0});return V.success("Trial created as draft!"),e}catch(e){throw B.error("Failed to create draft trial",e),V.error("Failed to create draft trial"),e}finally{p.value=!1}}},createAndStartTrial:async function(){if(n.value&&0!==u.value.length){p.value="start";try{const e=await i.createTrial({name:o.value||k(),designId:n.value.id,configurations:u.value.map(e=>({name:e.name,provider:e.provider,modelId:e.modelId,parameters:JSON.parse(JSON.stringify(e.parameters||{}))})),repeatConfig:c.value>1?{callsPerPrompt:c.value,strategy:"sequential"}:void 0});V.success("Trial created!");const a=await i.getRunningTrials();return a.length>0?{trialId:e,runningTrial:a[0]}:(V.success("Starting execution..."),await i.executeTrial(e),{trialId:e})}catch(e){throw B.error("Failed to create trial",e),V.error("Failed to create trial"),e}finally{p.value=!1}}},createAndExportTrial:async function(){if(n.value&&0!==u.value.length){p.value="export";try{const e=await i.createTrial({name:o.value||k(),designId:n.value.id,configurations:u.value.map(e=>({name:e.name,provider:e.provider,modelId:e.modelId,parameters:JSON.parse(JSON.stringify(e.parameters||{}))})),repeatConfig:c.value>1?{callsPerPrompt:c.value,strategy:"sequential"}:void 0}),a=await i.getTrial(e);if(!a)throw new Error("Trial not found after creation");return V.success("Trial created! Opening export options..."),a}catch(e){throw B.error("Failed to create trial for export",e),V.error("Failed to create trial for export"),e}finally{p.value=!1}}},initialize:async function(){await Promise.all([a.initialize(),t.initialize(),i.initialize()]);const s=e.value;if(s.initialDesignId){const e=a.designs.find(e=>e.id===s.initialDesignId);e&&C(e)}if(s.sourceTrial){const e=s.sourceTrial,t=a.designs.find(a=>a.id===e.designSnapshot.originalId);t&&(n.value=t,o.value="edit"===s.type?e.name:`Copy of ${e.name}`,e.repeatConfig?.callsPerPrompt&&(c.value=e.repeatConfig.callsPerPrompt),e.configurationSnapshots&&e.configurationSnapshots.length>0&&(u.value=e.configurationSnapshots.map(e=>({name:e.name||e.modelId,provider:e.provider,modelId:e.modelId,parameters:e.parameters||{}}))),g.value=!0)}},designsStore:a,variableListsStore:t,modelsStore:s,settingsStore:l}}(C),I=function(){const e=$(),a=x(),t=r(""),s=r(0);let i=null;const l=d(()=>{const a=e.designs;if(!t.value)return a;const s=t.value.toLowerCase();return a.filter(e=>e.name.toLowerCase().includes(s)||e.promptTemplate.toLowerCase().includes(s))}),n=d(()=>l.value.filter(e=>!e.executionMode||"cartesian"===e.executionMode)),o=d(()=>l.value.filter(e=>"aligned"===e.executionMode));function c(e){return e.replace(/\n+/g," ").replace(/\s+/g," ").trim()}function v(e){if(!e.variableBindings)return[{}];const t=[];for(const[i,l]of Object.entries(e.variableBindings))if("direct"===l.type&&l.values)t.push({name:i,values:[...l.values]});else if("list"===l.type&&l.listId){const e=a.lists.find(e=>e.id===l.listId);if(e){let a=[];a="simple"===e.category&&e.values?e.values:"attributed"===e.category&&e.items?e.items.map(e=>e.value):[`${i}_sample`],t.push({name:i,values:a})}}if(0===t.length)return[{}];const s=[...t.map(e=>e.values).reduce((e,a)=>e.flatMap(e=>a.map(a=>[...e,a])),[[]])];for(let a=s.length-1;a>0;a--){const e=Math.floor(Math.random()*(a+1));[s[a],s[e]]=[s[e],s[a]]}return s.map(e=>{const a={};return t.forEach((t,s)=>{a[t.name]=e[s]}),a})}function g(e){const a=document.createElement("div");return a.textContent=e,a.innerHTML}function m(){i||(i=setInterval(()=>{s.value++},1e3))}function f(){i&&(clearInterval(i),i=null)}return u(()=>{m()}),p(()=>{f()}),{designSearch:t,previewCycleIndex:s,filteredDesigns:l,classicDesigns:n,spreadsheetDesigns:o,countVariables:function(e){return Object.keys(e.variableBindings).length},truncateTemplate:c,formatLastEditDate:function(e){const a=new Date,t=a.getTime()-e.getTime(),s=Math.floor(t/864e5);if(0===s)return"Today";if(1===s)return"Yesterday";if(s<7)return`${s} days ago`;if(s<30){const e=Math.floor(s/7);return`${e} week${e>1?"s":""} ago`}return e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:e.getFullYear()!==a.getFullYear()?"numeric":void 0})},getOutputTypeColor:function(e){return{text:"blue",number:"green",boolean:"purple",json:"orange"}[e]||"default"},getCombinationCount:function(e){if(!e.variableBindings)return"1";let t=1;for(const s of Object.values(e.variableBindings))if("direct"===s.type&&s.values)t*=s.values.length;else if("list"===s.type&&s.listId){const e=a.lists.find(e=>e.id===s.listId);t*=e?.itemCount||1}return t>1e3?`${(t/1e3).toFixed(1)}k`:t.toString()},generateVariableCombinations:v,getPreviewTemplateHTML:function(e){const a=v(e);if(a.length<=1)return g(c(e.promptTemplate));const t=a[s.value%a.length],i=["variable-highlight-blue","variable-highlight-green","variable-highlight-purple","variable-highlight-orange","variable-highlight-pink","variable-highlight-teal"];let l=e.promptTemplate;Object.keys(e.variableBindings||{}).forEach((e,a)=>{if(void 0!==t[e]){const s=new RegExp(`\\{\\{\\s*${e}\\s*\\}\\}`,"g"),n=`<span class="${i[a%i.length]}">${g(String(t[e]))}</span>`;l=l.replace(s,n)}});let n=g(l);return i.forEach(e=>{n=n.replace(new RegExp(`&lt;span class="${e}"&gt;`,"g"),`<span class="${e}">`).replace(/&lt;\/span&gt;/g,"</span>")}),c(n)},escapeHtml:g,startCycling:m,stopCycling:f}}(),S=r(!0),D=d(()=>T.selectedDesign.value),M=d({get:()=>T.trialName.value,set:e=>{T.trialName.value=e}}),P=d({get:()=>T.repeatCount.value,set:e=>{T.repeatCount.value=e}}),E=d(()=>T.configurations.value),O=d({get:()=>T.showModelSelector.value,set:e=>{T.showModelSelector.value=e}}),U=d(()=>T.creating.value),J=d(()=>T.totalCombinations.value),{countVariables:R,getOutputTypeColor:W}=I,K=d(()=>v.isEditMode&&v.trialToDuplicate?`Edit Trial: ${v.trialToDuplicate.name}`:v.trialToDuplicate?`Duplicate Trial: ${v.trialToDuplicate.name}`:"Create New Trial"),Y=d(()=>T.canProceed.value);async function G(e){0===_.lists.length&&await _.initialize();const a={...e,variableBindings:Object.entries(e.variableBindings).reduce((e,[a,t])=>(e[a]={type:t.type,values:t.values?[...t.values]:void 0,listId:t.listId,listName:t.listName,source:t.source?{...t.source}:void 0},e),{}),tokenEstimate:e.tokenEstimate?{...e.tokenEstimate}:void 0,refusalWords:e.refusalWords?[...e.refusalWords]:void 0};T.selectDesign(a),S.value=!0,I.stopCycling()}async function Z(e){try{const a=await H.designs.get(e);a&&T.selectDesign(a)}catch(a){B.error("Failed to load design",a),L.error({title:"Failed to load design",content:a instanceof Error?a.message:"Unknown error"})}}function Q(){T.selectedDesign.value=null,T.configurations.value=[]}async function ee(){m("close"),window.location.href="#/designs"}async function ae(){m("close"),window.location.href="#/spreadsheet"}function te(e){T.trialName.value=e.trialName,T.repeatCount.value=e.repeatCount}function se(e){T.addConfiguration(e)}function ie(e){T.removeConfiguration(e)}function ne(e){se(e),T.showModelSelector.value=!1}async function oe(){try{const e=await T.createDraftTrial();e&&(m("created",e),m("close"))}catch(e){}}async function re(){try{const e=await T.createAndExportTrial();e&&(m("export-trial",e),m("close"))}catch(e){}}async function de(){try{const e=await T.createAndStartTrial();e&&(e.runningTrial?L.confirm({title:"Another trial is already running",content:`The trial "${e.runningTrial.name}" is currently running. Starting a new trial will pause it. Do you want to continue?`,okText:"Yes, start new trial",cancelText:"No, keep current trial",onOk:async()=>{try{await y.executeTrial(e.trialId),m("created-and-started",e.trialId),m("close")}catch(a){B.error("Failed to start trial after confirmation",a),V.error("Failed to start trial")}},onCancel:()=>{m("created",e.trialId),m("close")}}):(m("created-and-started",e.trialId),m("close")))}catch(e){}}function ce(){S.value=!S.value,S.value?I.stopCycling():I.startCycling()}return u(async()=>{await T.initialize(),0===_.lists.length&&await _.initialize()}),c(()=>v.trialToDuplicate,()=>{v.trialToDuplicate&&async function(){if(v.trialToDuplicate)try{v.trialToDuplicate.designSnapshot?.originalId&&await Z(v.trialToDuplicate.designSnapshot.originalId),v.isEditMode?T.trialName.value=v.trialToDuplicate.name:T.trialName.value=`${v.trialToDuplicate.name} (Copy)`,T.repeatCount.value=v.trialToDuplicate.repeatConfig?.callsPerPrompt||1,T.configurations.value=v.trialToDuplicate.configurationSnapshots||[]}catch(e){B.error("Failed to initialize duplication",e),L.error({title:"Failed to load trial data",content:e instanceof Error?e.message:"Unknown error"})}}()},{immediate:!0}),c(()=>v.initialDesignId,()=>{v.initialDesignId&&!v.trialToDuplicate&&async function(){v.initialDesignId&&await Z(v.initialDesignId)}()},{immediate:!0}),(t,o)=>{const r=f("a-button"),d=f("a-tag");return t.isTabMode?(i(),s("div",Ea,[n("div",Oa,[n("section",Na,[n("div",za,[o[8]||(o[8]=n("h3",null,"What are you testing?",-1)),D.value?(i(),g(r,{key:0,onClick:Q,size:"small",class:"back-button",style:{"margin-left":"2em"}},{default:b(()=>o[7]||(o[7]=[k(" ← Back to Select Design ")])),_:1,__:[7]})):l("",!0)]),n("div",ja,[D.value?(i(),s("div",Fa,[n("div",Va,[n("h4",null,h(D.value.name),1),n("span",Ba,h(J.value)+" combinations",1),n("div",Aa,[a(r,{onClick:ce,size:"small",type:S.value?"default":"primary",class:"pause-btn"},{default:b(()=>[k(h(S.value?"Start Variable Substitution":"Pause Variable Substitution"),1)]),_:1},8,["type"])])]),a(le,{design:D.value,cycling:!0,"cycling-paused":S.value,"show-controls":"none","display-mode":"inline","max-height":"none",class:"step2-preview","onUpdate:cyclingPaused":o[0]||(o[0]=e=>S.value=e)},null,8,["design","cycling-paused"]),n("div",La,[a(d,{size:"small",color:w(W)(D.value.outputType),class:"output-type-tag"},{default:b(()=>[k(h(D.value.outputType||"text"),1)]),_:1},8,["color"]),n("span",Ha,[n("span",Ua,h(w(R)(D.value)),1),o[9]||(o[9]=n("span",{class:"stat-label"},"vars",-1))]),o[12]||(o[12]=n("span",{class:"stat-divider"},"•",-1)),n("span",Ja,[n("span",qa,h(J.value),1),o[10]||(o[10]=n("span",{class:"stat-label"},"combos",-1))]),o[13]||(o[13]=n("span",{class:"stat-divider"},"•",-1)),n("span",Ra,[n("span",Wa,h(D.value.tokenEstimate?.avgTokens||"?"),1),o[11]||(o[11]=n("span",{class:"stat-label"},"tokens",-1))])])])):(i(),g(He,{key:0,"design-search":w(I).designSearch,"filtered-designs":w(I).filteredDesigns,"classic-designs":w(I).classicDesigns,"spreadsheet-designs":w(I).spreadsheetDesigns,"count-variables":w(I).countVariables,"format-last-edit-date":w(I).formatLastEditDate,"get-output-type-color":w(I).getOutputTypeColor,"get-combination-count":w(I).getCombinationCount,onSelect:G,onCreateNew:ee,onCreateSpreadsheet:ae},null,8,["design-search","filtered-designs","classic-designs","spreadsheet-designs","count-variables","format-last-edit-date","get-output-type-color","get-combination-count"]))])]),D.value?(i(),s("section",Ka,[o[15]||(o[15]=n("h3",null,"Trial Configuration",-1)),n("div",Ya,[a(Qe,{"model-value":{trialName:M.value,repeatCount:P.value},"total-combinations":J.value,"onUpdate:modelValue":te},null,8,["model-value","total-combinations"]),n("div",Ga,[o[14]||(o[14]=n("h4",null,"Model Configuration",-1)),a($a,{configurations:E.value,design:D.value,"total-combinations":J.value,"repeat-count":P.value,onShowModelSelector:o[1]||(o[1]=e=>O.value=!0),onAdd:se,onRemove:ie},null,8,["configurations","design","total-combinations","repeat-count"])])])])):l("",!0)]),n("div",Za,[n("div",Qa,[a(r,{size:"large",onClick:oe,loading:"draft"===U.value,disabled:!Y.value,"data-testid":"btn-create-draft-tab","aria-label":"Create trial as draft"},{default:b(()=>o[16]||(o[16]=[k(" Create as Draft ")])),_:1,__:[16]},8,["loading","disabled"]),a(r,{size:"large",onClick:re,loading:"export"===U.value,disabled:!Y.value,"data-testid":"btn-export-python-tab","aria-label":"Export trial to Python"},{default:b(()=>o[17]||(o[17]=[k(" Export to Python ")])),_:1,__:[17]},8,["loading","disabled"]),a(r,{type:"primary",size:"large",onClick:de,loading:"start"===U.value,disabled:!Y.value,"data-testid":"btn-create-and-start-tab","aria-label":"Create and start trial execution"},{default:b(()=>[a(w(A)),o[18]||(o[18]=k(" Create and Start "))]),_:1,__:[18]},8,["loading","disabled"])])]),a(q,{open:O.value&&!!D.value,mode:"trial",design:D.value||void 0,"existing-configurations":E.value,onClose:o[2]||(o[2]=e=>O.value=!1),onAddConfiguration:ne},null,8,["open","design","existing-configurations"])])):(i(),g(e,{key:1,"model-value":!0,title:K.value,size:"full","data-testid":"modal-trial-creation","onUpdate:modelValue":o[6]||(o[6]=e=>t.$emit("close"))},{footer:b(()=>[a(X,null,{default:b(()=>[a(r,{size:"large",onClick:oe,loading:"draft"===U.value,disabled:!Y.value,"data-testid":"btn-create-draft","aria-label":"Create trial as draft"},{default:b(()=>o[28]||(o[28]=[k(" Create as Draft ")])),_:1,__:[28]},8,["loading","disabled"]),a(r,{size:"large",onClick:re,loading:"export"===U.value,disabled:!Y.value,"data-testid":"btn-export-python","aria-label":"Export trial to Python"},{default:b(()=>o[29]||(o[29]=[k(" Export to Python ")])),_:1,__:[29]},8,["loading","disabled"]),a(r,{type:"primary",size:"large",onClick:de,loading:"start"===U.value,disabled:!Y.value,"data-testid":"btn-create-and-start","aria-label":"Create and start trial execution"},{default:b(()=>[a(w(A)),o[30]||(o[30]=k(" Create and Start "))]),_:1,__:[30]},8,["loading","disabled"])]),_:1})]),default:b(()=>[n("div",Xa,[n("section",et,[n("div",at,[o[20]||(o[20]=n("h3",null,"What are you testing?",-1)),D.value?(i(),g(r,{key:0,onClick:Q,size:"small",class:"back-button",style:{"margin-left":"2em"}},{default:b(()=>o[19]||(o[19]=[k(" ← Back to Select Design ")])),_:1,__:[19]})):l("",!0)]),n("div",tt,[D.value?(i(),s("div",st,[n("div",it,[n("h4",null,h(D.value.name),1),n("span",lt,h(J.value)+" combinations",1),n("div",nt,[a(r,{onClick:ce,size:"small",type:S.value?"default":"primary",class:"pause-btn"},{default:b(()=>[k(h(S.value?"Start Variable Substitution":"Pause Variable Substitution"),1)]),_:1},8,["type"])])]),a(le,{design:D.value,cycling:!0,"cycling-paused":S.value,"show-controls":"none","display-mode":"inline","max-height":"none",class:"step2-preview","onUpdate:cyclingPaused":o[3]||(o[3]=e=>S.value=e)},null,8,["design","cycling-paused"]),n("div",ot,[a(d,{size:"small",color:w(W)(D.value.outputType),class:"output-type-tag"},{default:b(()=>[k(h(D.value.outputType||"text"),1)]),_:1},8,["color"]),n("span",rt,[n("span",dt,h(w(R)(D.value)),1),o[21]||(o[21]=n("span",{class:"stat-label"},"vars",-1))]),o[24]||(o[24]=n("span",{class:"stat-divider"},"•",-1)),n("span",ct,[n("span",ut,h(J.value),1),o[22]||(o[22]=n("span",{class:"stat-label"},"combos",-1))]),o[25]||(o[25]=n("span",{class:"stat-divider"},"•",-1)),n("span",pt,[n("span",vt,h(D.value.tokenEstimate?.avgTokens||"?"),1),o[23]||(o[23]=n("span",{class:"stat-label"},"tokens",-1))])])])):(i(),g(He,{key:0,"design-search":w(I).designSearch,"filtered-designs":w(I).filteredDesigns,"classic-designs":w(I).classicDesigns,"spreadsheet-designs":w(I).spreadsheetDesigns,"count-variables":w(I).countVariables,"format-last-edit-date":w(I).formatLastEditDate,"get-output-type-color":w(I).getOutputTypeColor,"get-combination-count":w(I).getCombinationCount,onSelect:G,onCreateNew:ee,onCreateSpreadsheet:ae},null,8,["design-search","filtered-designs","classic-designs","spreadsheet-designs","count-variables","format-last-edit-date","get-output-type-color","get-combination-count"]))])]),D.value?(i(),s("section",gt,[o[27]||(o[27]=n("h3",null,"Trial Configuration",-1)),n("div",mt,[a(Qe,{"model-value":{trialName:M.value,repeatCount:P.value},"total-combinations":J.value,"onUpdate:modelValue":te},null,8,["model-value","total-combinations"]),n("div",ft,[o[26]||(o[26]=n("h4",null,"Model Configuration",-1)),a($a,{configurations:E.value,design:D.value,"total-combinations":J.value,"repeat-count":P.value,onShowModelSelector:o[4]||(o[4]=e=>O.value=!0),onAdd:se,onRemove:ie},null,8,["configurations","design","total-combinations","repeat-count"])])])])):l("",!0)]),a(q,{open:O.value&&!!D.value,mode:"trial",design:D.value||void 0,"existing-configurations":E.value,onClose:o[5]||(o[5]=e=>O.value=!1),onAddConfiguration:ne},null,8,["open","design","existing-configurations"])]),_:1},8,["title"]))}}}),[["__scopeId","data-v-befda5c7"]]);export{bt as T,le as a};
