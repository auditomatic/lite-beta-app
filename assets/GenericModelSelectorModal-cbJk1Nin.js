import{d as e,f as a,r as l,c as t,V as o,Z as s,W as i,Y as n,_ as d,a0 as r,a6 as u,a1 as c,k as v,a8 as p,F as m,aa as f,B as g,G as y}from"./vendor-BARfHmiz.js";import{u as k}from"./models-db-CK0qIBeX.js";import{p as b,_ as h}from"./index-0dU5AN9h.js";import{a as C}from"./cost-formatting-Bv_drrqY.js";import{i as _}from"./feature-flags-DaxAZY-J.js";import{E as x}from"./EnvironmentalCostSummary-Cj112wWk.js";const P={class:"modal-header"},T={class:"modal-content"},j={class:"models-panel"},w={class:"panel-header"},S={class:"models-list"},$={class:"provider-header"},M={class:"provider-name"},z={class:"provider-model-count"},E={class:"provider-models"},F=["onClick"],N={class:"model-info"},U={class:"model-name"},I={class:"model-cost"},O={class:"cost-primary"},A={key:0,class:"config-panel"},B={class:"config-header"},G={class:"total-cost"},K={class:"cost-value"},L={key:0,class:"cost-info"},q={key:0,class:"config-content"},D={class:"param-description"},V={class:"config-footer"},W=h(e({__name:"GenericModelSelectorModal",props:{open:{type:Boolean},mode:{},design:{},title:{},existingConfigurations:{}},emits:["close","add-configuration","select-model"],setup(e,{emit:h}){const W=e,Y=h,Z=k(),H=a(""),J=a([]),Q=a(null),R=a(""),X=l({}),ee=a(_()),ae=t(()=>{let e=Z.enabledModels;if(H.value){const a=H.value.toLowerCase();e=e.filter(e=>e.displayName.toLowerCase().includes(a)||e.modelId.toLowerCase().includes(a))}const a={};for(const l of e)a[l.provider]||(a[l.provider]=[]),a[l.provider].push(l);for(const l in a)a[l].sort((e,a)=>e.displayName.localeCompare(a.displayName));return a}),le=t(()=>{if("trial"!==W.mode||!W.design)return 1;let e=1;for(const a of Object.values(W.design.variableBindings))"direct"===a.type&&(e*=a.values?.length||1);return e}),te=t(()=>"trial"===W.mode?"Total cost":"Cost per 1K tokens"),oe=t(()=>{if(!Q.value)return{};const e=b.getParametersForModel(Q.value.provider,Q.value.modelId),a={};for(const[l,t]of Object.entries(e))t.basic&&(a[l]=t);return a});function se(e){if(!e.capabilities)return"—";if("trial"===W.mode&&W.design){const a=W.design.tokenEstimate?.avgTokens||150,l=256,t=((e.capabilities.inputCostPerToken||0)*a+(e.capabilities.outputCostPerToken||0)*l)*le.value;return C(t)}{const a=1e3*(e.capabilities.inputCostPerToken||0),l=1e3*(e.capabilities.outputCostPerToken||0);return 0===a&&0===l?"—":`$${a.toFixed(4)}/$${l.toFixed(4)}`}}function ie(){if(!Q.value||!Q.value.capabilities)return"—";if("trial"===W.mode&&W.design){const e=W.design.tokenEstimate?.avgTokens||150,a=X.max_tokens||X.max_completion_tokens||256,l=(Q.value.capabilities.inputCostPerToken||0)*e,t=(Q.value.capabilities.outputCostPerToken||0)*a;return C((l+t)*le.value)}{const e=1e3*(Q.value.capabilities.inputCostPerToken||0),a=1e3*(Q.value.capabilities.outputCostPerToken||0);return 0===e&&0===a?"—":`$${e.toFixed(4)}/$${a.toFixed(4)}`}}function ne(){Q.value&&R.value&&Y("add-configuration",{name:R.value,provider:Q.value.provider,modelId:Q.value.modelId,parameters:{...X}})}function de(){Q.value&&(Y("select-model",Q.value),Y("close"))}return(e,a)=>{const l=i("a-input-search"),t=i("a-button"),k=i("a-collapse-panel"),h=i("a-collapse"),C=i("a-input"),_=i("a-form-item"),Y=i("a-input-number"),Z=i("a-col"),re=i("a-row"),ue=i("a-form"),ce=i("a-modal");return n(),o(ce,{open:e.open,onCancel:a[3]||(a[3]=a=>e.$emit("close")),width:"90%",style:{"max-width":"1400px"},footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"}},{default:s(()=>[d("div",P,[d("h2",null,r(e.title||"Select Model"),1)]),d("div",T,[d("div",j,[d("div",w,[a[4]||(a[4]=d("h3",null,"Available Models",-1)),v(l,{value:H.value,"onUpdate:value":a[0]||(a[0]=e=>H.value=e),placeholder:"Search models...",size:"large","allow-clear":""},null,8,["value"])]),d("div",S,[v(h,{activeKey:J.value,"onUpdate:activeKey":a[1]||(a[1]=e=>J.value=e),bordered:!1},{default:s(()=>[(n(!0),u(m,null,p(ae.value,(a,l)=>(n(),o(k,{key:l,class:"provider-panel"},{header:s(()=>[d("div",$,[d("span",M,r(l),1),d("span",z,r(a.length)+" models",1)])]),extra:s(()=>[v(t,{size:"small",type:"text",onClick:g(e=>function(e){const a=J.value.indexOf(e);a>-1?J.value.splice(a,1):J.value.push(e)}(l),["stop"])},{default:s(()=>[y(r(J.value.includes(l)?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:s(()=>[d("div",E,[(n(!0),u(m,null,p(a,a=>(n(),u("div",{key:a.id,class:f(["model-row",{selected:Q.value?.id===a.id}]),onClick:e=>function(e){if(Q.value=e,"trial"===W.mode){R.value=e.displayName,Object.keys(X).forEach(e=>delete X[e]);const a=b.getParametersForModel(e.provider,e.modelId);Object.entries(a).forEach(([e,a])=>{void 0!==a.default&&(X[e]=a.default)})}}(a)},[d("div",N,[d("div",U,r(a.displayName),1)]),d("div",I,[d("span",O,r(se(a)),1),ee.value?(n(),o(x,{key:0,model:a,design:e.design,"total-calls":"trial"===e.mode?le.value:1,layout:"compact",class:"environmental-costs-inline"},null,8,["model","design","total-calls"])):c("",!0)])],10,F))),128))])]),_:2},1024))),128))]),_:1},8,["activeKey"])])]),Q.value?(n(),u("div",A,[d("div",B,[d("h3",null,r("trial"===e.mode?"Configure":"Selected")+": "+r(Q.value.displayName),1),d("div",G,[d("span",null,[y(r(te.value)+": ",1),d("strong",K,r(ie()),1)]),"trial"===e.mode&&le.value>1?(n(),u("span",L,"("+r(le.value)+" calls)",1)):c("",!0),ee.value&&Q.value?(n(),o(x,{key:1,model:Q.value,design:e.design,"total-calls":"trial"===e.mode?le.value:void 0,layout:"compact",class:"environmental-costs-inline"},null,8,["model","design","total-calls"])):c("",!0)])]),"trial"===e.mode?(n(),u("div",q,[v(ue,{layout:"vertical"},{default:s(()=>[v(_,{label:"Configuration Name",required:""},{default:s(()=>[v(C,{value:R.value,"onUpdate:value":a[2]||(a[2]=e=>R.value=e),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1}),v(h,{"default-active-key":["basic"],ghost:""},{default:s(()=>[v(k,{key:"basic",header:"Basic Parameters"},{default:s(()=>[v(re,{gutter:16},{default:s(()=>[(n(!0),u(m,null,p(oe.value,(e,a)=>(n(),o(Z,{key:a,span:12},{default:s(()=>[v(_,{label:e.label||a},{default:s(()=>["number"===e.type?(n(),o(Y,{key:0,value:X[a],"onUpdate:value":e=>X[a]=e,min:e.min,max:e.max,step:e.step,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","step","placeholder"])):(n(),o(C,{key:1,value:X[a],"onUpdate:value":e=>X[a]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),d("div",D,r(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})])):c("",!0),d("div",V,["trial"===e.mode?(n(),o(t,{key:0,type:"primary",size:"large",onClick:ne,disabled:!R.value||!Q.value},{default:s(()=>a[5]||(a[5]=[y(" Add Configuration ")])),_:1,__:[5]},8,["disabled"])):(n(),o(t,{key:1,type:"primary",size:"large",onClick:de,disabled:!Q.value},{default:s(()=>a[6]||(a[6]=[y(" Select Model ")])),_:1,__:[6]},8,["disabled"]))])])):c("",!0)])]),_:1},8,["open"])}}}),[["__scopeId","data-v-683632b6"]]);export{W as G};
