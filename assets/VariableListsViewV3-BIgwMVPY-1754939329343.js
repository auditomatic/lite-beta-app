import{i as te,j as v,m as d,b as t,v as n,t as s,k as o,z as m,y,F as ee,x as c,A as fe,q as G,D as w,J as oe,K as ye,R as ie,L as ge,_ as ae,r as T,c as E,w as be,B as f,u as ke,n as he,a as ne,P as we,V as xe,M as Ce,N as Ve}from"./index-DpVkXPX--1754939329343.js";import{a as Le}from"./useV4VariableLists-CP_2jk0g-1754939329343.js";import{u as re,a as $e}from"./useV4VariableListCommands-iMiBQPfK-1754939329343.js";import{E as De}from"./ExportOutlined-DrfZGU69-1754939329343.js";import{I as Se,S as Ie}from"./StopOutlined-QZpnu3C4-1754939329343.js";import{U as Ee}from"./UnorderedListOutlined-CFGIAzaS-1754939329343.js";import"./useV4LiveQuery-CNawwkyL-1754939329343.js";const Te={class:"variable-lists-table"},Fe={class:"name-cell"},Ue={class:"list-name"},Ne={key:0,class:"list-description"},Oe={class:"items-cell"},Re={class:"item-count"},Me={class:"item-type"},ze={key:0,class:"attribute-keys"},Be={key:0,class:"more-attributes"},Ke={key:2,class:"created-cell"},je={class:"created-date"},Ae={class:"created-time"},Pe={key:3,class:"actions-cell"},qe={class:"empty-state"},Je={class:"empty-title"},Ge={class:"empty-description"},He=te({__name:"VariableListsTableV3",props:{lists:{},loading:{type:Boolean,default:!1},category:{}},emits:["edit","delete","duplicate","export"],setup(H,{emit:U}){const N=H,$=U,B=[{title:"Name",key:"name",dataIndex:"name",width:300,ellipsis:!0},{title:"Items",key:"items",width:200,align:"center"},{title:"Created",key:"created",width:150,align:"center"},{title:"Actions",key:"actions",width:120,align:"center"}];function K(l){switch(l){case"simple":return"blue";case"attributed":return"green";case"refusal":return"orange";case"tabular":return"purple";default:return"default"}}function j(l){switch(l){case"simple":return"Simple";case"attributed":return"Intersectional";case"refusal":return"Refusal";case"tabular":return"Tabular";default:return l}}function _(l){switch(l.category){case"simple":return"values";case"attributed":return"items";case"refusal":return"patterns";case"tabular":return"rows";default:return"items"}}function F(l){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(new Date(l))}function k(l){return new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}).format(new Date(l))}function D(){switch(N.category){case"all":return"No variable lists yet";case"simple":return"No simple lists yet";case"attributed":return"No attributed lists yet";case"refusal":return"No refusal lists yet";default:return"No lists found"}}function A(){switch(N.category){case"all":return"Create your first variable list or import standard lists to get started";case"simple":return"Simple lists contain plain text values for template variables";case"attributed":return"Attributed lists contain values with additional metadata attributes";case"refusal":return"Refusal lists contain patterns to detect when models refuse requests";default:return"Create a new list to get started"}}function r(l,i){switch(l.key){case"duplicate":$("duplicate",i);break;case"export-csv":$("export",i,"csv");break;case"export-json":$("export",i,"json");break;case"delete":$("delete",i);break}}return(l,i)=>{const C=n("a-tag"),S=n("a-button"),g=n("a-menu-item"),O=n("a-menu-divider"),P=n("a-menu"),q=n("a-dropdown"),I=n("a-table");return d(),v("div",Te,[t(I,{dataSource:l.lists,columns:B,loading:l.loading,pagination:!1,scroll:{x:800,y:"calc(100vh - 320px)"},"row-key":"id"},{bodyCell:s(({column:x,record:u})=>[x.key==="name"?(d(),v(ee,{key:0},[o("div",Fe,[o("span",Ue,m(u.name),1),t(C,{color:K(u.category),class:"category-tag"},{default:s(()=>[c(m(j(u.category)),1)]),_:2},1032,["color"])]),u.description?(d(),v("div",Ne,m(u.description),1)):y("",!0)],64)):x.key==="items"?(d(),v(ee,{key:1},[o("div",Oe,[o("span",Re,m(u.itemCount),1),o("span",Me,m(_(u)),1)]),u.category==="attributed"&&u.attributeKeys?(d(),v("div",ze,[(d(!0),v(ee,null,fe(u.attributeKeys.slice(0,3),h=>(d(),G(C,{key:h,size:"small",class:"attribute-key-tag"},{default:s(()=>[c(m(h),1)]),_:2},1024))),128)),u.attributeKeys.length>3?(d(),v("span",Be," +"+m(u.attributeKeys.length-3)+" more ",1)):y("",!0)])):y("",!0)],64)):x.key==="created"?(d(),v("div",Ke,[o("div",je,m(F(u.created)),1),o("div",Ae,m(k(u.created)),1)])):x.key==="actions"?(d(),v("div",Pe,[t(S,{type:"text",size:"small",onClick:h=>l.$emit("edit",u),"data-testid":"btn-edit-list"},{default:s(()=>i[0]||(i[0]=[c(" Edit ")])),_:2,__:[0]},1032,["onClick"]),t(q,{trigger:["click"]},{overlay:s(()=>[t(P,{onClick:h=>r(h,u)},{default:s(()=>[t(g,{key:"duplicate"},{default:s(()=>[t(w(ye)),i[2]||(i[2]=c(" Duplicate "))]),_:1,__:[2]}),t(g,{key:"export-csv"},{default:s(()=>[t(w(De)),i[3]||(i[3]=c(" Export CSV "))]),_:1,__:[3]}),t(g,{key:"export-json"},{default:s(()=>[t(w(ie)),i[4]||(i[4]=c(" Export JSON "))]),_:1,__:[4]}),t(O),t(g,{key:"delete",danger:""},{default:s(()=>[t(w(ge)),i[5]||(i[5]=c(" Delete "))]),_:1,__:[5]})]),_:2},1032,["onClick"])]),default:s(()=>[t(S,{type:"text",size:"small"},{default:s(()=>[i[1]||(i[1]=c(" More ")),t(w(oe))]),_:1,__:[1]})]),_:2},1024)])):y("",!0)]),emptyText:s(()=>[o("div",qe,[i[6]||(i[6]=o("div",{class:"empty-icon"},"ðŸ“‹",-1)),o("div",Je,m(D()),1),o("div",Ge,m(A()),1)])]),_:1},8,["dataSource","loading"])])}}}),Q=ae(He,[["__scopeId","data-v-67afb7db"]]),Xe={class:"import-modal"},Qe={key:0,class:"step-content"},We={class:"import-methods"},Ye={class:"paste-section"},Ze={key:0,class:"data-info"},et={class:"upload-section"},tt={class:"ant-upload-drag-icon"},at={key:0,class:"file-info"},st={key:1,class:"step-content"},lt={class:"config-section"},nt={key:0,class:"format-info"},ot={key:2,class:"step-content"},it={class:"preview-section"},rt={class:"preview-header"},ut={class:"preview-stats"},dt={key:0},ct={class:"preview-table"},pt={class:"modal-actions"},mt=te({__name:"ImportModalV3",props:{open:{type:Boolean}},emits:["update:open","imported"],setup(H,{emit:U}){const N=H,$=U,{importFromCSV:B,isExecuting:K}=re(),{validateCSV:j}=$e(),_=T(0),F=T("paste"),k=T(""),D=T(null),A=E(()=>K.value),r=T({name:"",description:"",category:"simple"}),l=E(()=>{const a=k.value.trim();if(!a)return null;const e=j(a,r.value.category);return e.valid?e.preview:null}),i=E(()=>{if(!l.value||l.value.rows.length===0)return null;const{headers:a,rows:e}=l.value;return a.length>1?{type:"success",message:`Detected attributed list format with ${a.length} columns: ${a.join(", ")}`}:a.length===1?{type:"info",message:`Detected simple list format with ${e.length} values`}:{type:"warning",message:"Unable to detect format - please check your data"}}),C=E(()=>l.value?r.value.category==="attributed"?l.value.rows.map((a,e)=>({key:e,...a})):l.value.rows.map((a,e)=>({key:e,value:a[l.value.headers[0]]||""})):[]),S=E(()=>l.value?r.value.category==="attributed"?l.value.headers.map(a=>({title:a,dataIndex:a,key:a,ellipsis:!0})):[{title:"Value",dataIndex:"value",key:"value",ellipsis:!0}]:[]),g=E(()=>{var a;switch(_.value){case 0:return k.value.trim().length>0&&((a=l.value)==null?void 0:a.rows.length)>0;case 1:return r.value.name.trim().length>0&&r.value.category;case 2:return C.value.length>0;default:return!1}});function O(){l.value&&l.value.headers.length>1&&(r.value.category="attributed")}function P(a){D.value=a;const e=new FileReader;return e.onload=p=>{var b;k.value=(b=p.target)==null?void 0:b.result,F.value="upload",O()},e.readAsText(a),!1}function q(){}function I(a){if(a===0)return"0 Bytes";const e=1024,p=["Bytes","KB","MB"],b=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,b)).toFixed(2))+" "+p[b]}function x(){g.value&&_.value<2&&_.value++}function u(){_.value>0&&_.value--}async function h(){if(!g.value)return;const a=await B(k.value,r.value.name,r.value.category,r.value.description);if(!a.ok){f.error(`Import failed: ${a.error.message}`);return}f.success("Variable list imported successfully"),$("imported"),J()}function J(){$("update:open",!1)}return be(()=>N.open,a=>{a&&(_.value=0,k.value="",D.value=null,r.value={name:"",description:"",category:"simple"})}),(a,e)=>{const p=n("a-step"),b=n("a-steps"),R=n("a-textarea"),V=n("a-tab-pane"),M=n("a-upload-dragger"),W=n("a-tabs"),z=n("a-input"),Y=n("a-form-item"),se=n("a-col"),Z=n("a-select-option"),ue=n("a-select"),de=n("a-row"),ce=n("a-form"),pe=n("a-alert"),me=n("a-table"),X=n("a-button"),_e=n("a-modal");return d(),G(_e,{open:a.open,title:"Import Variable List",width:"800px",footer:null,onCancel:J,"destroy-on-close":!0},{default:s(()=>{var le;return[o("div",Xe,[t(b,{current:_.value,class:"import-steps"},{default:s(()=>[t(p,{title:"Import Data"}),t(p,{title:"Configure"}),t(p,{title:"Preview"})]),_:1},8,["current"]),_.value===0?(d(),v("div",Qe,[o("div",We,[t(W,{activeKey:F.value,"onUpdate:activeKey":e[1]||(e[1]=L=>F.value=L)},{default:s(()=>[t(V,{key:"paste",tab:"Paste Data"},{default:s(()=>{var L;return[o("div",Ye,[t(R,{value:k.value,"onUpdate:value":e[0]||(e[0]=ve=>k.value=ve),placeholder:`Paste your CSV data here...

Example for simple list:
red
blue
green

Example for attributed list:
name,gender,ethnicity
John Smith,Male,European
Maria Garcia,Female,Hispanic`,rows:12,size:"large",onChange:O},null,8,["value"]),k.value.trim()?(d(),v("div",Ze,m(((L=l.value)==null?void 0:L.rows.length)||0)+" rows detected ",1)):y("",!0)])]}),_:1}),t(V,{key:"upload",tab:"Upload File"},{default:s(()=>[o("div",et,[t(M,{"before-upload":P,"show-upload-list":!1,accept:".csv,.txt"},{default:s(()=>[o("p",tt,[t(w(Se))]),e[5]||(e[5]=o("p",{class:"ant-upload-text"},"Click or drag file to upload",-1)),e[6]||(e[6]=o("p",{class:"ant-upload-hint"},"Supports CSV and TXT files",-1))]),_:1,__:[5,6]}),D.value?(d(),v("div",at,[t(w(ie)),c(" "+m(D.value.name)+" ("+m(I(D.value.size))+") ",1)])):y("",!0)])]),_:1})]),_:1},8,["activeKey"])])])):y("",!0),_.value===1?(d(),v("div",st,[o("div",lt,[t(ce,{model:r.value,layout:"vertical"},{default:s(()=>[t(de,{gutter:16},{default:s(()=>[t(se,{span:12},{default:s(()=>[t(Y,{label:"List Name",required:""},{default:s(()=>[t(z,{value:r.value.name,"onUpdate:value":e[2]||(e[2]=L=>r.value.name=L),placeholder:"Enter list name",size:"large"},null,8,["value"])]),_:1})]),_:1}),t(se,{span:12},{default:s(()=>[t(Y,{label:"List Type",required:""},{default:s(()=>[t(ue,{value:r.value.category,"onUpdate:value":e[3]||(e[3]=L=>r.value.category=L),size:"large",onChange:q},{default:s(()=>[t(Z,{value:"simple"},{default:s(()=>e[7]||(e[7]=[c("Simple List")])),_:1,__:[7]}),t(Z,{value:"attributed"},{default:s(()=>e[8]||(e[8]=[c("Attributed List")])),_:1,__:[8]}),t(Z,{value:"refusal"},{default:s(()=>e[9]||(e[9]=[c("Refusal List")])),_:1,__:[9]})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(Y,{label:"Description (Optional)"},{default:s(()=>[t(z,{value:r.value.description,"onUpdate:value":e[4]||(e[4]=L=>r.value.description=L),placeholder:"Optional description",size:"large"},null,8,["value"])]),_:1})]),_:1},8,["model"]),i.value?(d(),v("div",nt,[t(pe,{type:i.value.type,"show-icon":""},{message:s(()=>[c(m(i.value.message),1)]),_:1},8,["type"])])):y("",!0)])])):y("",!0),_.value===2?(d(),v("div",ot,[o("div",it,[o("div",rt,[o("h4",null,"Preview ("+m(C.value.length)+" items)",1),o("div",ut,[o("span",null,m(r.value.category)+" list",1),r.value.category==="attributed"&&((le=l.value)!=null&&le.headers)?(d(),v("span",dt,m(l.value.headers.length)+" columns ",1)):y("",!0)])]),o("div",ct,[t(me,{dataSource:C.value,columns:S.value,pagination:{pageSize:10},size:"small",scroll:{x:600}},null,8,["dataSource","columns"])])])])):y("",!0),o("div",pt,[t(X,{onClick:J},{default:s(()=>e[10]||(e[10]=[c(" Cancel ")])),_:1,__:[10]}),_.value>0?(d(),G(X,{key:0,onClick:u},{default:s(()=>e[11]||(e[11]=[c(" Previous ")])),_:1,__:[11]})):y("",!0),_.value<2?(d(),G(X,{key:1,type:"primary",onClick:x,disabled:!g.value},{default:s(()=>e[12]||(e[12]=[c(" Next ")])),_:1,__:[12]},8,["disabled"])):y("",!0),_.value===2?(d(),G(X,{key:2,type:"primary",onClick:h,loading:A.value},{default:s(()=>e[13]||(e[13]=[c(" Import List ")])),_:1,__:[13]},8,["loading"])):y("",!0)])])]}),_:1},8,["open"])}}}),_t=ae(mt,[["__scopeId","data-v-b3a8719d"]]),vt={class:"variable-lists-view"},ft={class:"view-header"},yt={class:"header-actions"},gt=te({__name:"VariableListsViewV3",setup(H){const U=Ce(),{variableLists:N,simpleLists:$,attributedLists:B,refusalLists:K,loading:j}=Le(),{deleteVariableList:_,duplicateVariableList:F,exportToCSV:k,exportToJSON:D,isExecuting:A}=re(),r=ke(),l=T("all"),i=T(!1),C=T(!1),S=E(()=>j.value||A.value),g=E(()=>{switch(l.value){case"all":return N.value;case"simple":return $.value;case"attributed":return B.value;case"refusal":return K.value;default:return[]}});function O(a){l.value=a}async function P(){try{i.value=!0;const a=await r.defaultData.checkDefaultsNeeded();if(!a.ok){f.error("Failed to check default data status");return}if(!a.value){f.info("Standard lists are already imported");return}const e=await r.defaultData.importDefaults();if(!e.ok){const p=e;f.error(`Failed to import defaults: ${p.error.message}`);return}f.success(`Imported ${e.value.lists} variable lists and ${e.value.templates} templates`)}catch(a){ne.error("Error importing defaults:",a),f.error("An unexpected error occurred while importing defaults")}finally{i.value=!1}}function q({key:a}){U.push(`/variables/new?category=${a}`)}function I(a){U.push(`/variables/${a.id}/edit`)}async function x(a){Ve.confirm({title:"Delete Variable List",content:`Are you sure you want to delete "${a.name}"? This action cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{const e=await _(a.id);if(!e.ok){f.error(`Failed to delete list: ${e.error.message}`);return}f.success("Variable list deleted successfully")}})}async function u(a){const e=await F(a.id);if(!e.ok){f.error(`Failed to duplicate list: ${e.error.message}`);return}f.success("Variable list duplicated successfully")}async function h(a,e){let p;if(e==="csv"?p=await k(a.id):p=await D(a.id),!p.ok){f.error(`Failed to export list: ${p.error.message}`);return}const b=new Blob([p.value],{type:e==="csv"?"text/csv":"application/json"}),R=URL.createObjectURL(b),V=document.createElement("a");V.href=R,V.download=`${a.name}.${e}`,document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(R),f.success(`List exported as ${e.toUpperCase()}`)}function J(){C.value=!1,f.success("Import completed successfully")}return he(()=>{ne.info("VariableListsViewV3 mounted with V4 real-time queries")}),(a,e)=>{const p=n("a-button"),b=n("a-menu-item"),R=n("a-menu"),V=n("a-dropdown"),M=n("a-tab-pane"),W=n("a-tabs");return d(),v("div",vt,[o("div",ft,[e[7]||(e[7]=o("h1",null,"Variable Lists",-1)),o("div",yt,[t(p,{onClick:P,loading:i.value,"data-testid":"btn-import-defaults"},{default:s(()=>e[2]||(e[2]=[c(" Import Standard Lists ")])),_:1,__:[2]},8,["loading"]),t(V,{placement:"bottomRight"},{overlay:s(()=>[t(R,{onClick:q},{default:s(()=>[t(b,{key:"simple"},{icon:s(()=>[t(w(Ee))]),default:s(()=>[e[4]||(e[4]=c(" Simple List "))]),_:1,__:[4]}),t(b,{key:"attributed"},{icon:s(()=>[t(w(xe))]),default:s(()=>[e[5]||(e[5]=c(" Intersectional List "))]),_:1,__:[5]}),t(b,{key:"refusal"},{icon:s(()=>[t(w(Ie))]),default:s(()=>[e[6]||(e[6]=c(" Refusal List "))]),_:1,__:[6]})]),_:1})]),default:s(()=>[t(p,{type:"primary","data-testid":"btn-create-new"},{icon:s(()=>[t(w(we))]),default:s(()=>[e[3]||(e[3]=c(" Create New ")),t(w(oe))]),_:1,__:[3]})]),_:1})])]),t(W,{activeKey:l.value,"onUpdate:activeKey":e[0]||(e[0]=z=>l.value=z),class:"lists-tabs",onChange:O},{default:s(()=>[t(M,{key:"all",tab:"All Lists"},{default:s(()=>[t(Q,{lists:g.value,loading:S.value,category:"all",onEdit:I,onDelete:x,onDuplicate:u,onExport:h},null,8,["lists","loading"])]),_:1}),t(M,{key:"simple",tab:"Simple Lists"},{default:s(()=>[t(Q,{lists:g.value,loading:S.value,category:"simple",onEdit:I,onDelete:x,onDuplicate:u,onExport:h},null,8,["lists","loading"])]),_:1}),t(M,{key:"attributed",tab:"Intersectional Lists"},{default:s(()=>[t(Q,{lists:g.value,loading:S.value,category:"attributed",onEdit:I,onDelete:x,onDuplicate:u,onExport:h},null,8,["lists","loading"])]),_:1}),t(M,{key:"refusal",tab:"Refusal Lists"},{default:s(()=>[t(Q,{lists:g.value,loading:S.value,category:"refusal",onEdit:I,onDelete:x,onDuplicate:u,onExport:h},null,8,["lists","loading"])]),_:1})]),_:1},8,["activeKey"]),t(_t,{open:C.value,"onUpdate:open":e[1]||(e[1]=z=>C.value=z),onImported:J},null,8,["open"])])}}}),Lt=ae(gt,[["__scopeId","data-v-f195479c"]]);export{Lt as default};
