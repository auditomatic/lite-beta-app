import{i as Q,c as z,j as C,m as s,k as a,b as P,v as T,_ as H,u as ge,aa as de,F as x,y as w,x as E,z as h,r as L,q as _,t as m,A as K,ah as _e,D as N,ak as he,a4 as ue,w as Y,n as re,al as Ce,a as $,am as ke,U as Me,M as ye}from"./index-CL-lquVN.js";import{u as be}from"./useV4Models-D0fp-NVp.js";import{u as ce}from"./useV4ProviderParameters-DZpEmQaT.js";import{I as Pe}from"./InboxOutlined-nr8xdpiD.js";const $e={class:"model-search-filters"},Te={class:"panel-header"},we={class:"search-container"},Ae=Q({__name:"ModelSearchFiltersV3",props:{modelValue:{}},emits:["update:modelValue"],setup(R,{emit:v}){const n=R,A=v,M=z({get:()=>n.modelValue,set:D=>A("update:modelValue",D)});return(D,U)=>{const F=T("a-input-search");return s(),C("div",$e,[a("div",Te,[U[2]||(U[2]=a("h3",null,"Available Models",-1)),a("div",we,[U[1]||(U[1]=a("span",{class:"search-label"},"Search:",-1)),P(F,{value:M.value,"onUpdate:value":U[0]||(U[0]=p=>M.value=p),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])])])}}}),Ue=H(Ae,[["__scopeId","data-v-56bdd915"]]),qe={key:0,class:"cost-group"},Oe={class:"cost-item"},Ee={class:"cost-value"},De={class:"cost-value"},Fe={key:1,class:"cost-group"},Ie={class:"enviro-group"},Be={class:"enviro-item"},Ve={class:"enviro-item"},Ge={class:"enviro-item"},Se={key:0,class:"cost-group"},ze={class:"cost-item"},xe={class:"cost-value"},Re={class:"cost-value"},Ne={class:"enviro-group"},Ke={class:"enviro-item"},Le={class:"enviro-item"},je={class:"enviro-item"},Je={key:0,class:"cost-item financial"},Qe={key:0,class:"cost-value"},He={key:1,class:"cost-value"},Ye={class:"cost-item environmental"},Ze={class:"enviro-item"},We={class:"enviro-value"},Xe={class:"enviro-item"},et={class:"enviro-value"},tt={class:"enviro-item"},ot={class:"enviro-value"},lt={key:0,class:"cost-unit"},nt=Q({__name:"ModelCostDisplayV3",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(R){const v=R,n=ge();z(()=>n.settings.core.preferences.value);const A=z(()=>!0);function M(){if(!v.model.capabilities)return"â€”";const u=v.model.capabilities.inputCostPerToken||0,d=v.model.capabilities.outputCostPerToken||0;if(v.mode==="per-thousand"){const q=(u+d)*1e3;return D(q)}else if(v.mode==="total"){const q=u*v.inputTokens+d*v.outputTokens;return D(q)}return"â€”"}function D(u){return u===0?"0.00":u<.01?"<0.01":u<1?u.toFixed(2):u<10?u.toFixed(1):Math.round(u).toString()}function U(u){if(u===0)return"0";if(u>=.01)return u.toFixed(2).replace(/\.?0+$/,"");const q=u.toFixed(10).match(/^0\.0*[1-9]/);if(q){const V=q[0].length-2;return u.toFixed(V)}return u.toFixed(4)}function F(){if(!v.model.capabilities)return"0";const u=(v.model.capabilities.inputCostPerToken||0)*1e3;return U(u)}function p(){if(!v.model.capabilities)return"0";const u=(v.model.capabilities.outputCostPerToken||0)*1e3;return U(u)}function g(){if(!v.model.capabilities)return"?";const u=v.model.capabilities.inputCostPerToken||0,d=v.model.capabilities.outputCostPerToken||0,q=u*v.inputTokens+d*v.minOutputTokens;return U(q)}function y(){if(!v.model.capabilities||!v.maxOutputTokens)return"?";const u=v.model.capabilities.inputCostPerToken||0,d=v.model.capabilities.outputCostPerToken||0,q=u*v.inputTokens+d*v.maxOutputTokens;return U(q)}function O(u){return"??"}function I(u){return"??"}return(u,d)=>(s(),C("div",{class:de(["model-cost-display",[`layout-${u.layout}`,`size-${u.size}`]])},[u.mode==="range"?(s(),C(x,{key:0},[A.value&&u.maxOutputTokens?(s(),C("span",qe,[a("span",Oe,[a("span",Ee,"$"+h(g()),1),d[0]||(d[0]=E(" - ")),a("span",De,"$"+h(y()),1)])])):A.value?(s(),C("span",Fe,d[1]||(d[1]=[a("span",{class:"cost-item"},[a("span",{class:"cost-value"},"Cost: ??")],-1)]))):w("",!0),d[4]||(d[4]=a("span",{class:"cost-tab"},null,-1)),a("span",Ie,[a("span",Be,"COâ‚‚ "+h(I()),1),d[2]||(d[2]=a("span",{class:"cost-tab"},null,-1)),a("span",Ve,"ðŸ’§"+h(I()),1),d[3]||(d[3]=a("span",{class:"cost-tab"},null,-1)),a("span",Ge,"âš¡"+h(I()),1)])],64)):u.mode==="input-output"?(s(),C(x,{key:1},[A.value?(s(),C("span",Se,[a("span",ze,[a("span",xe,"$"+h(F()),1),d[5]||(d[5]=E("/1K input + ")),a("span",Re,"$"+h(p()),1),d[6]||(d[6]=E("/1K output "))])])):w("",!0),d[9]||(d[9]=a("span",{class:"cost-tab"},null,-1)),a("span",Ne,[a("span",Ke,"COâ‚‚ "+h(O()),1),d[7]||(d[7]=a("span",{class:"cost-tab"},null,-1)),a("span",Le,"ðŸ’§"+h(O()),1),d[8]||(d[8]=a("span",{class:"cost-tab"},null,-1)),a("span",je,"âš¡"+h(O()),1)])],64)):(s(),C(x,{key:2},[A.value?(s(),C("div",Je,[u.mode==="per-thousand"?(s(),C("span",Qe,[E(h(M())+" ",1),d[10]||(d[10]=a("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):u.mode==="total"?(s(),C("span",He,h(M()),1)):w("",!0)])):w("",!0),a("div",Ye,[a("span",Ze,[d[11]||(d[11]=a("span",{class:"enviro-icon"},"COâ‚‚",-1)),a("span",We,h(O()),1)]),a("span",Xe,[d[12]||(d[12]=a("span",{class:"enviro-icon"},"ðŸ’§",-1)),a("span",et,h(O()),1)]),a("span",tt,[d[13]||(d[13]=a("span",{class:"enviro-icon"},"âš¡",-1)),a("span",ot,h(O()),1)]),u.mode==="per-thousand"?(s(),C("span",lt,"/ 1,000")):w("",!0)])],64))],2))}}),pe=H(nt,[["__scopeId","data-v-9917b0aa"]]),st={class:"provider-header"},at={class:"provider-name"},it={class:"provider-model-count"},ut={key:0,class:"api-key-warning"},dt={class:"provider-models"},rt=["onClick"],ct={class:"model-name"},pt={key:0,class:"model-specs"},ft=Q({__name:"ModelProviderGroupV3",props:{groupedModels:{},selectedModelId:{},mode:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function},hasConfigPanel:{type:Boolean},requiresApiKey:{type:Function},getProviderGroup:{type:Function},hasApiKey:{type:Function}},emits:["select-model"],setup(R){const v=L(void 0);function n(M){return M}function A(M){v.value===M?v.value=void 0:v.value=M}return(M,D)=>{const U=T("a-button"),F=T("a-collapse-panel"),p=T("a-collapse");return s(),_(p,{activeKey:v.value,"onUpdate:activeKey":D[0]||(D[0]=g=>v.value=g),bordered:!1,accordion:""},{default:m(()=>[(s(!0),C(x,null,K(M.groupedModels,(g,y)=>(s(),_(F,{key:y,class:"provider-panel","data-provider":y},{header:m(()=>[a("div",st,[a("span",at,h(y),1),a("span",it,h(g.length)+" models",1),M.requiresApiKey(y)&&!M.hasApiKey(M.getProviderGroup(y))?(s(),C("div",ut,[P(N(he)),D[1]||(D[1]=a("span",null,"API Key Missing",-1))])):w("",!0)])]),extra:m(()=>[P(U,{size:"small",type:"text",onClick:_e(O=>A(y),["stop"])},{default:m(()=>[E(h(v.value===y?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:m(()=>[a("div",dt,[(s(!0),C(x,null,K(g,O=>(s(),C("div",{key:O.id,class:de(["model-row",{selected:M.selectedModelId===O.id}]),onClick:I=>M.$emit("select-model",O)},[a("div",ct,h(O.displayName),1),M.hasConfigPanel?w("",!0):(s(),C("div",pt,[P(pe,{model:O,mode:M.mode==="trial"?"range":"input-output","input-tokens":M.getInputTokensForModel(O),"min-output-tokens":10,"max-output-tokens":M.getOutputTokensForModel(O),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])]))],10,rt))),128))])]),_:2},1032,["data-provider"]))),128))]),_:1},8,["activeKey"])}}}),mt=H(ft,[["__scopeId","data-v-984223df"]]),vt={class:"config-panel"},gt={class:"config-header"},_t={class:"config-header-title"},ht={key:0,class:"total-cost"},Ct={key:0,class:"cost-info"},kt={class:"config-content"},Mt={class:"param-description"},yt={class:"param-description"},bt={key:0,class:"config-footer"},Pt={key:0,class:"duplicate-error"},$t=Q({__name:"ModelConfigurationPanelV3",props:{selectedModel:{},mode:{},totalCalls:{default:1},costEstimate:{},getInputTokensForModel:{},getOutputTokensForModel:{},existingConfigurations:{},showCloseButton:{type:Boolean,default:!0},initialParameters:{}},emits:["close","add-configuration","confirm-selection","parameters-changed"],setup(R,{emit:v}){const n=R,A=v,{getBasicParameters:M,getAdvancedParameters:D,getParametersForModel:U}=ce(),F=L(""),p=ue({}),g=ue({}),y=L(""),O=z(()=>n.selectedModel?M(n.selectedModel.provider,n.selectedModel.modelId):{}),I=z(()=>n.selectedModel?D(n.selectedModel.provider,n.selectedModel.modelId):{});function u(l){if(!l)return;$.info("PARAMDEBUG: setModelDefaults called for",l.provider,l.modelId,"mode:",n.mode),n.mode==="trial"&&(F.value=l.displayName),Object.keys(p).forEach(t=>delete p[t]),Object.keys(g).forEach(t=>delete g[t]);const e=U(l.provider,l.modelId);if(n.initialParameters&&Object.keys(n.initialParameters).length>0){$.info("PARAMDEBUG: using initial parameters:",n.initialParameters),Object.assign(p,n.initialParameters);for(const[t,o]of Object.entries(n.initialParameters)){const f=e[t];o===(f==null?void 0:f.default)?g[t]={mode:"default"}:g[t]={mode:"custom",value:o}}}else{$.info("PARAMDEBUG: allParams found:",Object.keys(e));for(const[t,o]of Object.entries(e))o.required?o.default!==void 0?(g[t]={mode:"default"},p[t]=o.default,$.info("PARAMDEBUG: setting required param",t,"to default =",o.default)):(g[t]={mode:"custom",value:null},p[t]=null,$.info("PARAMDEBUG: required param",t,"needs user input")):o.default!==void 0?(g[t]={mode:"default"},p[t]=o.default,$.info("PARAMDEBUG: setting optional param",t,"to default =",o.default)):(g[t]={mode:"unset"},p[t]=null,$.info("PARAMDEBUG: optional param",t,"starts unset"));$.info("PARAMDEBUG: final parameters:",{...p}),$.info("PARAMDEBUG: parameter states:",{...g})}}Y(()=>n.selectedModel,l=>{u(l),y.value=""},{immediate:!0}),Y(p,()=>{y.value=""},{deep:!0}),re(()=>{n.selectedModel&&u(n.selectedModel)});function d(l,e){const t=g[l],o=p[l];return $.info("PLACEHOLDER DEBUG:",l,"state:",t==null?void 0:t.mode,"value:",o,"param.default:",e.default),!e.required&&(o==null||o==="")||(t==null?void 0:t.mode)==="unset"?"Not set (parameter will be omitted)":e.default!==void 0?(t==null?void 0:t.mode)==="default"?`Using default: ${e.default}`:`Default: ${e.default} (enter to override)`:e.required?"Required - enter value":"Enter value (optional)"}function q(l){const e=g[l],t=n.selectedModel?U(n.selectedModel.provider,n.selectedModel.modelId)[l]:void 0;if(t!=null&&t.required&&(e==null?void 0:e.mode)==="unset"||t!=null&&t.required&&(e==null?void 0:e.mode)==="custom"&&!e.value)return"error";if((e==null?void 0:e.mode)==="default")return"warning"}function V(l){return l.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function G(l,e,t){$.info("PARAMDEBUG: handleParameterChange",l,"new value:",e,"param.required:",t.required),e==null||e===""?t!=null&&t.required?t.default!==void 0&&(p[l]=t.default,g[l]={mode:"default"},$.info("PARAMDEBUG: Required param",l,"cleared, reverting to default:",t.default)):(p[l]=null,g[l]={mode:"unset"},$.info("PARAMDEBUG: Optional param",l,"cleared, setting to unset")):(p[l]=e,e===(t==null?void 0:t.default)?g[l]={mode:"default"}:g[l]={mode:"custom",value:e}),(n.mode==="playground"||n.mode==="standalone")&&A("parameters-changed",{...p})}function Z(){const l=[],e=n.selectedModel?U(n.selectedModel.provider,n.selectedModel.modelId):{};for(const[t,o]of Object.entries(g)){const f=e[t];f!=null&&f.required&&(o.mode==="unset"?l.push(`${V(t)} is required`):o.mode==="custom"&&(o.value===null||o.value===void 0||o.value==="")&&l.push(`${V(t)} needs a value`)),o.mode==="custom"&&o.value!==void 0&&o.value!==null&&((f==null?void 0:f.min)!==void 0&&o.value<f.min&&l.push(`${V(t)} must be >= ${f.min}`),(f==null?void 0:f.max)!==void 0&&o.value>f.max&&l.push(`${V(t)} must be <= ${f.max}`))}return{valid:l.length===0,errors:l}}function W(){if(!n.selectedModel||n.mode==="trial"&&!F.value)return null;const l={},e=U(n.selectedModel.provider,n.selectedModel.modelId),t=(o,f,b)=>{const k=f.split(".");let S=o;for(let B=0;B<k.length-1;B++)S[k[B]]||(S[k[B]]={}),S=S[k[B]];S[k[k.length-1]]=b};for(const[o,f]of Object.entries(g)){const b=e[o];let k;switch(f.mode){case"default":k=b==null?void 0:b.default,$.info("PARAMDEBUG: Using default for",o,"=",k);break;case"custom":k=f.value,$.info("PARAMDEBUG: Using custom value for",o,"=",k);break;case"unset":$.info("PARAMDEBUG: Skipping unset param",o);continue}k!=null&&k!==""?t(l,o,k):k===!1?t(l,o,!1):b!=null&&b.required&&$.error(`Required parameter ${o} has no valid value`)}return{name:n.mode==="trial"?F.value:n.selectedModel.displayName,provider:n.selectedModel.provider,modelId:n.selectedModel.modelId,parameters:l}}function X(){y.value="";const l=Z();if(!l.valid){y.value=`Invalid configuration: ${l.errors.join(", ")}`;return}const e=W();if(e){if(n.existingConfigurations&&n.existingConfigurations.some(o=>o.provider===e.provider&&o.modelId===e.modelId&&JSON.stringify(o.parameters)===JSON.stringify(e.parameters))){y.value=`${e.provider}:${e.modelId} with these parameters is already added. Please modify the parameters or select a different model.`;return}A("add-configuration",e)}}function ee(l){var e;return((e=n.getInputTokensForModel)==null?void 0:e.call(n,l))||1e3}function j(l){var e;return((e=n.getOutputTokensForModel)==null?void 0:e.call(n,l))||1e3}return(l,e)=>{var se,ae,ie;const t=T("a-button"),o=T("a-input"),f=T("a-form-item"),b=T("a-tag"),k=T("a-input-number"),S=T("a-switch"),B=T("a-select-option"),te=T("a-select"),oe=T("a-col"),le=T("a-row"),ne=T("a-collapse-panel"),fe=T("a-collapse"),me=T("a-form"),ve=T("a-alert");return s(),C("div",vt,[a("div",gt,[a("div",_t,[a("h3",null,h(l.mode==="trial"?"Configure":"Model Parameters")+": "+h(l.selectedModel.displayName),1),l.showCloseButton?(s(),_(t,{key:0,type:"text",onClick:e[0]||(e[0]=i=>l.$emit("close")),class:"config-close-btn","aria-label":"Close configuration panel"},{default:m(()=>[P(N(Ce))]),_:1})):w("",!0)]),l.mode==="trial"?(s(),C("div",ht,[P(pe,{model:l.selectedModel,mode:"total","input-tokens":((ae=(se=l.costEstimate)==null?void 0:se.inputTokens)==null?void 0:ae.avgTokens)||ee(l.selectedModel),"output-tokens":((ie=l.costEstimate)==null?void 0:ie.outputTokens)||j(l.selectedModel),layout:"inline",size:"large"},null,8,["model","input-tokens","output-tokens"]),l.totalCalls>1?(s(),C("span",Ct,"("+h(l.totalCalls)+" calls)",1)):w("",!0)])):w("",!0)]),a("div",kt,[P(me,{layout:"vertical"},{default:m(()=>[l.mode==="trial"?(s(),_(f,{key:0,label:"Configuration Name",required:""},{default:m(()=>[P(o,{value:F.value,"onUpdate:value":e[1]||(e[1]=i=>F.value=i),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1})):w("",!0),P(fe,{"default-active-key":["basic"],ghost:""},{default:m(()=>[P(ne,{key:"basic",header:"Basic Parameters"},{default:m(()=>[P(le,{gutter:16},{default:m(()=>[(s(!0),C(x,null,K(O.value,(i,r)=>(s(),_(oe,{key:r,span:l.mode==="playground"?24:12},{default:m(()=>[P(f,null,{label:m(()=>{var c,J;return[a("span",null,h(V(r)),1),i.required?(s(),_(b,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[2]||(e[2]=[E("Required")])),_:1,__:[2]})):((c=g[r])==null?void 0:c.mode)==="default"?(s(),_(b,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[3]||(e[3]=[E("Default")])),_:1,__:[3]})):((J=g[r])==null?void 0:J.mode)==="unset"?(s(),_(b,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[4]||(e[4]=[E("Not Set")])),_:1,__:[4]})):w("",!0)]}),default:m(()=>[i.type==="number"?(s(),_(k,{key:0,value:p[r],"onUpdate:value":c=>p[r]=c,min:i.min,max:i.max,step:.1,placeholder:d(r,i),"allow-clear":!i.required,status:q(r),style:{width:"100%"},size:"large",onChange:c=>G(r,c,i)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):i.type==="integer"?(s(),_(k,{key:1,value:p[r],"onUpdate:value":c=>p[r]=c,min:i.min,max:i.max,placeholder:d(r,i),"allow-clear":!i.required,status:q(r),style:{width:"100%"},size:"large",onChange:c=>G(r,c,i)},null,8,["value","onUpdate:value","min","max","placeholder","allow-clear","status","onChange"])):i.type==="boolean"?(s(),_(S,{key:2,checked:p[r],"onUpdate:checked":c=>p[r]=c,"checked-children":"true","un-checked-children":"false",onChange:G},null,8,["checked","onUpdate:checked"])):i.type==="string"&&i.enum?(s(),_(te,{key:3,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:i.default?`Default: ${i.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!i.required,status:q(r),onChange:G},{default:m(()=>[i.default?(s(),_(B,{key:0,value:i.default},{default:m(()=>[E(h(i.default)+" (default) ",1)]),_:2},1032,["value"])):w("",!0),i.required?w("",!0):(s(),_(B,{key:1,value:void 0},{default:m(()=>e[5]||(e[5]=[a("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[5]})),(s(!0),C(x,null,K(i.enum.filter(c=>c!==i.default),c=>(s(),_(B,{key:c,value:c},{default:m(()=>[E(h(c),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(s(),_(o,{key:4,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:d(r,i),"allow-clear":!i.required,status:q(r),size:"large",onChange:G},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),a("div",Mt,h(i.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1}),Object.keys(I.value).length>0?(s(),_(ne,{key:"advanced",header:"Advanced Parameters"},{default:m(()=>[P(le,{gutter:16},{default:m(()=>[(s(!0),C(x,null,K(I.value,(i,r)=>(s(),_(oe,{key:r,span:l.mode==="playground"?24:12},{default:m(()=>[P(f,null,{label:m(()=>{var c,J;return[a("span",null,h(V(r)),1),i.required?(s(),_(b,{key:0,color:"red",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[6]||(e[6]=[E("Required")])),_:1,__:[6]})):((c=g[r])==null?void 0:c.mode)==="default"?(s(),_(b,{key:1,color:"blue",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[7]||(e[7]=[E("Default")])),_:1,__:[7]})):((J=g[r])==null?void 0:J.mode)==="unset"?(s(),_(b,{key:2,color:"gray",size:"small",style:{"margin-left":"8px"}},{default:m(()=>e[8]||(e[8]=[E("Not Set")])),_:1,__:[8]})):w("",!0)]}),default:m(()=>[i.type==="number"||i.type==="integer"?(s(),_(k,{key:0,value:p[r],"onUpdate:value":c=>p[r]=c,min:i.min,max:i.max,step:i.type==="number"?.1:1,placeholder:d(r,i),"allow-clear":!i.required,status:q(r),style:{width:"100%"},size:"large",onChange:c=>G(r,c,i)},null,8,["value","onUpdate:value","min","max","step","placeholder","allow-clear","status","onChange"])):i.type==="boolean"?(s(),_(S,{key:1,checked:p[r],"onUpdate:checked":c=>p[r]=c,"checked-children":"true","un-checked-children":"false",onChange:G},null,8,["checked","onUpdate:checked"])):i.type==="string"&&i.enum?(s(),_(te,{key:2,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:i.default?`Default: ${i.default}`:"Select value",size:"large",style:{width:"100%"},"allow-clear":!i.required,status:q(r),onChange:G},{default:m(()=>[i.default?(s(),_(B,{key:0,value:i.default},{default:m(()=>[E(h(i.default)+" (default) ",1)]),_:2},1032,["value"])):w("",!0),i.required?w("",!0):(s(),_(B,{key:1,value:void 0},{default:m(()=>e[9]||(e[9]=[a("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[9]})),(s(!0),C(x,null,K(i.enum.filter(c=>c!==i.default),c=>(s(),_(B,{key:c,value:c},{default:m(()=>[E(h(c),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder","allow-clear","status"])):(s(),_(o,{key:3,value:p[r],"onUpdate:value":c=>p[r]=c,placeholder:d(r,i),"allow-clear":!i.required,status:q(r),size:"large",onChange:G},null,8,["value","onUpdate:value","placeholder","allow-clear","status"])),a("div",yt,h(i.description),1)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1})]),l.mode==="trial"?(s(),C("div",bt,[y.value?(s(),C("div",Pt,[P(ve,{message:y.value,type:"error",showIcon:"",style:{marginBottom:"10px"}},null,8,["message"])])):w("",!0),P(t,{type:"primary",size:"large",onClick:X,disabled:!F.value||!l.selectedModel},{default:m(()=>e[10]||(e[10]=[E(" Add Model Configuration to Trial ")])),_:1,__:[10]},8,["disabled"])])):w("",!0)])}}}),Tt=H($t,[["__scopeId","data-v-e7d687ef"]]),wt={class:"modal-content-wrapper"},At={key:0,class:"loading-container"},Ut={key:1,class:"no-models-container"},qt={class:"no-models-content"},Ot={key:2,class:"modal-content"},Et={class:"models-panel"},Dt={class:"models-list"},Ft=Q({__name:"GenericModelSelectorModalV3",props:{visible:{type:Boolean},mode:{default:"single"},trialContext:{},design:{},title:{},existingConfigurations:{},showConfigPanel:{type:Boolean,default:!0}},emits:["update:visible","add-configuration","select-model","confirm"],setup(R,{emit:v}){const n=R,A=v,M=ye(),{enabledModels:D,loading:U}=be(),{requiresApiKey:F,getProviderGroup:p}=ce(),{hasApiKey:g}=ke(),y=z(()=>D.value||[]),O=z(()=>{const e=y.value.length>0;return U.value&&!e}),I=L(""),u=L(null),d=L(null),q=z(()=>{if(!y.value)return{};let e=y.value;if(I.value){const o=I.value.toLowerCase();e=e.filter(f=>f.displayName.toLowerCase().includes(o)||f.modelId.toLowerCase().includes(o))}const t={};for(const o of e)t[o.provider]||(t[o.provider]=[]),t[o.provider].push(o);for(const o in t)t[o].sort((f,b)=>f.displayName.localeCompare(b.displayName));return t}),V=z(()=>{var e;if(n.mode!=="trial")return 1;if(n.trialContext)return n.trialContext.totalCombinations;if(n.design){let t=1;for(const o of Object.values(n.design.variableBindings))o.type==="direct"&&(t*=((e=o.values)==null?void 0:e.length)||1);return t}return 1});Y([u],async()=>{if(!u.value||n.mode!=="trial"){d.value=null;return}if(!n.trialContext&&!n.design){d.value=null;return}try{const e=j(u.value),t=l(u.value),o=u.value.capabilities;if(o!=null&&o.inputCostPerToken&&(o!=null&&o.outputCostPerToken)){const f=e*o.inputCostPerToken/1e3,b=t*o.outputCostPerToken/1e3,k=(f+b)*V.value;d.value={inputTokens:{avgTokens:e},outputTokens:t,totalCost:k,inputCost:f,outputCost:b}}else d.value=null}catch(e){$.error("Failed to calculate cost estimate:",e),d.value=null}});function G(){A("update:visible",!1),M.push("/models")}function Z(e){if(u.value=e,n.mode==="playground"){A("select-model",e),A("update:visible",!1);return}}function W(e){$.info("ðŸŽ¯ GenericModelSelectorModalV3: Emitting add-configuration",{config:e,mode:n.mode}),n.mode==="single"?(A("confirm",{model:u.value,configuration:e}),A("update:visible",!1)):A("add-configuration",e)}function X(e){A("select-model",e),A("update:visible",!1)}function ee(){u.value=null}function j(e){var t;if(n.mode==="trial"){if(n.trialContext)return n.trialContext.avgTokens;if(n.design)return((t=n.design.tokenEstimate)==null?void 0:t.avgTokens)||150}return 1e3}function l(e){var t;return n.mode==="trial"?((t=e.capabilities)==null?void 0:t.maxTokens)||256:1e3}return Y(()=>n.visible,e=>{e&&(u.value=null,I.value="",$.debug("GenericModelSelectorModalV3 opened - reset selection"))}),re(()=>{$.debug("GenericModelSelectorModalV3 mounted",{mode:n.mode,open:n.open})}),(e,t)=>{const o=T("a-spin"),f=T("a-button"),b=T("a-modal");return s(),_(b,{open:e.visible,onCancel:t[1]||(t[1]=k=>e.$emit("update:visible",!1)),title:e.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:m(()=>{var k;return[a("div",wt,[O.value?(s(),C("div",At,[P(o,{size:"large",tip:"Loading models..."})])):y.value.length===0?(s(),C("div",Ut,[a("div",qt,[P(N(Pe),{class:"no-models-icon"}),t[3]||(t[3]=a("h3",null,"No Models Available",-1)),t[4]||(t[4]=a("p",null,"No LLM models are currently enabled. You need to enable at least one model to proceed.",-1)),P(f,{type:"primary",size:"large",onClick:G},{default:m(()=>[P(N(Me)),t[2]||(t[2]=E(" Go to Models View "))]),_:1,__:[2]})])])):(s(),C("div",Ot,[a("div",Et,[P(Ue,{modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=S=>I.value=S)},null,8,["modelValue"]),a("div",Dt,[P(mt,{"grouped-models":q.value,"selected-model-id":(k=u.value)==null?void 0:k.id,mode:e.mode,"get-input-tokens-for-model":j,"get-output-tokens-for-model":l,"has-config-panel":!!u.value,"requires-api-key":N(F),"get-provider-group":N(p),"has-api-key":N(g),onSelectModel:Z},null,8,["grouped-models","selected-model-id","mode","has-config-panel","requires-api-key","get-provider-group","has-api-key"])])]),u.value&&e.mode==="trial"?(s(),_(Tt,{key:0,"selected-model":u.value,mode:e.mode,"total-calls":V.value,"cost-estimate":d.value,"get-input-tokens-for-model":j,"get-output-tokens-for-model":l,"existing-configurations":e.existingConfigurations,onClose:ee,onAddConfiguration:W,onConfirmSelection:X},null,8,["selected-model","mode","total-calls","cost-estimate","existing-configurations"])):w("",!0)]))])]}),_:1},8,["open","title"])}}}),St=H(Ft,[["__scopeId","data-v-e4e05296"]]);export{St as G,pe as M};
