const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-Du1WcLqe.js","./vendor-BsQOyEiA.js","./db-CL8uhZCz.js","./index-CaK6nz9C.css"])))=>i.map(i=>d[i]);
import{H as e,l as a,p as t,_ as s,e as l,a1 as n,r as o,d as r,u as i,a as d,y as u}from"./index-Du1WcLqe.js";import{r as p,C as c}from"./api-key-redactor-BJKacP7f.js";import{f as m,U as v,d as g,r as f,c as y,w as h,aa as k,a0 as b,k as _,Y as x,_ as C,Z as w,$,X as I,F as P,ab as F,G as E,a2 as L,al as A,ae as M,a3 as j,q as O,u as R,A as S,o as D}from"./vendor-BsQOyEiA.js";import{T as z}from"./TemplateEditor-BwteTiHM.js";import{M as N,G as T}from"./GenericModelSelectorModal-B78cM9y6.js";import{t as V}from"./token-calculation.service-Dx9E119Z.js";import"./db-CL8uhZCz.js";import"./cost-formatting-Bv_drrqY.js";import"./variable.service-Dkw70T55.js";const U={class:"parameter-panel"},q={class:"panel-content"},W={key:0,class:"params-section"},H={key:0,class:"reasoning-warning"},B={key:5,class:"param-description"},J={key:4,class:"param-description"},K={key:2,class:"params-section"},G={class:"logprobs-controls"},X={class:"panel-actions"},Y=s(g({__name:"ParameterPanel",props:{model:{},modelValue:{}},emits:["update:modelValue","change"],setup(e,{emit:a}){const s=e,l=a,n=f({}),o=m(!1),r=m(3),i=y(()=>{if(!s.model)return{};const e=t.getParametersForModel(s.model.provider,s.model.modelId),a={},l=(e,t="")=>{Object.entries(e).forEach(([e,s])=>{const n=t?`${t}.${e}`:e;"object"===s.type&&s.properties?l(s.properties,n):a[n]=s})};l(e);const n={};for(const[t,s]of Object.entries(a))s.basic&&(n[t]=s);const o={},r=n.temperature?"temperature":n["options.temperature"]?"options.temperature":null;r&&(o[r]=n[r]);for(const[t,s]of Object.entries(n))t!==r&&(o[t]=s);return o}),d=y(()=>{if(!s.model)return{};const e=t.getParametersForModel(s.model.provider,s.model.modelId),a={},l=(e,t="")=>{Object.entries(e).forEach(([e,s])=>{const n=t?`${t}.${e}`:e;"object"===s.type&&s.properties?l(s.properties,n):a[n]=s})};l(e);const n={};for(const[t,s]of Object.entries(a))s.basic||(n[t]=s);return n}),u=y(()=>!!s.model&&(("openai-chat"===s.model.provider||"openai-responses"===s.model.provider)&&s.model.modelId.match(/^o[0-9]/))),p=y(()=>!!s.model&&t.supportsLogprobs(s.model.provider,s.model.modelId)),c=y(()=>s.model?t.getLogprobsParameters(s.model.provider,s.model.modelId):{}),v=y(()=>!!c.value.topLogprobs);function g(e,a){n[e]=a,l("update:modelValue",{...n}),l("change",{...n})}function A(e){return e.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function M(e){o.value=e,O()}function j(e){r.value=e||3,O()}function O(){const e=c.value;if(Object.keys(n).forEach(e=>{(e.includes("logprobs")||"include"===e)&&delete n[e]}),o.value){if(e.enableParams)for(const a of e.enableParams)if("boolean"===a.type)if(a.name.includes(".")){const e=a.name.split(".");let t=n;for(let a=0;a<e.length-1;a++)t[e[a]]||(t[e[a]]={}),t=t[e[a]];t[e[e.length-1]]=a.value}else n[a.name]=a.value;else"array"===a.type&&(n[a.name]||(n[a.name]=[]),n[a.name].includes(a.value)||n[a.name].push(a.value));if(e.topLogprobs)if(e.topLogprobs.includes(".")){const a=e.topLogprobs.split(".");let t=n;for(let e=0;e<a.length-1;e++)t[a[e]]||(t[a[e]]={}),t=t[a[e]];t[a[a.length-1]]=r.value}else n[e.topLogprobs]=r.value}else if(e.enableParams)for(const a of e.enableParams)"array"===a.type&&n[a.name]&&(n[a.name]=n[a.name].filter(e=>e!==a.value),0===n[a.name].length&&delete n[a.name]);l("update:modelValue",{...n}),l("change",{...n})}function R(){if(!s.model)return;Object.keys(n).forEach(e=>delete n[e]);const e=t.supportsLogprobs(s.model.provider,s.model.modelId);o.value=e,r.value=3;const a=(e,t="")=>{Object.entries(e).forEach(([e,s])=>{const l=t?`${t}.${e}`:e;"object"===s.type&&s.properties?a(s.properties,l):void 0!==s.default&&(n[l]=s.default)})},i=t.getParametersForModel(s.model.provider,s.model.modelId);a(i),e&&O(),l("update:modelValue",{...n}),l("change",{...n})}return h(()=>s.model,e=>{if(e){const a=t.supportsLogprobs(e.provider,e.modelId);o.value=a,r.value=3,R(),a&&O()}},{immediate:!0}),h(()=>s.modelValue,e=>{Object.assign(n,e)},{immediate:!0,deep:!0}),(e,a)=>{const t=x("a-alert"),s=x("a-input-number"),l=x("a-switch"),c=x("a-select-option"),m=x("a-select"),f=x("a-input"),y=x("a-form-item"),h=x("a-collapse-panel"),O=x("a-collapse"),S=x("a-button"),D=x("a-form");return w(),k("div",U,[a[6]||(a[6]=b("div",{class:"panel-header"},[b("h3",null,"Parameters")],-1)),b("div",q,[_(D,{layout:"vertical"},{default:C(()=>[Object.keys(i.value).length>0?(w(),k("div",W,[a[1]||(a[1]=b("h4",null,"Basic Parameters",-1)),u.value?(w(),k("div",H,[_(t,{message:"O* reasoning models do not support temperature",type:"info",size:"small","show-icon":"",closable:!1})])):$("",!0),(w(!0),k(P,null,F(i.value,(e,t)=>(w(),I(y,{key:t,label:A(t)},{default:C(()=>["number"===e.type?(w(),I(s,{key:0,value:n[t],onChange:e=>g(t,e),min:e.min,max:e.max,step:e.step||.1,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):"integer"===e.type?(w(),I(s,{key:1,value:n[t],onChange:e=>g(t,e),min:e.min,max:e.max,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","placeholder"])):"boolean"===e.type?(w(),I(l,{key:2,checked:n[t],onChange:e=>g(t,e),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):"string"===e.type&&e.enum?(w(),I(m,{key:3,value:n[t],onChange:e=>g(t,e),placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:C(()=>[_(c,{value:void 0},{default:C(()=>a[0]||(a[0]=[b("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[0]}),(w(!0),k(P,null,F(e.enum,e=>(w(),I(c,{key:e,value:e},{default:C(()=>[E(L(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(w(),I(f,{key:4,value:n[t],onChange:e=>g(t,e.target.value),placeholder:String(e.default),size:"large"},null,8,["value","onChange","placeholder"])),e.description?(w(),k("div",B,L(e.description),1)):$("",!0)]),_:2},1032,["label"]))),128))])):$("",!0),Object.keys(d.value).length>0?(w(),I(O,{key:1,ghost:""},{default:C(()=>[_(h,{key:"advanced",header:"Advanced Parameters"},{default:C(()=>[(w(!0),k(P,null,F(d.value,(e,t)=>(w(),I(y,{key:t,label:A(t)},{default:C(()=>["number"===e.type||"integer"===e.type?(w(),I(s,{key:0,value:n[t],onChange:e=>g(t,e),min:e.min,max:e.max,step:"number"===e.type?e.step||.1:1,placeholder:String(e.default),size:"large",style:{width:"100%"}},null,8,["value","onChange","min","max","step","placeholder"])):"boolean"===e.type?(w(),I(l,{key:1,checked:n[t],onChange:e=>g(t,e),"checked-children":"true","un-checked-children":"false"},null,8,["checked","onChange"])):"string"===e.type&&e.enum?(w(),I(m,{key:2,value:n[t],onChange:e=>g(t,e),placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:C(()=>[_(c,{value:void 0},{default:C(()=>a[2]||(a[2]=[b("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[2]}),(w(!0),k(P,null,F(e.enum,e=>(w(),I(c,{key:e,value:e},{default:C(()=>[E(L(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange","placeholder"])):(w(),I(f,{key:3,value:n[t],onChange:e=>g(t,e.target.value),placeholder:String(e.default),size:"large"},null,8,["value","onChange","placeholder"])),e.description?(w(),k("div",J,L(e.description),1)):$("",!0)]),_:2},1032,["label"]))),128))]),_:1})]),_:1})):$("",!0),p.value?(w(),k("div",K,[a[4]||(a[4]=b("h4",null,"Log Probabilities",-1)),b("div",G,[_(y,{label:"Enable Logprobs"},{default:C(()=>[_(l,{checked:o.value,onChange:M,"checked-children":"On","un-checked-children":"Off"},null,8,["checked"])]),_:1}),o.value&&v.value?(w(),I(y,{key:0,label:"Top Alternatives"},{default:C(()=>[_(s,{value:r.value,onChange:j,min:0,max:20,size:"large",style:{width:"100%"},placeholder:"3"},null,8,["value"]),a[3]||(a[3]=b("div",{class:"param-description"}," Number of alternative tokens to show (0-20) ",-1))]),_:1,__:[3]})):$("",!0)])])):$("",!0),b("div",X,[_(S,{onClick:R,size:"small"},{default:C(()=>a[5]||(a[5]=[E(" Reset to Defaults ")])),_:1,__:[5]})])]),_:1})])])}}}),[["__scopeId","data-v-0c19834d"]]),Q={class:"logprobs-display"},Z={key:0,class:"color-legend"},ee={key:1,class:"tokens-container"},ae=["onMouseenter"],te={key:2,class:"regular-text"},se={class:"tooltip-header"},le={class:"token-text"},ne={class:"token-probability"},oe={key:0,class:"alternatives"},re={class:"alt-text"},ie={class:"alt-probability"},de={class:"logprob-raw"},ue=s(g({__name:"LogprobsDisplay",props:{text:{},logprobsData:{}},setup(e){const a=e,t=m({visible:!1,token:{text:"",logprob:0},style:{}}),s=y(()=>a.logprobsData?a.logprobsData.map(e=>({text:e.token,logprob:e.logprob,bytes:e.bytes,topLogprobs:e.top_logprobs})):[]),l=["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#abd9e9","#74add1","#4575b4","#313695"];function n(e){const a=100*Math.exp(e.logprob),t=Math.min(Math.floor(a/(100/(l.length-1))),l.length-1);return{color:l[t],cursor:"pointer",transition:"all 0.2s ease"}}function o(e){return(100*Math.exp(e)).toFixed(2)}function r(){t.value.visible=!1}return(e,a)=>(w(),k("div",Q,[s.value.length>0?(w(),k("div",Z,a[1]||(a[1]=[A('<span class="legend-label" data-v-07949b98>Token Confidence:</span><div class="legend-gradient" data-v-07949b98><span class="legend-low" data-v-07949b98>Low</span><div class="gradient-bar" data-v-07949b98></div><span class="legend-high" data-v-07949b98>High</span></div>',2)]))):$("",!0),s.value.length>0?(w(),k("div",ee,[(w(!0),k(P,null,F(s.value,(e,s)=>(w(),k("span",{key:`token-${s}-${e.text}`,class:"token",style:M(n(e)),onMouseenter:a=>function(e,a,s){t.value={visible:!0,token:e,style:{position:"fixed",left:`${s.clientX+10}px`,top:s.clientY-10+"px",zIndex:"1000"}}}(e,0,a),onMouseleave:r,onMousemove:a[0]||(a[0]=e=>{return a=e,void(t.value.visible&&(t.value.style={...t.value.style,left:`${a.clientX+10}px`,top:a.clientY-10+"px"}));var a})},L(e.text),45,ae))),128))])):(w(),k("div",te,L(e.text),1)),t.value.visible?(w(),k("div",{key:3,class:"token-tooltip",style:M(t.value.style)},[b("div",se,[b("span",le,'"'+L(t.value.token.text)+'"',1),b("span",ne,L(o(t.value.token.logprob))+"%",1)]),t.value.token.topLogprobs&&t.value.token.topLogprobs.length>0?(w(),k("div",oe,[a[2]||(a[2]=b("div",{class:"alternatives-header"},"Alternative tokens:",-1)),(w(!0),k(P,null,F(t.value.token.topLogprobs?.slice(0,5),(e,a)=>(w(),k("div",{key:`alt-${a}-${e.token}`,class:"alternative-token"},[b("span",re,'"'+L(e.token)+'"',1),b("span",ie,L(o(e.logprob))+"%",1)]))),128))])):$("",!0),b("div",de," Raw logprob: "+L(t.value.token.logprob.toFixed(6)),1)],4)):$("",!0)]))}}),[["__scopeId","data-v-07949b98"]]),pe={class:"feature-content-renderer"},ce={key:0,class:"reasoning-content"},me={class:"reasoning-text"},ve={key:1,class:"tool-calls-content"},ge={class:"tool-call-header"},fe={class:"tool-name"},ye={class:"tool-type"},he={class:"tool-call-arguments"},ke={key:2,class:"search-results-content"},be={class:"search-result-title"},_e={class:"search-result-snippet"},xe={key:0,class:"search-result-url"},Ce=["href"],we={key:3,class:"images-content"},$e={class:"image-gallery"},Ie=["src","alt","onClick"],Pe={key:1,class:"image-caption"},Fe={key:4,class:"array-content"},Ee={key:0},Le={key:1},Ae={key:5,class:"object-content"},Me={key:6,class:"text-content"},je=s(g({__name:"FeatureContentRenderer",props:{featureName:{},content:{},config:{}},setup(e){function t(e){if(!e)return"";if("string"==typeof e)try{return JSON.stringify(JSON.parse(e),null,2)}catch{return e}return JSON.stringify(e,null,2)}return(e,s)=>(w(),k("div",pe,["reasoning"===e.featureName&&"string"==typeof e.content?(w(),k("div",ce,[b("pre",me,L(e.content),1)])):"tool_calls"===e.featureName&&Array.isArray(e.content)?(w(),k("div",ve,[(w(!0),k(P,null,F(e.content,(e,a)=>(w(),k("div",{key:`tool-call-${a}-${e.name||e.function?.name}`,class:"tool-call-item"},[b("div",ge,[b("span",fe,L(e.name||e.function?.name||"Unknown Tool"),1),b("span",ye,L(e.type||"function"),1)]),b("div",he,[b("pre",null,L(t(e.arguments||e.function?.arguments)),1)])]))),128))])):"search_results"===e.featureName&&Array.isArray(e.content)?(w(),k("div",ke,[(w(!0),k(P,null,F(e.content,(e,a)=>(w(),k("div",{key:`search-result-${a}-${e.title||e.url}`,class:"search-result-item"},[b("div",be,L(e.title||`Result ${a+1}`),1),b("div",_e,L(e.snippet||e.content),1),e.url?(w(),k("div",xe,[b("a",{href:e.url,target:"_blank",rel:"noopener"},L(e.url),9,Ce)])):$("",!0)]))),128))])):"images"===e.featureName&&Array.isArray(e.content)?(w(),k("div",we,[b("div",$e,[(w(!0),k(P,null,F(e.content,(e,t)=>(w(),k("div",{key:`image-${t}-${e.url||e.image_url}`,class:"image-item"},[e.url||e.image_url?(w(),k("img",{key:0,src:e.url||e.image_url,alt:e.alt||`Image ${t+1}`,onClick:t=>function(e){a.info("Show image modal:",e)}(e)},null,8,Ie)):$("",!0),e.caption?(w(),k("div",Pe,L(e.caption),1)):$("",!0)]))),128))])])):Array.isArray(e.content)?(w(),k("div",Fe,[(w(!0),k(P,null,F(e.content,(e,a)=>(w(),k("div",{key:`array-item-${a}-${"object"==typeof e?JSON.stringify(e).substring(0,50):e}`,class:"array-item"},["object"==typeof e?(w(),k("div",Ee,[b("pre",null,L(t(e)),1)])):(w(),k("div",Le,L(e),1))]))),128))])):"object"==typeof e.content?(w(),k("div",Ae,[b("pre",null,L(t(e.content)),1)])):(w(),k("div",Me,L(e.content),1))]))}}),[["__scopeId","data-v-b34d2904"]]),Oe={key:0,class:"feature-display-container"},Re={class:"feature-header"},Se={key:0,class:"feature-icon"},De={class:"feature-label"},ze={key:1,class:"feature-static"},Ne={class:"feature-header"},Te={key:0,class:"feature-icon"},Ve={class:"feature-label"},Ue=s(g({__name:"FeatureDisplay",props:{features:{},provider:{}},setup(e){const a=e,s=y(()=>a.provider&&t.getResponseFeatures(a.provider)||{});function l(e){return s.value[e]}function n(e){return e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}return(e,a)=>{const t=x("a-collapse-panel"),s=x("a-collapse");return e.features&&e.features.size>0?(w(),k("div",Oe,[(w(!0),k(P,null,F(e.features,([e,a])=>(w(),k("div",{key:e,class:j(["feature-item",[`position-${l(e)?.displayConfig.position||"after-content"}`]])},[!1!==l(e)?.displayConfig.collapsible?(w(),I(s,{key:0,"default-active-key":l(e)?.displayConfig.defaultCollapsed?[]:[e],ghost:""},{default:C(()=>[(w(),I(t,{key:e},{header:C(()=>[b("div",Re,[l(e)?.displayConfig.icon?(w(),k("span",Se,L(l(e)?.displayConfig.icon),1)):$("",!0),b("span",De,L(l(e)?.displayConfig.label||n(e)),1)])]),default:C(()=>[b("div",{class:j(["feature-content",[`styling-${l(e)?.displayConfig.styling||"standard"}`]]),style:M({maxHeight:l(e)?.displayConfig.maxHeight||"none"})},[_(je,{"feature-name":e,content:a,config:l(e)},null,8,["feature-name","content","config"])],6)]),_:2},1024))]),_:2},1032,["default-active-key"])):(w(),k("div",ze,[b("div",Ne,[l(e)?.displayConfig.icon?(w(),k("span",Te,L(l(e)?.displayConfig.icon),1)):$("",!0),b("span",Ve,L(l(e)?.displayConfig.label||n(e)),1)]),b("div",{class:j(["feature-content",[`styling-${l(e)?.displayConfig.styling||"standard"}`]]),style:M({maxHeight:l(e)?.displayConfig.maxHeight||"none"})},[_(je,{"feature-name":e,content:a,config:l(e)},null,8,["feature-name","content","config"])],6)]))],2))),128))])):$("",!0)}}}),[["__scopeId","data-v-3e7b057a"]]),qe={class:"response-display"},We={key:0,class:"loading-state"},He={key:1,class:"error-state"},Be={class:"error-details"},Je={key:2,class:"response-content"},Ke={class:"response-text"},Ge={class:"expand-icon"},Xe={class:"metadata-content"},Ye={class:"metadata-grid"},Qe={class:"metadata-item"},Ze={class:"value"},ea={key:0,class:"metadata-item"},aa={class:"value"},ta={key:1,class:"metadata-item"},sa={class:"value"},la={class:"cost-amount"},na={class:"cost-amount"},oa={class:"cost-amount"},ra={class:"metadata-item"},ia={class:"value env-costs"},da={class:"env-item"},ua={class:"env-item"},pa={class:"env-item"},ca={class:"raw-response"},ma={class:"raw-response"},va={key:3,class:"empty-state"},ga=s(g({__name:"ResponseDisplay",props:{response:{},isLoading:{type:Boolean},error:{}},setup(e){const a=e,s=l(),r=m(!1),i=y(()=>!(!a.response?.features||!a.response.model)&&u("before-content").size>0),d=y(()=>!(!a.response?.features||!a.response.model)&&u("after-content").size>0);function u(e){if(!a.response?.features||!a.response.model)return new Map;const s=t.getResponseFeatures(a.response.model.provider);if(!s)return new Map;const l=new Map;for(const[t,n]of a.response.features){const a=s[t];a?.displayConfig.position===e&&l.set(t,n)}return l}function p(e){return e<1e-4?e.toFixed(6):e<.01?e.toFixed(4):e.toFixed(3)}function v(e){if(!e)return"No raw response data";try{return JSON.stringify(e,null,2)}catch{return String(e)}}function g(e){if(!e)return"No error details available";try{return JSON.stringify(e,null,2)}catch{return String(e)}}function f(e,t){if(!s.environmentalCostsEnabled)return"??";if(!a.response?.model)return"-";if(!o.hasDataForModel(a.response.model.provider,a.response.model.modelId))return"-";const l=t||0;if(0===l)return"-";const n=o.calculateEnvironmentalCostUnsafe(a.response.model.provider,a.response.model.modelId,l)[e];if(0===n)return"-";switch(e){case"carbon":return n<.001?"<1Î¼g":n<1?`${(1e3*n).toFixed(0)}Î¼g`:n<1e3?`${n.toFixed(1)}mg`:`${(n/1e3).toFixed(1)}g`;case"water":return n<.001?"<1nL":n<1?`${(1e3*n).toFixed(0)}nL`:n<1e3?`${n.toFixed(1)}Î¼L`:`${(n/1e3).toFixed(1)}mL`;case"energy":return n<.001?"<1Î¼Wh":n<1?`${(1e3*n).toFixed(0)}Î¼Wh`:n<1e3?`${n.toFixed(1)}mWh`:`${(n/1e3).toFixed(1)}Wh`;default:return"-"}}return(e,a)=>{const t=x("a-spin"),s=x("a-alert"),l=x("a-collapse-panel"),o=x("a-collapse");return w(),k("div",qe,[e.isLoading?(w(),k("div",We,[_(t,{size:"large"},{tip:C(()=>a[1]||(a[1]=[E("Generating response...")])),_:1})])):e.error?(w(),k("div",He,[_(s,{type:"error",message:e.error.message||"API Error",description:e.error.details,"show-icon":""},null,8,["message","description"]),e.error.response?(w(),I(o,{key:0,ghost:"",style:{"margin-top":"16px"}},{default:C(()=>[_(l,{key:"details",header:"Full API Request/Response"},{default:C(()=>[b("pre",Be,L(g(e.error.response)),1)]),_:1})]),_:1})):$("",!0)])):e.response?(w(),k("div",Je,[i.value?(w(),I(Ue,{key:0,features:u("before-content"),provider:e.response.model?.provider,class:"features-before"},null,8,["features","provider"])):$("",!0),b("div",Ke,[_(ue,{text:e.response.content,"logprobs-data":e.response.logprobs},null,8,["text","logprobs-data"])]),d.value?(w(),I(Ue,{key:1,features:u("after-content"),provider:e.response.model?.provider,class:"features-after"},null,8,["features","provider"])):$("",!0),b("div",{class:j(["response-metadata",{expanded:r.value}])},[b("h3",{class:"metadata-header",onClick:a[0]||(a[0]=e=>r.value=!r.value)},[b("span",Ge,[r.value?(w(),I(R(n),{key:1})):(w(),I(R(c),{key:0}))]),a[2]||(a[2]=E(" Response Details "))]),O(b("div",Xe,[b("div",Ye,[b("div",Qe,[a[3]||(a[3]=b("span",{class:"label"},"Latency:",-1)),b("span",Ze,L(e.response.latency)+"ms",1)]),e.response.tokens?(w(),k("div",ea,[a[4]||(a[4]=b("span",{class:"label"},"Token Usage:",-1)),b("span",aa,L(e.response.tokens.prompt_tokens||"?")+" input + "+L(e.response.tokens.completion_tokens||"?")+" output = "+L(e.response.tokens.total_tokens||"?")+" total tokens ",1)])):$("",!0),e.response.cost?(w(),k("div",ta,[a[8]||(a[8]=b("span",{class:"label"},"Cost Estimate:",-1)),b("span",sa,[b("span",la,"$"+L(p(e.response.cost.input)),1),a[5]||(a[5]=E(" input + ")),b("span",na,"$"+L(p(e.response.cost.output)),1),a[6]||(a[6]=E(" output = ")),b("span",oa,"$"+L(p(e.response.cost.total)),1),a[7]||(a[7]=E(" total "))])])):$("",!0),b("div",ra,[a[9]||(a[9]=b("span",{class:"label"},"Environmental:",-1)),b("span",ia,[b("span",da,"COâ‚‚ ðŸ­: "+L(f("carbon",e.response.tokens?.total_tokens))+"Â Â ",1),b("span",ua,"Water ðŸ’§: "+L(f("water",e.response.tokens?.total_tokens))+"Â Â ",1),b("span",pa,"Energy âš¡: "+L(f("energy",e.response.tokens?.total_tokens)),1)])])]),_(o,{ghost:"",style:{"margin-top":"16px"}},{default:C(()=>[_(l,{key:"raw",header:"Raw API Response"},{default:C(()=>[b("pre",ca,L(v(e.response.raw)),1)]),_:1})]),_:1}),e.response.debug?(w(),I(o,{key:0,ghost:"",style:{"margin-top":"8px"}},{default:C(()=>[_(l,{key:"debug",header:"API Request Details"},{default:C(()=>[b("pre",ma,L(v(e.response.debug)),1)]),_:1})]),_:1})):$("",!0)],512),[[S,r.value]])],2)])):(w(),k("div",va,a[10]||(a[10]=[b("div",{class:"empty-content"},[b("div",{class:"empty-icon"},"ðŸ’¬"),b("p",null,"Response will appear here after running a prompt")],-1)])))])}}}),[["__scopeId","data-v-ce778b2d"]]),fa={class:"playground-view","data-testid":"page-playground"},ya={class:"page-header"},ha={class:"header-actions"},ka={key:0,class:"cost-estimate"},ba={class:"cost-tooltip"},_a={class:"playground-content"},xa={class:"left-panel"},Ca={class:"panel-section"},wa={key:0,class:"model-info"},$a={class:"info-header"},Ia={class:"model-name"},Pa={class:"provider-badge"},Fa={key:0,class:"info-details"},Ea={class:"detail-item"},La={class:"value"},Aa={class:"detail-item"},Ma={class:"value"},ja={class:"dollar-amount"},Oa={class:"detail-item"},Ra={class:"value"},Sa={class:"dollar-amount"},Da={class:"detail-item"},za={class:"value"},Na={class:"detail-item"},Ta={class:"value"},Va={class:"detail-item"},Ua={class:"value"},qa={class:"panel-section"},Wa={class:"action-buttons"},Ha={key:0,class:"panel-section"},Ba={class:"template-buttons"},Ja={class:"center-panel"},Ka={class:"prompt-section"},Ga={class:"section-header"},Xa={class:"character-count"},Ya={key:0,class:"response-section"},Qa={class:"section-header"},Za={key:0,class:"response-meta"},et={class:"response-container"},at={key:0,class:"right-panel"},tt={class:"design-list"},st=["onClick"],lt={class:"design-name"},nt={class:"design-description"},ot={class:"design-preview"},rt={class:"design-type"},it=s(g({__name:"PlaygroundView",setup(t){const s=r(),n=i(),c=d(),g=l(),f=y(()=>[...n.templates.map(e=>({id:e.id,name:e.name,description:e.description,text:e.template,type:"template"})),...c.spreadsheets.map(e=>({id:e.id,name:e.name,description:e.description,text:e.promptPattern,type:"spreadsheet"}))]),h=m(null),I=m(""),A=m({}),M=m(!1),j=m(!1),O=m(!1),{isExecuting:S,lastResponse:U,lastError:q,executePrompt:W}=function(){const t=m(!1),s=m(null),l=m(null),n=m([]);return{isExecuting:v(t),lastResponse:v(s),lastError:v(l),executionHistory:v(n),executePrompt:async function(o){if(t.value)throw new Error("Execution already in progress");t.value=!0,s.value=null,l.value=null;const r={timestamp:new Date,model:`${o.model.provider}:${o.model.modelId}`,prompt:o.prompt,parameters:{...o.parameters}};try{const{APICallExecutor:t}=await e(async()=>{const{APICallExecutor:e}=await import("./index-Du1WcLqe.js").then(e=>e.a9);return{APICallExecutor:e}},__vite__mapDeps([0,1,2,3]),import.meta.url),l=new t({getApiKey:o.getApiKey,getBaseUrl:o.getBaseUrl}),n={id:Date.now().toString(),variables:{},prompt:o.prompt,status:"pending",created:new Date},{providerRegistry:i}=await e(async()=>{const{providerRegistry:e}=await import("./index-Du1WcLqe.js").then(e=>e.a7);return{providerRegistry:e}},__vite__mapDeps([0,1,2,3]),import.meta.url),d=i.getProvider(o.model.provider),u={provider:o.model.provider,modelId:o.model.modelId,name:o.model.displayName,parameters:o.parameters,providerSnapshot:d||{},modelSnapshot:o.model},c=Date.now(),m=await l.executeAPICall(n,u),v=m.response?.latencyMs||Date.now()-c,g=m.response?.body;if(!m.response||m.response.status>=400){const e=new Error(m.result?.error||"API request failed");throw e.fullResponse={request:m.request,response:m.response},e}const f=m.result?.content||g?.choices?.[0]?.message?.content||"",{parameterAdapter:y}=await e(async()=>{const{parameterAdapter:e}=await import("./index-Du1WcLqe.js").then(e=>e.a8);return{parameterAdapter:e}},__vite__mapDeps([0,1,2,3]),import.meta.url),h=y.extractUsageInfo(o.model.provider,g);let k,b;if(o.parameters.include_logprobs&&g?.choices?.[0]?.logprobs&&(k=g.choices[0].logprobs),o.model.capabilities&&(h.prompt_tokens||h.completion_tokens)){const e=h.prompt_tokens||0,a=h.completion_tokens||0,t=(o.model.capabilities.inputCostPerToken||0)*e,s=(o.model.capabilities.outputCostPerToken||0)*a;b={input:t,output:s,total:t+s}}const _={content:f,latency:v,tokens:h,cost:b,logprobs:k,features:new Map,raw:g,debug:{request:m.request?{url:m.request.url,method:m.request.method,headers:p({headers:m.request.headers},o.model.provider).headers,body:m.request.body}:void 0,response:m.response?{status:m.response.status,statusText:"OK",headers:m.response.headers||{}}:void 0},model:o.model};s.value=_,r.response=_,a.info("Playground execution successful",{model:o.model.modelId,latency:v,tokens:h.total_tokens})}catch(i){const e={message:i instanceof Error?i.message:String(i),details:i instanceof Error?i.stack:void 0,response:i.fullResponse};throw l.value=e,r.error=e,a.error("Playground execution failed",i,{model:o.model.modelId,error:e.message,fullResponse:e.response}),i}finally{t.value=!1,n.value.unshift(r),n.value.length>10&&(n.value=n.value.slice(0,10))}},clearResults:function(){s.value=null,l.value=null},clearHistory:function(){n.value=[]}}}(),H=[{name:"Creative",prompt:"Write a creative short story about:"},{name:"Analysis",prompt:"Analyze the following text and provide insights:"},{name:"Explain",prompt:"Explain this concept in simple terms:"},{name:"Summarize",prompt:"Summarize the following content:"}],B=y(()=>h.value&&I.value.trim().length>0&&!S.value),J=y(()=>{if(!I.value)return 0;const e=Math.ceil(I.value.length/4);return a.debug("PlaygroundView estimated input token count",{tokenCount:e,promptLength:I.value.length}),e}),K=y(()=>{if(!h.value)return 256;const e=V.getOutputTokenLimit(h.value.provider,h.value.modelId,A.value);return a.debug("Output token limit",{provider:h.value.provider,modelId:h.value.modelId,parameters:A.value,limit:e}),e});function G(e){A.value={...e}}function X(){M.value=!0}function Q(){I.value=""}function Z(e){h.value=e,j.value=!1,A.value={}}function ee(e){return e<.01?e.toFixed(4):e<1?e.toFixed(3):e.toFixed(2)}function ae(e){if(!h.value||!g.environmentalCostsEnabled)return"??";if(!o.hasDataForModel(h.value.provider,h.value.modelId))return"-";const a=o.calculateEnvironmentalCostUnsafe(h.value.provider,h.value.modelId,1e3)[e];if(0===a)return"-";switch(e){case"carbon":return a<.001?"<1Î¼g":a<1?`${(1e3*a).toFixed(0)}Î¼g`:a<1e3?`${a.toFixed(1)}mg`:`${(a/1e3).toFixed(1)}g`;case"water":return a<.001?"<1nL":a<1?`${(1e3*a).toFixed(0)}nL`:a<1e3?`${a.toFixed(1)}Î¼L`:`${(a/1e3).toFixed(1)}mL`;case"energy":return a<.001?"<1Î¼Wh":a<1?`${(1e3*a).toFixed(0)}Î¼Wh`:a<1e3?`${a.toFixed(1)}mWh`:`${(a/1e3).toFixed(1)}Wh`;default:return"-"}}async function te(){B.value&&h.value&&(O.value=!0,await W({model:h.value,prompt:I.value,parameters:A.value,getApiKey:e=>g.getApiKey(e),getBaseUrl:e=>g.getBaseUrl(e)}))}return D(async()=>{s.enabledModels.length>0&&(h.value=s.enabledModels[0])}),(e,a)=>{const t=x("a-tooltip"),s=x("a-button"),l=x("a-modal");return w(),k("div",fa,[b("div",ya,[a[8]||(a[8]=b("div",{class:"header-content"},[b("h1",null,"LLM Playground"),b("p",{class:"description"},"Test prompts and explore model responses interactively")],-1)),b("div",ha,[h.value?(w(),k("div",ka,[_(t,{placement:"bottom"},{title:C(()=>[b("div",ba,[a[5]||(a[5]=b("div",null,"Cost estimate based on:",-1)),b("div",null,"â€¢ Input: "+L(J.value)+" tokens",1),b("div",null,"â€¢ Output: 10 - "+L(K.value)+" tokens",1),a[6]||(a[6]=b("div",null,"â€¢ Min assumes 10 token response",-1)),a[7]||(a[7]=b("div",null,"â€¢ Max assumes full response limit",-1))])]),default:C(()=>[_(R(u),{class:"info-icon"})]),_:1}),_(N,{model:h.value,mode:"range","input-tokens":J.value,"min-output-tokens":10,"max-output-tokens":K.value,layout:"inline",size:"medium"},null,8,["model","input-tokens","max-output-tokens"])])):$("",!0),_(s,{type:"primary",onClick:te,disabled:!B.value,loading:R(S)},{default:C(()=>[E(L(R(S)?"Running...":"Run"),1)]),_:1},8,["disabled","loading"])])]),b("div",_a,[b("div",xa,[b("div",Ca,[a[18]||(a[18]=b("h3",null,"Select Model",-1)),_(s,{type:"primary",size:"large",style:{width:"100%"},onClick:a[0]||(a[0]=e=>j.value=!0)},{default:C(()=>a[9]||(a[9]=[E(" Select Model ")])),_:1,__:[9]}),h.value?(w(),k("div",wa,[b("div",$a,[b("span",Ia,L(h.value.displayName),1),b("span",Pa,L(h.value.provider),1)]),h.value.capabilities?(w(),k("div",Fa,[b("div",Ea,[a[10]||(a[10]=b("span",{class:"label"},"Context:",-1)),b("span",La,L((n=h.value.capabilities.contextWindow,n?n>=1e6?(n/1e6).toFixed(1)+"M":n>=1e3?(n/1e3).toFixed(0)+"k":n.toString():"N/A"))+" tokens",1)]),b("div",Aa,[a[12]||(a[12]=b("span",{class:"label"},"Input:",-1)),b("span",Ma,[b("span",ja,"$"+L(ee(1e3*(h.value.capabilities.inputCostPerToken||0))),1),a[11]||(a[11]=E("/1k"))])]),b("div",Oa,[a[14]||(a[14]=b("span",{class:"label"},"Output:",-1)),b("span",Ra,[b("span",Sa,"$"+L(ee(1e3*(h.value.capabilities.outputCostPerToken||0))),1),a[13]||(a[13]=E("/1k"))])]),b("div",Da,[a[15]||(a[15]=b("span",{class:"label"},"COâ‚‚: ðŸ­",-1)),b("span",za,L(ae("carbon")),1)]),b("div",Na,[a[16]||(a[16]=b("span",{class:"label"},"Water: ðŸ’§",-1)),b("span",Ta,L(ae("water")),1)]),b("div",Va,[a[17]||(a[17]=b("span",{class:"label"},"Energy: âš¡",-1)),b("span",Ua,L(ae("energy")),1)])])):$("",!0)])):$("",!0)]),b("div",qa,[a[21]||(a[21]=b("h3",null,"Actions",-1)),b("div",Wa,[_(s,{type:"default",onClick:X,disabled:!f.value.length,block:""},{default:C(()=>a[19]||(a[19]=[E(" Load from Design ")])),_:1,__:[19]},8,["disabled"]),_(s,{type:"default",onClick:Q,disabled:!I.value,block:""},{default:C(()=>a[20]||(a[20]=[E(" Clear Prompt ")])),_:1,__:[20]},8,["disabled"])])]),h.value?(w(),k("div",Ha,[a[22]||(a[22]=b("h3",null,"Quick Templates",-1)),b("div",Ba,[(w(),k(P,null,F(H,e=>_(s,{key:e.name,size:"small",onClick:a=>function(e){I.value=e}(e.prompt)},{default:C(()=>[E(L(e.name),1)]),_:2},1032,["onClick"])),64))])])):$("",!0)]),b("div",Ja,[b("div",Ka,[b("div",Ga,[a[23]||(a[23]=b("h3",null,"Prompt",-1)),b("span",Xa,L(I.value.length)+" characters",1)]),_(z,{modelValue:I.value,"onUpdate:modelValue":a[1]||(a[1]=e=>I.value=e),rows:6,placeholder:"Enter your prompt here...","data-testid":"playground-prompt-editor"},null,8,["modelValue"])]),O.value?(w(),k("div",Ya,[b("div",Qa,[a[24]||(a[24]=b("h3",null,"Response",-1)),R(U)?(w(),k("div",Za,[b("span",null,L(R(U).latency)+"ms",1),b("span",null,L(R(U).tokens?.total_tokens||"?")+" tokens",1)])):$("",!0)]),b("div",et,[_(ga,{response:R(U),"is-loading":R(S),error:R(q)},null,8,["response","is-loading","error"])])])):$("",!0)]),h.value?(w(),k("div",at,[_(Y,{model:h.value,modelValue:A.value,"onUpdate:modelValue":a[2]||(a[2]=e=>A.value=e),onChange:G},null,8,["model","modelValue"])])):$("",!0)]),_(l,{open:M.value,"onUpdate:open":a[3]||(a[3]=e=>M.value=e),title:"Load from Design",width:"800px",footer:null},{default:C(()=>[b("div",tt,[(w(!0),k(P,null,F(f.value,e=>(w(),k("div",{key:e.id,class:"design-item",onClick:a=>function(e){I.value=e.text,M.value=!1}(e)},[b("div",lt,L(e.name),1),b("div",nt,L(e.description||"No description"),1),b("div",ot,L(e.text.substring(0,100))+"...",1),b("div",rt,L(e.type),1)],8,st))),128))])]),_:1},8,["open"]),_(T,{open:j.value,mode:"playground",title:"Select Model",onClose:a[4]||(a[4]=e=>j.value=!1),onSelectModel:Z},null,8,["open"])]);var n}}}),[["__scopeId","data-v-2ee23cf5"]]);export{it as default};
