import{_ as e,e as t,l as a,r as l,p as o,a3 as n,d as s}from"./index-Du1WcLqe.js";import{t as i}from"./token-calculation.service-Dx9E119Z.js";import{d,c as u,aa as r,Z as c,a0 as p,k as m,Y as v,a3 as f,F as k,$ as g,G as y,a2 as h,f as C,X as b,_ as x,ab as T,B as _,r as M,w as F,u as $}from"./vendor-BsQOyEiA.js";import{a as O}from"./cost-formatting-Bv_drrqY.js";const w={class:"model-search-filters"},U={class:"panel-header"},I={class:"search-container"},P=e(d({__name:"ModelSearchFilters",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=t,o=u({get:()=>a.modelValue,set:e=>l("update:modelValue",e)});return(e,t)=>{const a=v("a-input-search");return c(),r("div",w,[p("div",U,[t[2]||(t[2]=p("h3",null,"Available Models",-1)),p("div",I,[t[1]||(t[1]=p("span",{class:"search-label"},"Search:",-1)),m(a,{value:o.value,"onUpdate:value":t[0]||(t[0]=e=>o.value=e),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])])])}}}),[["__scopeId","data-v-b69ac8fd"]]),S={key:0,class:"cost-group"},z={class:"cost-item"},E={class:"cost-value"},L={class:"cost-value"},j={key:1,class:"cost-group"},N={class:"enviro-group"},W={class:"enviro-item"},A={class:"enviro-item"},B={class:"enviro-item"},D={key:0,class:"cost-group"},V={class:"cost-item"},G={class:"cost-value"},K={class:"cost-value"},R={class:"enviro-group"},q={class:"enviro-item"},X={class:"enviro-item"},Y={class:"enviro-item"},Z={key:0,class:"cost-item financial"},H={key:0,class:"cost-value"},J={key:1,class:"cost-value"},Q={class:"cost-item environmental"},ee={class:"enviro-item"},te={class:"enviro-value"},ae={class:"enviro-item"},le={class:"enviro-value"},oe={class:"enviro-item"},ne={class:"enviro-value"},se={key:0,class:"cost-unit"},ie=e(d({__name:"ModelCostDisplay",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(e){const o=e,n=t(),s=u(()=>{const e=n.financialCostsEnabled;return a.debug("ModelCostDisplay showFinancial check",{financialCostsEnabled:e,settingsStoreReady:!n.isLoading,mode:o.mode,model:o.model?.displayName}),e});function i(){if(!o.model.capabilities)return"â€”";const e=o.model.capabilities.inputCostPerToken||0,t=o.model.capabilities.outputCostPerToken||0;if("per-thousand"===o.mode){return O(1e3*(e+t))}if("total"===o.mode){const a=e*o.inputTokens+t*o.outputTokens;return O(a)}return"â€”"}function d(e){if(0===e)return"0";if(e>=.01)return e.toFixed(2).replace(/\.?0+$/,"");const t=e.toFixed(10).match(/^0\.0*[1-9]/);if(t){const a=t[0].length-2;return e.toFixed(a)}return e.toFixed(4)}function m(){if(!o.model.capabilities)return"0";return d(1e3*(o.model.capabilities.inputCostPerToken||0))}function v(){if(!o.model.capabilities)return"0";return d(1e3*(o.model.capabilities.outputCostPerToken||0))}function C(){if(!o.model.capabilities)return"?";const e=o.model.capabilities.inputCostPerToken||0,t=o.model.capabilities.outputCostPerToken||0,l=e*o.inputTokens+t*o.minOutputTokens;return a.debug("formatRangeMin",{inputTokens:o.inputTokens,minOutputTokens:o.minOutputTokens,inputCost:e,outputCost:t,minCost:l}),d(l)}function b(){if(!o.model.capabilities||!o.maxOutputTokens)return"?";const e=o.model.capabilities.inputCostPerToken||0,t=o.model.capabilities.outputCostPerToken||0,l=e*o.inputTokens+t*o.maxOutputTokens;return a.debug("formatRangeMax",{inputTokens:o.inputTokens,maxOutputTokens:o.maxOutputTokens,inputCost:e,outputCost:t,maxCost:l}),d(l)}function x(e){if(!n.environmentalCostsEnabled)return"??";if(!l.hasDataForModel(o.model.provider,o.model.modelId))return"-";const t="total"===o.mode?o.inputTokens+o.outputTokens:1e3,a=l.calculateEnvironmentalCostUnsafe(o.model.provider,o.model.modelId,t)[e];if(0===a)return"-";switch(e){case"carbon":return a<.001?"<1Î¼g":a<1?`${(1e3*a).toFixed(0)}Î¼g`:a<1e3?`${a.toFixed(1)}mg`:`${(a/1e3).toFixed(1)}g`;case"water":return a<.001?"<1nL":a<1?`${(1e3*a).toFixed(0)}nL`:a<1e3?`${a.toFixed(1)}Î¼L`:`${(a/1e3).toFixed(1)}mL`;case"energy":return a<.001?"<1Î¼Wh":a<1?`${(1e3*a).toFixed(0)}Î¼Wh`:a<1e3?`${a.toFixed(1)}mWh`:`${(a/1e3).toFixed(1)}Wh`;default:return"-"}}function T(e){if(!n.environmentalCostsEnabled)return"??";if(!l.hasDataForModel(o.model.provider,o.model.modelId))return"-";if(!o.maxOutputTokens)return"?";const t=o.inputTokens+o.minOutputTokens,a=o.inputTokens+o.maxOutputTokens,s=l.calculateEnvironmentalCostUnsafe(o.model.provider,o.model.modelId,t),i=l.calculateEnvironmentalCostUnsafe(o.model.provider,o.model.modelId,a),d=s[e],u=i[e];if(0===d&&0===u)return"-";const r=t=>{switch(e){case"carbon":return t<.001?"<1Î¼g":t<1?`${(1e3*t).toFixed(0)}Î¼g`:t<1e3?`${t.toFixed(0)}mg`:`${(t/1e3).toFixed(1)}g`;case"water":return t<.001?"<1nL":t<1?`${(1e3*t).toFixed(0)}nL`:t<1e3?`${t.toFixed(0)}Î¼L`:`${(t/1e3).toFixed(1)}mL`;case"energy":return t<.001?"<1Î¼Wh":t<1?`${(1e3*t).toFixed(0)}Î¼Wh`:t<1e3?`${t.toFixed(0)}mWh`:`${(t/1e3).toFixed(1)}Wh`;default:return"-"}};return`${r(d)}-${r(u)}`}return a.debug("ModelCostDisplay props received",{model:o.model?.displayName,mode:o.mode,inputTokens:o.inputTokens,outputTokens:o.outputTokens,minOutputTokens:o.minOutputTokens,maxOutputTokens:o.maxOutputTokens,modelCapabilities:!!o.model?.capabilities,inputCostPerToken:o.model?.capabilities?.inputCostPerToken,outputCostPerToken:o.model?.capabilities?.outputCostPerToken}),(e,t)=>(c(),r("div",{class:f(["model-cost-display",[`layout-${e.layout}`,`size-${e.size}`]])},["range"===e.mode?(c(),r(k,{key:0},[s.value&&e.maxOutputTokens?(c(),r("span",S,[p("span",z,[p("span",E,"$"+h(C()),1),t[0]||(t[0]=y(" - ")),p("span",L,"$"+h(b()),1)])])):s.value?(c(),r("span",j,t[1]||(t[1]=[p("span",{class:"cost-item"},[p("span",{class:"cost-value"},"Cost: ??")],-1)]))):g("",!0),t[4]||(t[4]=p("span",{class:"cost-tab"},null,-1)),p("span",N,[p("span",W,"COâ‚‚ "+h(T("carbon")),1),t[2]||(t[2]=p("span",{class:"cost-tab"},null,-1)),p("span",A,"ðŸ’§"+h(T("water")),1),t[3]||(t[3]=p("span",{class:"cost-tab"},null,-1)),p("span",B,"âš¡"+h(T("energy")),1)])],64)):"input-output"===e.mode?(c(),r(k,{key:1},[s.value?(c(),r("span",D,[p("span",V,[p("span",G,"$"+h(m()),1),t[5]||(t[5]=y("/1K input + ")),p("span",K,"$"+h(v()),1),t[6]||(t[6]=y("/1K output "))])])):g("",!0),t[9]||(t[9]=p("span",{class:"cost-tab"},null,-1)),p("span",R,[p("span",q,"COâ‚‚ "+h(x("carbon")),1),t[7]||(t[7]=p("span",{class:"cost-tab"},null,-1)),p("span",X,"ðŸ’§"+h(x("water")),1),t[8]||(t[8]=p("span",{class:"cost-tab"},null,-1)),p("span",Y,"âš¡"+h(x("energy")),1)])],64)):(c(),r(k,{key:2},[s.value?(c(),r("div",Z,["per-thousand"===e.mode?(c(),r("span",H,[y(h(i())+" ",1),t[10]||(t[10]=p("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):"total"===e.mode?(c(),r("span",J,h(i()),1)):g("",!0)])):g("",!0),p("div",Q,[p("span",ee,[t[11]||(t[11]=p("span",{class:"enviro-icon"},"COâ‚‚",-1)),p("span",te,h(x("carbon")),1)]),p("span",ae,[t[12]||(t[12]=p("span",{class:"enviro-icon"},"ðŸ’§",-1)),p("span",le,h(x("water")),1)]),p("span",oe,[t[13]||(t[13]=p("span",{class:"enviro-icon"},"âš¡",-1)),p("span",ne,h(x("energy")),1)]),"per-thousand"===e.mode?(c(),r("span",se,"/ 1,000")):g("",!0)])],64))],2))}}),[["__scopeId","data-v-0e44d7ba"]]),de={class:"provider-header"},ue={class:"provider-name"},re={class:"provider-model-count"},ce={class:"provider-models"},pe=["onClick"],me={class:"model-name"},ve={class:"model-specs"},fe=e(d({__name:"ModelProviderGroup",props:{groupedModels:{},selectedModelId:{},mode:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function},hasConfigPanel:{type:Boolean}},emits:["select-model"],setup(e){const t=C([]);return(e,a)=>{const l=v("a-button"),o=v("a-collapse-panel"),n=v("a-collapse");return c(),b(n,{activeKey:t.value,"onUpdate:activeKey":a[0]||(a[0]=e=>t.value=e),bordered:!1},{default:x(()=>[(c(!0),r(k,null,T(e.groupedModels,(a,n)=>(c(),b(o,{key:n,class:"provider-panel"},{header:x(()=>[p("div",de,[p("span",ue,h(n),1),p("span",re,h(a.length)+" models",1)])]),extra:x(()=>[m(l,{size:"small",type:"text",onClick:_(e=>function(e){const a=t.value.indexOf(e);a>-1?t.value.splice(a,1):t.value.push(e)}(n),["stop"])},{default:x(()=>[y(h(t.value.includes(n)?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:x(()=>[p("div",ce,[(c(!0),r(k,null,T(a,t=>(c(),r("div",{key:t.id,class:f(["model-row",{selected:e.selectedModelId===t.id}]),onClick:a=>e.$emit("select-model",t)},[p("div",me,h(t.displayName),1),p("div",ve,[m(ie,{model:t,mode:"trial"===e.mode?"range":"input-output","input-tokens":e.getInputTokensForModel(t),"min-output-tokens":10,"max-output-tokens":e.getOutputTokensForModel(t),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])])],10,pe))),128))])]),_:2},1024))),128))]),_:1},8,["activeKey"])}}}),[["__scopeId","data-v-d7f63954"]]),ke={class:"config-panel"},ge={class:"config-header"},ye={class:"config-header-title"},he={class:"total-cost"},Ce={key:0,class:"cost-info"},be={key:0,class:"config-content"},xe={class:"param-description"},Te={class:"param-description"},_e={class:"config-footer"},Me=e(d({__name:"ModelConfigurationPanel",props:{selectedModel:{},mode:{},totalCalls:{},costEstimate:{},getInputTokensForModel:{type:Function},getOutputTokensForModel:{type:Function}},emits:["close","add-configuration","confirm-selection"],setup(e){const t=e,a=C(""),l=M({}),s=u(()=>t.selectedModel?o.getBasicParameters(t.selectedModel.provider,t.selectedModel.modelId):{}),i=u(()=>t.selectedModel?o.getAdvancedParameters(t.selectedModel.provider,t.selectedModel.modelId):{});function d(e){return e.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}return F(()=>t.selectedModel,e=>{if(!e)return;a.value=e.displayName,Object.keys(l).forEach(e=>delete l[e]);const t={...o.getBasicParameters(e.provider,e.modelId),...o.getAdvancedParameters(e.provider,e.modelId)};for(const[a,o]of Object.entries(t))void 0!==o.default&&(l[a]=o.default)},{immediate:!0}),(e,o)=>{const u=v("a-button"),f=v("a-input"),C=v("a-form-item"),_=v("a-input-number"),M=v("a-switch"),F=v("a-select-option"),O=v("a-select"),w=v("a-col"),U=v("a-row"),I=v("a-collapse-panel"),P=v("a-collapse"),S=v("a-form");return c(),r("div",ke,[p("div",ge,[p("div",ye,[p("h3",null,h("trial"===e.mode?"Configure":"Selected")+": "+h(e.selectedModel.displayName),1),m(u,{type:"text",onClick:o[0]||(o[0]=t=>e.$emit("close")),class:"config-close-btn","aria-label":"Close configuration panel"},{default:x(()=>[m($(n))]),_:1})]),p("div",he,[m(ie,{model:e.selectedModel,mode:"trial"===e.mode?"total":"input-output","input-tokens":e.costEstimate?.inputTokens.avgTokens||e.getInputTokensForModel(e.selectedModel),"output-tokens":e.costEstimate?.outputTokens||e.getOutputTokensForModel(e.selectedModel),layout:"inline",size:"large"},null,8,["model","mode","input-tokens","output-tokens"]),"trial"===e.mode&&e.totalCalls>1?(c(),r("span",Ce,"("+h(e.totalCalls)+" calls)",1)):g("",!0)])]),"trial"===e.mode?(c(),r("div",be,[m(S,{layout:"vertical"},{default:x(()=>[m(C,{label:"Configuration Name",required:""},{default:x(()=>[m(f,{value:a.value,"onUpdate:value":o[1]||(o[1]=e=>a.value=e),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1}),m(P,{"default-active-key":["basic"],ghost:""},{default:x(()=>[m(I,{key:"basic",header:"Basic Parameters"},{default:x(()=>[m(U,{gutter:16},{default:x(()=>[(c(!0),r(k,null,T(s.value,(e,t)=>(c(),b(w,{key:t,span:12},{default:x(()=>[m(C,{label:d(t)},{default:x(()=>["number"===e.type?(c(),b(_,{key:0,value:l[t],"onUpdate:value":e=>l[t]=e,min:e.min,max:e.max,step:.1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"integer"===e.type?(c(),b(_,{key:1,value:l[t],"onUpdate:value":e=>l[t]=e,min:e.min,max:e.max,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"boolean"===e.type?(c(),b(M,{key:2,checked:l[t],"onUpdate:checked":e=>l[t]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(c(),b(O,{key:3,value:l[t],"onUpdate:value":e=>l[t]=e,placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:x(()=>[m(F,{value:void 0},{default:x(()=>o[4]||(o[4]=[p("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[4]}),(c(!0),r(k,null,T(e.enum,e=>(c(),b(F,{key:e,value:e},{default:x(()=>[y(h(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(c(),b(f,{key:4,value:l[t],"onUpdate:value":e=>l[t]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),p("div",xe,h(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1}),Object.keys(i.value).length>0?(c(),b(I,{key:"advanced",header:"Advanced Parameters"},{default:x(()=>[m(U,{gutter:16},{default:x(()=>[(c(!0),r(k,null,T(i.value,(e,t)=>(c(),b(w,{key:t,span:12},{default:x(()=>[m(C,{label:d(t)},{default:x(()=>["number"===e.type||"integer"===e.type?(c(),b(_,{key:0,value:l[t],"onUpdate:value":e=>l[t]=e,min:e.min,max:e.max,step:"number"===e.type?.1:1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","step","placeholder"])):"boolean"===e.type?(c(),b(M,{key:1,checked:l[t],"onUpdate:checked":e=>l[t]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(c(),b(O,{key:2,value:l[t],"onUpdate:value":e=>l[t]=e,placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:x(()=>[m(F,{value:void 0},{default:x(()=>o[5]||(o[5]=[p("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[5]}),(c(!0),r(k,null,T(e.enum,e=>(c(),b(F,{key:e,value:e},{default:x(()=>[y(h(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(c(),b(f,{key:3,value:l[t],"onUpdate:value":e=>l[t]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),p("div",Te,h(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})])):g("",!0),p("div",_e,["trial"===e.mode?(c(),b(u,{key:0,type:"primary",size:"large",onClick:o[2]||(o[2]=o=>e.$emit("add-configuration",function(){if(!t.selectedModel||!a.value)return null;const e={},o=(e,t,a)=>{const l=t.split(".");let o=e;for(let n=0;n<l.length-1;n++)o[l[n]]||(o[l[n]]={}),o=o[l[n]];o[l[l.length-1]]=a};for(const[t,a]of Object.entries(l))(null!=a&&""!==a||!1===a)&&o(e,t,a);return{name:a.value,provider:t.selectedModel.provider,modelId:t.selectedModel.modelId,parameters:e}}())),disabled:!a.value||!e.selectedModel},{default:x(()=>o[6]||(o[6]=[y(" Add Configuration ")])),_:1,__:[6]},8,["disabled"])):(c(),b(u,{key:1,type:"primary",size:"large",onClick:o[3]||(o[3]=t=>e.$emit("confirm-selection",e.selectedModel)),disabled:!e.selectedModel},{default:x(()=>o[7]||(o[7]=[y(" Select Model ")])),_:1,__:[7]},8,["disabled"]))])])}}}),[["__scopeId","data-v-57e055eb"]]),Fe={class:"modal-content-wrapper"},$e={class:"modal-content"},Oe={class:"models-panel"},we={class:"models-list"},Ue=e(d({__name:"GenericModelSelectorModal",props:{open:{type:Boolean},mode:{},trialContext:{},design:{},title:{},existingConfigurations:{}},emits:["close","add-configuration","select-model"],setup(e,{emit:t}){const l=e,o=t,n=s(),d=C(""),r=C(null),f=C(null),k=u(()=>{let e=n.enabledModels;if(d.value){const t=d.value.toLowerCase();e=e.filter(e=>e.displayName.toLowerCase().includes(t)||e.modelId.toLowerCase().includes(t))}const t={};for(const a of e)t[a.provider]||(t[a.provider]=[]),t[a.provider].push(a);for(const a in t)t[a].sort((e,t)=>e.displayName.localeCompare(t.displayName));return t}),y=u(()=>{if("trial"!==l.mode)return 1;if(l.trialContext)return l.trialContext.totalCombinations;if(l.design){let e=1;for(const t of Object.values(l.design.variableBindings))"direct"===t.type&&(e*=t.values?.length||1);return e}return 1});function h(e){if(r.value=e,"playground"===l.mode)return o("select-model",e),void o("close")}function T(e){o("add-configuration",e)}function _(e){o("select-model",e),o("close")}function M(){r.value=null}function $(e){if("trial"===l.mode){if(l.trialContext)return l.trialContext.avgTokens;if(l.design)return l.design.tokenEstimate?.avgTokens||150}return 1e3}function O(e){if("trial"===l.mode){return i.getOutputTokenLimit(e.provider,e.modelId,{})||256}return 1e3}return F([r],async()=>{if(r.value&&"trial"===l.mode)if(l.trialContext||l.design)try{l.trialContext?f.value=await i.calculateCostEstimateFromContext(l.trialContext.totalCombinations,l.trialContext.avgTokens,r.value,{}):l.design&&(f.value=await i.calculateCostEstimate(l.design,r.value,{}))}catch(e){a.error("Failed to calculate cost estimate:",e),f.value=null}else f.value=null;else f.value=null}),(e,t)=>{const a=v("a-modal");return c(),b(a,{open:e.open,onCancel:t[1]||(t[1]=t=>e.$emit("close")),title:e.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:x(()=>[p("div",Fe,[p("div",$e,[p("div",Oe,[m(P,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e)},null,8,["modelValue"]),p("div",we,[m(fe,{"grouped-models":k.value,"selected-model-id":r.value?.id,mode:e.mode,"get-input-tokens-for-model":$,"get-output-tokens-for-model":O,"has-config-panel":!!r.value,onSelectModel:h},null,8,["grouped-models","selected-model-id","mode","has-config-panel"])])]),r.value&&"trial"===e.mode?(c(),b(Me,{key:0,"selected-model":r.value,mode:e.mode,"total-calls":y.value,"cost-estimate":f.value,"get-input-tokens-for-model":$,"get-output-tokens-for-model":O,onClose:M,onAddConfiguration:T,onConfirmSelection:_},null,8,["selected-model","mode","total-calls","cost-estimate"])):g("",!0)])])]),_:1},8,["open","title"])}}}),[["__scopeId","data-v-f085f906"]]);export{Ue as G,ie as M};
