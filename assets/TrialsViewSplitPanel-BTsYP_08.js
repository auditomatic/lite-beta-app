import{k as e,S as t,f as a,c as l,X as n,W as r,d as s,w as i,o,b as u,ab as c,a1 as d,a0 as p,Y as m,u as v,Z as f,$ as g,F as y,ac as h,_ as b,G as w,a4 as _,a3 as k,ag as x,M as C,N as S,H as I,ak as T,aj as O,al as P,am as $,B as E,g as M,s as F,h as R,a7 as N,q as A,A as j,n as D,af as z,an as L,ah as q,ao as U,r as V,ai as H,ae as B,a2 as K}from"./vendor-CdfxntmD.js";import{I as G,O as W,i as J,b as Q,l as Y,T as X,d as Z,K as ee,R as te,V as ae,_ as le,W as ne,X as re,Y as se,c as ie,f as oe,Z as ue,x as ce,g as de,$ as pe,e as me,a0 as ve,S as fe,J as ge,a1 as ye,F as he,a2 as be,p as we,m as _e,a3 as ke,D as xe,C as Ce,w as Se,a4 as Ie,E as Te,A as Oe,a5 as Pe}from"./index-DiVikgh0.js";import{u as $e,p as Ee,f as Me}from"./useLiveData-BApH4Ic9.js";import{F as Fe}from"./FilterOutlined-S3xoDtEr.js";import{F as Re,t as Ne,T as Ae}from"./TrialCreationModalNew-C2oQEKqu.js";import{D as je,C as De}from"./DollarOutlined-B9qF9fHT.js";import{r as ze,C as Le}from"./api-key-redactor-BTPTKMg2.js";import{l as qe}from"./db-CL8uhZCz.js";import{u as Ue}from"./useLiveDataSingle-BXJl31e-.js";import{_ as Ve}from"./BaseModal.vue_vue_type_style_index_0_lang-DY82666A.js";import"./papaparse.min-DYvV7_qI.js";import"./cost-formatting-DSpbVMtV.js";import"./useEnvironmentalCost-qu-1QhkL.js";import"./token-calculation.service-mxzEEp8v.js";import"./variable.service-S4IrrOpw.js";import"./GenericModelSelectorModalV2-BnvX38d-.js";import"./ModelCostDisplayV2-C0k9EEIQ.js";var He={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"};function Be(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){Ke(e,t,a[t])})}return e}function Ke(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ge=function(t,a){var l=Be({},t,a.attrs);return e(G,Be({},l,{icon:He}),null)};Ge.displayName="ClearOutlined",Ge.inheritAttrs=!1;var We={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"};function Je(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){Qe(e,t,a[t])})}return e}function Qe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ye=function(t,a){var l=Je({},t,a.attrs);return e(G,Je({},l,{icon:We}),null)};Ye.displayName="ExportOutlined",Ye.inheritAttrs=!1;var Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"}},{tag:"path",attrs:{d:"M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"}}]},name:"field-time",theme:"outlined"};function Ze(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){et(e,t,a[t])})}return e}function et(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var tt=function(t,a){var l=Ze({},t,a.attrs);return e(G,Ze({},l,{icon:Xe}),null)};tt.displayName="FieldTimeOutlined",tt.inheritAttrs=!1;var at={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function lt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){nt(e,t,a[t])})}return e}function nt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var rt=function(t,a){var l=lt({},t,a.attrs);return e(G,lt({},l,{icon:at}),null)};rt.displayName="InboxOutlined",rt.inheritAttrs=!1;var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};function it(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){ot(e,t,a[t])})}return e}function ot(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ut=function(t,a){var l=it({},t,a.attrs);return e(G,it({},l,{icon:st}),null)};ut.displayName="PauseCircleOutlined",ut.inheritAttrs=!1;var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"};function dt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){pt(e,t,a[t])})}return e}function pt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var mt=function(t,a){var l=dt({},t,a.attrs);return e(G,dt({},l,{icon:ct}),null)};mt.displayName="RobotOutlined",mt.inheritAttrs=!1;var vt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};function ft(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){gt(e,t,a[t])})}return e}function gt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var yt=function(t,a){var l=ft({},t,a.attrs);return e(G,ft({},l,{icon:vt}),null)};yt.displayName="StopOutlined",yt.inheritAttrs=!1;var ht={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M848 359.3H627.7L825.8 109c4.1-5.3.4-13-6.3-13H436c-2.8 0-5.5 1.5-6.9 4L170 547.5c-3.1 5.3.7 12 6.9 12h174.4l-89.4 357.6c-1.9 7.8 7.5 13.3 13.3 7.7L853.5 373c5.2-4.9 1.7-13.7-5.5-13.7zM378.2 732.5l60.3-241H281.1l189.6-327.4h224.6L487 427.4h211L378.2 732.5z"}}]},name:"thunderbolt",theme:"outlined"};function bt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){wt(e,t,a[t])})}return e}function wt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var _t=function(t,a){var l=bt({},t,a.attrs);return e(G,bt({},l,{icon:ht}),null)};_t.displayName="ThunderboltOutlined",_t.inheritAttrs=!1;var kt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"};function xt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),l.forEach(function(t){Ct(e,t,a[t])})}return e}function Ct(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var St=function(t,a){var l=xt({},t,a.attrs);return e(G,xt({},l,{icon:kt}),null)};St.displayName="WarningOutlined",St.inheritAttrs=!1;const It="auditomatic.trial-split-view",Tt=t("trial-split-view",()=>{const e=n(),t=r(),s=W(),i=a(null),o=a("medium"),u=a(""),c=a("all"),d=a(-1),p=l(()=>i.value&&s.trials.find(e=>e.id===i.value)||null),m=l(()=>{switch(o.value){case"wide":return 400;case"medium":return 250;case"collapsed":return 100}}),v=l(()=>"collapsed"===o.value),f=l(()=>{let e=s.trials;if("all"!==c.value&&(e=e.filter(e=>e.status===c.value)),u.value){const t=u.value.toLowerCase();e=e.filter(e=>!!e.name.toLowerCase().includes(t)||(!(!J(e)||!e.templateName.toLowerCase().includes(t))||!(!Q(e)||!e.datasetName.toLowerCase().includes(t))))}return[...e].sort((e,t)=>{const a=e.completed||e.started||e.created;return(t.completed||t.started||t.created).getTime()-a.getTime()})}),g=l(()=>({running:f.value.filter(e=>"running"===e.status),recent:f.value.filter(e=>"running"!==e.status)})),y=l(()=>f.value.length),h=l(()=>{const e={all:s.trials.length,running:0,completed:0,failed:0,draft:0,paused:0};return s.trials.forEach(t=>{const a=t.status;a in e&&e[a]++}),e});function b(t){i.value=t,d.value=-1,t?e.push({name:"trials",params:{trialId:t}}):e.push({name:"trials"}),Y.debug("Trial selected",{trialId:t})}function w(){try{const e={panelMode:o.value,statusFilter:c.value,searchQuery:u.value};localStorage.setItem(`${It}.preferences`,JSON.stringify(e))}catch(e){Y.warn("Failed to save split view preferences",{error:e})}}return function(){try{const e=localStorage.getItem(`${It}.preferences`);if(e){const t=JSON.parse(e);t.panelMode&&(o.value=t.panelMode),t.statusFilter&&(c.value=t.statusFilter),t.searchQuery&&(u.value=t.searchQuery)}}catch(e){Y.warn("Failed to load split view preferences",{error:e})}}(),{selectedTrialId:l(()=>i.value),selectedTrial:l(()=>p.value),panelMode:l(()=>o.value),effectiveWidth:l(()=>m.value),isCollapsed:l(()=>v.value),searchQuery:l(()=>u.value),statusFilter:l(()=>c.value),keyboardFocusIndex:l(()=>d.value),filteredTrials:l(()=>f.value),groupedTrials:l(()=>g.value),totalFilteredCount:l(()=>y.value),statusCounts:l(()=>h.value),selectTrial:b,setSearchQuery:function(e){u.value=e,w()},setStatusFilter:function(e){c.value=e,w()},navigateByKeyboard:function(e){const t=[...g.value.running,...g.value.recent];0!==t.length&&(d.value="down"===e?Math.min(d.value+1,t.length-1):Math.max(d.value-1,0),d.value>=0&&d.value<t.length&&b(t[d.value].id))},togglePanelMode:function(){switch(o.value){case"wide":o.value="medium";break;case"medium":o.value="collapsed";break;case"collapsed":o.value="wide"}w()},setPanelMode:function(e){o.value=e,w()},savePreferences:w,clearPreferences:function(){try{localStorage.removeItem(`${It}.preferences`),o.value="medium",c.value="all",u.value=""}catch(e){Y.warn("Failed to clear split view preferences",{error:e})}},syncWithRoute:function(){const e=t.params.trialId;e&&e!==i.value?i.value=e:e||(i.value=null)}}}),Ot=["data-collapsed"],Pt={class:"list-toolbar"},$t={class:"list-title"},Et={key:1},Mt={key:0,class:"list-actions"},Ft={key:0,class:"list-search"},Rt={key:1,class:"status-tabs"},Nt=["onClick"],At={class:"tab-icon"},jt={class:"tab-label"},Dt={class:"tab-count"},zt={key:0,class:"list-section"},Lt=["onClick","data-index"],qt={key:0,class:"collapsed-content"},Ut={class:"collapsed-info"},Vt={class:"collapsed-count"},Ht={key:1,class:"item-content"},Bt={class:"item-header"},Kt={class:"item-name"},Gt={class:"item-meta"},Wt={class:"meta-text"},Jt={class:"meta-text"},Qt={class:"meta-text"},Yt={key:1,class:"list-section"},Xt=["onClick","data-index"],Zt={key:0,class:"collapsed-content"},ea={class:"collapsed-info"},ta={class:"collapsed-count"},aa={key:1,class:"item-content"},la={class:"item-header"},na={class:"item-name"},ra={class:"item-meta"},sa={class:"meta-text"},ia={class:"meta-text"},oa={class:"meta-text"},ua={key:2,class:"empty-list"},ca=le(s({__name:"TrialListPanel",props:{collapsed:{type:Boolean,default:!1}},emits:["create-trial"],setup(t){const n=Tt(),{data:r}=$e(()=>Z.trials.orderBy("created").reverse().toArray(),{debounce:100}),s=a(),x=a(),C=a(n.searchQuery),S=l(()=>n.selectedTrialId),I=l(()=>n.statusFilter),T=l(()=>n.keyboardFocusIndex),O=l(()=>{let e=r.value||[];if("all"!==I.value&&(e=e.filter(e=>e.status===I.value)),C.value){const t=C.value.toLowerCase();e=e.filter(e=>!!e.name.toLowerCase().includes(t)||(!(!J(e)||!e.templateName.toLowerCase().includes(t))||!(!Q(e)||!e.datasetName.toLowerCase().includes(t))))}return[...e].sort((e,t)=>{const a=e.completed||e.started||e.created;return(t.completed||t.started||t.created).getTime()-a.getTime()})}),P=l(()=>({running:O.value.filter(e=>"running"===e.status),recent:O.value.filter(e=>"running"!==e.status)})),$=l(()=>O.value.length),E=l(()=>{const e=r.value||[],t={all:e.length,running:0,completed:0,failed:0,draft:0,paused:0};return e.forEach(e=>{const a=e.status;a in t&&t[a]++}),t}),M=l(()=>[{key:"all",label:"All",icon:"ðŸ“Š",count:E.value.all},{key:"running",label:"Active",icon:"ðŸŸ¢",count:E.value.running+E.value.paused},{key:"completed",label:"Done",icon:"âœ…",count:E.value.completed}]);function F(e){n.selectTrial(e)}function R(e){return 0===e.progress.total?0:Math.round(e.progress.completed/e.progress.total*100)}function N(e){const t=(new Date).getTime()-e.getTime(),a=Math.floor(t/6e4),l=Math.floor(a/60),n=Math.floor(l/24);return a<1?"now":a<60?`${a}m`:l<24?`${l}h`:n<7?`${n}d`:e.toLocaleDateString()}function A(e){"ArrowDown"===e.key||"j"===e.key?(e.preventDefault(),n.navigateByKeyboard("down"),j()):"ArrowUp"!==e.key&&"k"!==e.key||(e.preventDefault(),n.navigateByKeyboard("up"),j())}function j(){const e=x.value?.querySelectorAll(".list-item"),t=T.value;e&&t>=0&&e[t]&&e[t].scrollIntoView({behavior:"smooth",block:"nearest"})}function D({key:e}){n.setStatusFilter(e)}async function z(){Y.info("Trial list refreshed")}i(C,e=>{n.setSearchQuery(e)});const L=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),s.value?.focus())};return o(()=>{document.addEventListener("keydown",L)}),u(()=>{document.removeEventListener("keydown",L)}),(t,a)=>{const l=f("a-badge"),r=f("a-button"),i=f("a-tooltip"),o=f("a-menu-item"),u=f("a-menu-divider"),O=f("a-menu"),E=f("a-dropdown"),j=f("a-input"),L=f("a-progress"),q=f("a-tag");return b(),c("div",{class:"trial-list-panel","data-collapsed":t.collapsed},[d("div",Pt,[d("div",$t,[t.collapsed?p("",!0):(b(),m(v(X),{key:0})),t.collapsed?p("",!0):(b(),c("span",Et,"Trials")),e(l,{count:$.value,showZero:!0,style:{"margin-left":"8px"}},null,8,["count"])]),t.collapsed?p("",!0):(b(),c("div",Mt,[e(r,{type:"primary",size:"small",onClick:a[0]||(a[0]=e=>t.$emit("create-trial"))},{icon:g(()=>[e(v(ee))]),default:g(()=>[a[3]||(a[3]=w(" New Trial "))]),_:1,__:[3]}),e(i,{title:"Refresh"},{default:g(()=>[e(r,{type:"text",size:"small",onClick:z},{icon:g(()=>[e(v(te))]),_:1})]),_:1}),e(E,null,{overlay:g(()=>[e(O,{onClick:D},{default:g(()=>[e(o,{key:"all"},{default:g(()=>a[4]||(a[4]=[w("All Trials")])),_:1,__:[4]}),e(u),e(o,{key:"running"},{default:g(()=>a[5]||(a[5]=[d("span",{class:"status-dot running"},null,-1),w(" Running Only ")])),_:1,__:[5]}),e(o,{key:"completed"},{default:g(()=>a[6]||(a[6]=[d("span",{class:"status-dot completed"},null,-1),w(" Completed Only ")])),_:1,__:[6]}),e(o,{key:"failed"},{default:g(()=>a[7]||(a[7]=[d("span",{class:"status-dot failed"},null,-1),w(" Failed Only ")])),_:1,__:[7]}),e(o,{key:"paused"},{default:g(()=>a[8]||(a[8]=[d("span",{class:"status-dot paused"},null,-1),w(" Paused Only ")])),_:1,__:[8]}),e(o,{key:"draft"},{default:g(()=>a[9]||(a[9]=[d("span",{class:"status-dot draft"},null,-1),w(" Draft Only ")])),_:1,__:[9]})]),_:1})]),default:g(()=>[e(r,{type:"text",size:"small"},{icon:g(()=>[e(v(Fe))]),_:1})]),_:1})]))]),t.collapsed?p("",!0):(b(),c("div",Ft,[e(j,{placeholder:"Filter trials...",size:"small",value:C.value,"onUpdate:value":a[1]||(a[1]=e=>C.value=e),onKeydown:A,ref_key:"searchInputRef",ref:s},{prefix:g(()=>[e(v(ae))]),_:1},8,["value"])])),t.collapsed?p("",!0):(b(),c("div",Rt,[(b(!0),c(y,null,h(M.value,e=>(b(),c("div",{key:e.key,class:_(["status-tab",{active:I.value===e.key}]),onClick:t=>{return a=e.key,void n.setStatusFilter(a);var a}},[d("span",At,k(e.icon),1),d("span",jt,k(e.label),1),d("span",Dt,k(e.count),1)],10,Nt))),128))])),d("div",{class:"trial-list",ref_key:"trialListRef",ref:x},[P.value.running.length>0?(b(),c("div",zt,[a[14]||(a[14]=d("div",{class:"section-header"},"RUNNING",-1)),(b(!0),c(y,null,h(P.value.running,(l,n)=>(b(),c("div",{key:l.id,class:_(["list-item running-item",{active:S.value===l.id,"keyboard-focus":T.value===n}]),onClick:e=>F(l.id),"data-index":n},[a[13]||(a[13]=d("div",{class:"item-indicator running"},null,-1)),t.collapsed?(b(),c("div",qt,[e(i,{title:`${l.name} - ${l.progress.completed}/${l.progress.total} tasks`},{default:g(()=>[d("div",Ut,[d("span",Vt,k(l.progress.completed),1),e(L,{type:"circle",percent:R(l),width:20,showInfo:!1,strokeWidth:3},null,8,["percent"])])]),_:2},1032,["title"])])):(b(),c("div",Ht,[d("div",Bt,[d("span",Kt,k(l.name),1),e(q,{color:"blue",size:"small"},{default:g(()=>a[10]||(a[10]=[w("RUNNING")])),_:1,__:[10]}),e(L,{percent:R(l),showInfo:!1,strokeWidth:3,style:{width:"80px"}},null,8,["percent"])]),d("div",Gt,[d("span",Wt,k(l.progress.completed)+"/"+k(l.progress.total)+" tasks",1),a[11]||(a[11]=d("span",{class:"meta-separator"},"â€¢",-1)),d("span",Jt,k(N(l.completed||l.started||l.created)),1),a[12]||(a[12]=d("span",{class:"meta-separator"},"â€¢",-1)),d("span",Qt,"$"+k((l.estimatedCost||0).toFixed(2)),1)])]))],10,Lt))),128))])):p("",!0),P.value.recent.length>0?(b(),c("div",Yt,[a[17]||(a[17]=d("div",{class:"section-header"},"RECENT",-1)),(b(!0),c(y,null,h(P.value.recent,(l,n)=>{return b(),c("div",{key:l.id,class:_(["list-item",{active:S.value===l.id,"keyboard-focus":T.value===P.value.running.length+n}]),onClick:e=>F(l.id),"data-index":P.value.running.length+n},[d("div",{class:_(["item-indicator",l.status])},null,2),t.collapsed?(b(),c("div",Zt,[e(i,{title:`${l.name} - ${l.status} - ${l.progress.completed} tasks`},{default:g(()=>[d("div",ea,[d("span",ta,k(l.progress.completed),1)])]),_:2},1032,["title"])])):(b(),c("div",aa,[d("div",la,[d("span",na,k(l.name),1),e(q,{color:(r=l.status,{running:"blue",completed:"green",failed:"red",paused:"orange",draft:"default"}[r]||"default"),size:"small"},{default:g(()=>[w(k(l.status),1)]),_:2},1032,["color"])]),d("div",ra,[d("span",sa,k(l.progress.completed)+" tasks",1),a[15]||(a[15]=d("span",{class:"meta-separator"},"â€¢",-1)),d("span",ia,k(N(l.completed||l.started||l.created)),1),a[16]||(a[16]=d("span",{class:"meta-separator"},"â€¢",-1)),d("span",oa,"$"+k((l.estimatedCost||0).toFixed(2)),1)])]))],10,Xt);var r}),128))])):p("",!0),0===$.value?(b(),c("div",ua,[e(v(rt),{style:{"font-size":"32px",color:"#ccc"}}),a[19]||(a[19]=d("p",null,"No trials found",-1)),e(r,{type:"primary",onClick:a[2]||(a[2]=e=>t.$emit("create-trial"))},{default:g(()=>a[18]||(a[18]=[w(" Create New Trial ")])),_:1,__:[18]})])):p("",!0)],512)],8,Ot)}}}),[["__scopeId","data-v-993ad329"]]),da={class:"trial-header"},pa={class:"header-top-row"},ma={class:"header-left"},va={class:"trial-title"},fa={class:"trial-meta"},ga={class:"progress-inline"},ya={class:"progress-bar-small"},ha={class:"progress-text-inline"},ba={class:"inline-stats"},wa={class:"stat-item"},_a={class:"stat-item"},ka={class:"stat-item"},xa={key:0,class:"stat-item"},Ca=le(s({__name:"TrialHeader",props:{trial:{}},setup(t){const a=t,n=l(()=>a.trial.name.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}/g,"").replace(/\s*\(Copy\)(\s*\(Copy\))*$/g,"").trim()),r=l(()=>({running:"blue",completed:"green",failed:"red",paused:"orange",draft:"default"}[a.trial.status]||"default")),s=l(()=>0===a.trial.progress.total?0:Math.round(a.trial.progress.completed/a.trial.progress.total*100)),i=l(()=>{if(0===a.trial.progress.total)return 0;const e=a.trial.progress.completed-(a.trial.progress.networkErrors||0);return Math.round(e/a.trial.progress.total*100)}),o=l(()=>{if(!a.trial.created)return"N/A";const e=new Date(a.trial.started||a.trial.created).getTime(),t=(a.trial.completed?new Date(a.trial.completed).getTime():Date.now())-e,l=Math.floor(t/36e5),n=Math.floor(t%36e5/6e4);return l>0?`${l}h ${n}m`:`${n}m`}),u=l(()=>"3.6s"),m=l(()=>{if(!a.trial.started)return"calculating...";const e=Date.now()-new Date(a.trial.started).getTime(),t=a.trial.progress.completed;if(0===t)return"calculating...";const l=e/t*(a.trial.progress.total-t),n=Math.floor(l/6e4),r=Math.floor(l%6e4/1e3);if(n>60){return`${Math.floor(n/60)}h ${n%60}m`}return`${n}m ${r}s`});return(t,a)=>{const l=f("a-tag");return b(),c("div",da,[d("div",pa,[d("div",ma,[d("h2",va,k(n.value),1),d("div",fa,[e(l,{color:r.value,class:"status-tag"},{default:g(()=>[w(k(t.trial.status.toUpperCase()),1)]),_:1},8,["color"]),d("div",ga,[d("div",ya,[d("div",{class:"progress-fill",style:x({width:s.value+"%"})},null,4)]),d("span",ha,k(t.trial.progress.completed)+"/"+k(t.trial.progress.total)+" ("+k(i.value)+"%) ",1)]),d("div",ba,[d("span",wa,[e(v(ne)),a[0]||(a[0]=d("span",null,"Duration:",-1)),d("strong",null,k(o.value),1)]),d("span",_a,[e(v(_t)),a[1]||(a[1]=d("span",null,"Latency:",-1)),d("strong",null,k(u.value),1)]),d("span",ka,[e(v(je)),a[2]||(a[2]=d("span",null,"Cost:",-1)),d("strong",null,"$"+k((t.trial.estimatedCost||0).toFixed(2)),1)]),"running"===t.trial.status||"paused"===t.trial.status?(b(),c("span",xa,[e(v(tt)),a[3]||(a[3]=d("span",null,"Remaining:",-1)),d("strong",null,"~"+k(m.value),1)])):p("",!0)])])])])])}}}),[["__scopeId","data-v-5e979bc9"]]),Sa={class:"trial-actions"},Ia=le(s({__name:"TrialActions",props:{trial:{},isResuming:{type:Boolean}},emits:["pause-trial","resume-trial","cancel-trial","export-data","export-python","duplicate-trial","edit-trial","delete-trial"],setup:t=>(t,a)=>{const l=f("a-button"),n=f("a-menu-item"),r=f("a-menu"),s=f("a-dropdown");return b(),c("div",Sa,["running"===t.trial.status?(b(),c(y,{key:0},[e(l,{onClick:a[0]||(a[0]=e=>t.$emit("pause-trial")),size:"large",class:"action-button"},{icon:g(()=>[e(v(ut))]),default:g(()=>[a[9]||(a[9]=w(" Pause "))]),_:1,__:[9]}),e(l,{onClick:a[1]||(a[1]=e=>t.$emit("cancel-trial")),danger:"",size:"large",class:"action-button"},{icon:g(()=>[e(v(yt))]),default:g(()=>[a[10]||(a[10]=w(" Cancel "))]),_:1,__:[10]})],64)):"paused"===t.trial.status?(b(),c(y,{key:1},[e(l,{type:"primary",onClick:a[2]||(a[2]=e=>t.$emit("resume-trial")),disabled:t.isResuming,size:"large",class:"action-button"},{icon:g(()=>[t.isResuming?(b(),m(v(re),{key:0,spin:""})):(b(),m(v(se),{key:1}))]),default:g(()=>[w(" "+k(t.isResuming?"Resuming...":"Resume"),1)]),_:1},8,["disabled"]),e(l,{onClick:a[3]||(a[3]=e=>t.$emit("cancel-trial")),danger:"",size:"large",class:"action-button"},{icon:g(()=>[e(v(yt))]),default:g(()=>[a[11]||(a[11]=w(" Cancel "))]),_:1,__:[11]})],64)):p("",!0),e(s,null,{overlay:g(()=>[e(r,null,{default:g(()=>[e(n,{onClick:a[4]||(a[4]=e=>t.$emit("export-data"))},{default:g(()=>[e(v(Re)),a[13]||(a[13]=w(" Export Data "))]),_:1,__:[13]}),e(n,{onClick:a[5]||(a[5]=e=>t.$emit("export-python"))},{default:g(()=>[e(v(De)),a[14]||(a[14]=w(" Export Python Script "))]),_:1,__:[14]})]),_:1})]),default:g(()=>[e(l,{size:"large",class:"action-button"},{icon:g(()=>[e(v(oe))]),default:g(()=>[a[12]||(a[12]=w(" Export ")),e(v(ie))]),_:1,__:[12]})]),_:1}),e(l,{onClick:a[6]||(a[6]=e=>t.$emit("duplicate-trial")),size:"large",class:"action-button"},{icon:g(()=>[e(v(ue))]),default:g(()=>[a[15]||(a[15]=w(" Duplicate "))]),_:1,__:[15]}),"draft"===t.trial.status?(b(),m(l,{key:2,onClick:a[7]||(a[7]=e=>t.$emit("edit-trial")),size:"large",class:"action-button"},{icon:g(()=>[e(v(ce))]),default:g(()=>[a[16]||(a[16]=w(" Edit "))]),_:1,__:[16]})):p("",!0),e(l,{onClick:a[8]||(a[8]=e=>t.$emit("delete-trial")),danger:"",size:"large",class:"action-button"},{icon:g(()=>[e(v(de))]),default:g(()=>[a[17]||(a[17]=w(" Delete "))]),_:1,__:[17]})])}}),[["__scopeId","data-v-7a87e1d1"]]);const Ta="undefined"!=typeof window&&"undefined"!=typeof document;"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const Oa=Object.prototype.toString,Pa=()=>{};function $a(e){return Array.isArray(e)?e:[e]}function Ea(e,t=200,a=!1,l=!0,n=!1){return function(e,t){return function(...a){return new Promise((l,n)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(l).catch(n)})}}(function(...e){let t,a,l,n,r,s,i=0,o=!0,u=Pa;I(e[0])||"object"!=typeof e[0]?[l,n=!0,r=!0,s=!1]=e:({delay:l,trailing:n=!0,leading:r=!0,rejectOnCancel:s=!1}=e[0]);const c=()=>{t&&(clearTimeout(t),t=void 0,u(),u=Pa)};return e=>{const d=T(l),p=Date.now()-i,m=()=>a=e();return c(),d<=0?(i=Date.now(),m()):(p>d&&(r||!o)?(i=Date.now(),m()):n&&(a=new Promise((e,a)=>{u=s?a:e,t=setTimeout(()=>{i=Date.now(),o=!0,e(m()),c()},Math.max(0,d-p))})),r||t||(t=setTimeout(()=>o=!0,d)),o=!1,a)}}(t,a,l,n),e)}const Ma=Ta?window:void 0;function Fa(...e){const t=[],a=()=>{t.forEach(e=>e()),t.length=0},n=l(()=>{const t=$a(T(e[0])).filter(e=>null!=e);return t.every(e=>"string"!=typeof e)?t:void 0}),r=(s=([e,l,n,r])=>{if(a(),!(null==e?void 0:e.length)||!(null==l?void 0:l.length)||!(null==n?void 0:n.length))return;const s=(i=r,"[object Object]"===Oa.call(i)?{...r}:r);var i;t.push(...e.flatMap(e=>l.flatMap(t=>n.map(a=>((e,t,a,l)=>(e.addEventListener(t,a,l),()=>e.removeEventListener(t,a,l)))(e,t,a,s)))))},o={flush:"post"},i(()=>{var t,a;return[null!=(a=null==(t=n.value)?void 0:t.map(e=>function(e){var t;const a=T(e);return null!=(t=null==a?void 0:a.$el)?t:a}(e)))?a:[Ma].filter(e=>null!=e),$a(T(n.value?e[1]:e[0])),$a(v(n.value?e[2]:e[1])),T(n.value?e[3]:e[2])]},s,{...o,immediate:!0}));var s,o;var u;return u=a,C()&&S(u),()=>{r(),a()}}const Ra={class:"virtual-table"},Na={class:"virtual-table"},Aa=["data-row-index","data-row-id","onClick"],ja=le(s({__name:"VirtualTable",props:{columns:{},dataSource:{},rowHeight:{default:48},rowKey:{type:[String,Function],default:"id"},overscan:{default:5},showHeader:{type:Boolean,default:!0},getRowClass:{},minHeight:{default:"300px"},maxHeight:{default:"calc(100vh - 250px)"}},emits:["row-click"],setup(e,{expose:t,emit:n}){P(e=>({"1f3b711c":e.minHeight,"7b519df8":e.maxHeight}));const r=e,s=n,m=a(),f=a(),g=a(0),C=a(0),S=a(0);let I=null;const T=l(()=>r.dataSource.length*r.rowHeight),$=l(()=>{const e=Math.floor(g.value/r.rowHeight),t=Math.ceil((g.value+C.value)/r.rowHeight);return{start:Math.max(0,e-r.overscan),end:Math.min(r.dataSource.length,t+r.overscan)}}),E=l(()=>$.value.start),M=l(()=>r.dataSource.slice($.value.start,$.value.end)),F=l(()=>E.value*r.rowHeight);function R(e){return"function"==typeof r.rowKey?r.rowKey(e):e[r.rowKey]}function N(e,t){const a=t.key.split(".");let l=e;for(const n of a){if(!l||"object"!=typeof l)return;l=l[n]}return l}function A(e){const t={};return e.width&&(t.width="number"==typeof e.width?`${e.width}px`:e.width),e.align&&(t.textAlign=e.align),t}const j=Ea(e=>{null!==I&&cancelAnimationFrame(I),I=requestAnimationFrame(()=>{const t=e.target;g.value=t.scrollTop,I=null})},16);let D=null;function z(){if(m.value){const e=m.value.querySelector(".virtual-content");C.value=e?e.clientHeight:m.value.clientHeight}f.value&&(S.value=f.value.offsetHeight)}function L(){if(m.value){const e=m.value.querySelector(".virtual-content");e&&(e.scrollTop=0)}}return o(()=>{z(),m.value&&(D=new ResizeObserver(()=>{z()}),D.observe(m.value))}),u(()=>{D&&D.disconnect(),null!==I&&cancelAnimationFrame(I)}),i(()=>r.dataSource.length,()=>{g.value>T.value&&L()}),t({scrollToRow:function(e){if(m.value){const t=m.value.querySelector(".virtual-content");if(t){const a=e*r.rowHeight;t.scrollTop=a}}},scrollToTop:L}),(e,t)=>(b(),c("div",{class:"virtual-table-container",ref_key:"containerRef",ref:m,"data-testid":"virtual-table",role:"table","aria-label":"Data table with virtual scrolling"},[e.showHeader?(b(),c("div",{key:0,class:"virtual-header",ref_key:"headerRef",ref:f},[d("table",Ra,[d("thead",null,[d("tr",null,[(b(!0),c(y,null,h(e.columns,e=>(b(),c("th",{key:e.key,style:x(A(e)),class:_(e.className)},k(e.title),7))),128))])])])],512)):p("",!0),d("div",{class:"virtual-content",style:x({height:`calc(100% - ${S.value}px)`}),onScrollPassive:t[0]||(t[0]=(...e)=>v(j)&&v(j)(...e))},[d("div",{class:"virtual-spacer",style:x({height:T.value+"px"})},[d("div",{class:"virtual-viewport",style:x({transform:`translateY(${F.value}px)`})},[d("table",Na,[d("tbody",null,[(b(!0),c(y,null,h(M.value,(t,a)=>(b(),c("tr",{key:R(t),"data-row-index":E.value+a,"data-row-id":R(t),class:_(e.getRowClass?e.getRowClass(t):""),"data-testid":"table-row",role:"row",onClick:e=>function(e){s("row-click",e)}(t)},[(b(!0),c(y,null,h(e.columns,a=>(b(),c("td",{key:a.key,style:x(A(a)),class:_(a.className)},[O(e.$slots,"cell",{column:a,record:t,value:N(t,a)},()=>[w(k(N(t,a)),1)],!0)],6))),128))],10,Aa))),128))])])],4)],4)],36)],512))}}),[["__scopeId","data-v-124032b7"]]),Da=le(s({__name:"VirtualDataTable",props:{columns:{},dataSource:{},loading:{type:Boolean,default:!1},rowKey:{},rowHeight:{type:[Number,Function],default:60},overscan:{default:10},pagination:{type:[Boolean,Object],default:!1},scroll:{},size:{default:"small"},customRow:{},onRow:{},rowClassName:{},className:{},style:{},forceVirtual:{type:Boolean,default:!1}},emits:["row-click","cell-click"],setup(e,{emit:t}){const a=e,n=t,r=l(()=>!!a.forceVirtual||a.dataSource.length>100&&(Ee.trackComponentRender("VirtualDataTable"),!0)),s=l(()=>a.columns.map(e=>({key:e.key||("string"==typeof e.dataIndex?e.dataIndex:e.dataIndex?.[0])||"",title:e.title,width:e.width,align:e.align,className:e.className}))),i=l(()=>{if("function"==typeof a.rowHeight)return a.rowHeight;return{small:48,middle:60,large:72}[a.size||"small"]||a.rowHeight});function o(e){if(n("row-click",e),a.customRow){const t=a.customRow(e);t&&"object"==typeof t&&"onClick"in t&&t.onClick()}}function u(e){if("function"==typeof a.rowClassName){const t=a.dataSource.indexOf(e);return a.rowClassName(e,t)}return a.rowClassName||""}const d=l(()=>{const e={};return a.customRow&&(e.customRow=a.customRow),a.onRow&&(e.onRow=a.onRow),a.rowClassName&&(e.rowClassName=a.rowClassName),e});return(e,t)=>(b(),c("div",{class:_(["virtual-data-table",{"virtual-enabled":r.value}])},[r.value?(b(),m(ja,{key:0,columns:s.value,"data-source":e.dataSource,"row-height":"function"==typeof i.value?void 0:i.value,"row-key":e.rowKey,overscan:e.overscan,"show-header":!0,"get-row-class":u,"min-height":e.scroll?.y?`${e.scroll.y}px`:"400px","max-height":e.scroll?.y?`${e.scroll.y}px`:"calc(100vh - 300px)",onRowClick:o},{cell:g(({column:t,record:a,value:l})=>[O(e.$slots,"bodyCell",{column:e.columns.find(e=>e.key===t.key||e.dataIndex===t.key),record:a,text:l,value:l,index:e.dataSource.indexOf(a)},()=>[w(k(l),1)],!0)]),_:3},8,["columns","data-source","row-height","row-key","overscan","min-height","max-height"])):(b(),m(v(pe),$({key:1},d.value,{columns:e.columns,"data-source":e.dataSource,loading:e.loading,pagination:e.pagination,scroll:e.scroll,size:e.size,"row-key":e.rowKey,"custom-row":e.customRow,"row-class-name":e.rowClassName,class:e.className,style:e.style}),{bodyCell:g(({column:t,record:a,text:l,value:n,index:r})=>[O(e.$slots,"bodyCell",{column:t,record:a,text:l,value:n,index:r},void 0,!0)]),_:3},16,["columns","data-source","loading","pagination","scroll","size","row-key","custom-row","row-class-name","class","style"]))],2))}}),[["__scopeId","data-v-2264c400"]]),za={class:"api-call-modal"},La={class:"modal-header"},qa={class:"modal-content"},Ua={class:"section"},Va={class:"info-grid"},Ha={class:"info-item"},Ba={class:"call-id"},Ka={class:"info-item"},Ga={class:"info-item"},Wa={key:0,class:"info-item"},Ja={class:"info-item"},Qa={key:1,class:"info-item"},Ya={key:2,class:"info-item"},Xa={key:3,class:"info-item"},Za={key:0,class:"info-item full-width"},el={key:1,class:"info-item full-width"},tl={class:"pattern-display"},al={class:"section"},ll={class:"variables-detail"},nl={class:"variable-value"},rl={key:0,class:"attributes-section"},sl={class:"attribute-items"},il={class:"section"},ol={class:"prompt-display"},ul={key:0,class:"section"},cl={key:0,class:"response-info"},dl={class:"info-grid"},pl={class:"info-item"},ml={class:"info-item"},vl={key:1,class:"result-content"},fl={key:0,class:"error-result"},gl={class:"error-message"},yl={key:0,class:"error-raw"},hl={class:"error-response"},bl={key:1,class:"content-result"},wl={class:"content-display"},_l={key:0,class:"parsed-content"},kl={class:"content-display parsed"},xl={key:1,class:"no-match-warning"},Cl={class:"warning-message"},Sl={class:"section"},Il={class:"raw-data"},Tl={key:1,class:"section"},Ol={class:"raw-data"},Pl={class:"modal-footer"},$l=le(s({__name:"APICallDetailModal",props:{apiCall:{},trial:{}},emits:["close"],setup(t){const a=t,n=l(()=>{if(!a.apiCall.request)return"No request data";let e;a.trial&&a.trial.configurationSnapshots[a.apiCall.configurationIndex]&&(e=a.trial.configurationSnapshots[a.apiCall.configurationIndex].provider);const t=ze(a.apiCall.request,e);return JSON.stringify(t,null,2)});function r(){if(!a.trial)return null;if(J(a.trial)||Q(a.trial)){const e=a.trial.extractPattern;if("string"==typeof e)return e;if(e&&"object"==typeof e&&"pattern"in e)return e.pattern}return null}function s(){if(!a.trial||!a.trial.configurationSnapshots[a.apiCall.configurationIndex])return null;const e=a.trial.configurationSnapshots[a.apiCall.configurationIndex];return`${e.provider} / ${e.modelId}`}function i(){return a.trial&&a.trial.configurationSnapshots[a.apiCall.configurationIndex]&&a.trial.configurationSnapshots[a.apiCall.configurationIndex].name||`Configuration ${a.apiCall.configurationIndex+1}`}function o(e){const t="string"==typeof e?new Date(e):e;return isNaN(t.getTime())?"Invalid date":t.toLocaleString()}async function u(){const e={id:a.apiCall.id,status:a.apiCall.status,configuration:i(),variables:a.apiCall.variables,variableAttributes:a.apiCall.variableAttributes,prompt:a.apiCall.prompt,request:JSON.parse(n.value),response:a.apiCall.response,result:a.apiCall.result,created:a.apiCall.created,completed:a.apiCall.completed},t=JSON.stringify(e,null,2);try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(t),void me.success("Details copied to clipboard!");const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();const a=document.execCommand("copy");if(document.body.removeChild(e),!a)throw new Error("execCommand failed");me.success("Details copied to clipboard!")}catch(l){Y.error("Failed to copy to clipboard",l),prompt("Copy this text manually:",t)}}return(t,l)=>{const m=f("a-button");return b(),c("div",{class:"modal-overlay",onClick:l[2]||(l[2]=E(e=>t.$emit("close"),["self"]))},[d("div",za,[d("div",La,[l[3]||(l[3]=d("h2",null,"API Call Details",-1)),d("button",{class:"close-btn",onClick:l[0]||(l[0]=e=>t.$emit("close")),"data-testid":"btn-close-api-call-modal","aria-label":"Close API call details"},"Ã—")]),d("div",qa,[d("div",Ua,[l[14]||(l[14]=d("h3",null,"Overview",-1)),d("div",Va,[d("div",Ha,[l[4]||(l[4]=d("label",null,"Call ID:",-1)),d("span",Ba,k(t.apiCall.id),1)]),d("div",Ka,[l[5]||(l[5]=d("label",null,"Status:",-1)),d("span",{class:_(["status-badge",t.apiCall.status])},k(t.apiCall.status),3)]),d("div",Ga,[l[6]||(l[6]=d("label",null,"Configuration:",-1)),d("span",null,k(i()),1)]),void 0!==t.apiCall.repeatIndex?(b(),c("div",Wa,[l[7]||(l[7]=d("label",null,"Repeat:",-1)),d("span",null,"#"+k(t.apiCall.repeatIndex+1),1)])):p("",!0),d("div",Ja,[l[8]||(l[8]=d("label",null,"Created:",-1)),d("span",null,k(o(t.apiCall.created)),1)]),t.apiCall.completed?(b(),c("div",Qa,[l[9]||(l[9]=d("label",null,"Completed:",-1)),d("span",null,k(o(t.apiCall.completed)),1)])):p("",!0),t.apiCall.completed?(b(),c("div",Ya,[l[10]||(l[10]=d("label",null,"Duration:",-1)),d("span",null,k((x=t.apiCall.completed.getTime()-t.apiCall.created.getTime(),x<1e3?`${x}ms`:`${(x/1e3).toFixed(1)}s`)),1)])):p("",!0),t.apiCall.response?.latencyMs?(b(),c("div",Xa,[l[11]||(l[11]=d("label",null,"API Latency:",-1)),d("span",null,k(t.apiCall.response.latencyMs)+"ms",1)])):p("",!0)]),s()?(b(),c("div",Za,[l[12]||(l[12]=d("label",null,"Provider/Model:",-1)),d("span",null,k(s()),1)])):p("",!0),r()?(b(),c("div",el,[l[13]||(l[13]=d("label",null,"Extraction Pattern:",-1)),d("code",tl,k(r()),1)])):p("",!0)]),d("div",al,[l[16]||(l[16]=d("h3",null,"Variables",-1)),d("div",ll,[(b(!0),c(y,null,h(Object.entries(t.apiCall.variables),([e,t])=>(b(),c("div",{key:e,class:"variable-item"},[d("label",null,k(e)+":",1),d("span",nl,k(t),1)]))),128))]),t.apiCall.variableAttributes&&Object.keys(t.apiCall.variableAttributes).length>0?(b(),c("div",rl,[l[15]||(l[15]=d("h4",null,"Variable Attributes",-1)),(b(!0),c(y,null,h(Object.entries(t.apiCall.variableAttributes),([e,t])=>(b(),c("div",{key:e,class:"attribute-group"},[d("h5",null,k(e),1),d("div",sl,[(b(!0),c(y,null,h(Object.entries(t),([e,t])=>(b(),c("div",{key:e,class:"attribute-item"},[d("label",null,k(e)+":",1),d("span",null,k(t),1)]))),128))])]))),128))])):p("",!0)]),d("div",il,[l[17]||(l[17]=d("h3",null,"Resolved Prompt",-1)),d("div",ol,k(t.apiCall.prompt),1)]),t.apiCall.response||t.apiCall.result?(b(),c("div",ul,[l[26]||(l[26]=d("h3",null,"Response",-1)),t.apiCall.response?(b(),c("div",cl,[d("div",dl,[d("div",pl,[l[18]||(l[18]=d("label",null,"HTTP Status:",-1)),d("span",null,k(t.apiCall.response.status),1)]),d("div",ml,[l[19]||(l[19]=d("label",null,"Latency:",-1)),d("span",null,k(t.apiCall.response.latencyMs)+"ms",1)])])])):p("",!0),t.apiCall.result?(b(),c("div",vl,[!1===t.apiCall.result.success?(b(),c("div",fl,[l[21]||(l[21]=d("h4",null,"Error",-1)),d("div",gl,k(t.apiCall.result.error),1),t.apiCall.response?(b(),c("div",yl,[l[20]||(l[20]=d("h5",null,"Raw Response:",-1)),d("pre",hl,k(JSON.stringify(t.apiCall.response,null,2)),1)])):p("",!0)])):p("",!0),t.apiCall.result.content?(b(),c("div",bl,[l[25]||(l[25]=d("h4",null,"Content",-1)),d("div",wl,k(t.apiCall.result.content),1),void 0!==t.apiCall.result.parsedContent&&t.apiCall.result.parsedContent!==t.apiCall.result.content?(b(),c("div",_l,[l[22]||(l[22]=d("h4",null,"Parsed Content",-1)),d("div",kl,k(t.apiCall.result.parsedContent),1)])):void 0!==t.apiCall.result.parsedContent||!a.trial||!J(a.trial)&&!Q(a.trial)||!a.trial.extractPattern?p("",!0):(b(),c("div",xl,[l[24]||(l[24]=d("h4",null,"Parsed Content",-1)),d("div",Cl,[e(v(St)),l[23]||(l[23]=w(" Pattern did not match any content "))])]))])):p("",!0)])):p("",!0)])):p("",!0),d("div",Sl,[l[27]||(l[27]=d("h3",null,"Raw Request",-1)),d("pre",Il,k(n.value),1)]),t.apiCall.response?(b(),c("div",Tl,[l[28]||(l[28]=d("h3",null,"Raw Response",-1)),d("pre",Ol,k(JSON.stringify(t.apiCall.response,null,2)),1)])):p("",!0)]),d("div",Pl,[e(m,{onClick:l[1]||(l[1]=e=>t.$emit("close")),size:"large",class:"footer-button","data-testid":"btn-close-modal-footer","aria-label":"Close modal"},{default:g(()=>l[29]||(l[29]=[w(" Close ")])),_:1,__:[29]}),e(m,{type:"primary",onClick:u,size:"large",class:"footer-button footer-button-primary","data-testid":"btn-copy-api-call-details","aria-label":"Copy API call details to clipboard"},{default:g(()=>l[30]||(l[30]=[w(" Copy Details ")])),_:1,__:[30]})])])]);var x}}}),[["__scopeId","data-v-292cc187"]]),El=new Map;function Ml(e,t={}){const n=a(0),r=Me.isEnabled("OPTIMIZED_SORTING"),s=l(()=>{n.value;const a=e.value;if(!a||0===a.length)return[];const l=t.compareFunction||((e,t)=>e<t?-1:e>t?1:0);t.trackPerformance&&Ee.start("optimizedSort");try{const e=t.cacheKey||(r?function(e,t){const a=e[0],l=e[e.length-1],n=e[Math.floor(e.length/2)];return`${e.length}-${JSON.stringify(a)?.slice(0,20)}-${JSON.stringify(n)?.slice(0,20)}-${JSON.stringify(l)?.slice(0,20)}-${t?.toString().slice(0,50)}`}(a,l):null);if(r&&e&&El.has(e)){const l=El.get(e);if(l.length===a.length){if(t.trackPerformance){const e=Ee.end("optimizedSort");Y.debug(`Sort cache hit: ${e}ms`)}return l}}const n=r?function(e,t,a){return e.length<32?function(e,t,a){const l=a?e:[...e];for(let n=1;n<l.length;n++){const e=l[n];let a=n-1;for(;a>=0&&t(l[a],e)>0;)l[a+1]=l[a],a--;l[a+1]=e}return l}(e,t,a):function(e,t){for(let a=1;a<e.length;a++)if(t(e[a-1],e[a])>0)return!1;return!0}(e,t)?a?e:[...e]:(a?e:[...e]).sort(t)}(a,l,!1):[...a].sort(l);if(r&&e&&(El.set(e,n),function(){if(El.size>100){const e=Math.floor(El.size/2),t=Array.from(El.keys());for(let a=0;a<e;a++)El.delete(t[a])}}()),t.trackPerformance){const e=Ee.end("optimizedSort");e>16&&Ee.logWarning(`Slow sort: ${e}ms for ${a.length} items`)}return n}catch(s){return t.trackPerformance&&Ee.end("optimizedSort"),Y.error("Sort error:",s),[...a]}});return{sorted:s,resort:function(){n.value++},clearCache:function(){if(t.cacheKey)El.delete(t.cacheKey);else if(e.value){const t=`${e.value.length}-`;Array.from(El.keys()).filter(e=>e.startsWith(t)).forEach(e=>El.delete(e))}n.value++}}}const Fl={class:"results-table-container"},Rl={class:"filters-bar"},Nl={key:0,class:"queue-position"},Al={key:1},jl={key:0,class:"repeat-index"},Dl={key:1,class:"text-secondary"},zl={key:3,class:"variables-compact"},Ll={key:0,class:"text-secondary"},ql={key:1,class:"text-secondary"},Ul={key:2,class:"text-error"},Vl={key:3,class:"response-content"},Hl={key:4,class:"text-secondary"},Bl={key:0,class:"parsed-response-content"},Kl={key:1,class:"text-warning"},Gl={key:2,class:"text-secondary"},Wl={key:0,class:"length-value"},Jl={key:1,class:"text-secondary"},Ql={key:0},Yl={key:1,class:"text-secondary"},Xl="trial-results-visible-columns",Zl=le(s({__name:"TrialResultsTable",props:{trial:{},apiCalls:{},loading:{type:Boolean}},setup(t){const n=t,r=a(""),s=a(""),_=a(""),x=function(e,t=300){const l=a(e.value);let n;const r=i(e,e=>{clearTimeout(n),n=window.setTimeout(()=>{l.value=e},t)});return M()&&u(()=>{clearTimeout(n),r()}),l}(_,300),C=a(!1),S=a(null),I=a(["parsedResponse"]),T=l(()=>{const e=n.trial.repeatConfig?.callsPerPrompt?96:80;return Me.isEnabled("SHALLOW_REACTIVITY")?e:e+16}),O=(e,t="medium")=>{const a=A.value/1920,l="high"===t?Math.max(.8,Math.min(1.2,a)):"low"===t?Math.max(.6,Math.min(1,a)):Math.max(.7,Math.min(1.1,a));return Math.round(e*l)},P=l(()=>{const e=[{title:"Status",key:"status",dataIndex:"status",width:O(120,"high"),fixed:A.value>1200?"left":void 0},{title:"Configuration",key:"config",dataIndex:"configurationIndex",width:O(200,"medium")}];return ve(n.trial)&&e.push({title:"Repeat",key:"repeat",dataIndex:"repeatIndex",width:O(100,"low")}),e.push({title:"Variables",key:"variables",dataIndex:"variables",width:O(300,"medium")},{title:"Response",key:"response",dataIndex:"result",width:O(400,"high")},{title:"Parsed Response",key:"parsedResponse",dataIndex:"result",width:O(300,"medium")},{title:"Length",key:"length",dataIndex:"result",width:O(120,"low"),align:"right"},{title:"Latency",key:"latency",dataIndex:"response",width:O(120,"low"),align:"right"}),e}),$=l(()=>P.value.filter(e=>!I.value.includes(e.key))),A=a(window.innerWidth),j=a(window.innerHeight);Fa(window,"resize",()=>{A.value=window.innerWidth,j.value=window.innerHeight});const D=l(()=>{const e=$.value.reduce((e,t)=>e+("number"==typeof t.width?t.width:parseInt(t.width||"200")),0),t=Math.max(400,j.value-350);return{x:Math.min(e,2*A.value),y:t}}),z=F([]),L=F([]);let q=0,U="";R(()=>{const e=n.apiCalls||[];if(e.length!==q)return q=e.length,void(L.value=e);let t=`${e.length}`;const a=Math.min(5,e.length),l=Math.max(1,Math.floor(e.length/a));for(let n=0;n<e.length;n+=l){const a=e[n];a&&(t+=`|${a.id}-${a.status}-${a.result?.success}-${a.response?.latencyMs}`)}t!==U&&(U=t,L.value=e)});const{sorted:V}=function(e,t={}){const a=e=>{switch(e){case"pending":return 1;case"running":return 2;case"completed":case"failed":return 3;default:return 4}};return Ml(e,{...t,compareFunction:(e,t)=>{const l=a(e.status),n=a(t.status);if(l!==n)return l-n;const r=e.created instanceof Date?e.created.getTime():new Date(e.created).getTime(),s=t.created instanceof Date?t.created.getTime():new Date(t.created).getTime();return"pending"===e.status?r-s:s-r},cacheKey:`apiCall-${e.value.length}-${e.value[0]?.id||""}-${e.value[e.value.length-1]?.id||""}`})}(L,{trackPerformance:Me.isEnabled("PERFORMANCE_MONITORING")}),H=l(()=>Me.isEnabled("OPTIMIZED_SORTING")?V.value:L.value);let B="";R(()=>{const e=H.value.slice(0,3).map(e=>`${e.id}-${e.status}`).join(","),t=`${r.value}|${s.value}|${x.value}|${H.value.length}|${e}`;if(t===B)return;B=t,Me.isEnabled("PERFORMANCE_MONITORING")&&Ee.start("filterApiCalls");let a=H.value;if(r.value&&(a=a.filter(e=>e.status===r.value)),""!==s.value&&(a=a.filter(e=>e.configurationIndex===Number(s.value))),x.value){const e=x.value.toLowerCase();a=a.filter(t=>{if(JSON.stringify(t.variables).toLowerCase().includes(e))return!0;if(t.result?.content){if(String(t.result.content).toLowerCase().includes(e))return!0}return!1})}if(z.value=a,Me.isEnabled("PERFORMANCE_MONITORING")){const e=Ee.end("filterApiCalls");e>16&&Ee.logWarning(`Slow filter operation: ${e}ms for ${n.apiCalls.length} items`)}});const K=l(()=>z.value);function G(e){const t=n.trial.configurationSnapshots[e];return t?.name||`Config ${e+1}`}return o(()=>{const e=localStorage.getItem(Xl);if(e)try{I.value=JSON.parse(e)}catch(t){console.error("Failed to load column preferences:",t),I.value=["parsedResponse"]}}),(t,a)=>{const l=f("a-select-option"),i=f("a-select"),o=f("a-input-search"),u=f("a-space"),x=f("a-button"),O=f("a-checkbox"),M=f("a-menu-item"),F=f("a-menu"),R=f("a-dropdown"),A=f("a-tag"),j=f("a-tooltip");return b(),c("div",Fl,[d("div",Rl,[e(u,{size:"large",style:{flex:"1"}},{default:g(()=>[e(i,{value:r.value,"onUpdate:value":a[0]||(a[0]=e=>r.value=e),placeholder:"All Statuses",style:{width:"200px"},size:"large","allow-clear":"","data-testid":"select-status-filter","aria-label":"Filter results by status"},{default:g(()=>[e(l,{value:""},{default:g(()=>a[7]||(a[7]=[w("All Statuses")])),_:1,__:[7]}),e(l,{value:"completed"},{default:g(()=>a[8]||(a[8]=[w("Completed")])),_:1,__:[8]}),e(l,{value:"failed"},{default:g(()=>a[9]||(a[9]=[w("Failed")])),_:1,__:[9]}),e(l,{value:"running"},{default:g(()=>a[10]||(a[10]=[w("Running")])),_:1,__:[10]}),e(l,{value:"pending"},{default:g(()=>a[11]||(a[11]=[w("Pending")])),_:1,__:[11]})]),_:1},8,["value"]),e(i,{value:s.value,"onUpdate:value":a[1]||(a[1]=e=>s.value=e),placeholder:"All Configurations",style:{width:"250px"},size:"large","allow-clear":"","data-testid":"select-config-filter","aria-label":"Filter results by configuration"},{default:g(()=>[e(l,{value:""},{default:g(()=>a[12]||(a[12]=[w("All Configurations")])),_:1,__:[12]}),(b(!0),c(y,null,h(t.trial.configurationSnapshots,(e,t)=>(b(),m(l,{key:`config-${e.name||t}`,value:t},{default:g(()=>[w(k(e.name||`Config ${t+1}`),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),e(o,{value:_.value,"onUpdate:value":a[2]||(a[2]=e=>_.value=e),placeholder:"Search variables or response...",style:{width:"400px",flex:"1"},size:"large","allow-clear":"","data-testid":"input-search-results","aria-label":"Search in variables or response content"},null,8,["value"])]),_:1}),e(u,null,{default:g(()=>[e(R,{trigger:["click"]},{overlay:g(()=>[e(F,{class:"column-visibility-menu"},{default:g(()=>[(b(!0),c(y,null,h(P.value,t=>(b(),m(M,{key:t.key,onClick:e=>function(e){const t=I.value.indexOf(e);t>-1?I.value.splice(t,1):I.value.push(e),localStorage.setItem(Xl,JSON.stringify(I.value))}(t.key)},{default:g(()=>[e(O,{checked:!I.value.includes(t.key),onClick:a[3]||(a[3]=E(()=>{},["prevent"]))},{default:g(()=>[w(k(t.title),1)]),_:2},1032,["checked"])]),_:2},1032,["onClick"]))),128))]),_:1})]),default:g(()=>[e(x,{size:"large","data-testid":"btn-column-visibility","aria-label":"Toggle column visibility"},{icon:g(()=>[e(v(fe))]),_:1})]),_:1}),e(x,{size:"large",type:"primary",onClick:a[4]||(a[4]=e=>C.value=!0),"data-testid":"btn-export-results-data","aria-label":"Export trial results data"},{icon:g(()=>[e(v(Ye))]),default:g(()=>[a[13]||(a[13]=w(" Export Data "))]),_:1,__:[13]})]),_:1})]),e(Da,{columns:$.value,"data-source":K.value,loading:t.loading,pagination:!1,scroll:D.value,size:"middle","row-key":"id",class:"results-table","custom-row":e=>({onClick:()=>{return t=e,void(S.value=t);var t},class:"clickable-row"}),"row-height":T.value,overscan:10,"force-virtual":!0},{bodyCell:g(({column:t,record:l})=>{return["status"===t.key?(b(),c(y,{key:0},[e(A,{color:(r=l.status,{completed:"success",failed:"error",running:"processing",pending:"default"}[r]||"default")},{default:g(()=>[w(k(l.status.toUpperCase()),1)]),_:2},1032,["color"]),"pending"===l.status&&l.queuePosition?(b(),c("span",Nl," #"+k(l.queuePosition)+" in queue ",1)):p("",!0)],64)):p("",!0),"config"===t.key?(b(),c("code",Al,k(G(l.configurationIndex)),1)):p("",!0),"repeat"===t.key?(b(),c(y,{key:2},[void 0!==l.repeatIndex?(b(),c("span",jl," #"+k(l.repeatIndex+1),1)):(b(),c("span",Dl,"-"))],64)):p("",!0),"variables"===t.key?(b(),c("div",zl,[(b(!0),c(y,null,h(l.variables,(t,a)=>(b(),m(j,{key:a},{title:g(()=>[w(k(a)+": "+k(t),1)]),default:g(()=>[e(A,null,{default:g(()=>{return[w(k(a)+": "+k((e=String(t),l=20,e.length<=l?e:e.substring(0,l)+"...")),1)];var e,l}),_:2},1024)]),_:2},1024))),128))])):p("",!0),"response"===t.key?(b(),c(y,{key:4},["pending"===l.status?(b(),c("div",Ll," Waiting... ")):"running"===l.status?(b(),c("div",ql,[e(v(re)),a[14]||(a[14]=w(" Processing... "))])):"failed"===l.status?(b(),c("div",Ul,k(l.result?.error||"API call failed"),1)):l.result?.content?(b(),c("div",Vl,k(String(l.result.content)),1)):(b(),c("div",Hl," No content "))],64)):p("",!0),"parsedResponse"===t.key?(b(),c(y,{key:5},[void 0!==l.result?.parsedContent?(b(),c("div",Bl,[d("span",null,k(String(l.result.parsedContent)),1)])):l.result?.content&&(J(n.trial)||Q(n.trial))&&n.trial.extractPattern?(b(),c("div",Kl,[e(j,{title:"Pattern did not match any content"},{default:g(()=>[e(v(St)),a[15]||(a[15]=w(" No match "))]),_:1,__:[15]})])):(b(),c("div",Gl," - "))],64)):p("",!0),"length"===t.key?(b(),c(y,{key:6},[l.result?.content?(b(),c("span",Wl,k(String(l.result.content).length),1)):(b(),c("span",Jl,"-"))],64)):p("",!0),"latency"===t.key?(b(),c(y,{key:7},[l.response?.latencyMs?(b(),c("span",Ql,k(l.response.latencyMs)+"ms ",1)):(b(),c("span",Yl,"-"))],64)):p("",!0)];var r}),_:1},8,["columns","data-source","loading","scroll","custom-row","row-height"]),C.value?(b(),m(N(()=>ge(()=>Promise.resolve().then(()=>$i),void 0,import.meta.url)),{key:0,trial:t.trial,"api-calls":K.value,onClose:a[5]||(a[5]=e=>C.value=!1)},null,40,["trial","api-calls"])):p("",!0),S.value?(b(),m($l,{key:1,"api-call":S.value,trial:t.trial,onClose:a[6]||(a[6]=e=>S.value=null)},null,8,["api-call","trial"])):p("",!0)])}}}),[["__scopeId","data-v-efd8f36f"]]),en={class:"stats-grid"},tn={class:"stat-item"},an={class:"stat-value"},ln={class:"stat-item"},nn={class:"stat-value"},rn={class:"stat-item"},sn={class:"stat-value"},on={class:"stat-item"},un={class:"stat-value"},cn={class:"detail-sections"},dn={class:"detail-row"},pn={class:"detail-value"},mn={class:"detail-value"},vn={class:"detail-value"},fn={key:0,class:"detail-row"},gn={key:0,class:"separator"},yn={key:1,class:"detail-row"},hn={class:"detail-value error"},bn={key:2,class:"detail-row"},wn={key:0,class:"separator"},_n={key:3,class:"detail-row"},kn={class:"detail-value"},xn={key:4,class:"detail-row"},Cn={key:5,class:"detail-section"},Sn={class:"template-preview"},In={key:0,class:"action-buttons"},Tn=le(s({__name:"TrialDetailView",props:{trial:{},compact:{type:Boolean}},setup(t){const r=t,s=n(),i=a(!1),o=l(()=>J(r.trial)?r.trial.templateName:r.trial.spreadsheetName),u=l(()=>ye(r.trial));function x(e,t){const a=t.getTime()-e.getTime(),l=Math.floor(a/36e5),n=Math.floor(a%36e5/6e4);return l>0?`${l}h ${n}m`:`${n}m`}async function C(){if(i.value)Y.warn("Trial start already in progress",{trialId:r.trial.id});else{i.value=!0;try{const e=await Ne.executeTrialWithConfirmation(r.trial.id);if(e.needsConfirmation&&e.runningTrial){if(!(await new Promise(t=>{be.confirm({title:"Another Trial is Running",content:`"${e.runningTrial.name}" is currently running. Starting this trial will pause it. Continue?`,onOk:()=>t(!0),onCancel:()=>t(!1)})})))return;await Ne.executeTrialWithConfirmation(r.trial.id,!0)}Y.info("Trial started",{trialId:r.trial.id})}catch(e){Y.error("Failed to start trial",e),be.error({title:"Failed to start trial",content:e instanceof Error?e.message:"Unknown error"})}finally{i.value=!1}}}function S(){s.push({name:"trials",query:{tab:"create",duplicate:r.trial.id,edit:"true"}})}return(t,a)=>{const l=f("a-button");return b(),c("div",{class:_(["trial-detail-view",{compact:t.compact}])},[d("div",en,[d("div",tn,[e(v(ne),{class:"stat-icon-inline"}),a[0]||(a[0]=d("span",{class:"stat-label"},"Duration:",-1)),d("span",an,k(x(t.trial.created,t.trial.completed||new Date)),1)]),d("div",ln,[e(v(je),{class:"stat-icon-inline"}),a[1]||(a[1]=d("span",{class:"stat-label"},"Cost:",-1)),d("span",nn,"$"+k((t.trial.estimatedCost||0).toFixed(2)),1)]),d("div",rn,[e(v(mt),{class:"stat-icon-inline"}),a[2]||(a[2]=d("span",{class:"stat-label"},"Models:",-1)),d("span",sn,k(t.trial.configurationSnapshots?.length||0),1)]),d("div",on,[e(v(he),{class:"stat-icon-inline"}),a[3]||(a[3]=d("span",{class:"stat-label"},"Design:",-1)),d("span",un,k(o.value),1)])]),d("div",cn,[d("div",dn,[a[4]||(a[4]=d("span",{class:"detail-label"},"Created:",-1)),d("span",pn,k(new Date(t.trial.created).toLocaleString()),1),a[5]||(a[5]=d("span",{class:"detail-label"},"Repeats:",-1)),d("span",mn,k(t.trial.repeatConfig?.callsPerPrompt||1)+"x",1),a[6]||(a[6]=d("span",{class:"detail-label"},"Variables:",-1)),d("span",vn,k((J(r.trial)&&r.trial.variableSnapshots.length>0?r.trial.variableSnapshots[0].originalListName:Q(r.trial)?r.trial.datasetName:null)||"None"),1)]),t.trial.configurationSnapshots?.length>0?(b(),c("div",fn,[a[7]||(a[7]=d("span",{class:"detail-label"},"Models:",-1)),(b(!0),c(y,null,h(t.trial.configurationSnapshots,(a,l)=>(b(),c("span",{key:`trial-config-${a.name}-${l}`,class:"model-inline"},[e(v(mt)),w(" "+k(a.name)+" ("+k(a.provider)+", temp: "+k(a.parameters?.temperature||.7)+") ",1),l<t.trial.configurationSnapshots.length-1?(b(),c("span",gn,"â€¢")):p("",!0)]))),128))])):p("",!0),t.trial.progress.networkErrors>0?(b(),c("div",yn,[a[8]||(a[8]=d("span",{class:"detail-label"},"Issues:",-1)),d("span",hn,k(t.trial.progress.networkErrors)+" network errors occurred",1)])):p("",!0),v(J)(t.trial)&&t.trial.variableSnapshots&&t.trial.variableSnapshots.length>0?(b(),c("div",bn,[a[9]||(a[9]=d("span",{class:"detail-label"},"Variables Used:",-1)),(b(!0),c(y,null,h(t.trial.variableSnapshots,(e,a)=>(b(),c("span",{key:e.variableName,class:"detail-value"},[d("strong",null,k(e.variableName),1),w(" from "+k(e.originalListName)+" ("+k(e.data.itemCount)+" values) ",1),a<t.trial.variableSnapshots.length-1?(b(),c("span",wn,"â€¢")):p("",!0)]))),128))])):p("",!0),v(Q)(t.trial)?(b(),c("div",_n,[a[10]||(a[10]=d("span",{class:"detail-label"},"Dataset:",-1)),d("span",kn,k(t.trial.datasetName)+" ("+k(t.trial.totalRows)+" rows)",1)])):p("",!0),"failed"===t.trial.status?(b(),c("div",xn,a[11]||(a[11]=[d("span",{class:"detail-label"},"Status:",-1),d("span",{class:"detail-value error"},"Trial failed - check task details for more information",-1)]))):p("",!0),u.value?(b(),c("div",Cn,[d("h4",null,[e(v(he)),a[12]||(a[12]=w(" Prompt Template"))]),d("div",Sn,[d("pre",null,k(u.value),1)])])):p("",!0)]),"draft"===t.trial.status?(b(),c("div",In,[i.value?(b(),m(l,{key:0,type:"primary",disabled:!0},{icon:g(()=>[e(v(re),{spin:""})]),default:g(()=>[a[13]||(a[13]=w(" Starting... "))]),_:1,__:[13]})):(b(),m(l,{key:1,type:"primary",onClick:C,disabled:i.value},{icon:g(()=>[e(v(se))]),default:g(()=>[a[14]||(a[14]=w(" Start Trial "))]),_:1,__:[14]},8,["disabled"])),e(l,{onClick:S},{icon:g(()=>[e(v(ce))]),default:g(()=>[a[15]||(a[15]=w(" Edit Configuration "))]),_:1,__:[15]})])):p("",!0)],2)}}}),[["__scopeId","data-v-039670f9"]]),On=t("taskMonitoring",()=>{const e=F([]),t=F([]);let a=null,n=null;const r=l(()=>{let t=0,a=0,l=0,n=0,r=0;for(const s of e.value)switch(s.status){case"pending":t++;break;case"claimed":case"running":a++;break;case"completed":l++;break;case"failed":n++;break;case"cancelled":r++}return{pending:t,running:a,completed:l,failed:n,cancelled:r,total:e.value.length}}),s=l(()=>{const e=t.value.filter(e=>"running"===e.status);return 0===e.length?null:(e.sort((e,t)=>(e.started?.getTime()||0)-(t.started?.getTime()||0)),e[0])}),i=l(()=>{const a=new Map,l=we.getAllGroups();for(const e of l)a.set(e,{provider:e,pending:0,running:0,completed:0,failed:0});for(const n of e.value){const e=t.value.find(e=>e.id===n.trialId);if(!e)continue;const l=e.configurationSnapshots[n.configurationIndex];if(!l)continue;const r=we.getProviderGroup(l.provider),s=a.get(r);if(s)switch(n.status){case"pending":s.pending++;break;case"claimed":case"running":s.running++;break;case"completed":s.completed++;break;case"failed":s.failed++}}return Array.from(a.values()).filter(e=>e.pending>0||e.running>0||e.completed>0||e.failed>0)});let o=0;return{allApiCalls:e,trials:t,globalStats:r,providerStats:i,activeTrial:s,getTrialStats:function(a){const l=e.value.filter(e=>e.trialId===a);let n=0,r=0,s=0,i=0;for(const e of l)switch(e.status){case"pending":n++;break;case"claimed":case"running":r++;break;case"completed":s++;break;case"failed":i++}let o=0;if(n>0){const l=t.value.find(e=>e.id===a);l&&l.created&&(o=e.value.filter(e=>{if("pending"!==e.status||e.trialId===a)return!1;const n=t.value.find(t=>t.id===e.trialId);return n&&n.created&&n.created<l.created}).length)}return{pending:n,running:r,completed:s,failed:i,total:l.length,queuePosition:o}},initialize:function(){o++,a||n?Y.debug("Task monitoring store already initialized",{count:o}):(a=qe(async()=>{const e=(await Z.trials.where("status").anyOf(["running","paused"]).toArray()).map(e=>e.id);if(0===e.length)return[];return(await Z.apiCalls.where("trialId").anyOf(e).toArray()).map(e=>({id:e.id,trialId:e.trialId,status:e.status,configurationIndex:e.configurationIndex}))}).subscribe({next:t=>{e.value=t},error:e=>{Y.error("Error in API calls subscription",e)}}),n=qe(()=>Z.trials.toArray()).subscribe({next:e=>{t.value=e},error:e=>{Y.error("Error in trials subscription",e)}}))},destroy:function(){o--,o>0?Y.debug("Task monitoring store still has references",{count:o}):(a&&(a.unsubscribe(),a=null),n&&(n.unsubscribe(),n=null),Y.debug("Task monitoring store destroyed"))}}});const Pn={debounce:100,onError:e=>Y.error("LiveDataConditional error:",e),trackPerformance:!1};function $n(e,t,n={}){const r={...Pn,...n},s=I(e)?e:l(e),o=F([]),c=a(!1),d=a(null);let p=null,m=null,v=!1;const f=()=>{m&&(clearTimeout(m),m=null),p&&(p.unsubscribe(),p=null)};i(s,(e,a)=>{e!==a&&(e?(()=>{if(v||!s.value)return o.value=[],c.value=!1,void(d.value=null);f(),c.value=!0;const e=qe(t);p=e.subscribe({next:e=>{v||(m&&clearTimeout(m),m=window.setTimeout(()=>{!v&&s.value&&(o.value=e||[],c.value=!1,d.value=null)},r.debounce))},error:e=>{if(v)return;const t=e instanceof Error?e:new Error(String(e));d.value=t,c.value=!1,r.onError(t)}})})():(f(),o.value=[],c.value=!1,d.value=null))},{immediate:!0});const g=()=>{v=!0,f()};return u(g),{data:o,loading:c,error:d,refresh:async()=>{if(s.value)try{c.value=!0,d.value=null;const e=await t();!v&&s.value&&(o.value=e||[])}catch(e){if(!v){const t=e instanceof Error?e:new Error(String(e));d.value=t,r.onError(t)}}finally{v||(c.value=!1)}},destroy:g}}const En={class:"header-left"},Mn={class:"console-title"},Fn={key:0,class:"event-count"},Rn={class:"header-actions"},Nn={key:0,class:"empty-console"},An={key:1,class:"event-list"},jn={class:"event-time"},Dn={class:"event-provider"},zn={class:"event-message"},Ln=le(s({__name:"TaskDebugConsole",props:{trialId:{},maxEvents:{default:100}},setup(t){const l=t,n=a(!0),r=a([]),s=a(),i=new Set,{data:x}=$e(l.trialId?()=>Z.apiCalls.where("trialId").equals(l.trialId).toArray():()=>Z.apiCalls.orderBy("created").reverse().limit(50).toArray(),{debounce:100}),{data:C}=Ue(()=>l.trialId?Z.trials.get(l.trialId):Promise.resolve(null),{debounce:100});function S(){if(!x.value)return;const e=[];for(const t of x.value){const a=`${t.id}-${t.status}`;if(i.has(a))continue;i.add(a);const l=I(t),n=t.prompt?t.prompt.substring(0,50)+"...":"No prompt";switch(t.status){case"pending":t.created.getTime()>Date.now()-5e3&&e.push({id:`${t.id}-queued`,timestamp:t.created,type:"queued",provider:l,message:`Task queued: "${n}"`,apiCallId:t.id});break;case"running":e.push({id:`${t.id}-started`,timestamp:new Date,type:"started",provider:l,message:`Task started: "${n}"`,apiCallId:t.id});break;case"completed":const a=t.completed?t.completed.getTime()-t.created.getTime():0;e.push({id:`${t.id}-completed`,timestamp:t.completed||new Date,type:"completed",provider:l,message:`Task completed in ${P(a)}: "${n}"`,apiCallId:t.id});break;case"failed":e.push({id:`${t.id}-failed`,timestamp:t.completed||new Date,type:"failed",provider:l,message:`Task failed: ${t.result?.error||"Unknown error"}`,apiCallId:t.id})}}e.length>0&&(r.value=[...e,...r.value].slice(0,l.maxEvents),D(()=>{s.value&&!n.value&&(s.value.scrollTop=s.value.scrollHeight)}))}function I(e){if(!C.value)return"unknown";const t=C.value.configurationSnapshots?.[e.configurationIndex];return t?.provider||"unknown"}function T(){n.value=!n.value}function O(){r.value=[],i.clear()}function P(e){return e<1e3?`${e}ms`:`${(e/1e3).toFixed(1)}s`}return o(()=>{S();const e=setInterval(S,500);u(()=>{clearInterval(e)})}),(t,a)=>{const l=f("a-button");return b(),c("div",{class:_(["task-debug-console",{collapsed:n.value}])},[d("div",{class:"console-header",onClick:T},[d("div",En,[e(v(Le),{class:_(["collapse-icon",{rotated:!n.value}])},null,8,["class"]),d("h3",Mn,[e(v(De)),a[0]||(a[0]=w(" Task Debug Console "))]),n.value?(b(),c("span",Fn," ("+k(r.value.length)+" events) ",1)):p("",!0)]),d("div",Rn,[n.value?p("",!0):(b(),m(l,{key:0,size:"small",type:"text",onClick:E(O,["stop"]),disabled:0===r.value.length},{default:g(()=>[e(v(Ge)),a[1]||(a[1]=w(" Clear "))]),_:1,__:[1]},8,["disabled"]))])]),A(d("div",{class:"console-content",ref_key:"consoleContent",ref:s},[0===r.value.length?(b(),c("div",Nn,a[2]||(a[2]=[d("span",{class:"empty-text"},"Waiting for task events...",-1)]))):(b(),c("div",An,[(b(!0),c(y,null,h(r.value,e=>{return b(),c("div",{key:e.id,class:_(["event-entry",`event-${e.type}`])},[d("span",jn,k((t=e.timestamp,`${t.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}.${t.getMilliseconds().toString().padStart(3,"0")}`)),1),d("span",Dn,"["+k(e.provider)+"]",1),d("span",zn,k(e.message),1)],2);var t}),128))]))],512),[[j,!n.value]])],2)}}}),[["__scopeId","data-v-8630c187"]]),qn={class:"header-left"},Un={class:"queue-title"},Vn={key:0,class:"mini-dashboard"},Hn={class:"mini-stat"},Bn={class:"mini-value"},Kn={class:"mini-stat"},Gn={class:"mini-value"},Wn={class:"mini-stat"},Jn={class:"mini-value"},Qn={class:"mini-stat error"},Yn={class:"mini-value"},Xn={class:"mini-stat active-trial"},Zn={class:"leader-status"},er={class:"expandable-content"},tr={key:0,class:"active-trial-banner"},ar={class:"active-text"},lr={class:"queue-stats-grid"},nr={class:"stat-card"},rr={class:"stat-value"},sr={class:"stat-card"},ir={class:"stat-value"},or={class:"stat-card"},ur={class:"stat-value"},cr={class:"stat-card"},dr={class:"stat-value"},pr={key:1,class:"provider-section"},mr={class:"section-subtitle"},vr={class:"provider-list"},fr={class:"provider-header"},gr={class:"provider-name"},yr={key:0,class:"provider-status"},hr={class:"provider-counts"},br={key:1,class:"provider-status"},wr={class:"concurrency-gauge"},_r={class:"gauge-label"},kr={class:"gauge-value"},xr={class:"gauge-info"},Cr={key:2,class:"trial-queue-section"},Sr={class:"trial-queue-stats"},Ir={class:"trial-stat"},Tr={class:"trial-stat-value"},Or={class:"debug-console-section"},Pr=le(s({__name:"QueueStatusPanelV2",props:{trialId:{},trial:{},compact:{type:Boolean,default:!1}},setup(t){const n=t,r=a(!1),s=a(!1);function i(){r.value=!r.value}o(async()=>{try{await we.waitForReady(),s.value=!0,Y.debug("Provider registry ready in QueueStatusPanel")}catch(e){Y.error("Failed to initialize provider registry",e)}});const{isLeader:x,queueStats:C,providerStats:S}=function(){const e=On(),t=_e();o(()=>{e.initialize()}),u(()=>{e.destroy()});const n=a(!1),r=a("");let s;const i=()=>{try{const e=ke.getQueueStats();n.value=e.hasLock,r.value=e.hasLock?e.tabId:"",e.hasLock&&(e.tabId,e.queuedTaskCount)}catch(e){}};o(()=>{i(),s=window.setInterval(i,500)}),u(()=>{s&&(clearInterval(s),s=void 0)});const c=l(()=>({pending:e.globalStats.pending,reserved:0,executing:e.globalStats.running,completed:e.globalStats.completed,failed:e.globalStats.failed,buried:e.globalStats.cancelled,total:e.globalStats.total})),d=l(()=>e.providerStats.map(e=>{let a=t.getGroupConcurrency(e.provider);if(void 0===a){const t=we.getProvidersInGroup(e.provider);a=1;for(const e of t)e.execution?.defaultConcurrency&&(a=Math.max(a,e.execution.defaultConcurrency))}const l=a>0?Math.round(e.running/a*100):0;return{provider:e.provider,pending:e.pending,executing:e.running,rateLimit:{tokens:a-e.running,requestsPerSecond:a,burstSize:a,utilization:l}}})),p=a({});return{isLeader:n,leaderId:r,queueStats:c,providerStats:d,rateLimits:p,getTrialQueueInfo:function(t){return l(()=>{const a=e.getTrialStats(t);return{position:a.queuePosition,pending:a.pending,executing:a.running,completed:a.completed}})},getTaskInfo:async function(e){},refreshStats:async function(){},refreshRateLimits:async function(){},destroy:function(){e.destroy()}}}(),{data:I}=$n(l(()=>!n.trialId),()=>Z.trials.where("status").equals("running").toArray(),{debounce:100}),T=l(()=>{if(n.trialId||!I.value||0===I.value.length)return null;return[...I.value].sort((e,t)=>(e.started?.getTime()||0)-(t.started?.getTime()||0))[0]}),O=l(()=>n.trialId||""),P=n.trialId?function(e){const t=On(),n=a([]),r=l(()=>{const a=t.getTrialStats(e.value);return{pending:a.pending,reserved:0,executing:a.running,completed:a.completed,failed:a.failed,buried:0,queuePosition:a.queuePosition}});return o(()=>{t.initialize()}),{tasks:n,stats:r,destroy:function(){}}}(O):null,$=l(()=>P?P.stats.value:{pending:0,executing:0,queuePosition:0}),E=l(()=>{if(n.trialId&&$.value){const e=n.trial?.progress||{completed:0,failed:0};return{pending:$.value.pending||0,executing:$.value.executing||0,completed:e.completed||0,failed:e.failed||0}}return C.value}),M=l(()=>{if(!n.trialId||!n.trial)return S.value;const e=new Set;return n.trial.configurationSnapshots&&s.value&&n.trial.configurationSnapshots.forEach(t=>{if(t.provider){const a=we.getProviderGroup(t.provider);e.add(t.provider),e.add(a)}}),S.value.filter(t=>e.has(t.provider)).map(e=>({...e,pending:0,executing:0,rateLimit:e.rateLimit}))});return(t,a)=>{const l=f("router-link"),n=f("a-tag"),s=f("a-progress");return b(),c("div",{class:_(["queue-status-panel",{collapsed:r.value}])},[d("div",{class:"queue-header",onClick:i},[d("div",qn,[e(v(Le),{class:_(["collapse-icon",{rotated:!r.value}])},null,8,["class"]),d("h3",Un,[e(v(xe)),w(" "+k(t.trialId?"Trial Progress":"Global Task Queue (All Trials)"),1)]),r.value?(b(),c("div",Vn,[d("span",Hn,[d("span",Bn,k(E.value.pending),1),a[0]||(a[0]=w(" pending "))]),a[6]||(a[6]=d("span",{class:"mini-divider"},"|",-1)),d("span",Kn,[d("span",Gn,k(E.value.executing),1),a[1]||(a[1]=w(" running "))]),a[7]||(a[7]=d("span",{class:"mini-divider"},"|",-1)),d("span",Wn,[d("span",Jn,k(E.value.completed),1),a[2]||(a[2]=w(" done "))]),E.value.failed>0?(b(),c(y,{key:0},[a[4]||(a[4]=d("span",{class:"mini-divider"},"|",-1)),d("span",Qn,[d("span",Yn,k(E.value.failed),1),a[3]||(a[3]=w(" failed "))])],64)):p("",!0),T.value&&!t.trialId?(b(),c(y,{key:1},[a[5]||(a[5]=d("span",{class:"mini-divider"},"|",-1)),d("span",Xn,[e(v(se)),w(" "+k(T.value.name),1)])],64)):p("",!0)])):p("",!0)]),d("div",Zn,[v(x)?(b(),c(y,{key:0},[e(v(Ce),{class:"leader-icon active"}),a[8]||(a[8]=d("span",{class:"leader-text"},"Queue Processor (Leader)",-1))],64)):(b(),c(y,{key:1},[e(v(Se),{class:"leader-icon"}),a[9]||(a[9]=d("span",{class:"leader-text"},"Observer",-1))],64))])]),A(d("div",er,[!t.trialId&&T.value?(b(),c("div",tr,[e(v(se),{class:"active-icon"}),d("span",ar,"Active Trial: "+k(T.value.name),1),e(l,{to:`/trials/${T.value.id}`,class:"active-link"},{default:g(()=>[a[10]||(a[10]=w(" View ")),e(v(Ie))]),_:1,__:[10]},8,["to"])])):p("",!0),d("div",lr,[d("div",nr,[d("div",rr,k(E.value.pending),1),a[11]||(a[11]=d("div",{class:"stat-label"},"Pending",-1))]),d("div",sr,[d("div",ir,k(E.value.executing),1),a[12]||(a[12]=d("div",{class:"stat-label"},"Executing",-1))]),d("div",or,[d("div",ur,k(E.value.completed),1),a[13]||(a[13]=d("div",{class:"stat-label"},"Completed",-1))]),d("div",cr,[d("div",dr,k(E.value.failed),1),a[14]||(a[14]=d("div",{class:"stat-label"},"Failed",-1))])]),M.value.length>0?(b(),c("div",pr,[d("h4",mr,k(t.trialId?"Trial Provider Status":"Provider Status"),1),d("div",vr,[(b(!0),c(y,null,h(M.value,l=>{return b(),c("div",{key:l.provider,class:"provider-item"},[d("div",fr,[d("span",gr,k(l.provider),1),t.trialId?(b(),c("div",br,[e(n,{color:"blue",size:"small"},{default:g(()=>a[15]||(a[15]=[w("Used by this trial")])),_:1,__:[15]})])):(b(),c("div",yr,[d("div",hr,[l.pending>0?(b(),m(n,{key:0,color:"blue"},{default:g(()=>[w(k(l.pending)+" pending ",1)]),_:2},1024)):p("",!0),l.executing>0?(b(),m(n,{key:1,color:"green"},{default:g(()=>[w(k(l.executing)+" running ",1)]),_:2},1024)):p("",!0)])]))]),d("div",wr,[d("div",_r,[a[16]||(a[16]=d("span",null,"Concurrency",-1)),d("span",kr,k(l.rateLimit.utilization)+"% slots used ",1)]),e(s,{percent:l.rateLimit.utilization,"stroke-color":(r=l.rateLimit.utilization,r<50?"#52c41a":r<80?"#faad14":"#f5222d"),"show-info":!1,size:"small"},null,8,["percent","stroke-color"]),d("div",xr,k(l.rateLimit.requestsPerSecond)+" max concurrent ",1)])]);var r}),128))])])):p("",!0),t.trialId?(b(),c("div",Cr,[a[18]||(a[18]=d("h4",{class:"section-subtitle"},"Additional Info",-1)),d("div",Sr,[d("div",Ir,[a[17]||(a[17]=d("span",{class:"trial-stat-label"},"Queue Position:",-1)),d("span",Tr,k($.value.queuePosition||"Processing"),1)])])])):p("",!0),d("div",Or,[e(Ln,{"trial-id":t.trialId,"max-events":50},null,8,["trial-id"])])],512),[[j,!r.value]])],2)}}}),[["__scopeId","data-v-9d8b5953"]]);function $r(e,t){const a=new Set,l=new Set,n=new Set;e.forEach(e=>{e.variables&&Object.keys(e.variables).forEach(e=>a.add(e)),e.variableAttributes&&Object.values(e.variableAttributes).forEach(e=>{e&&Object.keys(e).forEach(e=>l.add(e))})});const r=Array.from(a).sort(),s=Array.from(l).sort(),i=Array.from(n).sort(),o=[];t&&(J(t)||Q(t))&&t.extractPattern&&o.push("extracted_value");const u=["success","refused",...o,...i];return{categorical:[...r,...s,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens","extracted_value",...o].sort(),extracted:u}}function Er(e,t,a){switch(t){case"model":if(a&&e.configurationIndex<a.configurationSnapshots.length){return a.configurationSnapshots[e.configurationIndex].modelId||"Unknown"}return"Unknown";case"status":return e.status;case"response_time":return e.response?.latencyMs||0;case"total_tokens":if(e.response?.body?.usage){const t=e.response.body.usage;return t.total_tokens||t.prompt_tokens+t.completion_tokens||0}return 0;case"prompt_tokens":return e.response?.body?.usage?.prompt_tokens||e.response?.body?.usage?.input_tokens||0;case"completion_tokens":return e.response?.body?.usage?.completion_tokens||e.response?.body?.usage?.output_tokens||0;case"error_type":return e.result?.errorType||(!1===e.result?.success?"api_error":"success");case"success":return e.result?.success?1:0;case"refused":return e.result?.refused?1:0;case"extracted_value":if(e.result?.success&&void 0!==e.result?.content){const t=String(e.result.content),a=parseFloat(t);return isNaN(a)||t.trim()!==String(a)?t:a}return null}if(void 0!==e.variables?.[t])return e.variables[t];if(e.variableAttributes)for(const l of Object.keys(e.variableAttributes)){const a=e.variableAttributes[l];if(a&&void 0!==a[t])return a[t]}return null}const Mr={count:{label:"Count",calculate:e=>e.length,format:e=>e.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?t.reduce((e,t)=>e+t,0):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},mean:{label:"Mean",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?t.reduce((e,t)=>e+t,0)/t.length:null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},median:{label:"Median",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);if(0===t.length)return null;const a=[...t].sort((e,t)=>e-t),l=Math.floor(a.length/2);return a.length%2==0?(a[l-1]+a[l])/2:a[l]},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},mode:{label:"Mode",calculate:e=>{if(0===e.length)return null;const t=new Map;e.forEach(e=>t.set(e,(t.get(e)||0)+1));let a=0,l=null;return t.forEach((e,t)=>{e>a&&(a=e,l=t)}),{value:l,count:a,total:e.length}},format:e=>e?`${e.value} (${e.count}/${e.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);if(t.length<=1)return null;const a=t.reduce((e,t)=>e+t,0)/t.length;return t.reduce((e,t)=>e+Math.pow(t-a,2),0)/(t.length-1)},format:e=>e?.toFixed(3)||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:e=>{const t=Mr.variance.calculate(e);return null!==t?Math.sqrt(t):null},format:e=>e?.toFixed(3)||"-",needsNumeric:!0},min:{label:"Min",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?Math.min(...t):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},max:{label:"Max",calculate:e=>{const t=e.map(e=>"number"==typeof e?e:null).filter(e=>null!==e);return t.length>0?Math.max(...t):null},format:e=>e?.toFixed(2)||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(e,t)=>{const a=t.filter(e=>e.result?.success).length;return t.length>0?a/t.length:0},format:e=>`${Math.round(100*e)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(e,t)=>{const a=t.filter(e=>e.result?.refused).length;return t.length>0?a/t.length:0},format:e=>`${Math.round(100*e)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(e,t)=>{const a=t.filter(e=>e.response?.latencyMs).map(e=>e.response.latencyMs);return a.length>0?a.reduce((e,t)=>e+t,0)/a.length:null},format:e=>e?`${Math.round(e)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function Fr(e,t){if(!e||null===e.value)return"-";return Mr[t].format(e.value)}const Rr={"blue-subtle":{name:"Blue (Subtle)",colors:["rgba(59, 130, 246, 0.1)","rgba(59, 130, 246, 0.3)","rgba(59, 130, 246, 0.7)"]},"green-red":{name:"Green-Red",colors:["#dc2626","#fbbf24","#10b981"]},"blue-yellow":{name:"Blue-Yellow",colors:["#1e40af","#3b82f6","#fbbf24"]},"purple-orange":{name:"Purple-Orange",colors:["#7c3aed","#a855f7","#ff9500"]},grayscale:{name:"Grayscale",colors:["#f3f4f6","#9ca3af","#374151"]},viridis:{name:"Viridis",colors:["#440154","#482878","#3e4989","#31688e","#26828e","#1f9e89","#35b779","#6ece58","#b5de2b","#fde725"]},inferno:{name:"Inferno",colors:["#000004","#1b0c41","#4a0c6b","#781c6d","#a52c60","#cf4446","#ed6925","#fb9b06","#f7d13d","#fcffa4"]},magma:{name:"Magma",colors:["#000004","#180f3d","#440f76","#721f81","#9e2f7f","#cd4071","#f1605d","#fd9668","#feca8d","#fcfdbf"]},plasma:{name:"Plasma",colors:["#0d0887","#46039f","#7201a8","#9c179e","#bd3786","#d8576b","#ed7953","#fb9f3a","#fdca26","#f0f921"]}};function Nr(e,t){if(0===t.length)return"transparent";if(1===t.length)return t[0];e=Math.max(0,Math.min(1,e));const a=1/(t.length-1),l=Math.floor(e/a),n=e%a/a;return Ar(t[Math.min(l,t.length-1)],t[Math.min(l+1,t.length-1)],n)}function Ar(e,t,a){if(e.startsWith("rgba")&&t.startsWith("rgba")){const l=e=>{const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]*)\)/);return t?{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:t[4]?parseFloat(t[4]):1}:null},n=l(e),r=l(t);if(n&&r){return`rgba(${Math.round(n.r+(r.r-n.r)*a)}, ${Math.round(n.g+(r.g-n.g)*a)}, ${Math.round(n.b+(r.b-n.b)*a)}, ${(n.a+(r.a-n.a)*a).toFixed(2)})`}}if(e.startsWith("rgba")||t.startsWith("rgba"))return a<.5?e:t;const l=e.replace("#",""),n=t.replace("#",""),r=parseInt(l.substr(0,2),16),s=parseInt(l.substr(2,2),16),i=parseInt(l.substr(4,2),16),o=parseInt(n.substr(0,2),16),u=parseInt(n.substr(2,2),16),c=parseInt(n.substr(4,2),16),d=Math.round(r+(o-r)*a),p=Math.round(s+(u-s)*a),m=Math.round(i+(c-i)*a);return`#${d.toString(16).padStart(2,"0")}${p.toString(16).padStart(2,"0")}${m.toString(16).padStart(2,"0")}`}function jr(e){let t,a,l;if(e.startsWith("rgba")){const n=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]*)\)/);if(!n)return!1;t=parseInt(n[1]),a=parseInt(n[2]),l=parseInt(n[3])}else{const n="#"===e.charAt(0)?e.substring(1,7):e;t=parseInt(n.substring(0,2),16),a=parseInt(n.substring(2,4),16),l=parseInt(n.substring(4,6),16)}const n=[t/255,a/255,l/255].map(e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*n[0]+.7152*n[1]+.0722*n[2]<=.179}function Dr(e){return jr(e)?"#FFFFFF":"#000000"}function zr(e,t,a){const{colorScales:n,interpolateColor:r,getContrastColor:s}={colorScales:Rr,interpolateColor:Nr,interpolateBetweenColors:Ar,colorIsDarkAdvanced:jr,getContrastColor:Dr};function i(e){if("number"==typeof e)return e;if("string"==typeof e){const t=parseFloat(e);return isNaN(t)?null:t}return null}return{getCellStyle:function(l,o,u){if(!l||null===l.value||"number"!=typeof l.value)return{};const c=n[t.value];if(!c)return{};const d=function(t,l,n){const r=i(t.value);if(null===r)return.5;if("global"===a.value){const t=e.value.rows.flatMap(e=>e.cells).filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(t.length>0){const e=Math.min(...t),a=Math.max(...t);if(a!==e)return(r-e)/(a-e)}}else if("column"===a.value){const t=e.value.rows.map(e=>e.cells[n]).filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(t.length>0){const e=Math.min(...t),a=Math.max(...t);if(a!==e)return(r-e)/(a-e)}}else if("row"===a.value){const t=e.value.rows.find(e=>e.label===l);if(t){const e=t.cells.filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(e.length>0){const t=Math.min(...e),a=Math.max(...e);if(a!==t)return(r-t)/(a-t)}}}return.5}(l,o,u),p=r(d,c.colors);return{backgroundColor:`${p} !important`,color:`${s(p)} !important`,fontSize:"15px !important",fontWeight:"600 !important"}},getSummaryStyle:function(a){if(!a||null===a.value||"number"!=typeof a.value)return{};const l=n[t.value];if(!l)return{};let o=.5;const u=e.value.rows.flatMap(e=>e.cells).filter(e=>null!==e).map(e=>i(e.value)).filter(e=>null!==e);if(u.length>0){const e=Math.min(...u),t=Math.max(...u),l=i(a.value);null!==l&&(o=t!==e?(l-e)/(t-e):.5)}const c=r(o,l.colors);return{backgroundColor:`${c} !important`,color:`${s(c)} !important`,fontSize:"15px !important",fontWeight:"600 !important"}},styleKey:l(()=>`${t.value}-${a.value}`)}}const Lr={class:"pivot-config"},qr={class:"config-row"},Ur={class:"config-group"},Vr=["value","aria-label"],Hr={label:"Categorical"},Br=["value"],Kr={class:"config-group sort-group"},Gr=["value","aria-label"],Wr={class:"config-group"},Jr=["value","aria-label"],Qr={label:"Categorical"},Yr=["value"],Xr={class:"config-group sort-group"},Zr=["value","aria-label"],es={class:"config-group"},ts=["value","aria-label"],as={label:"Extracted Values"},ls=["value"],ns={label:"Numeric Fields"},rs=["value"],ss={class:"config-group"},is=["value","aria-label"],os=le(s({__name:"PivotConfiguration",props:{config:{},availableFields:{}},emits:["update-config"],setup(e,{emit:t}){const a=t;function l(e,t){a("update-config",e,t)}function n(e){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[e]||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}return(e,t)=>(b(),c("div",Lr,[d("div",qr,[d("div",Ur,[t[6]||(t[6]=d("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),d("select",{id:"pivot-row-field",value:e.config.rowField,"aria-label":"Group rows by "+n(e.config.rowField),onChange:t[0]||(t[0]=e=>l("rowField",e.target.value))},[d("optgroup",Hr,[(b(!0),c(y,null,h(e.availableFields.categorical,e=>(b(),c("option",{key:e,value:e},k(n(e)),9,Br))),128))])],40,Vr)]),d("div",Kr,[t[8]||(t[8]=d("label",{for:"pivot-row-sort"},"Sort Rows:",-1)),d("select",{id:"pivot-row-sort",value:e.config.rowSort||"original","aria-label":"Sort rows by "+(e.config.rowSort||"original")+" order",onChange:t[1]||(t[1]=e=>l("rowSort",e.target.value))},t[7]||(t[7]=[d("option",{value:"original"},"Original",-1),d("option",{value:"alpha"},"Alphabetical",-1)]),40,Gr)]),d("div",Wr,[t[9]||(t[9]=d("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),d("select",{id:"pivot-column-field",value:e.config.columnField,"aria-label":"Group columns by "+n(e.config.columnField),onChange:t[2]||(t[2]=e=>l("columnField",e.target.value))},[d("optgroup",Qr,[(b(!0),c(y,null,h(e.availableFields.categorical,e=>(b(),c("option",{key:e,value:e},k(n(e)),9,Yr))),128))])],40,Jr)]),d("div",Xr,[t[11]||(t[11]=d("label",{for:"pivot-column-sort"},"Sort Columns:",-1)),d("select",{id:"pivot-column-sort",value:e.config.columnSort||"original","aria-label":"Sort columns by "+(e.config.columnSort||"original")+" order",onChange:t[3]||(t[3]=e=>l("columnSort",e.target.value))},t[10]||(t[10]=[d("option",{value:"original"},"Original",-1),d("option",{value:"alpha"},"Alphabetical",-1)]),40,Zr)]),d("div",es,[t[12]||(t[12]=d("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),d("select",{id:"pivot-value-field",value:e.config.valueField,"aria-label":"Aggregate "+e.config.valueField+" values",onChange:t[4]||(t[4]=e=>l("valueField",e.target.value))},[d("optgroup",as,[(b(!0),c(y,null,h(e.availableFields.extracted,e=>(b(),c("option",{key:e,value:e},k(e),9,ls))),128))]),d("optgroup",ns,[(b(!0),c(y,null,h(e.availableFields.numeric,e=>(b(),c("option",{key:e,value:e},k(n(e)),9,rs))),128))])],40,ts)]),d("div",ss,[t[14]||(t[14]=d("label",{for:"pivot-aggregation"},"Aggregation:",-1)),d("select",{id:"pivot-aggregation",value:e.config.aggregation,"aria-label":"Aggregation method: "+e.config.aggregation,onChange:t[5]||(t[5]=e=>l("aggregation",e.target.value))},t[13]||(t[13]=[z('<optgroup label="Statistical" data-v-1a3408c6><option value="mean" data-v-1a3408c6>Mean</option><option value="median" data-v-1a3408c6>Median</option><option value="variance" data-v-1a3408c6>Variance</option><option value="std_dev" data-v-1a3408c6>Std Dev</option><option value="min" data-v-1a3408c6>Min</option><option value="max" data-v-1a3408c6>Max</option></optgroup><optgroup label="Frequency" data-v-1a3408c6><option value="count" data-v-1a3408c6>Count</option><option value="mode" data-v-1a3408c6>Mode</option></optgroup><optgroup label="Performance" data-v-1a3408c6><option value="success_rate" data-v-1a3408c6>Success Rate</option><option value="refusal_rate" data-v-1a3408c6>Refusal Rate</option><option value="avg_time" data-v-1a3408c6>Avg Time</option></optgroup>',3)]),40,is)])])]))}}),[["__scopeId","data-v-1a3408c6"]]),us={class:"heatmap-controls"},cs={class:"color-scale-selector"},ds=["value","aria-label"],ps={class:"gradient-mode-selector"},ms={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},vs=["aria-pressed"],fs=["aria-pressed"],gs=["aria-pressed"],ys=["title","aria-label"],hs=le(s({__name:"PivotHeatmapControls",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(e,{emit:t}){const a=t;function l(e){const t=e.target.value;a("update-color-scale",t)}function n(e){a("update-gradient-mode",e)}return(e,t)=>(b(),c("div",us,[d("div",cs,[t[5]||(t[5]=d("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),d("select",{id:"heatmap-color-scale",value:e.selectedColorScale,"aria-label":"Color scale: "+e.selectedColorScale,onChange:l},t[4]||(t[4]=[z('<option value="blue-subtle" data-v-4b4f9d62>Blue (Subtle)</option><option value="green-red" data-v-4b4f9d62>Green-Red (Success)</option><option value="blue-yellow" data-v-4b4f9d62>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-4b4f9d62>Purple-Orange (General)</option><option value="viridis" data-v-4b4f9d62>Viridis</option><option value="inferno" data-v-4b4f9d62>Inferno</option><option value="magma" data-v-4b4f9d62>Magma</option><option value="plasma" data-v-4b4f9d62>Plasma</option><option value="grayscale" data-v-4b4f9d62>Grayscale</option>',9)]),40,ds)]),d("div",ps,[t[6]||(t[6]=d("label",null,"Gradient Mode:",-1)),d("div",ms,[d("button",{type:"button",class:_(["toggle-btn",{active:"global"===e.gradientMode}]),"aria-pressed":"global"===e.gradientMode,onClick:t[0]||(t[0]=e=>n("global"))}," Global ",10,vs),d("button",{type:"button",class:_(["toggle-btn",{active:"column"===e.gradientMode}]),"aria-pressed":"column"===e.gradientMode,onClick:t[1]||(t[1]=e=>n("column"))}," Per Column ",10,fs),d("button",{type:"button",class:_(["toggle-btn",{active:"row"===e.gradientMode}]),"aria-pressed":"row"===e.gradientMode,onClick:t[2]||(t[2]=e=>n("row"))}," Per Row ",10,gs)])]),d("button",{type:"button",class:"fullscreen-btn",title:e.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":e.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:t[3]||(t[3]=t=>e.$emit("toggle-fullscreen"))},k(e.isFullscreen?"âŠŸ":"âŠž"),9,ys)]))}}),[["__scopeId","data-v-4b4f9d62"]]),bs={class:"filters-row"},ws={key:0,class:"filter-group"},_s=["value"],ks=["for"],xs=["id","onUpdate:modelValue","aria-label"],Cs={value:""},Ss=["value"],Is={key:1,class:"filter-group"},Ts=["value"],Os={class:"table-view"},Ps={key:0,class:"empty-state","data-testid":"empty-data-message"},$s={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},Es={key:2,class:"pivot-table-container"},Ms={class:"pivot-table-grid responsive-table",role:"table"},Fs={role:"row"},Rs={class:"corner-cell",role:"columnheader"},Ns={key:0,class:"total-header",role:"columnheader"},As={class:"row-header",role:"rowheader"},js=["data-testid","title","aria-label","role","onClick","onKeydown"],Ds={key:0,class:"cell-content"},zs=["title"],Ls={class:"cell-value"},qs={class:"error-message"},Us={key:1},Vs=le(s({__name:"PivotTableCore",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0}},emits:["config-change","cell-click"],setup(t,{emit:n}){const r=t,s=n,o=a(!1),m=a("viridis"),f=a("global"),g=a({rowField:r.config?.rowField||"",columnField:r.config?.columnField||"",valueField:r.config?.valueField||"",aggregation:r.config?.aggregation||"mean",rowSort:r.config?.rowSort||"original",columnSort:r.config?.columnSort||"original"});i(()=>r.config,e=>{e&&Object.assign(g.value,e)},{deep:!0});const w=a({}),C=a([]),S=l(()=>Object.values(w.value).some(e=>""!==e)),I=F($r(r.apiCalls,r.trial));let T=0;i(()=>r.apiCalls,e=>{if(0===e.length||0===T||e.length-T>=10){const t=C.value.length>0||S.value?C.value:e;I.value=$r(t,r.trial),T=e.length}},{immediate:!0});const O=F({});let P=0;i(()=>r.apiCalls.length,e=>{(0===e||0===P||e-P>=5)&&((()=>{if(0===r.apiCalls.length)return void(O.value={});const e={};r.apiCalls.forEach(t=>{if(r.trial&&t.configurationIndex<r.trial.configurationSnapshots.length){const a=r.trial.configurationSnapshots[t.configurationIndex].modelId||"Unknown";e.model||(e.model=new Set),e.model.add(a)}t.status&&(e.status||(e.status=new Set),e.status.add(t.status)),t.variables&&Object.entries(t.variables).forEach(([t,a])=>{a&&String(a).trim()&&(e[t]||(e[t]=new Set),e[t].add(String(a)))})});const t={};Object.entries(e).forEach(([e,a])=>{t[e]=Array.from(a).sort()}),O.value=t})(),P=e)},{immediate:!0});const $=l(()=>{const{model:e,status:t,...a}=O.value;return a});function M(){C.value=r.apiCalls.filter(e=>{if(w.value.model&&""!==w.value.model){if(!r.trial||e.configurationIndex>=r.trial.configurationSnapshots.length)return!1;if((r.trial.configurationSnapshots[e.configurationIndex].modelId||"Unknown")!==w.value.model)return!1}if(w.value.status&&""!==w.value.status&&e.status!==w.value.status)return!1;for(const[t,a]of Object.entries(w.value))if(a&&""!==a&&"model"!==t&&"status"!==t){const l=e.variables?.[t];if(l!==a)return!1}return!0})}function R(){w.value={},M()}i(()=>r.apiCalls,()=>{S.value?M():C.value=r.apiCalls},{immediate:!0});const N=l(()=>{const e=C.value.length>0||S.value?C.value:r.apiCalls;return 0===e.length?{rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}:function(e,t,a){const l=new Map,n=new Set,r=new Set;e.forEach(e=>{const s=String(Er(e,t.rowField,a)||"Unknown"),i=String(Er(e,t.columnField,a)||"Unknown");n.add(s),r.add(i),l.has(s)||l.set(s,new Map),l.get(s).has(i)||l.get(s).set(i,[]),l.get(s).get(i).push(e)});const s=e=>e.every(e=>!isNaN(Number(e))&&""!==e.trim())?e.sort((e,t)=>Number(e)-Number(t)):e.sort(),i=(e,t)=>{if(!a)return s(e);if(J(a)){const l=a.variableSnapshots?.find(e=>e.variableName===t);if(l?.data.values){const t=new Map(l.data.values.map((e,t)=>[String(e),t]));return e.sort((e,a)=>(t.get(e)??1/0)-(t.get(a)??1/0))}}if(Q(a)&&a.datasetSnapshot?.columns.includes(t)){const l=[],n=new Set;a.datasetSnapshot.rows.forEach(e=>{const a=String(e[t]||"");a&&!n.has(a)&&(l.push(a),n.add(a))});const r=new Map(l.map((e,t)=>[e,t]));return e.sort((e,t)=>(r.get(e)??1/0)-(r.get(t)??1/0))}return s(e)},o="original"===t.rowSort?i(Array.from(n),t.rowField):s(Array.from(n)),u="original"===t.columnSort?i(Array.from(r),t.columnField):s(Array.from(r)),c=Mr[t.aggregation];function d(e){const l=e.map(e=>Er(e,t.valueField,a));if(!c||"function"!=typeof c.calculate)return Y.error("Invalid aggregation function:",t.aggregation,c),{value:null,count:e.length,apiCalls:e,rawValues:l,error:"Invalid aggregation function"};const n={nonNumeric:0,nullUndefined:0};return c.needsNumeric&&(n.nonNumeric=l.filter(e=>"number"!=typeof e).length),n.nullUndefined=l.filter(e=>null==e).length,{value:c.usesApiCalls?c.calculate(l,e):c.calculate(l),count:e.length,apiCalls:e,rawValues:l,excludedCounts:n}}const p=o.map(e=>{const t=[],a=[];return u.forEach(n=>{const r=l.get(e)?.get(n)||[];t.push(r.length>0?d(r):null),a.push(...r)}),{label:e,cells:t,total:d(a)}}),m=u.map(e=>{const t=[];return o.forEach(a=>{const n=l.get(a)?.get(e)||[];t.push(...n)}),d(t)});return{rows:p,columns:u,totals:m,grandTotal:d(e)}}(e,g.value,r.trial)}),j=l(()=>N.value.rows),{getCellStyle:D,getSummaryStyle:z,styleKey:V}=zr(N,m,f);function H(e){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[e]||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function B(e,t,a){if(!a)return`${e} Ã— ${t}: No data`;let l=`${e} Ã— ${t}: ${Fr(a,g.value.aggregation)} (${a.count} calls)`;if(a.excludedCounts){const e=[];a.excludedCounts.nonNumeric>0&&e.push(`${a.excludedCounts.nonNumeric} non-numeric responses excluded`),a.excludedCounts.nullUndefined>0&&e.push(`${a.excludedCounts.nullUndefined} null/empty responses`),e.length>0&&(l+=` | ${e.join(", ")}`)}return a.error&&(l+=` - ERROR: ${a.error}`),l}function K(e,t,a){if(!a)return`${e} by ${t}: No data`;const l=Fr(a,g.value.aggregation);return a.error?`${e} by ${t}: ${l} with data integrity error: ${a.error}`:`${e} by ${t}: ${l} from ${a.count} API calls`}function G(e,t){"rowField"!==e&&"columnField"!==e&&"valueField"!==e&&"aggregation"!==e&&"rowSort"!==e&&"columnSort"!==e||(g.value[e]=t),s("config-change",{...g.value})}function W(e,t,a){a&&s("cell-click",{row:e,column:t,cell:a})}function X(){o.value=!o.value,o.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return u(()=>{o.value&&(document.body.style.overflow="")}),i([I,()=>r.apiCalls.length],([e])=>{if(r.apiCalls.length>0&&(!g.value.rowField||""===g.value.rowField)&&e.categorical.length>0){if(g.value.rowField=e.categorical.find(e=>"model"!==e&&"status"!==e&&"error_type"!==e)||e.categorical[0]||"model",g.value.columnField=g.value.columnField||"model",g.value.valueField=g.value.valueField||"extracted_value",!g.value.aggregation||""===g.value.aggregation){const e=r.apiCalls.slice(0,3).map(e=>Er(e,g.value.valueField,r.trial)).filter(e=>null!=e),t=e.length>0&&e.every(e=>"number"==typeof e);g.value.aggregation=t?"mean":"mode"}s("config-change",{...g.value})}},{immediate:!0}),(t,a)=>(b(),c("div",{class:_(["pivot-table-core",{fullscreen:o.value}])},[L([I.value,g.value],()=>(b(),c("div",null,[e(os,{config:g.value,"available-fields":I.value,onUpdateConfig:G},null,8,["config","available-fields"])])),a,0),e(hs,{"selected-color-scale":m.value,"gradient-mode":f.value,"is-fullscreen":o.value,onUpdateColorScale:a[1]||(a[1]=e=>m.value=e),onUpdateGradientMode:a[2]||(a[2]=e=>f.value=e),onToggleFullscreen:X},null,8,["selected-color-scale","gradient-mode","is-fullscreen"]),Object.keys(O.value).length>0?L([O.value,w.value],()=>(b(),c("div",{key:0,class:"data-filters"},[d("div",bs,[O.value.model&&O.value.model.length>1?(b(),c("div",ws,[a[7]||(a[7]=d("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),A(d("select",{id:"filter-model","onUpdate:modelValue":a[3]||(a[3]=e=>w.value.model=e),class:"filter-select","aria-label":"Filter by model",onChange:M},[a[6]||(a[6]=d("option",{value:""},"All Models",-1)),(b(!0),c(y,null,h(O.value.model,e=>(b(),c("option",{key:e,value:e},k(e),9,_s))),128))],544),[[U,w.value.model]])])):p("",!0),(b(!0),c(y,null,h($.value,(e,t)=>(b(),c("div",{key:t,class:"filter-group"},[d("label",{for:`filter-${t}`,class:"filter-label"},k(H(String(t)))+": ",9,ks),A(d("select",{id:`filter-${t}`,"onUpdate:modelValue":e=>w.value[t]=e,class:"filter-select","aria-label":`Filter by ${H(String(t))}`,onChange:M},[d("option",Cs,"All "+k(H(String(t))),1),(b(!0),c(y,null,h(e,e=>(b(),c("option",{key:e,value:e},k(e),9,Ss))),128))],40,xs),[[U,w.value[t]]])]))),128)),O.value.status&&O.value.status.length>1?(b(),c("div",Is,[a[9]||(a[9]=d("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),A(d("select",{id:"filter-status","onUpdate:modelValue":a[4]||(a[4]=e=>w.value.status=e),class:"filter-select","aria-label":"Filter by status",onChange:M},[a[8]||(a[8]=d("option",{value:""},"All Statuses",-1)),(b(!0),c(y,null,h(O.value.status,e=>(b(),c("option",{key:e,value:e},k(e),9,Ts))),128))],544),[[U,w.value.status]])])):p("",!0),S.value?(b(),c("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:R}," Clear Filters ")):p("",!0)])])),a,5):p("",!0),d("div",Os,[0===r.apiCalls.length?(b(),c("div",Ps,a[10]||(a[10]=[d("p",null,"No data available for pivot table analysis.",-1)]))):g.value.aggregation in v(Mr)?(b(),c("div",Es,[d("table",Ms,[d("thead",null,[d("tr",Fs,[d("th",Rs,k(H(g.value.rowField)||"Items")+" / "+k(H(g.value.columnField)||"Aggregated"),1),(b(!0),c(y,null,h(N.value.columns,e=>(b(),c("th",{key:e,class:"column-header",role:"columnheader"},k(e),1))),128)),g.value.columnField&&t.showTotals?(b(),c("th",Ns," Total ")):p("",!0)])]),d("tbody",null,[(b(!0),c(y,null,h(j.value,e=>(b(),c("tr",{key:`${e.label}-${v(V)}`,class:"data-row",role:"row"},[d("td",As,k(e.label),1),(b(!0),c(y,null,h(e.cells,(t,a)=>(b(),c("td",{key:`${a}-${v(V)}`,class:_(["data-cell",{"error-cell":t?.error}]),"data-testid":t?.error?"pivot-cell-error":"pivot-cell",style:x(v(D)(t,e.label,a)),title:B(e.label,N.value.columns[a],t),"aria-label":K(e.label,N.value.columns[a],t),role:t?.error?"alert":"cell",tabindex:"0",onClick:l=>W(e.label,N.value.columns[a],t),onKeydown:[q(l=>W(e.label,N.value.columns[a],t),["enter"]),q(E(l=>W(e.label,N.value.columns[a],t),["prevent"]),["space"])]},[t?.error?(b(),c("div",Ds,[d("span",{class:"error-indicator",title:t.error},"âš ï¸",8,zs),d("span",Ls,k(t?v(Fr)(t,g.value.aggregation):"-"),1),d("div",qs,k(t.error),1)])):(b(),c("span",Us,k(t?v(Fr)(t,g.value.aggregation):"-"),1))],46,js))),128)),g.value.columnField&&t.showTotals?(b(),c("td",{key:0,class:"total-cell",style:x(v(z)(e.total)),role:"cell"},k(v(Fr)(e.total,g.value.aggregation)),5)):p("",!0)]))),128)),g.value.rowField&&t.showTotals?(b(),c("tr",{key:`totals-${v(V)}`,class:"total-row",role:"row"},[a[12]||(a[12]=d("td",{class:"row-header",role:"rowheader"},"Total",-1)),(b(!0),c(y,null,h(N.value.totals,(e,t)=>(b(),c("td",{key:`total-${t}-${v(V)}`,class:"total-cell",style:x(v(z)(e)),role:"cell"},k(v(Fr)(e,g.value.aggregation)),5))),128)),g.value.columnField?(b(),c("td",{key:0,class:"grand-total-cell",style:x(v(z)(N.value.grandTotal)),role:"cell"},k(v(Fr)(N.value.grandTotal,g.value.aggregation)),5)):p("",!0)])):p("",!0)])])])):(b(),c("div",$s,[d("p",null,"Invalid aggregation function: "+k(g.value.aggregation),1),a[11]||(a[11]=d("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),[["__scopeId","data-v-e52c136d"]]),Hs={class:"summary-row"},Bs={key:0,class:"filter-row"},Ks=["title"],Gs=["title"],Ws=le(s({__name:"PivotCellDetailModal",props:{row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(t){const a=t,n=V({}),r=l(()=>{const e=new Set;return a.apiCalls.forEach(t=>{t.variables&&Object.keys(t.variables).forEach(t=>e.add(t)),t.attributedVariables&&Object.entries(t.attributedVariables).forEach(([t,a])=>{a&&"object"==typeof a&&Object.keys(a).forEach(a=>{e.add(`${t}.${a}`)})})}),Array.from(e).sort()}),s=l(()=>r.value.map(e=>({title:e,dataIndex:`var_${e}`,key:`var_${e}`,width:150,ellipsis:!0,sorter:(t,a)=>{const l=t[`var_${e}`]||"",n=a[`var_${e}`]||"";return l.localeCompare(n)}}))),i=[{title:"Status",dataIndex:"status",key:"status",width:100,fixed:"left",sorter:(e,t)=>e.status.localeCompare(t.status)},{title:"Model",dataIndex:"model",key:"model",width:150,ellipsis:!0,sorter:(e,t)=>e.model.localeCompare(t.model)}],o=[{title:"Response",dataIndex:"response",key:"response",width:300,ellipsis:!0},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150,ellipsis:!0,sorter:(e,t)=>(e.extracted||"").localeCompare(t.extracted||"")},{title:"Duration",dataIndex:"duration",key:"duration",width:100,sorter:(e,t)=>(parseInt(e.duration)||0)-(parseInt(t.duration)||0)},{title:"Cost",dataIndex:"cost",key:"cost",width:100,sorter:(e,t)=>(e.cost||0)-(t.cost||0)}],u=l(()=>[...i,...s.value,...o]),v=l(()=>`${a.row} Ã— ${a.column} - ${a.apiCalls.length} API Calls`),_=l(()=>a.apiCalls.map(e=>{const t={id:e.id,status:e.status,model:e.model||"-",response:e.result?.content||e.result?.error||"-",extracted:e.extracted||"-",duration:e.duration?`${e.duration}ms`:"-",cost:e.cost||0};return r.value.forEach(a=>{if(a.includes(".")){const[l,n]=a.split("."),r=e.attributedVariables?.[l]?.[n];t[`var_${a}`]=void 0!==r?String(r):"-"}else t[`var_${a}`]=e.variables?.[a]||"-"}),t})),x=l(()=>Object.values(n).some(e=>void 0!==e&&""!==e)),C=l(()=>x.value?_.value.filter(e=>Object.entries(n).every(([t,a])=>!a||e[t]===a)):_.value),S=l(()=>{const e=a.apiCalls.filter(e=>"completed"===e.status).length;return Math.round(e/a.apiCalls.length*100)}),I=l(()=>{const e=a.apiCalls.filter(e=>e.duration).map(e=>e.duration);return 0===e.length?0:Math.round(e.reduce((e,t)=>e+t,0)/e.length)}),T=l(()=>a.apiCalls.filter(e=>e.cost).map(e=>e.cost).reduce((e,t)=>e+t,0).toFixed(4));function O(e){switch(e){case"completed":return"success";case"failed":return"error";case"pending":return"warning";case"running":return"processing";default:return"default"}}function P(e){const t=new Set;return _.value.forEach(a=>{const l=a[e];l&&"-"!==l&&t.add(l)}),Array.from(t).sort()}function $(){}function E(){Object.keys(n).forEach(e=>{delete n[e]})}return(t,a)=>{const l=f("a-select-option"),r=f("a-select"),i=f("a-button"),o=f("a-tag"),_=f("a-table"),M=f("a-modal");return b(),m(M,{open:!0,width:"98vw",footer:null,title:v.value,onCancel:a[0]||(a[0]=e=>t.$emit("close")),"body-style":{padding:"16px",height:"90vh",display:"flex",flexDirection:"column"},class:"pivot-cell-detail-modal"},{default:g(()=>[d("div",Hs,[d("span",null,[a[1]||(a[1]=d("b",null,"Total:",-1)),w(" "+k(t.apiCalls.length),1)]),d("span",null,[a[2]||(a[2]=d("b",null,"Success Rate:",-1)),w(" "+k(S.value)+"%",1)]),d("span",null,[a[3]||(a[3]=d("b",null,"Avg Duration:",-1)),w(" "+k(I.value)+"ms",1)]),d("span",null,[a[4]||(a[4]=d("b",null,"Total Cost:",-1)),w(" $"+k(T.value),1)])]),s.value.length>0?(b(),c("div",Bs,[(b(!0),c(y,null,h(s.value,t=>(b(),c("div",{key:t.key,class:"variable-filter"},[e(r,{value:n[t.key],"onUpdate:value":e=>n[t.key]=e,placeholder:`Filter ${t.title}`,allowClear:"",style:{width:"150px"},size:"small",onChange:$},{default:g(()=>[(b(!0),c(y,null,h(P(t.key),e=>(b(),m(l,{key:e,value:e},{default:g(()=>[w(k(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])]))),128)),x.value?(b(),m(i,{key:0,size:"small",onClick:E},{default:g(()=>a[5]||(a[5]=[w("Clear Filters")])),_:1,__:[5]})):p("",!0)])):p("",!0),e(_,{columns:u.value,"data-source":C.value,scroll:{x:1500,y:"calc(90vh - 140px)"},pagination:!1,size:"small","row-key":e=>e.id,class:"api-calls-table"},{bodyCell:g(({column:e,record:t})=>{return["status"===e.key?(b(),m(o,{key:0,color:O(t.status),style:{margin:"0"}},{default:g(()=>[w(k(t.status),1)]),_:2},1032,["color"])):"response"===e.key?(b(),c("span",{key:1,class:"response-cell",title:t.response},k((a=t.response,l=100,a?a.length<=l?a:a.slice(0,l)+"...":"")),9,Ks)):"cost"===e.key?(b(),c(y,{key:2},[w(k(0===t.cost?"-":`$${t.cost.toFixed(4)}`),1)],64)):e.key.startsWith("var_")?(b(),c("span",{key:3,class:"variable-cell",title:t[e.key]},k(t[e.key]||"-"),9,Gs)):p("",!0)];var a,l}),_:1},8,["columns","data-source","row-key"])]),_:1},8,["title"])}}}),[["__scopeId","data-v-d1eba3c3"]]),Js={class:"trial-tab-content"},Qs={class:"tab-content status-tab-content"},Ys={class:"status-scroll-container"},Xs={key:0,class:"queue-status-section"},Zs={class:"tab-content task-view-tab"},ei={class:"tab-content pivot-tab-content"},ti={class:"pivot-scroll-container"},ai={class:"pivot-container"},li={key:1,class:"empty-state"},ni=le(s({__name:"TrialTabContent",props:{trial:{},apiCalls:{},loading:{type:Boolean}},setup(t){const n=t,r=a("status"),s=a({rowField:"",columnField:"model",valueField:"success",aggregation:"mean"}),i=a(!1),o=a({row:"",column:"",apiCalls:[],value:0}),u=l(()=>[...n.apiCalls].sort((e,t)=>{if("running"===e.status&&"running"!==t.status)return-1;if("running"!==e.status&&"running"===t.status)return 1;const a=e.completed||e.created||new Date(0);return(t.completed||t.created||new Date(0)).getTime()-a.getTime()})),v=e=>{s.value=e},y=e=>{if(!e.cell)return;const t=e.cell.apiCalls||[];0!==t.length&&(o.value={row:e.row,column:e.column,apiCalls:t,value:e.cell.value},i.value=!0)};return(t,a)=>{const l=f("a-tab-pane"),n=f("a-tabs");return b(),c("div",Js,[e(n,{activeKey:r.value,"onUpdate:activeKey":a[0]||(a[0]=e=>r.value=e),class:"detail-tabs","tab-bar-style":{marginBottom:0}},{default:g(()=>[e(l,{key:"status",tab:"Status"},{default:g(()=>[d("div",Qs,[d("div",Ys,[e(Tn,{trial:t.trial,compact:!1},null,8,["trial"]),"running"===t.trial.status||"paused"===t.trial.status?(b(),c("div",Xs,[a[2]||(a[2]=d("h3",{class:"section-title"},"Queue Status",-1)),e(Pr,{"trial-id":t.trial.id,trial:t.trial,compact:!1},null,8,["trial-id","trial"])])):p("",!0)])])]),_:1}),e(l,{key:"tasks",tab:"Task View"},{default:g(()=>[d("div",Zs,[e(Zl,{trial:t.trial,"api-calls":u.value,loading:t.loading},null,8,["trial","api-calls","loading"])])]),_:1}),e(l,{key:"pivot",tab:"Pivot Table"},{default:g(()=>[d("div",ei,[d("div",ti,[d("div",ai,[t.apiCalls.length>0?(b(),m(Vs,{key:0,"api-calls":t.apiCalls,trial:t.trial,config:s.value,"show-totals":!0,onConfigChange:v,onCellClick:y},null,8,["api-calls","trial","config"])):(b(),c("div",li,a[3]||(a[3]=[d("p",null,"No data available for pivot table analysis.",-1)])))])])])]),_:1})]),_:1},8,["activeKey"]),i.value?(b(),m(Ws,{key:0,row:o.value.row,column:o.value.column,"api-calls":o.value.apiCalls,trial:t.trial,value:o.value.value,onClose:a[1]||(a[1]=e=>i.value=!1)},null,8,["row","column","api-calls","trial","value"])):p("",!0)])}}}),[["__scopeId","data-v-a19f2231"]]),ri={class:"modal-content"},si={class:"modal-header"},ii={class:"modal-body"},oi={class:"section"},ui={class:"format-options"},ci=["data-testid","aria-label"],di=["value","data-testid","aria-label"],pi={class:"format-label"},mi={class:"format-name"},vi={class:"section"},fi={class:"field-groups"},gi=["data-testid"],yi={class:"field-list"},hi=["data-testid","aria-label"],bi=["value","data-testid","aria-label"],wi={class:"field-label"},_i={class:"field-name"},ki={class:"field-desc"},xi={class:"section"},Ci={class:"preview-info"},Si={class:"preview-count"},Ii={class:"preview-fields"},Ti={class:"preview-size"},Oi={class:"modal-footer"},Pi=le(s({__name:"ExportDataModal",props:{trial:{},apiCalls:{}},emits:["close"],setup(t){const n=t,r=[{id:"csv",name:"CSV",description:"Comma-separated values (Excel compatible)"},{id:"tsv",name:"TSV",description:"Tab-separated values"},{id:"excel",name:"Excel",description:"Microsoft Excel (.xlsx)"},{id:"json",name:"JSON",description:"JavaScript Object Notation"},{id:"jsonl",name:"JSONL",description:"JSON Lines (one object per line)"}],s=[{name:"Basic Info",fields:[{id:"id",name:"ID",description:"API call identifier",default:!0},{id:"trial_id",name:"Trial ID",description:"Parent trial identifier",default:!0},{id:"trial_name",name:"Trial Name",description:"Human-readable trial name",default:!0},{id:"status",name:"Status",description:"Call status (completed, failed, etc.)",default:!0},{id:"created",name:"Created",description:"When the call was initiated",default:!0},{id:"completed",name:"Completed",description:"When the call finished",default:!0}]},{name:"Configuration",fields:[{id:"configuration_index",name:"Config Index",description:"Configuration array index",default:!1},{id:"configuration_name",name:"Config Name",description:"Human-readable config name",default:!1},{id:"provider",name:"Provider",description:"LLM service provider",default:!0},{id:"model",name:"Model",description:"Model identifier",default:!0},{id:"parameters",name:"Parameters",description:"Model parameters as separate columns (temperature, max_tokens, etc.)",default:!0}]},{name:"Content",fields:[{id:"prompt",name:"Prompt",description:"Input prompt text",default:!0},{id:"variables",name:"Variables",description:"Variable substitutions (flattened as separate columns)",default:!0},{id:"result_content",name:"Result Content",description:"LLM response content",default:!0},{id:"result_error",name:"Result Error",description:"Error message if failed",default:!0}]},{name:"Performance",fields:[{id:"response_latency_ms",name:"Latency (ms)",description:"Response time",default:!0},{id:"duration_ms",name:"Duration (ms)",description:"Total processing time",default:!1},{id:"result_success",name:"Success",description:"Whether call succeeded",default:!0}]},{name:"Technical Details",fields:[{id:"request_url",name:"Request URL",description:"API endpoint URL",default:!0},{id:"request_method",name:"Request Method",description:"HTTP method",default:!1},{id:"request_headers",name:"Request Headers",description:"HTTP request headers",default:!1},{id:"request_body",name:"Request Body",description:"Full request payload",default:!1},{id:"response_status",name:"Response Status",description:"HTTP status code",default:!0},{id:"response_headers",name:"Response Headers",description:"HTTP response headers",default:!1},{id:"response_body",name:"Response Body",description:"Full response payload",default:!1}]},{name:"Error Handling",fields:[{id:"network_error_count",name:"Network Errors",description:"Number of network failures",default:!1},{id:"retry_count",name:"Retry Count",description:"Number of retry attempts",default:!1}]}],i=a("csv"),o=a([]),u=s.flatMap(e=>e.fields);o.value=u.filter(e=>e.default).map(e=>e.id);const p=l(()=>{const e=50*o.value.length,t=n.apiCalls.length*e;return t<1024?`${t}B`:t<1048576?`${(t/1024).toFixed(1)}KB`:`${(t/1048576).toFixed(1)}MB`});function m(){o.value=u.map(e=>e.id)}function v(){o.value=u.filter(e=>e.default).map(e=>e.id)}function _(){o.value=[]}function x(e){const t=new Set(["model","messages","prompt","stream","user"]),a={};for(const[l,n]of Object.entries(e))t.has(l)||(a[l]=n);return a}function C(e,t=""){const a={};for(const[l,n]of Object.entries(e)){const e=t?`${t}.${l}`:l;null===n||"object"!=typeof n||Array.isArray(n)?a[e]=Array.isArray(n)?JSON.stringify(n):n:Object.assign(a,C(n,e))}return a}function S(){const e=new Set,t=[];if(Q(n.trial)){const{columns:a}=n.trial.datasetSnapshot;t.push(...a),a.forEach(t=>e.add(t))}o.value.includes("variables")&&n.apiCalls.forEach(a=>{a.variables&&"object"==typeof a.variables&&Object.keys(a.variables).forEach(a=>{e.has(a)||(e.add(a),t.push(a))})});const a=new Set,l=[];return o.value.includes("parameters")&&n.apiCalls.forEach(e=>{if(e.request?.body){const t=C(x(e.request.body));Object.keys(t).forEach(e=>{a.has(e)||(a.add(e),l.push(e))})}}),n.apiCalls.map((e,a)=>{const r={};var s,i;if(Q(n.trial)&&(r.Row=a+1),o.value.includes("id")&&(r.ID=e.id),o.value.includes("trial_id")&&(r["Trial ID"]=e.trialId),o.value.includes("trial_name")&&(r["Trial Name"]=n.trial.name),o.value.includes("status")&&(r.Status=e.status),o.value.includes("created")&&(r.Created=e.created?new Date(e.created).toISOString():""),o.value.includes("completed")&&(r.Completed=e.completed?new Date(e.completed).toISOString():""),o.value.includes("configuration_index")&&(r["Configuration Index"]=e.configurationIndex),o.value.includes("configuration_name")&&(r["Configuration Name"]=(s=e.configurationIndex,n.trial.configurationSnapshots[s]&&n.trial.configurationSnapshots[s].name||`Config ${s+1}`)),o.value.includes("provider")&&(r.Provider=n.trial.configurationSnapshots?.[e.configurationIndex]?.provider||(i=e,i.request?.url?.includes("openai.com")?"OpenAI":i.request?.url?.includes("anthropic.com")?"Anthropic":i.request?.url?.includes("openrouter.ai")?"OpenRouter":i.request?.url?.includes("localhost:11434")?"Ollama":"Unknown")),o.value.includes("model")&&(r.Model=n.trial.configurationSnapshots?.[e.configurationIndex]?.modelId||function(e){return e.request?.body?.model?e.request.body.model:"Unknown"}(e)),o.value.includes("prompt")&&(r.Prompt=e.prompt),o.value.includes("variables"))for(const l of t)r[l]=e.variables?.[l]||"";if(o.value.includes("result_content")&&(r["Result Content"]=e.result?.content||""),o.value.includes("result_error")&&(r["Result Error"]=e.result?.error||""),o.value.includes("response_latency_ms")&&(r["Response Latency (ms)"]=e.response?.latencyMs||""),o.value.includes("duration_ms")){const t=e.created?new Date(e.created).getTime():0,a=e.completed?new Date(e.completed).getTime():0;r["Duration (ms)"]=t&&a?a-t:""}if(o.value.includes("result_success")&&(r["Result Success"]=e.result?.success||!1),o.value.includes("request_url")&&(r["Request URL"]=e.request?.url||""),o.value.includes("request_method")&&(r["Request Method"]=e.request?.method||""),o.value.includes("request_headers")&&(r["Request Headers"]=JSON.stringify(e.request?.headers||{})),o.value.includes("request_body")&&(r["Request Body"]=JSON.stringify(e.request?.body||{})),o.value.includes("response_status")&&(r["Response Status"]=e.response?.status||""),o.value.includes("response_headers")&&(r["Response Headers"]=JSON.stringify(e.response?.headers||{})),o.value.includes("response_body")&&(r["Response Body"]=JSON.stringify(e.response?.body||{})),o.value.includes("network_error_count")&&(r["Network Error Count"]=0),o.value.includes("retry_count")&&(r["Retry Count"]=0),o.value.includes("parameters")&&l.length>0)if(e.request?.body){const t=x(e.request.body),n=C(t);a<3&&Y.debug("Export parameters debug",{callId:e.id,requestBody:e.request.body,extractedParams:t,flatParams:n,parameterOrder:l});for(const e of l){r[`param.${e}`]=void 0!==n[e]?n[e]:""}}else for(const t of l){r[`param.${t}`]=""}return void 0!==e.repeatIndex&&(r.Repeat=e.repeatIndex+1,r["Repeat Group"]=e.repeatGroupId),r})}async function I(){const e=S(),t=(new Date).toISOString().split("T")[0],a=`${n.trial.name}_${i.value}_${t}`;try{switch(i.value){case"csv":!function(e,t){if(0===e.length)return;const a=Object.keys(e[0]||{}),l=[a.join(","),...e.map(e=>a.map(t=>`"${String(e[t]??"").replace(/"/g,'""')}"`).join(","))].join("\n");T(l,`${t}.csv`,"text/csv")}(e,a);break;case"tsv":!function(e,t){if(0===e.length)return;const a=Object.keys(e[0]||{}),l=[a.join("\t"),...e.map(e=>a.map(t=>String(e[t]||"").replace(/\t/g," ")).join("\t"))].join("\n");T(l,`${t}.tsv`,"text/tab-separated-values")}(e,a);break;case"excel":await async function(e,t){const a=await ge(()=>import("./xlsx-C4WhbwXR.js"),[],import.meta.url),l=a.utils.book_new(),n=a.utils.json_to_sheet(e),r=Object.keys(e[0]||{}),s=r.map(e=>({wch:Math.min(Math.max(e.length,10),50)}));n["!cols"]=s,a.utils.book_append_sheet(l,n,"Trial Results"),a.writeFile(l,`${t}.xlsx`)}(e,a);break;case"json":!function(e,t){const a=JSON.stringify(e,null,2);T(a,`${t}.json`,"application/json")}(e,a);break;case"jsonl":!function(e,t){const a=e.map(e=>JSON.stringify(e)).join("\n");T(a,`${t}.jsonl`,"application/jsonl")}(e,a)}}catch(l){Y.error("Export failed",l),me.error("Export failed: "+(l instanceof Error?l.message:"Unknown error"))}}function T(e,t,a){let l=e;"text/csv"!==a&&"text/tab-separated-values"!==a||(l="\ufeff"+e);const n=new Blob([l],{type:`${a};charset=utf-8`}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}return(t,a)=>{const l=f("a-button");return b(),c("div",{class:"modal-overlay",onClick:a[4]||(a[4]=E(e=>t.$emit("close"),["self"]))},[d("div",ri,[d("div",si,[a[5]||(a[5]=d("h3",null,"Export Trial Data",-1)),d("button",{onClick:a[0]||(a[0]=e=>t.$emit("close")),class:"close-btn","data-testid":"btn-close-export-modal","aria-label":"Close export modal"},"Ã—")]),d("div",ii,[d("div",oi,[a[6]||(a[6]=d("h4",null,"Export Format",-1)),d("div",ui,[(b(),c(y,null,h(r,e=>d("label",{key:e.id,class:"format-option","data-testid":`label-format-${e.id}`,"aria-label":`Export as ${e.name} format`},[A(d("input",{type:"radio",value:e.id,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),class:"format-radio","data-testid":`radio-format-${e.id}`,"aria-label":`Select ${e.name} format`},null,8,di),[[H,i.value]]),d("span",pi,[d("span",mi,k(e.name),1)])],8,ci)),64))])]),d("div",vi,[d("h4",null,[a[7]||(a[7]=w(" Fields to Export ")),d("div",{class:"field-controls"},[d("button",{onClick:m,class:"control-btn","data-testid":"btn-select-all-fields","aria-label":"Select all export fields"},"Select All"),d("button",{onClick:v,class:"control-btn","data-testid":"btn-select-default-fields","aria-label":"Select default export fields"},"Defaults"),d("button",{onClick:_,class:"control-btn","data-testid":"btn-select-no-fields","aria-label":"Deselect all export fields"},"Select None")])]),d("div",fi,[(b(),c(y,null,h(s,e=>d("div",{key:e.name,class:"field-group","data-testid":`field-group-${e.name.toLowerCase().replace(/\s+/g,"-")}`},[d("h5",null,k(e.name),1),d("div",yi,[(b(!0),c(y,null,h(e.fields,e=>(b(),c("label",{key:e.id,class:"field-option","data-testid":`label-field-${e.id}`,"aria-label":`Include ${e.name} in export`},[A(d("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":a[2]||(a[2]=e=>o.value=e),class:"field-checkbox","data-testid":`checkbox-field-${e.id}`,"aria-label":`Select ${e.name} field for export`},null,8,bi),[[B,o.value]]),d("span",wi,[d("span",_i,k(e.name),1),d("span",ki,k(e.description),1)])],8,hi))),128))])],8,gi)),64))])]),d("div",xi,[a[8]||(a[8]=d("h4",null,"Export Preview",-1)),d("div",Ci,[d("span",Si,k(t.apiCalls.length)+" records",1),d("span",Ii,k(o.value.length)+" fields",1),d("span",Ti,"~"+k(p.value),1)])])]),d("div",Oi,[e(l,{onClick:a[3]||(a[3]=e=>t.$emit("close")),size:"large",class:"footer-button","data-testid":"btn-cancel-export","aria-label":"Cancel export"},{default:g(()=>a[9]||(a[9]=[w(" Cancel ")])),_:1,__:[9]}),e(l,{type:"primary",onClick:I,disabled:0===o.value.length,size:"large",class:"footer-button footer-button-primary","data-testid":"btn-confirm-export","data-format":i.value,"aria-label":`Export data as ${i.value.toUpperCase()}`},{default:g(()=>[w(" Export "+k(i.value.toUpperCase()),1)]),_:1},8,["disabled","data-format","aria-label"])])])])}}}),[["__scopeId","data-v-4705d0fc"]]),$i=Object.freeze(Object.defineProperty({__proto__:null,default:Pi},Symbol.toStringTag,{value:"Module"}));function Ei(e,t={}){const{embedded:l=!1,providedApiCalls:n}=t,r=F(n||[]),s=a(!0),o=a(null);let c=null;return i(e,(e,t)=>{e!==t&&(c&&(c.unsubscribe(),c=null),l&&!n&&e?(async e=>{s.value=!0,o.value=null;try{if(n)return r.value=n,void(s.value=!1);c=qe(()=>Z.apiCalls.where("trialId").equals(e).toArray()).subscribe({next:e=>{r.value=e,s.value=!1},error:t=>{Y.error("Error loading API calls",t,{component:"useTrialApiCalls",trialId:e}),o.value=t instanceof Error?t:new Error("Failed to load API calls"),s.value=!1}})}catch(t){Y.error("Error setting up API calls subscription",t,{component:"useTrialApiCalls",trialId:e}),o.value=t instanceof Error?t:new Error("Failed to setup API calls subscription"),s.value=!1}})(e):s.value=!1)},{immediate:!0}),u(()=>{c&&c.unsubscribe()}),{apiCalls:r,loading:s,error:o}}const Mi={class:"trial-details-panel"},Fi={key:0,class:"empty-details"},Ri={class:"empty-illustration"},Ni={key:1,class:"trial-details"},Ai={class:"details-header-fixed"},ji={class:"details-content-tabbed"},Di=le(s({__name:"TrialDetailsPanel",emits:["create-trial"],setup(t){const r=Tt(),s=n(),i=a(!1),o=a(null),u=a([]),h=a(!1),_=l(()=>r.selectedTrial),k=l(()=>_.value?.id||void 0),{apiCalls:x,loading:C}=Ei(k,{embedded:!0});async function S(){if(_.value)try{await Ne.pauseTrial(_.value.id),Y.info("Trial paused",{trialId:_.value.id})}catch(e){Y.error("Failed to pause trial",e),be.error({title:"Failed to pause trial",content:e instanceof Error?e.message:"Unknown error"})}}async function I(){if(_.value&&!h.value){h.value=!0;try{const e=await Ne.getRunningTrials();e.length>0?be.confirm({title:"Another trial is already running",content:`The trial "${e[0].name}" is currently running. Resuming this trial will pause it. Do you want to continue?`,okText:"Yes, resume this trial",cancelText:"No, keep current trial",onOk:async()=>{try{await Ne.resumeTrial(_.value.id),Y.info("Trial resumed",{trialId:_.value.id})}catch(e){Y.error("Failed to resume trial",e),be.error({title:"Failed to resume trial",content:e instanceof Error?e.message:"Unknown error"})}finally{h.value=!1}},onCancel:()=>{h.value=!1}}):(await Ne.resumeTrial(_.value.id),Y.info("Trial resumed",{trialId:_.value.id}),h.value=!1)}catch(e){Y.error("Failed to check running trials",e),be.error({title:"Failed to resume trial",content:e instanceof Error?e.message:"Unknown error"}),h.value=!1}}}async function T(){_.value&&be.confirm({title:"Cancel Trial?",content:"Are you sure you want to cancel this trial? This action cannot be undone.",okText:"Cancel Trial",okType:"danger",cancelText:"Keep Running",onOk:async()=>{try{await Ne.cancelTrial(_.value.id),Y.info("Trial cancelled",{trialId:_.value.id})}catch(e){Y.error("Failed to cancel trial",e),be.error({title:"Failed to cancel trial",content:e instanceof Error?e.message:"Unknown error"})}}})}async function O(){await async function(){if(!_.value)return;try{const{PythonExportService:e}=await ge(async()=>{const{PythonExportService:e}=await Promise.resolve().then(()=>Vi);return{PythonExportService:e}},void 0,import.meta.url),t=e.validateTrialForExport(_.value);if(!t.valid)return void be.error({title:"Cannot export trial",content:t.errors.join("\n")});const a=await e.generatePythonScript(_.value,{mode:"simple"}),l=new Blob([a],{type:"text/x-python"}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=`auditomatic_${_.value.name.replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.py`,r.click(),URL.revokeObjectURL(n),Y.info("Trial exported",{trialId:_.value.id})}catch(e){Y.error("Failed to export trial",e),be.error({title:"Failed to export trial",content:e instanceof Error?e.message:"Unknown error"})}}()}async function P(){if(!_.value)return;const e=await Z.apiCalls.where("trialId").equals(_.value.id).toArray();i.value=!0,o.value=_.value,u.value=e}function $(){_.value&&s.push({name:"trials",query:{tab:"create",duplicate:_.value.id}})}function E(){_.value&&s.push({name:"trials",query:{tab:"create",duplicate:_.value.id,edit:"true"}})}async function M(){_.value&&be.confirm({title:"Delete Trial?",content:`Are you sure you want to delete "${_.value.name}"? This action cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{try{await Ne.deleteTrial(_.value.id),r.selectTrial(null),Y.info("Trial deleted",{trialId:_.value.id})}catch(e){Y.error("Failed to delete trial",e),be.error({title:"Failed to delete trial",content:e instanceof Error?e.message:"Unknown error"})}}})}return(t,a)=>{const l=f("a-button");return b(),c(y,null,[d("div",Mi,[_.value?(b(),c("div",Ni,[d("div",Ai,[e(Ca,{trial:_.value},null,8,["trial"]),e(Ia,{trial:_.value,"is-resuming":h.value,onPauseTrial:S,onResumeTrial:I,onCancelTrial:T,onExportData:P,onExportPython:O,onDuplicateTrial:$,onEditTrial:E,onDeleteTrial:M},null,8,["trial","is-resuming"])]),d("div",ji,[e(ni,{trial:_.value,"api-calls":v(x),loading:v(C)},null,8,["trial","api-calls","loading"])])])):(b(),c("div",Fi,[d("div",Ri,[e(v(Te),{style:{"font-size":"64px",color:"var(--color-primary-alpha)"}})]),a[3]||(a[3]=d("h3",null,"Select a trial to view details",-1)),a[4]||(a[4]=d("p",null,"Choose from the list or create a new one",-1)),e(l,{type:"primary",class:"create-trial-button-large",onClick:a[0]||(a[0]=e=>t.$emit("create-trial"))},{icon:g(()=>[e(v(ee))]),default:g(()=>[a[2]||(a[2]=w(" Create New Trial "))]),_:1,__:[2]})]))]),i.value?(b(),m(Pi,{key:0,trial:o.value,"api-calls":u.value,onClose:a[1]||(a[1]=e=>i.value=!1)},null,8,["trial","api-calls"])):p("",!0)],64)}}}),[["__scopeId","data-v-94edbb3a"]]);class zi{static generate(e){const t=this.extractData(e);return this.generateScript(t,e.name)}static extractData(e){const t=e.configurationSnapshots.map(e=>({provider:e.provider,modelId:e.modelId,displayName:e.name,parameters:e.parameters})),a=new Set(t.map(e=>e.provider)),l={};for(const n of a){const e=we.getProvider(n);e&&(l[n]=this.buildProviderConfig(n,e))}if(Q(e)){const{columns:a,rows:n}=e.datasetSnapshot;return{trialType:"spreadsheet",experiment:{promptTemplate:e.promptPattern,dataset:{columns:a,rows:n}},models:t,providerConfigs:l}}if(J(e)){const a={};return e.variableSnapshots.forEach(e=>{"simple"===e.category&&e.data.values?a[e.variableName]=e.data.values:"attributed"===e.category&&e.data.items&&(a[e.variableName]=e.data.items.map(e=>e.value))}),{trialType:"template",experiment:{promptTemplate:e.template,variables:a},models:t,providerConfigs:l}}throw new Error("Unknown trial type for export")}static buildProviderConfig(e,t){const a=t.requestTransform||{},l=t.auth||{type:"none"};let n="direct";"messages"===a.promptKey&&a.wrapPrompt?n="messages":"input"===a.promptKey&&(n="input");let r,s,i="root";"ollama-chat"===e?(i="options",r={max_tokens:"num_predict",max_completion_tokens:"num_predict"}):"ollama-generate"===e&&(i="mixed",s={root:["model","prompt","stream","format","raw"],options:["temperature","num_predict","top_k","top_p"]},r={max_tokens:"num_predict",max_completion_tokens:"num_predict"});const o=Object.values(t.responseModes||{})[0],u=this.parseResponsePath(o?.responseTransform?.contentPath),c=o?.responseTransform?.fallbackPaths?.map(e=>this.parseResponsePath(e)),d=t.api.baseUrl+(t.api.endpoints.chat||t.api.endpoints.generate||"");return{name:t.name,endpoint:d,auth:{type:l.type,header:l.header,prefix:"bearer"===l.type?"Bearer":void 0},headers:t.headers,request:{modelPrefixStrip:!0,promptFormat:n,messageRole:a.messageRole,paramLocation:i,paramRenames:r,mixedParams:s},response:{successPath:u,fallbackPaths:c,errorPath:["error","message"]}}}static parseResponsePath(e){return e?e.split(/[\.\[\]]/).filter(Boolean).map(e=>{const t=parseInt(e);return isNaN(t)?e:t}):["content"]}static generateScript(e,t){const a=(new Date).toISOString(),l=JSON.stringify(e.models,null,4),n=JSON.stringify(e.providerConfigs,null,4),r="template"===e.trialType?`"variables": ${JSON.stringify(e.experiment.variables,null,4)}`:`"dataset": ${JSON.stringify(e.experiment.dataset,null,4)}`;return`#!/usr/bin/env python3\n"""\nAI Model Testing Script - Simple Mode\n=====================================\nGenerated by Auditomatic Lite v${Oe.short} on ${a}\n\nThis script reproduces your experiment by generating API calls from variables.\nPerfect for understanding, modifying, and extending your experiments.\n\nOriginal trial: ${t}\n"""\n\nimport os\nimport json\nimport time\nimport requests\nimport pandas as pd\nfrom datetime import datetime\nfrom typing import Dict, List, Any, Optional\n\n# === CONFIGURATION ===\n\n# API Keys - Add your keys here or set as environment variables\nAPI_KEYS = {\n${Object.keys(e.providerConfigs).map(e=>{const t=e.split("-")[0].toUpperCase();return`    "${e}": os.environ.get("${t}_API_KEY", ""),`}).join("\n")}\n}\n\n# Your experiment design\nEXPERIMENT = {\n    "trial_type": "${e.trialType}",\n    "prompt_template": "${e.experiment.promptTemplate.replace(/"/g,'\\"')}",\n    ${r}\n}\n\n# Models to test\nMODELS = ${l}\n\n# Provider configurations (how to talk to each API)\nPROVIDER_CONFIGS = ${n}\n\n# Output settings\nOUTPUT_FORMAT = "csv"  # Options: csv, excel, json, parquet, html, markdown, stata, pickle\n\n# === IMPLEMENTATION ===\n\ndef make_api_call(provider_id: str, model: str, prompt: str, params: dict) -> dict:\n    """\n    Universal API caller that handles all provider quirks.\n    \n    Returns dict with 'success', 'content', 'error', and timing info.\n    """\n    config = PROVIDER_CONFIGS[provider_id]\n    \n    # Build headers\n    headers = {"Content-Type": "application/json"}\n    \n    # Add authentication\n    auth = config["auth"]\n    if auth["type"] == "bearer":\n        api_key = API_KEYS.get(provider_id, "")\n        if not api_key:\n            return {"success": False, "error": f"No API key for {provider_id}"}\n        headers[auth["header"]] = f"{auth['prefix']} {api_key}"\n    elif auth["type"] == "header":\n        api_key = API_KEYS.get(provider_id, "")\n        if not api_key:\n            return {"success": False, "error": f"No API key for {provider_id}"}\n        headers[auth["header"]] = api_key\n    \n    # Add provider-specific headers\n    if config.get("headers"):\n        headers.update(config["headers"])\n    \n    # Build request body\n    request = config["request"]\n    \n    # Strip provider prefix from model\n    if request.get("modelPrefixStrip"):\n        model = model.split(":", 1)[-1]\n    \n    body = {"model": model}\n    \n    # Format prompt\n    if request["promptFormat"] == "messages":\n        body["messages"] = [{"role": request.get("messageRole", "user"), "content": prompt}]\n    elif request["promptFormat"] == "direct":\n        body["prompt"] = prompt\n    elif request["promptFormat"] == "input":\n        body["input"] = prompt\n    \n    # Handle parameters\n    processed_params = params.copy()\n    \n    # Apply renames\n    if request.get("paramRenames"):\n        for old_key, new_key in request["paramRenames"].items():\n            if old_key in processed_params:\n                processed_params[new_key] = processed_params.pop(old_key)\n    \n    # Place parameters\n    if request["paramLocation"] == "root":\n        body.update(processed_params)\n    elif request["paramLocation"] == "options":\n        body["options"] = processed_params\n    elif request.get("mixedParams"):\n        mixed = request["mixedParams"]\n        for key, value in processed_params.items():\n            if key in mixed.get("root", []):\n                body[key] = value\n            else:\n                if "options" not in body:\n                    body["options"] = {}\n                body["options"][key] = value\n    \n    # Make request\n    start_time = time.time()\n    try:\n        response = requests.post(\n            config["endpoint"],\n            headers=headers,\n            json=body,\n            timeout=30\n        )\n        latency_ms = (time.time() - start_time) * 1000\n        \n        if response.ok:\n            data = response.json()\n            content = extract_from_path(data, config["response"]["successPath"])\n            \n            # Try fallback paths\n            if content is None and config["response"].get("fallbackPaths"):\n                for path in config["response"]["fallbackPaths"]:\n                    content = extract_from_path(data, path)\n                    if content is not None:\n                        break\n            \n            return {\n                "success": True,\n                "content": content or "",\n                "latency_ms": latency_ms,\n                "status_code": response.status_code\n            }\n        else:\n            return {\n                "success": False,\n                "error": f"HTTP {response.status_code}: {response.text[:200]}",\n                "latency_ms": latency_ms,\n                "status_code": response.status_code\n            }\n            \n    except Exception as e:\n        return {\n            "success": False,\n            "error": str(e),\n            "latency_ms": (time.time() - start_time) * 1000\n        }\n\ndef extract_from_path(data: Any, path: List[Any]) -> Optional[str]:\n    """Extract value from nested data using a path like ['choices', 0, 'message', 'content']"""\n    try:\n        current = data\n        for key in path:\n            if isinstance(current, dict):\n                current = current[key]\n            elif isinstance(current, list):\n                current = current[int(key)]\n            else:\n                return None\n        return str(current) if current is not None else None\n    except (KeyError, IndexError, TypeError):\n        return None\n\ndef generate_prompts():\n    """Generate all prompts from template and variables"""\n    template = EXPERIMENT["prompt_template"]\n    trial_type = EXPERIMENT["trial_type"]\n    \n    if trial_type == "spreadsheet":\n        # Spreadsheet trials: row-by-row execution\n        dataset = EXPERIMENT["dataset"]\n        \n        for row in dataset["rows"]:\n            # Replace variables in template with values from this row\n            prompt = template\n            var_dict = {}\n            \n            for col, value in row.items():\n                var_dict[col] = str(value) if value is not None else ""\n                prompt = prompt.replace(f"{{{{{col}}}}}", var_dict[col])\n            \n            yield prompt, var_dict\n    else:\n        # Template trials: cartesian product execution\n        variables = EXPERIMENT["variables"]\n        \n        # Get variable names from template\n        import re\n        var_names = re.findall(r'{{(\\w+)}}', template)\n        \n        # Generate all combinations\n        from itertools import product\n        \n        var_lists = [variables[var] for var in var_names if var in variables]\n        if not var_lists:\n            yield template, {}\n            return\n            \n        for values in product(*var_lists):\n            var_dict = dict(zip(var_names, values))\n            \n            # Replace variables in template\n            prompt = template\n            for var, val in var_dict.items():\n                prompt = prompt.replace(f"{{{{{var}}}}}", str(val))\n            \n            yield prompt, var_dict\n\ndef run_experiment():\n    """Run the full experiment"""\n    results = []\n    total_calls = len(MODELS) * len(list(generate_prompts()))\n    current = 0\n    \n    print(f"Running experiment with {len(MODELS)} models and {total_calls} total API calls")\n    print("=" * 60)\n    \n    for model_config in MODELS:\n        print(f"\\nTesting {model_config['displayName']}...")\n        \n        for prompt, variables in generate_prompts():\n            current += 1\n            print(f"[{current}/{total_calls}] {prompt[:50]}...", end=" ")\n            \n            # Make API call\n            result = make_api_call(\n                model_config["provider"],\n                model_config["modelId"],\n                prompt,\n                model_config["parameters"]\n            )\n            \n            # Collect results\n            results.append({\n                "timestamp": datetime.now(),\n                "provider": model_config["provider"],\n                "model": model_config["modelId"],\n                "model_name": model_config["displayName"],\n                "prompt": prompt,\n                "response": result.get("content", ""),\n                "success": result.get("success", False),\n                "error": result.get("error", ""),\n                "latency_ms": result.get("latency_ms", 0),\n                "status_code": result.get("status_code", 0),\n                **variables  # Add variables as columns\n            })\n            \n            # Show result\n            if result["success"]:\n                print(f"âœ“ {result['content'][:30]}")\n            else:\n                print(f"âœ— {result['error'][:30]}")\n            \n            # Rate limiting\n            time.sleep(0.1)\n    \n    return results\n\ndef save_results(results: List[Dict[str, Any]], format: str = OUTPUT_FORMAT):\n    """Save results using pandas in the specified format"""\n    df = pd.DataFrame(results)\n    \n    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")\n    base_filename = f"experiment_results_{timestamp}"\n    \n    if format == "csv":\n        filename = f"{base_filename}.csv"\n        df.to_csv(filename, index=False)\n    elif format == "excel":\n        filename = f"{base_filename}.xlsx"\n        df.to_excel(filename, index=False)\n    elif format == "json":\n        filename = f"{base_filename}.json"\n        df.to_json(filename, orient="records", indent=2)\n    elif format == "parquet":\n        filename = f"{base_filename}.parquet"\n        df.to_parquet(filename)\n    elif format == "html":\n        filename = f"{base_filename}.html"\n        df.to_html(filename, index=False)\n    elif format == "markdown":\n        filename = f"{base_filename}.md"\n        with open(filename, "w") as f:\n            f.write(df.to_markdown(index=False))\n    elif format == "stata":\n        filename = f"{base_filename}.dta"\n        df.to_stata(filename)\n    elif format == "pickle":\n        filename = f"{base_filename}.pkl"\n        df.to_pickle(filename)\n    else:\n        filename = f"{base_filename}.csv"\n        df.to_csv(filename, index=False)\n    \n    print(f"\\nResults saved to {filename}")\n    return filename\n\ndef main():\n    """Main entry point"""\n    # Check for API keys\n    missing_keys = []\n    for model in MODELS:\n        provider = model["provider"]\n        if provider not in API_KEYS or not API_KEYS[provider]:\n            missing_keys.append(provider)\n    \n    if missing_keys:\n        print("WARNING: Missing API keys for:", ", ".join(set(missing_keys)))\n        print("Set them in the API_KEYS dict or as environment variables.")\n        response = input("\\nContinue anyway? (y/N): ")\n        if response.lower() != 'y':\n            return\n    \n    # Run experiment\n    results = run_experiment()\n    \n    # Save results\n    if results:\n        save_results(results)\n        \n        # Basic summary\n        df = pd.DataFrame(results)\n        print(f"\\nSummary:")\n        print(f"Total calls: {len(df)}")\n        print(f"Successful: {df['success'].sum()}")\n        print(f"Failed: {(~df['success']).sum()}")\n        if 'latency_ms' in df.columns:\n            print(f"Avg latency: {df['latency_ms'].mean():.1f}ms")\n    else:\n        print("\\nNo results to save")\n\nif __name__ == "__main__":\n    main()\n`}}class Li{static generate(e){return this.generateDisabledScript(e.name)}static generateDisabledScript(e){return`#!/usr/bin/env python3\n"""\nLiteral Mode Export - Currently Disabled\n=======================================\nGenerated by Auditomatic Lite on ${(new Date).toISOString()}\n\nThis export mode is temporarily disabled during V2 migration.\nLiteral mode will be restored in the next release with support for:\n- Template trials (cartesian product execution)  \n- Spreadsheet trials (row-by-row execution)\n- Pre-computed exact API calls for reproduction\n\nOriginal trial: ${e}\n\nFor now, please use Simple Mode export which provides full functionality.\n"""\n\nprint("âŒ Literal mode export is temporarily disabled during V2 migration.")\nprint("âœ… Please use Simple Mode export for full trial reproduction functionality.")\nprint("ðŸ“… Literal mode will be restored in the next release.")\n`}}class qi{static generate(e){return this.generateDisabledScript(e.name)}static generateDisabledScript(e){return`#!/usr/bin/env python3\n"""\nNative Mode Export - Currently Disabled\n=======================================\nGenerated by Auditomatic Lite on ${(new Date).toISOString()}\n\nThis export mode is temporarily disabled during V2 migration.\nNative mode will be restored in the next release with support for:\n- Template trials (cartesian product execution)\n- Spreadsheet trials (row-by-row execution)  \n- Official Python SDKs (openai, anthropic, ollama)\n- Clean production-ready code\n\nOriginal trial: ${e}\n\nFor now, please use Simple Mode export which provides full functionality.\nRequired packages when restored: pip install openai anthropic ollama\n"""\n\nprint("âŒ Native mode export is temporarily disabled during V2 migration.")\nprint("âœ… Please use Simple Mode export for full trial reproduction functionality.")\nprint("ðŸ“… Native mode will be restored in the next release.")\nprint("ðŸ“¦ When restored, install with: pip install openai anthropic ollama")\n`}}class Ui{static async generatePythonScript(e,t){try{const a=t||this.getDefaultOptions(),l=this.validateTrialForExport(e);if(!l.valid)throw new Error(`Trial validation failed: ${l.errors.join(", ")}`);switch(a.mode){case"simple":return zi.generate(e);case"literal":return Li.generate(e);case"native":return qi.generate(e);default:throw new Error(`Unknown export mode: ${a.mode}`)}}catch(a){throw new Error(`Failed to generate Python export: ${a instanceof Error?a.message:String(a)}`)}}static async downloadPythonScript(e,t){const a=await this.generatePythonScript(e,t),l=t||this.getDefaultOptions(),n=new Blob([a],{type:"text/x-python"}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=this.generateFilename(e,l.mode),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}static validateTrialForExport(e){const t=[];return J(e)?(e.template||t.push("Template trial missing template text"),e.variableSnapshots||t.push("Template trial missing variable snapshots"),e.totalCombinations||t.push("Template trial missing combination count")):Q(e)?(e.promptPattern||t.push("Spreadsheet trial missing prompt pattern"),e.datasetSnapshot||t.push("Spreadsheet trial missing dataset snapshot"),e.datasetSnapshot?.rows?.length||t.push("Spreadsheet trial missing dataset rows"),e.totalRows||t.push("Spreadsheet trial missing row count")):t.push("Unknown trial type for export"),e.configurationSnapshots&&0!==e.configurationSnapshots.length?e.configurationSnapshots.forEach((e,a)=>{e.provider||t.push(`Configuration ${a+1} missing provider`),e.modelId||t.push(`Configuration ${a+1} missing model`),e.parameters||t.push(`Configuration ${a+1} missing parameters`)}):t.push("Trial missing model configurations"),{valid:0===t.length,errors:t}}static getExportSummary(e){const t=new Set(e.configurationSnapshots.map(e=>e.provider)),a=Pe(e);return{apiCallCount:e.configurationSnapshots.length*a,providersUsed:Array.from(t),variableCombinations:a,configurations:e.configurationSnapshots.length}}static getDefaultOptions(){return{mode:"simple"}}static generateFilename(e,t){const a=e.name||`trial_${e.id}`,l=(new Date).toISOString().split("T")[0];return`${a.toLowerCase().replace(/[^a-z0-9]/g,"_")}_${t}_${l}.py`}}const Vi=Object.freeze(Object.defineProperty({__proto__:null,PythonExportService:Ui},Symbol.toStringTag,{value:"Module"})),Hi={class:"trial-info"},Bi={class:"trial-stats"},Ki={class:"export-section"},Gi={class:"mode-content"},Wi={class:"mode-content"},Ji={class:"mode-content"},Qi={class:"export-section"},Yi={class:"preview-content"},Xi={class:"preview-info"},Zi=s({__name:"PythonExportModal",props:{trial:{}},emits:["close","exported"],setup(t,{emit:n}){const r=t,s=n,i=a("simple"),o=a(!1),u=l(()=>r.trial.progress.total),c=l(()=>r.trial.configurationSnapshots?.length||0),p=l(()=>{if(J(r.trial))return r.trial.totalCombinations||0;if(Q(r.trial)){return(r.trial.datasetSnapshot?.rows?.length||0)*(r.trial.configurationSnapshots?.length||0)}return 0}),v=l(()=>{const e=.05*p.value+.3*c.value;return Math.round(15+e)}),y=l(()=>{const e=r.trial.name.toLowerCase().replace(/\s+/g,"_"),t=(new Date).toISOString().split("T")[0];return`${e}_${i.value}_${t}.py`}),h=l(()=>{if("simple"===i.value){return 300+(p.value+10*c.value)}if("native"===i.value){return 250+(p.value+8*c.value)}return 200+15*u.value});async function _(){o.value=!0;try{const e={mode:i.value};await Ui.downloadPythonScript(r.trial,e),s("exported",y.value),s("close")}catch(e){Y.error("Export failed",e),alert("Export failed: "+(e instanceof Error?e.message:"Unknown error"))}finally{o.value=!1}}return(t,a)=>{const l=f("a-button"),n=f("a-tag"),r=f("a-radio"),s=f("a-radio-group"),x=f("a-typography-text");return b(),m(Ve,{"model-value":!0,title:"Export Python Script",size:"full","onUpdate:modelValue":a[2]||(a[2]=e=>t.$emit("close"))},{footer:g(()=>[e(l,{onClick:a[0]||(a[0]=e=>t.$emit("close")),size:"large","data-testid":"btn-cancel-python-export","aria-label":"Cancel Python export"},{default:g(()=>a[3]||(a[3]=[w(" Cancel ")])),_:1,__:[3]}),e(l,{type:"primary",onClick:_,loading:o.value,size:"large","data-testid":"btn-confirm-python-export","data-mode":i.value,"aria-label":`Export Python script in ${i.value} mode`},{default:g(()=>a[4]||(a[4]=[w(" Export Script ")])),_:1,__:[4]},8,["loading","data-mode","aria-label"])]),default:g(()=>[d("div",Hi,[d("h3",null,k(t.trial.name),1),d("div",Bi,[e(n,null,{default:g(()=>[w(k(u.value)+" API calls",1)]),_:1}),e(n,null,{default:g(()=>[w(k(c.value)+" configurations",1)]),_:1}),e(n,null,{default:g(()=>[w(k(p.value)+" variable combinations",1)]),_:1})])]),d("div",Ki,[a[13]||(a[13]=d("h4",null,"Export Mode",-1)),e(s,{value:i.value,"onUpdate:value":a[1]||(a[1]=e=>i.value=e),class:"mode-options","data-testid":"radiogroup-export-mode","aria-label":"Select Python export mode"},{default:g(()=>[e(r,{value:"simple",class:"mode-radio","data-testid":"radio-mode-simple","aria-label":"Simple script mode"},{default:g(()=>[d("div",Gi,[a[5]||(a[5]=d("div",{class:"mode-title"},"Simple Script",-1)),a[6]||(a[6]=d("div",{class:"mode-description"}," Educational script with variables as lists. Easy to understand, modify, and extend. Perfect for learning how AI APIs work. ",-1)),e(n,{color:"blue",size:"small"},{default:g(()=>[w("~"+k(v.value)+"KB",1)]),_:1})])]),_:1}),e(r,{value:"literal",class:"mode-radio disabled-mode","data-testid":"radio-mode-literal","aria-label":"Literal reproduction mode",disabled:""},{default:g(()=>[d("div",Wi,[a[8]||(a[8]=d("div",{class:"mode-title"},"Literal Reproduction (Coming Soon)",-1)),a[9]||(a[9]=d("div",{class:"mode-description"}," Exact API calls pre-computed. Currently being updated for V2 trials. Will be available in the next release. ",-1)),e(n,{color:"orange",size:"small"},{default:g(()=>a[7]||(a[7]=[w("V2 Migration")])),_:1,__:[7]})])]),_:1}),e(r,{value:"native",class:"mode-radio disabled-mode","data-testid":"radio-mode-native","aria-label":"Native libraries mode",disabled:""},{default:g(()=>[d("div",Ji,[a[11]||(a[11]=d("div",{class:"mode-title"},"Native Libraries (Coming Soon)",-1)),a[12]||(a[12]=d("div",{class:"mode-description"}," Uses official Python SDKs (openai, anthropic, ollama). Currently being updated for V2 trials. Will be available in the next release. ",-1)),e(n,{color:"orange",size:"small"},{default:g(()=>a[10]||(a[10]=[w("V2 Migration")])),_:1,__:[10]})])]),_:1})]),_:1},8,["value"])]),a[15]||(a[15]=d("div",{class:"export-section"},[d("h4",null,"Output Format"),d("div",{class:"format-info"},[d("p",null,"Both scripts save results using pandas in your choice of format:"),d("ul",null,[d("li",null,[d("strong",null,"CSV"),w(" - Universal format, opens in Excel/Google Sheets")]),d("li",null,[d("strong",null,"Excel"),w(" - Native Excel format")]),d("li",null,[d("strong",null,"JSON"),w(" - For programmatic access")]),d("li",null,[d("strong",null,"Parquet"),w(" - Efficient compressed format")]),d("li",null,[d("strong",null,"HTML"),w(" - For web viewing")]),d("li",null,[d("strong",null,"Markdown"),w(" - For documentation")]),d("li",null,[d("strong",null,"Stata"),w(" - For statistical analysis")]),d("li",null,[d("strong",null,"Pickle"),w(" - Python native format")])])])],-1)),d("div",Qi,[a[14]||(a[14]=d("h4",null,"Script Preview",-1)),d("div",Yi,[e(x,{code:"",class:"preview-filename"},{default:g(()=>[w(k(y.value),1)]),_:1}),d("div",Xi,[e(n,{size:"small"},{default:g(()=>[w(k(h.value)+" lines",1)]),_:1}),e(n,{size:"small"},{default:g(()=>[w(k(i.value)+" mode",1)]),_:1})])])])]),_:1,__:[15]})}}}),eo=le(s({__name:"ResizableDivider",props:{minSize:{default:300},maxSize:{default:600},currentWidth:{default:380},disabled:{type:Boolean,default:!1}},emits:["resize","resizeStart","resizeEnd","reset"],setup(e,{emit:t}){const l=e,n=t,r=a(!1);return(e,t)=>(b(),c("div",{class:_(["resizable-divider",{resizing:r.value,disabled:e.disabled}]),onMousedown:t[0]||(t[0]=t=>!e.disabled&&function(e){e.preventDefault(),r.value=!0;const t=e.clientX,a=l.currentWidth;n("resizeStart");const s=e=>{if(!r.value)return;const s=e.clientX-t,i=a+s,o=Math.max(l.minSize,Math.min(l.maxSize,i));n("resize",o)},i=()=>{r.value=!1,n("resizeEnd"),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",i),document.body.style.userSelect="",document.body.style.cursor=""};document.body.style.userSelect="none",document.body.style.cursor="col-resize",document.addEventListener("mousemove",s),document.addEventListener("mouseup",i)}(t)),onDblclick:t[1]||(t[1]=t=>!e.disabled&&e.$emit("reset"))},t[2]||(t[2]=[d("div",{class:"divider-handle"},[d("div",{class:"handle-bar"})],-1)]),34))}}),[["__scopeId","data-v-d9082894"]]),to={class:"trials-view-split","data-testid":"page-trials"},ao={class:"trials-layout"},lo={class:"trials-content"},no="auditomatic.trial-sider-width",ro=le(s({__name:"TrialsViewSplitPanel",setup(t){const s=Tt(),y=r(),h=n(),{data:_}=$e(()=>Z.trials.orderBy("created").reverse().toArray(),{debounce:100}),{data:k}=$e(async()=>{const e=await Z.settings.get("main");return e?[e]:[]},{debounce:100}),C=l(()=>k.value?.[0]),S=a(!1),I=a(!1),T=a(null),O=a(null),P=a(!1),$=a(),E=a(),M=a(250),F=localStorage.getItem(no);F&&(M.value=parseInt(F,10));const R=l(()=>{if(!C.value)return!1;const e=C.value.apiKeys&&Object.values(C.value.apiKeys).some(e=>e&&e.length>0),t=C.value.providers?.["ollama-chat"]?.enabled??!1,a=C.value.providers?.["ollama-generate"]?.enabled??!1;return e||t||a});function N(e){M.value=e,localStorage.setItem(no,e.toString())}function A(){M.value=250,localStorage.setItem(no,"250")}function j(){S.value=!1,$.value=void 0,O.value=null,P.value=!1}function D(e){Y.info("Trial created",{trialId:e}),j(),s.selectTrial(e)}async function z(e){Y.info("Trial created and started",{trialId:e}),j(),await new Promise(e=>setTimeout(e,100)),s.selectTrial(e)}function L(e){Y.info("Opening export for trial",{trialId:e.id}),T.value=e,I.value=!0}function q(e){Y.info("Python script exported",{filename:e})}function U(){const e=y.query;if(e.duplicate&&"string"==typeof e.duplicate){const t=_.value?.find(t=>t.id===e.duplicate);t&&(O.value=t,P.value="true"===e.edit,S.value=!0)}else e.designId&&"string"==typeof e.designId?($.value=e.designId,S.value=!0):e.promptSource&&e.promptId&&(E.value={type:e.promptSource,id:e.promptId},S.value=!0);(e.duplicate||e.designId||e.edit||e.promptSource)&&h.replace({query:{}})}const V=e=>{if((e.metaKey||e.ctrlKey)&&"k"===e.key){e.preventDefault();const t=document.querySelector(".trial-list-search input");t?.focus()}};return i(()=>y.query,()=>{U()}),i(()=>y.params.trialId,()=>{s.syncWithRoute()},{immediate:!0}),o(async()=>{if(document.addEventListener("keydown",V),await new Promise(e=>setTimeout(e,100)),U(),s.syncWithRoute(),!s.selectedTrialId&&_.value){const e=_.value.find(e=>"running"===e.status);e&&s.selectTrial(e.id)}}),u(()=>{document.removeEventListener("keydown",V)}),(t,a)=>{const l=f("a-button"),n=f("a-alert");return b(),c("div",to,[R.value?p("",!0):(b(),m(n,{key:0,type:"warning",message:"No LLM providers configured",description:"Add keys for external APIs (local Ollama does not need keys) or enable Ollama provider.","show-icon":"",class:"provider-warning"},{action:g(()=>[e(v(K),{to:"/settings"},{default:g(()=>[e(l,{size:"small",type:"primary"},{default:g(()=>a[3]||(a[3]=[w(" Go to Settings ")])),_:1,__:[3]})]),_:1})]),_:1})),d("div",ao,[d("div",{class:"trials-sider",style:x({width:M.value+"px"})},[e(ca,{collapsed:M.value<100,onCreateTrial:a[0]||(a[0]=e=>S.value=!0)},null,8,["collapsed"])],4),e(eo,{"min-size":50,"max-size":600,"current-width":M.value,onResize:N,onReset:A},null,8,["current-width"]),d("div",lo,[e(Di,{onCreateTrial:a[1]||(a[1]=e=>S.value=!0)})])]),S.value?(b(),m(Ae,{key:1,initialTemplateId:$.value,initialPromptSource:E.value,trialToDuplicate:O.value||void 0,isEditMode:P.value,onClose:j,onCreated:D,onCreatedAndStarted:z,onExportTrial:L},null,8,["initialTemplateId","initialPromptSource","trialToDuplicate","isEditMode"])):p("",!0),I.value&&T.value?(b(),m(Zi,{key:2,trial:T.value,onClose:a[2]||(a[2]=e=>{I.value=!1,T.value=null}),onExported:q},null,8,["trial"])):p("",!0)])}}}),[["__scopeId","data-v-dbfa62b5"]]);export{ro as default};
