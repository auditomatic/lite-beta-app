import{k as e,d as a,c as t,f as l,o as s,ab as n,_ as i,a1 as o,F as r,ac as d,a3 as c,a0 as u,q as p,ad as v,G as m,a4 as g,u as b,ae as f,af as h,b as y,Z as w,Y as k,$ as _,X as C}from"./vendor-CdfxntmD.js";import{u as D}from"./useLiveData-n7g3jX7E.js";import{I as x,d as T,p as A,_ as S,l as I,i as P,b as E,M as U,B as N,u as L,Q as R}from"./index-BMmW_fIo.js";import{s as M}from"./storage-calculation.service-mxSDwPZU.js";import{p as O,a as j,b as $,c as z,d as V,e as K}from"./import-helpers-R1GGtEJc.js";import"./db-CL8uhZCz.js";var B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"};function W(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?Object(arguments[a]):{},l=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),l.forEach(function(a){F(e,a,t[a])})}return e}function F(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var G=function(a,t){var l=W({},a,t.attrs);return e(x,W({},l,{icon:B}),null)};G.displayName="RocketOutlined",G.inheritAttrs=!1;const H=!1,J={class:"provider-endpoint-configuration"},q={class:"endpoint-grid"},Y=["value","onInput","placeholder","disabled","data-testid","aria-label"],Z=S(a({__name:"ProviderEndpointConfiguration",setup(e){const{data:a}=D(async()=>{const e=await T.settings.get("main");return e?[e]:[]},{debounce:100}),u=t(()=>a.value?.[0]),p=l([]);function v(e){const a=p.value.find(a=>a.id===e);return a?.api.baseUrl||""}function m(e){return u.value?.providers?.[e]?.enabled??!0}return s(async()=>{await A.waitForReady(),p.value=[...A.getAllProviders()]}),(e,a)=>(i(),n("div",J,[a[0]||(a[0]=o("h3",null,"Provider Endpoints",-1)),a[1]||(a[1]=o("p",{class:"section-desc"},"Configure base URLs for API providers",-1)),o("div",q,[(i(!0),n(r,null,d(p.value,e=>{return i(),n("div",{key:e.id,class:"endpoint-item"},[o("label",null,c(e.name),1),o("input",{value:(a=e.id,u.value?.customBaseUrls?.[a]||""),onInput:a=>async function(e,a){const t=a.target.value,l=await T.settings.get("main");l&&await T.settings.update("main",{customBaseUrls:{...l.customBaseUrls,[e]:t}})}(e.id,a),placeholder:v(e.id),disabled:!m(e.id),class:"endpoint-input","data-testid":`input-endpoint-${e.id}`,"aria-label":`${e.name} endpoint URL`},null,40,Y)]);var a}),128))])]))}}),[["__scopeId","data-v-8e87ffd2"]]),Q={class:"system-information-panel"},X={class:"info-grid"},ee={class:"info-item"},ae={class:"info-item"},te={class:"info-item"},le={class:"info-item"},se=S(a({__name:"SystemInformationPanel",props:{totalRecords:{}},setup(e){const a=e,r=l(null),d=t(()=>({dbVersion:"1.0.0",totalRecords:a.totalRecords,storageUsed:r.value?r.value.formattedUsed:"Calculating...",lastUpdated:(new Date).toLocaleString()}));return s(async()=>{try{r.value=await M.getStorageInfo()}catch(e){I.warn("Failed to get storage info",{error:e})}}),(e,a)=>(i(),n("div",Q,[a[4]||(a[4]=o("h3",null,"System Information",-1)),o("div",X,[o("div",ee,[a[0]||(a[0]=o("label",null,"Database Version:",-1)),o("span",null,c(d.value.dbVersion),1)]),o("div",ae,[a[1]||(a[1]=o("label",null,"Records Count:",-1)),o("span",null,c(d.value.totalRecords),1)]),o("div",te,[a[2]||(a[2]=o("label",null,"Storage Used:",-1)),o("span",null,c(d.value.storageUsed),1)]),o("div",le,[a[3]||(a[3]=o("label",null,"Last Updated:",-1)),o("span",null,c(d.value.lastUpdated),1)])])]))}}),[["__scopeId","data-v-92906e97"]]),ne={class:"database-table-manager"},ie={class:"table-header"},oe={class:"table-actions"},re=["onClick","data-testid","aria-label"],de=["onClick","data-testid","aria-label"],ce=["onClick","disabled","data-testid","aria-label"],ue={key:0,class:"table-content"},pe={class:"table-controls"},ve=["onUpdate:modelValue","data-testid","aria-label"],me=["onClick","data-testid","aria-label"],ge={class:"table-data"},be=["onClick","data-testid","aria-label","aria-expanded"],fe=S(a({__name:"DatabaseTableManager",props:{tableData:{}},emits:["refresh-data"],setup(e,{emit:a}){const s=e,m=a,g=l(new Set),b=l({}),f=l(""),h=l(),y=t(()=>[{name:"designs",count:s.tableData.designs?.length||0},{name:"variableLists",count:s.tableData.variableLists?.length||0},{name:"trials",count:s.tableData.trials?.length||0},{name:"models",count:s.tableData.models?.length||0},{name:"apiCalls",count:s.tableData.apiCalls?.length||0},{name:"settings",count:s.tableData.settings?.length||0},{name:"templatePrompts",count:s.tableData.templatePrompts?.length||0},{name:"spreadsheetPrompts",count:s.tableData.spreadsheetPrompts?.length||0}]);function w(e){const a=s.tableData[e]||[],t=b.value[e]?.toLowerCase()||"";if(!t)return JSON.stringify(a.slice(0,10),null,2);const l=a.filter(e=>JSON.stringify(e).toLowerCase().includes(t));return JSON.stringify(l.slice(0,10),null,2)}function k(e){!function(e,a){const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),l=URL.createObjectURL(t),s=document.createElement("a");s.href=l,s.download=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)}(s.tableData[e]||[],`${e}_export.json`)}async function _(e){const a=e.target.files?.[0];if(a){try{const e=await a.text(),t=JSON.parse(e);s.tableData[f.value]&&await async function(e,a){const t=T[e];if(t){let l=a;switch(e){case"trials":l=V(a);break;case"designs":l=z(a);break;case"variableLists":l=$(a);break;case"models":l=j(a);break;case"apiCalls":l=O(a)}await t.bulkPut(l)}}(f.value,t),m("refresh-data"),alert("Import completed successfully!")}catch(t){I.error("Import failed",t),alert("Import failed: "+(t instanceof Error?t.message:"Unknown error"))}h.value&&(h.value.value="")}}return(e,a)=>(i(),n("div",ne,[a[0]||(a[0]=o("h3",null,"Database Tables",-1)),(i(!0),n(r,null,d(y.value,e=>(i(),n("div",{key:e.name,class:"table-section"},[o("div",ie,[o("h4",null,c(e.name)+" ("+c(e.count)+" records)",1),o("div",oe,[o("button",{onClick:a=>k(e.name),class:"export-btn","data-testid":`btn-export-table-${e.name}`,"aria-label":`Export ${e.name} table`},"Export",8,re),o("button",{onClick:a=>{return t=e.name,f.value=t,void h.value?.click();var t},class:"import-btn","data-testid":`btn-import-table-${e.name}`,"aria-label":`Import ${e.name} table`},"Import",8,de),o("button",{onClick:a=>async function(e){if(!confirm(`Are you sure you want to clear all ${e} data? This cannot be undone.`))return;const a=T[e];a&&(await a.clear(),m("refresh-data"))}(e.name),class:"clear-btn",disabled:0===e.count,"data-testid":`btn-clear-table-${e.name}`,"aria-label":`Clear all ${e.name} data`}," Clear All ",8,ce)])]),g.value.has(e.name)?(i(),n("div",ue,[o("div",pe,[p(o("input",{"onUpdate:modelValue":a=>b.value[e.name]=a,placeholder:"Search records...",class:"search-input","data-testid":`input-search-${e.name}`,"aria-label":`Search ${e.name} records`},null,8,ve),[[v,b.value[e.name]]]),o("button",{onClick:a=>(e.name,void m("refresh-data")),class:"refresh-btn","data-testid":`btn-refresh-${e.name}`,"aria-label":`Refresh ${e.name} table`},"Refresh",8,me)]),o("div",ge,[o("pre",null,c(w(e.name)),1)])])):u("",!0),o("button",{onClick:a=>{return t=e.name,void(g.value.has(t)?g.value.delete(t):g.value.add(t));var t},class:"toggle-btn","data-testid":`btn-toggle-${e.name}`,"aria-label":`${g.value.has(e.name)?"Collapse":"Expand"} ${e.name} table`,"aria-expanded":g.value.has(e.name)},c(g.value.has(e.name)?"Collapse":"Expand"),9,be)]))),128)),o("input",{ref_key:"fileInput",ref:h,type:"file",accept:".json",onChange:_,style:{display:"none"},"data-testid":"input-file-import","aria-label":"Select JSON file to import"},null,544)]))}}),[["__scopeId","data-v-f84bffa7"]]),he={class:"trial-debug-information"},ye={key:0,class:"debug-info"},we={class:"debug-row"},ke={class:"debug-row"},_e={class:"debug-row"},Ce={class:"debug-row"},De={class:"debug-row"},xe={class:"debug-row"},Te={class:"debug-json"},Ae={key:0,class:"debug-row"},Se={class:"native-snapshot-info template"},Ie={key:1,class:"debug-row"},Pe={class:"native-snapshot-info spreadsheet"},Ee={key:2,class:"debug-row"},Ue={key:1,class:"empty-state"},Ne=S(a({__name:"TrialDebugInformation",setup(e){const a=l(null);async function t(){try{const e=await T.trials.toArray();if(e.length>0){const t=e.sort((e,a)=>new Date(a.created).getTime()-new Date(e.created).getTime())[0];a.value=t,P(t)?I.info("Latest trial debug info (Template):",{name:t.name,type:t.type,templateId:t.templateId,templateName:t.templateName}):E(t)&&I.info("Latest trial debug info (Spreadsheet):",{name:t.name,type:t.type,spreadsheetId:t.spreadsheetId,datasetName:t.datasetName})}else a.value=null}catch(e){I.error("Failed to load latest trial",e)}}function s(e){return e?P(e)?"Template":E(e)?"Spreadsheet":"Unknown V2 type":"No trial"}function r(e){return e?P(e)?e.templateId:E(e)?e.spreadsheetId:"Unknown":"N/A"}function d(e){return e?P(e)?e.templateName:E(e)?e.datasetName:"Unknown":"N/A"}function p(e){return e?P(e)?{type:e.type,templateId:e.templateId,templateName:e.templateName,template:e.template?.substring(0,100)+"...",variablesCount:Object.keys(e.variables||{}).length,outputType:e.outputType,configCount:e.configurationSnapshots?.length||0}:E(e)?{type:e.type,spreadsheetId:e.spreadsheetId,datasetName:e.datasetName,promptPattern:e.promptPattern?.substring(0,100)+"...",datasetRowCount:e.datasetSnapshot?.rows?.length||0,outputType:e.outputType,configCount:e.configurationSnapshots?.length||0}:{type:"unknown",raw:e}:null}return t(),(e,l)=>{return i(),n("div",he,[l[9]||(l[9]=o("h3",null,"Latest Trial Debug Info",-1)),a.value?(i(),n("div",ye,[o("div",we,[l[0]||(l[0]=o("strong",null,"Name:",-1)),m(" "+c(a.value.name),1)]),o("div",ke,[l[1]||(l[1]=o("strong",null,"Created:",-1)),m(" "+c(new Date(a.value.created).toLocaleString()),1)]),o("div",_e,[l[2]||(l[2]=o("strong",null,"Source Type:",-1)),o("span",{class:g(["source-type",(v=a.value,v?P(v)?"template":E(v)?"spreadsheet":"unknown":"none")])},c(s(a.value)),3)]),o("div",Ce,[l[3]||(l[3]=o("strong",null,"Source ID:",-1)),o("code",null,c(r(a.value)),1)]),o("div",De,[l[4]||(l[4]=o("strong",null,"Source Name:",-1)),o("span",null,c(d(a.value)),1)]),o("div",xe,[l[5]||(l[5]=o("strong",null,"V2 Trial Data:",-1)),o("pre",Te,c(JSON.stringify(p(a.value),null,2)),1)]),b(P)(a.value)?(i(),n("div",Ae,[l[6]||(l[6]=o("strong",null,"V2 Template Trial:",-1)),o("div",Se,[o("div",null,"Template Name: "+c(a.value.templateName),1),o("div",null,"Template Length: "+c(a.value.template?.length||0)+" chars",1),o("div",null,"Variables: "+c(Object.keys(a.value.variables||{}).join(", ")||"None"),1),o("div",null,"Output Type: "+c(a.value.outputType),1),o("div",null,"Extract Pattern: "+c(a.value.extractPattern||"None"),1)])])):u("",!0),b(E)(a.value)?(i(),n("div",Ie,[l[7]||(l[7]=o("strong",null,"V2 Spreadsheet Trial:",-1)),o("div",Pe,[o("div",null,"Dataset Name: "+c(a.value.datasetName),1),o("div",null,"Prompt Pattern Length: "+c(a.value.promptPattern?.length||0)+" chars",1),o("div",null,"Dataset Rows: "+c(a.value.datasetSnapshot?.rows?.length||0),1),o("div",null,"Dataset Columns: "+c(a.value.datasetSnapshot?.columns?.join(", ")||"None"),1),o("div",null,"Output Type: "+c(a.value.outputType),1)])])):u("",!0),!a.value||b(P)(a.value)||b(E)(a.value)?u("",!0):(i(),n("div",Ee,l[8]||(l[8]=[o("div",{class:"warning-box"}," ⚠️ Unknown V2 trial type - this trial may be corrupted or from an unsupported version ",-1)])))])):(i(),n("div",Ue," No trials found ")),o("button",{onClick:t,class:"refresh-btn"}," Refresh Latest Trial ")]);var v}}}),[["__scopeId","data-v-d30cff78"]]),Le={class:"import-export-tools"},Re=S(a({__name:"ImportExportTools",props:{tableData:{}},emits:["refresh-data"],setup(e,{emit:a}){const t=e,s=a,r=l(""),d=l();async function c(){k({version:"1.0.0",exported:(new Date).toISOString(),data:t.tableData},`auditomatic_full_export_${Date.now()}.json`)}async function u(){const e=t.tableData.designs||[],a=t.tableData.variableLists||[];k({version:"1.0.0",exported:(new Date).toISOString(),designs:e,variableLists:a},`designs_variables_export_${Date.now()}.json`)}async function p(){const e=t.tableData.trials||[],a=t.tableData.apiCalls||[];k({version:"1.0.0",exported:(new Date).toISOString(),trials:e,apiCalls:a},`trials_export_${Date.now()}.json`)}async function v(){k(t.tableData.models||[],`models_export_${Date.now()}.json`)}async function m(){k((t.tableData.models||[]).map(e=>({id:e.id,provider:e.provider,modelId:e.modelId,enabled:e.enabled})),`model_states_export_${Date.now()}.json`)}function g(){r.value="fullDatabase",d.value?.click()}function b(){r.value="designsAndVariables",d.value?.click()}function f(){r.value="trials",d.value?.click()}function h(){r.value="models",d.value?.click()}function y(){r.value="modelStates",d.value?.click()}async function w(e){const a=e.target.files?.[0];if(a){try{const e=await a.text(),t=JSON.parse(e);switch(r.value){case"fullDatabase":await async function(e){const a=K(e);if(a.data)for(const[t,l]of Object.entries(a.data)){const e=T[t];e&&await e.bulkPut(l)}}(t);break;case"designsAndVariables":await async function(e){if(e.designs){const a=z(e.designs);await T.designs.bulkPut(a)}if(e.variableLists){const a=$(e.variableLists);await T.variableLists.bulkPut(a)}}(t);break;case"trials":await async function(e){if(e.trials){const a=V(e.trials);await T.trials.bulkPut(a)}if(e.apiCalls){const a=O(e.apiCalls);await T.apiCalls.bulkPut(a)}}(t);break;case"models":await async function(e){const a=j(e);await T.models.bulkPut(a)}(t);break;case"modelStates":await async function(e){for(const a of e)await T.models.update(a.id,{enabled:a.enabled})}(t)}s("refresh-data"),alert("Import completed successfully!")}catch(t){I.error("Import failed",t),alert("Import failed: "+(t instanceof Error?t.message:"Unknown error"))}d.value&&(d.value.value="")}}function k(e,a){const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),l=URL.createObjectURL(t),s=document.createElement("a");s.href=l,s.download=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)}return(e,a)=>(i(),n("div",Le,[a[6]||(a[6]=o("h3",null,"Import/Export Tools",-1)),o("div",{class:"export-group"},[a[0]||(a[0]=o("h4",null,"Complete Database",-1)),o("div",{class:"export-actions"},[o("button",{onClick:c,class:"export-all-btn","data-testid":"btn-export-full-database","aria-label":"Export complete database"},"Export All Data"),o("button",{onClick:g,class:"import-all-btn","data-testid":"btn-import-full-database","aria-label":"Import complete database"},"Import All Data")])]),o("div",{class:"export-group"},[a[1]||(a[1]=o("h4",null,"Designs & Variables",-1)),a[2]||(a[2]=o("p",{class:"export-desc"},"Exports designs with their linked variable lists",-1)),o("div",{class:"export-actions"},[o("button",{onClick:u,class:"export-btn","data-testid":"btn-export-designs-variables","aria-label":"Export designs and variables"},"Export Designs+Variables"),o("button",{onClick:b,class:"import-btn","data-testid":"btn-import-designs-variables","aria-label":"Import designs and variables"},"Import Designs+Variables")])]),o("div",{class:"export-group"},[a[3]||(a[3]=o("h4",null,"Trials",-1)),a[4]||(a[4]=o("p",{class:"export-desc"},"Exports trials with configuration snapshots and results",-1)),o("div",{class:"export-actions"},[o("button",{onClick:p,class:"export-btn"},"Export Trials"),o("button",{onClick:f,class:"import-btn"},"Import Trials")])]),o("div",{class:"export-group"},[a[5]||(a[5]=o("h4",null,"Models",-1)),o("div",{class:"export-actions"},[o("button",{onClick:v,class:"export-btn"},"Export All Models"),o("button",{onClick:h,class:"import-btn"},"Import All Models")]),o("div",{class:"export-actions"},[o("button",{onClick:m,class:"export-state-btn"},"Export Model States Only"),o("button",{onClick:y,class:"import-state-btn"},"Import Model States Only")])]),o("input",{ref_key:"fileInput",ref:d,type:"file",accept:".json",onChange:w,style:{display:"none"},"data-testid":"input-file-import","aria-label":"Select JSON file to import"},null,544)]))}}),[["__scopeId","data-v-89d2b8b7"]]),Me={class:"developer-tools"},Oe={key:0,class:"section"},je={key:0,class:"migration-status"},$e={class:"status-item"},ze={class:"status-item"},Ve={class:"status-item"},Ke={class:"migration-actions"},Be=["disabled"],We=["disabled"],Fe=["disabled"],Ge={key:0},He={key:0},Je={class:"section"},qe={class:"tokenizer-test"},Ye={class:"test-input-group"},Ze={class:"test-actions"},Qe=["disabled"],Xe=["disabled"],ea=["disabled"],aa={class:"worker-status"},ta={class:"text-secondary"},la={key:0,class:"test-results"},sa={class:"result-grid"},na={class:"result-item"},ia={class:"result-item"},oa={class:"result-item"},ra={class:"result-item"},da={key:0,class:"error-message"},ca={key:1,class:"progress-messages"},ua={class:"section debug-settings-section"},pa={class:"debug-toggle"},va={class:"checkbox-label"},ma={class:"checkbox-text"},ga={key:0,class:"debug-warning"},ba={class:"section deterministic-section"},fa={class:"deterministic-config"},ha={class:"checkbox-label"},ya={class:"checkbox-text"},wa={key:0,class:"deterministic-info"},ka=S(a({__name:"DeveloperTools",emits:["refresh-data"],setup(e,{emit:a}){const b=a,y=l(H),w=l(!1),k=l(!1),_=l(!1),C=l(null),x=l(null),A=l("Hello world! This is a test of tiktoken tokenization."),S=l(!1),P=l(!1),E=l(null),N=l(null),{data:L}=D(async()=>{const e=await T.settings.get("main");return e?[e]:[]},{debounce:100}),R=t(()=>L.value?.[0]),M=l(!1),O=l(!1);async function j(){await T.settings.update("main",{debugThrowAllErrors:M.value}),I.info("Debug throw all errors flag updated",{enabled:M.value})}async function $(){const e=await T.settings.get("main");e&&(await T.settings.update("main",{providers:{...e.providers,deterministic:{enabled:O.value}}}),O.value&&await T.settings.update("main",{apiKeys:{...e.apiKeys,deterministic:"no-key-needed"}})),I.info("Deterministic provider toggled",{enabled:O.value})}async function z(){w.value=!0,x.value=null;try{const e=await T.designs.toArray(),a=await T.templatePrompts.toArray(),t=await T.spreadsheetPrompts.toArray();let l=0;const s=new Set(e.map(e=>e.id)),n=new Set([...a.map(e=>e.id),...t.map(e=>e.id)]);for(const r of s)n.has(r)&&l++;const i=e.length,o=i-l;C.value={total:i,migrated:l,pending:o},0===l&&i>0?x.value={type:"warning",title:"No migrations found",details:`${i} designs are ready to migrate to the new prompt system.`}:l===i&&i>0?x.value={type:"success",title:"Migration complete",details:"All designs have been migrated to the new prompt system."}:l>0&&o>0&&(x.value={type:"warning",title:"Partial migration",details:`${l} of ${i} designs have been migrated. ${o} remaining.`})}catch(e){I.error("Failed to check migration status",e),x.value={type:"error",title:"Failed to check migration status",details:e instanceof Error?e.message:"Unknown error"}}finally{w.value=!1}}async function V(){k.value=!0,x.value=null;try{await U.forceReMigration(),await z();const e=await U.getMigrationStatus();x.value={type:"success",title:"V2 migration completed successfully",details:`Migration completed. Status: ${e.templatePromptsCount} templates, ${e.spreadsheetPromptsCount} spreadsheets. ${e.legacyDesignsCount} legacy designs remaining.`}}catch(e){I.error("Migration failed",e),x.value={type:"error",title:"V2 migration failed",details:e instanceof Error?e.message:"Unknown error"}}finally{k.value=!1}}async function K(){_.value=!0,x.value=null;try{const e=await U.validateMigration();e.valid?x.value={type:"success",title:"Migration validation passed",details:"All designs have been correctly migrated to their respective prompt tables."}:x.value={type:"error",title:"Migration validation failed",details:`Found ${e.errors.length} validation errors.`,errors:e.errors.join("\n")}}catch(e){I.error("Validation failed",e),x.value={type:"error",title:"Validation failed",details:e instanceof Error?e.message:"Unknown error"}}finally{_.value=!1}}async function B(){if(!A.value)return;S.value=!0,N.value=null;const e=Date.now();try{const a=Math.ceil(A.value.length/4),t=Date.now()-e;N.value={method:"Approximate (4 chars/token)",tokens:a,duration:t,isAccurate:!1}}catch(a){N.value={method:"Approximate (4 chars/token)",tokens:0,duration:Date.now()-e,isAccurate:!1,error:a instanceof Error?a.message:"Unknown error"}}finally{S.value=!1}}async function W(){if(!A.value)return;P.value=!0,N.value=null;const e=Date.now(),a=[];try{const t=new Worker(new URL(""+new URL("token-calculation.worker-_TmsjB_5.js",import.meta.url).href,import.meta.url),{type:"module"}),l=`test-${Date.now()}`,s=await new Promise((e,s)=>{const n=setTimeout(()=>{t.terminate(),s(new Error("Worker timeout after 30 seconds"))},3e4);t.onmessage=i=>{const o=i.data;o.id===l&&("progress"===o.type?a.push(`${o.stage}: ${o.message}`):"result"===o.type?(clearTimeout(n),t.terminate(),e(o.result)):"error"===o.type&&(clearTimeout(n),t.terminate(),s(new Error(o.error.message))))},t.onerror=e=>{clearTimeout(n),t.terminate(),s(e)},t.postMessage({id:l,method:"accurate",design:{promptTemplate:A.value,variableBindings:{}}})}),n=Date.now()-e;N.value={method:"Accurate (Reload CDN)",tokens:s.minTokens,duration:n,isAccurate:s.isAccurate,progress:a}}catch(t){N.value={method:"Accurate (Reload CDN)",tokens:0,duration:Date.now()-e,isAccurate:!1,error:t instanceof Error?t.message:"Unknown error",progress:a}}finally{P.value=!1}}async function F(){if(!A.value||!E.value)return;P.value=!0,N.value=null;const e=Date.now(),a=[];try{const t=`test-${Date.now()}`,l=await new Promise((e,l)=>{const s=setTimeout(()=>{l(new Error("Worker timeout after 30 seconds"))},3e4),n=i=>{const o=i.data;o.id===t&&("progress"===o.type?a.push(`${o.stage}: ${o.message}`):"result"===o.type?(clearTimeout(s),E.value?.removeEventListener("message",n),e(o.result)):"error"===o.type&&(clearTimeout(s),E.value?.removeEventListener("message",n),l(new Error(o.error.message))))};E.value?.addEventListener("message",n),E.value?.postMessage({id:t,method:"accurate",design:{promptTemplate:A.value,variableBindings:{}}})}),s=Date.now()-e;N.value={method:"Accurate (Use Cached)",tokens:l.minTokens,duration:s,isAccurate:l.isAccurate,progress:a}}catch(t){N.value={method:"Accurate (Use Cached)",tokens:0,duration:Date.now()-e,isAccurate:!1,error:t instanceof Error?t.message:"Unknown error",progress:a}}finally{P.value=!1}}async function G(){if(!E.value)try{const e=new Worker(new URL(""+new URL("token-calculation.worker-_TmsjB_5.js",import.meta.url).href,import.meta.url),{type:"module"});await new Promise(a=>{const t=setTimeout(()=>a(!1),1e4);e.onmessage=e=>{"result"!==e.data.type&&"error"!==e.data.type||(clearTimeout(t),a(!0))},e.postMessage({id:"prime",method:"accurate",design:{promptTemplate:"test",variableBindings:{}}})})?E.value=e:e.terminate()}catch(e){I.error("Failed to initialize persistent worker",e)}}function J(){E.value&&(E.value.terminate(),E.value=null)}async function q(){confirm("Are you sure you want to clear ALL data? This cannot be undone.")&&(await T.delete(),localStorage.clear(),sessionStorage.clear(),document.cookie.split(";").forEach(e=>{document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}),I.info("All data cleared - reloading page"),window.location.reload())}async function Y(){confirm("Reset all settings to defaults? This will clear all data.")&&await q()}async function Z(){confirm("Regenerate database? This will clear all data and rebuild.")&&(await T.delete(),await T.open(),b("refresh-data"))}return s(async()=>{M.value=R.value?.debugThrowAllErrors||!1,O.value=R.value?.providers?.deterministic?.enabled||!1}),(e,a)=>(i(),n("div",Me,[y.value?(i(),n("div",Oe,[a[6]||(a[6]=o("h3",null,"Design Type Migration",-1)),a[7]||(a[7]=o("p",{class:"section-desc"},"Migrate old designs to new template/spreadsheet prompt types",-1)),C.value?(i(),n("div",je,[o("div",$e,[a[3]||(a[3]=o("label",null,"Total Designs:",-1)),o("span",null,c(C.value.total),1)]),o("div",ze,[a[4]||(a[4]=o("label",null,"Already Migrated:",-1)),o("span",null,c(C.value.migrated),1)]),o("div",Ve,[a[5]||(a[5]=o("label",null,"Pending Migration:",-1)),o("span",null,c(C.value.pending),1)])])):u("",!0),o("div",Ke,[o("button",{onClick:z,class:"check-btn",disabled:w.value},c(w.value?"Checking...":"Check Migration Status"),9,Be),o("button",{onClick:V,class:"migrate-btn",disabled:k.value||null!==C.value&&0===C.value.pending},c(k.value?"Migrating...":"Run Migration"),9,We),o("button",{onClick:K,class:"validate-btn",disabled:_.value},c(_.value?"Validating...":"Validate Migration"),9,Fe)]),x.value?(i(),n("div",{key:1,class:g(["migration-result",x.value.type])},[o("h4",null,c(x.value.title),1),x.value.details?(i(),n("div",Ge,[o("p",null,c(x.value.details),1),x.value.errors?(i(),n("pre",He,c(x.value.errors),1)):u("",!0)])):u("",!0)],2)):u("",!0)])):u("",!0),o("div",Je,[a[15]||(a[15]=o("h3",null,"Tokenizer Testing",-1)),a[16]||(a[16]=o("p",{class:"section-desc"},"Test the CDN-based tiktoken worker implementation",-1)),o("div",qe,[o("div",Ye,[a[8]||(a[8]=o("label",null,"Test Text:",-1)),p(o("textarea",{"onUpdate:modelValue":a[0]||(a[0]=e=>A.value=e),placeholder:"Enter text to tokenize...",class:"test-textarea",rows:"3"},null,512),[[v,A.value]])]),o("div",Ze,[o("button",{onClick:B,class:"test-btn",disabled:!A.value||S.value},c(S.value?"Testing...":"Test Approximate (4 chars/token)"),9,Qe),o("button",{onClick:W,class:"test-btn primary",disabled:!A.value||P.value},c(P.value?"Loading CDN...":"Test Accurate (Reload CDN)"),9,Xe),o("button",{onClick:F,class:"test-btn secondary",disabled:!A.value||P.value||!E.value},c(P.value?"Testing...":"Test Accurate (Use Cached)"),9,ea)]),o("div",aa,[o("small",ta,[m(" Worker Status: "+c(E.value?"✅ Cached (CDN loaded)":"❌ Not initialized")+" ",1),E.value?u("",!0):(i(),n("button",{key:0,onClick:G,class:"init-btn"},"Initialize Cached Worker")),E.value?(i(),n("button",{key:1,onClick:J,class:"terminate-btn"},"Terminate Worker")):u("",!0)])]),N.value?(i(),n("div",la,[a[14]||(a[14]=o("h4",null,"Results:",-1)),o("div",sa,[o("div",na,[a[9]||(a[9]=o("label",null,"Method:",-1)),o("span",null,c(N.value.method),1)]),o("div",ia,[a[10]||(a[10]=o("label",null,"Token Count:",-1)),o("span",null,c(N.value.tokens),1)]),o("div",oa,[a[11]||(a[11]=o("label",null,"Time Taken:",-1)),o("span",null,c(N.value.duration)+"ms",1)]),o("div",ra,[a[12]||(a[12]=o("label",null,"Is Accurate:",-1)),o("span",null,c(N.value.isAccurate?"✅ Yes":"❌ No"),1)])]),N.value.error?(i(),n("div",da," ❌ Error: "+c(N.value.error),1)):u("",!0),N.value.progress?(i(),n("div",ca,[a[13]||(a[13]=o("h5",null,"Progress:",-1)),(i(!0),n(r,null,d(N.value.progress,e=>(i(),n("div",{key:e,class:"progress-msg"},c(e),1))),128))])):u("",!0)])):u("",!0)])]),o("div",ua,[a[18]||(a[18]=o("h3",null,"🚨 Heisenbug Debug Mode",-1)),a[19]||(a[19]=o("p",{class:"section-desc"},"When enabled, all API execution errors will throw immediately instead of being stored, showing full stack traces in DevTools.",-1)),o("div",pa,[o("label",va,[p(o("input",{type:"checkbox","onUpdate:modelValue":a[1]||(a[1]=e=>M.value=e),onChange:j},null,544),[[f,M.value]]),o("span",ma,c(M.value?"🔥 Debug Mode ON - Errors will throw!":"💤 Debug Mode OFF - Errors stored normally"),1)])]),M.value?(i(),n("div",ga,a[17]||(a[17]=[m(" ⚠️ "),o("strong",null,"Warning:",-1),m(" With debug mode enabled, any error during API execution will crash the application and show stack traces in browser DevTools. This is intended for debugging the heisenbug. ")]))):u("",!0)]),o("div",ba,[a[21]||(a[21]=o("h3",null,"🔬 Deterministic Testing Provider",-1)),a[22]||(a[22]=o("p",{class:"section-desc"},[m(" Enable deterministic testing models that return predictable outputs. "),o("strong",null,"WARNING:"),m(" This is for testing only - not for production use. ")],-1)),o("div",fa,[o("label",ha,[p(o("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=e=>O.value=e),onChange:$},null,544),[[f,O.value]]),o("span",ya,c(O.value?"✅ Deterministic Testing Enabled":"⭕ Deterministic Testing Disabled"),1)]),O.value?(i(),n("div",wa,a[20]||(a[20]=[h('<p data-v-a34d04af>Available deterministic models:</p><ul data-v-a34d04af><li data-v-a34d04af><strong data-v-a34d04af>echo:</strong> Returns the input prompt as-is</li><li data-v-a34d04af><strong data-v-a34d04af>vader:</strong> Returns Darth Vader quotes</li><li data-v-a34d04af><strong data-v-a34d04af>error:</strong> Always returns an error</li><li data-v-a34d04af><strong data-v-a34d04af>json:</strong> Returns structured JSON data</li></ul><p class="warning-note" data-v-a34d04af> ⚠️ These models are for testing workflows without consuming API credits. They do not provide real AI responses. </p>',3)]))):u("",!0)])]),o("div",{class:"section danger-actions-section"},[a[23]||(a[23]=o("h3",null,"Destructive Actions",-1)),o("div",{class:"danger-actions"},[o("button",{onClick:q,class:"danger-btn","data-testid":"btn-clear-all-data","aria-label":"Clear all application data"},"Clear All Data"),o("button",{onClick:Y,class:"danger-btn","data-testid":"btn-reset-defaults","aria-label":"Reset application to default settings"},"Reset to Defaults"),o("button",{onClick:Z,class:"danger-btn","data-testid":"btn-regenerate-database","aria-label":"Regenerate database structure"},"Regenerate Database")])])]))}}),[["__scopeId","data-v-a34d04af"]]),_a={class:"debug-data-management"},Ca=S(a({__name:"DebugDataManagement",setup(a){const o=l({}),r=t(()=>Object.values(o.value).reduce((e,a)=>e+a.length,0));async function d(){try{const e={designs:await T.designs.toArray(),variableLists:await T.variableLists.toArray(),trials:await T.trials.toArray(),models:await T.models.toArray(),apiCalls:await T.apiCalls.toArray(),settings:await T.settings.toArray(),templatePrompts:await T.templatePrompts.toArray(),spreadsheetPrompts:await T.spreadsheetPrompts.toArray()};o.value=e}catch(e){I.error("Failed to load table data",e)}}return s(async()=>{await d()}),(a,t)=>(i(),n("div",_a,[e(Z),e(se,{"total-records":r.value},null,8,["total-records"]),e(fe,{"table-data":o.value,onRefreshData:d},null,8,["table-data"]),e(Ne),e(Re,{"table-data":o.value,onRefreshData:d},null,8,["table-data"]),e(ka,{onRefreshData:d})]))}}),[["__scopeId","data-v-224fee86"]]),Da={class:"background-keep-alive-settings"},xa={class:"setting-row"},Ta={key:1,class:"keep-alive-config"},Aa={class:"setting-row"},Sa={key:0,class:"setting-row"},Ia={class:"method-info"},Pa={class:"methods-grid"},Ea={class:"method-name"},Ua={class:"method-description"},Na={key:0,class:"method-status"},La={class:"current-status"},Ra={class:"status-grid"},Ma={class:"status-item"},Oa={key:0,class:"status-item"},ja={key:1,class:"status-item"},$a={class:"status-item"},za={class:"setting-row"},Va=S(a({__name:"BackgroundKeepAliveSettings",setup(a){const{data:p}=D(async()=>{const e=await T.settings.get("main");return e?[e]:[]},{debounce:100}),v=t(()=>({backgroundKeepAlive:p.value?.[0]?.backgroundKeepAlive||{enabled:!1,method:"auto",fallbackMethods:["self-loopback","open-relay","google-stun"],showBrowserWarnings:!0}})),b=N.getInstance(),f=l(b.getStatus()),h=l(b.getAvailableMethods()),C=l(b.getBrowserRecommendation());let x=null;s(()=>{x=window.setInterval(()=>{f.value=b.getStatus()},5e3)}),y(()=>{x&&clearInterval(x)});const A=async e=>{const a=await T.settings.get("main");if(a){const t={...a.backgroundKeepAlive,...e};await T.settings.update("main",{backgroundKeepAlive:t})}},S=e=>{const a=v.value.backgroundKeepAlive;return a.method===e||"auto"===a.method&&a.fallbackMethods.includes(e)},I=e=>{switch(e){case"open":return"green";case"connecting":return"orange";case"closed":return"red";default:return"gray"}};return(a,t)=>{const l=w("a-alert"),s=w("a-switch"),p=w("a-select-option"),b=w("a-select"),y=w("a-tag");return i(),n("div",Da,[t[24]||(t[24]=o("div",{class:"section-header"},[o("h3",null,"Background Tab Protection"),o("p",{class:"section-desc"}," Prevent browser throttling during long trials by maintaining WebRTC connections ")],-1)),v.value.backgroundKeepAlive.showBrowserWarnings&&C.value?(i(),k(l,{key:0,type:C.value.severity,message:`${C.value.browser} Browser Detected`,description:C.value.recommendation,"show-icon":!0,closable:!0,onClose:t[0]||(t[0]=()=>A({showBrowserWarnings:!1})),style:{"margin-bottom":"16px"}},null,8,["type","message","description"])):u("",!0),o("div",xa,[t[5]||(t[5]=o("div",{class:"setting-label"},[o("label",null,"Enable Background Protection"),o("div",{class:"setting-desc"}," Keep trials running smoothly when browser tab is in background ")],-1)),e(s,{checked:v.value.backgroundKeepAlive.enabled,onChange:t[1]||(t[1]=e=>A({enabled:e}))},null,8,["checked"])]),v.value.backgroundKeepAlive.enabled?(i(),n("div",Ta,[o("div",Aa,[t[11]||(t[11]=o("div",{class:"setting-label"},[o("label",null,"Protection Method"),o("div",{class:"setting-desc"}," Choose how to prevent background throttling ")],-1)),e(b,{value:v.value.backgroundKeepAlive.method,onChange:t[2]||(t[2]=e=>A({method:e})),style:{width:"200px"}},{default:_(()=>[e(p,{value:"auto"},{default:_(()=>t[6]||(t[6]=[o("div",{class:"method-option"},[o("strong",null,"Auto (Recommended)"),o("div",{class:"method-desc"},"Try methods with fallbacks")],-1)])),_:1,__:[6]}),e(p,{value:"self-loopback"},{default:_(()=>t[7]||(t[7]=[o("div",{class:"method-option"},[o("strong",null,"Self-Loopback"),o("div",{class:"method-desc"},"No external servers needed")],-1)])),_:1,__:[7]}),e(p,{value:"open-relay"},{default:_(()=>t[8]||(t[8]=[o("div",{class:"method-option"},[o("strong",null,"Open Relay"),o("div",{class:"method-desc"},"Free public TURN service")],-1)])),_:1,__:[8]}),e(p,{value:"google-stun"},{default:_(()=>t[9]||(t[9]=[o("div",{class:"method-option"},[o("strong",null,"Google STUN"),o("div",{class:"method-desc"},"Google's STUN servers")],-1)])),_:1,__:[9]}),e(p,{value:"disabled"},{default:_(()=>t[10]||(t[10]=[o("div",{class:"method-option"},[o("strong",null,"Disabled"),o("div",{class:"method-desc"},"No background protection")],-1)])),_:1,__:[10]})]),_:1},8,["value"])]),"auto"===v.value.backgroundKeepAlive.method?(i(),n("div",Sa,[t[15]||(t[15]=o("div",{class:"setting-label"},[o("label",null,"Fallback Order"),o("div",{class:"setting-desc"}," Order to try methods if primary fails ")],-1)),e(b,{mode:"multiple",value:v.value.backgroundKeepAlive.fallbackMethods,onChange:t[3]||(t[3]=e=>A({fallbackMethods:e})),style:{width:"300px"},placeholder:"Select fallback methods"},{default:_(()=>[e(p,{value:"self-loopback"},{default:_(()=>t[12]||(t[12]=[m("Self-Loopback")])),_:1,__:[12]}),e(p,{value:"open-relay"},{default:_(()=>t[13]||(t[13]=[m("Open Relay")])),_:1,__:[13]}),e(p,{value:"google-stun"},{default:_(()=>t[14]||(t[14]=[m("Google STUN")])),_:1,__:[14]})]),_:1},8,["value"])])):u("",!0),o("div",Ia,[t[17]||(t[17]=o("h4",null,"Method Details",-1)),o("div",Pa,[(i(!0),n(r,null,d(h.value,(a,l)=>(i(),n("div",{key:l,class:g(["method-card",{active:S(l)}])},[o("div",Ea,c(a.name),1),o("div",Ua,c(a.description),1),S(l)?(i(),n("div",Na,[e(y,{color:"green"},{default:_(()=>t[16]||(t[16]=[m("Currently Selected")])),_:1,__:[16]})])):u("",!0)],2))),128))])])])):u("",!0),o("div",La,[t[22]||(t[22]=o("h4",null,"Current Status",-1)),o("div",Ra,[o("div",Ma,[t[18]||(t[18]=o("label",null,"Protection Active:",-1)),e(y,{color:f.value.isActive?"green":"red"},{default:_(()=>[m(c(f.value.isActive?"Active":"Inactive"),1)]),_:1},8,["color"])]),f.value.method?(i(),n("div",Oa,[t[19]||(t[19]=o("label",null,"Method:",-1)),o("span",null,c(f.value.methodName),1)])):u("",!0),f.value.lastHeartbeat?(i(),n("div",ja,[t[20]||(t[20]=o("label",null,"Last Heartbeat:",-1)),o("span",null,c((D=f.value.lastHeartbeat,new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(D))),1)])):u("",!0),o("div",$a,[t[21]||(t[21]=o("label",null,"Connection State:",-1)),e(y,{color:I(f.value.connectionState)},{default:_(()=>[m(c(f.value.connectionState),1)]),_:1},8,["color"])])])]),o("div",za,[t[23]||(t[23]=o("div",{class:"setting-label"},[o("label",null,"Show Browser Warnings"),o("div",{class:"setting-desc"}," Display warnings about browser-specific throttling behavior ")],-1)),e(s,{checked:v.value.backgroundKeepAlive.showBrowserWarnings,onChange:t[4]||(t[4]=e=>A({showBrowserWarnings:e}))},null,8,["checked"])])]);var D}}}),[["__scopeId","data-v-475835de"]]),Ka={class:"settings-view full-width","data-testid":"page-settings"},Ba={class:"api-key-label"},Wa={class:"provider-info spacing-top-xs"},Fa={class:"text-secondary"},Ga={class:"help-item"},Ha={class:"help-content"},Ja={class:"help-item"},qa={class:"help-content"},Ya={class:"single-line-setting"},Za={key:0,class:"environmental-toggle-section"},Qa={class:"env-toggle-container"},Xa=S(a({__name:"SettingsView",setup(a){const s=L(),p=C(),{data:v}=D(async()=>{const e=await T.settings.get("main");return e?[e]:[]},{debounce:100}),f=t(()=>v.value?.[0]),h=l([]),y=l([]),x=t({get:()=>f.value?.financialCostsEnabled??!0,set:async e=>{f.value&&await T.settings.update("main",{financialCostsEnabled:e})}}),S=l(!0),I=t({get:()=>f.value?.environmentalCostsEnabled??!1,set:async e=>{f.value&&await T.settings.update("main",{environmentalCostsEnabled:e})}}),P=l("carbon"),E=l(["cars","phones"]),U=[{title:"Provider Group",dataIndex:"name",key:"name",width:150},{title:"Providers",dataIndex:"providers",key:"providers",width:200},{title:"Value",key:"input",width:100,align:"center"},{title:"Slider (1-6)",key:"slider",width:200,align:"center"}],N=t(()=>{const e=A.getAllGroups(),a=[];for(const t of e){const e=A.getProvidersInGroup(t);if(0===e.length)continue;let l=1;for(const a of e)a.execution?.defaultConcurrency&&(l=Math.max(l,a.execution.defaultConcurrency));const s=f.value?.providerConcurrency?.[t],n=void 0!==s?s:l;a.push({id:t,name:t.charAt(0).toUpperCase()+t.slice(1),providers:e.map(e=>e.name).join(", "),concurrency:n,enabled:!0,defaultConcurrency:l})}return a}),M=t(()=>{if(!f.value)return{};const e={},a=A.getAllProviders();for(const t of a)if("bearer"===t.auth?.type||"header"===t.auth?.type){const a=t.group||t.id;e[a]||(e[a]={id:a,name:a.charAt(0).toUpperCase()+a.slice(1)+" API",providers:[],hasKey:!1}),e[a].providers.push(t.name),f.value.apiKeys?.[a]&&(e[a].hasKey=!0)}return e});async function O(e,a){if(!f.value)return;const t={...f.value.providerConcurrency};t[e]=a,await T.settings.update("main",{providerConcurrency:t})}function j(){p.push("/environmental-config")}function $(){s.reset(),p.push("/welcome")}return(a,t)=>{const l=w("a-tag"),s=w("a-alert"),p=w("a-input-password"),v=w("a-form-item"),C=w("a-col"),D=w("a-row"),A=w("a-form"),L=w("a-card"),z=w("a-button"),V=w("a-divider"),K=w("a-space"),B=w("a-input-number"),W=w("a-slider"),F=w("a-table"),H=w("a-collapse-panel"),J=w("a-collapse"),q=w("a-switch"),Y=w("a-select-option"),Z=w("a-select"),Q=w("a-checkbox"),X=w("a-checkbox-group");return i(),n("div",Ka,[t[31]||(t[31]=o("div",{class:"settings-header"},[o("h2",null,"Settings"),o("p",{class:"description"},"Configure API keys and provider settings for scientific model testing")],-1)),e(L,{title:"API Keys",class:"settings-card",size:"small"},{extra:_(()=>[e(l,{color:"green",size:"small"},{default:_(()=>[m(c(Object.values(M.value).filter(e=>e.hasKey).length)+" / "+c(Object.keys(M.value).length)+" configured ",1)]),_:1})]),default:_(()=>[e(s,{message:"Local Storage Only: API keys are stored locally in your browser and are never sent to auditomatic.org. API Keys only leave your browser as authentication to external LLM API providers, via encrypted HTTPS.",type:"info","show-icon":"",class:"spacing-bottom-md"}),e(A,{layout:"vertical",size:"small"},{default:_(()=>[e(D,{gutter:[16,16]},{default:_(()=>[(i(!0),n(r,null,d(M.value,a=>(i(),k(C,{key:a.id,span:12},{default:_(()=>[e(v,null,{label:_(()=>[o("div",Ba,[m(c(a.name)+" ",1),a.hasKey?(i(),k(l,{key:0,color:"success",size:"small"},{default:_(()=>t[6]||(t[6]=[m("✓ Configured")])),_:1,__:[6]})):(i(),k(l,{key:1,color:"default",size:"small"},{default:_(()=>t[7]||(t[7]=[m("Not configured")])),_:1,__:[7]}))])]),default:_(()=>{return[e(p,{value:(t=a.id,f.value?.apiKeys?.[t]||""),onInput:e=>async function(e,a){const t=a.target.value;if(!f.value)return;const l={...f.value.apiKeys};t?l[e]=t:delete l[e],await T.settings.update("main",{apiKeys:l})}(a.id,e),placeholder:`Enter ${a.name} API key`,autocomplete:"off",size:"small",visibilityToggle:!0,"data-testid":`input-api-key-${a.id}`,"aria-label":`${a.name} API key input`},null,8,["value","onInput","placeholder","data-testid","aria-label"]),o("div",Wa,[o("small",Fa," Used by: "+c(a.providers.join(", ")),1)])];var t}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(L,{title:"Getting Started",class:"settings-card",size:"small"},{extra:_(()=>[e(l,{color:"blue",size:"small"},{default:_(()=>t[8]||(t[8]=[m("Help")])),_:1,__:[8]})]),default:_(()=>[e(K,{direction:"vertical",style:{width:"100%"}},{default:_(()=>[o("div",Ga,[e(b(G),{class:"help-icon"}),o("div",Ha,[t[10]||(t[10]=o("h4",null,"Setup Wizard",-1)),t[11]||(t[11]=o("p",null,"New to Auditomatic? Run the setup wizard to configure providers and learn the basics.",-1)),e(z,{onClick:$},{default:_(()=>t[9]||(t[9]=[m(" Run Setup Wizard ")])),_:1,__:[9]})])]),e(V,{style:{margin:"12px 0"}}),o("div",Ja,[e(b(R),{class:"help-icon"}),o("div",qa,[t[13]||(t[13]=o("h4",null,"Documentation",-1)),t[14]||(t[14]=o("p",null,"Learn more about using Auditomatic Lite for systematic LLM testing.",-1)),e(z,{type:"link",href:"/docs",target:"_blank"},{default:_(()=>t[12]||(t[12]=[m(" View Documentation → ")])),_:1,__:[12]})])])]),_:1})]),_:1}),e(L,{class:"settings-card",size:"small"},{default:_(()=>[e(J,{activeKey:h.value,"onUpdate:activeKey":t[0]||(t[0]=e=>h.value=e),bordered:!1},{default:_(()=>[e(H,{key:"concurrency"},{header:_(()=>t[15]||(t[15]=[o("div",{class:"collapse-header"},[o("span",{class:"collapse-title"},"Concurrency Settings"),o("small",{class:"text-secondary"},"Request limits per provider group (max 6 due to browser limitations)")],-1)])),default:_(()=>[e(s,{message:"Browser Connection Limit",description:"Modern browsers limit HTTP/1.1 connections to 6 per host. Since all AI providers use HTTP/1.1, setting concurrency above 6 will have no effect.",type:"info","show-icon":"",style:{marginBottom:"16px"}}),e(F,{columns:U,"data-source":N.value,pagination:!1,size:"small",class:"scientific-table","row-key":"id"},{bodyCell:_(({column:e,record:a})=>["input"===e.key?(i(),k(B,{key:0,value:a.concurrency,onChange:e=>O(a.id,e),min:1,max:6,disabled:!a.enabled,size:"small",style:{width:"80px"},"data-testid":`input-concurrency-${a.id}`,"aria-label":`Concurrency limit for ${a.name}`},null,8,["value","onChange","disabled","data-testid","aria-label"])):u("",!0),"slider"===e.key?(i(),k(W,{key:1,value:a.concurrency,onChange:e=>O(a.id,e),min:1,max:6,disabled:!a.enabled,style:{width:"150px",margin:"0 auto"},size:"small"},null,8,["value","onChange","disabled"])):u("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1},8,["activeKey"])]),_:1}),e(L,{title:"Cost Tracking",class:"settings-card",size:"small"},{default:_(()=>[o("div",Ya,[t[16]||(t[16]=o("span",{class:"setting-label"},"Financial:",-1)),t[17]||(t[17]=o("span",{class:"setting-desc"},"Display estimated API costs for model usage",-1)),e(q,{checked:x.value,"onUpdate:checked":t[1]||(t[1]=e=>x.value=e),"data-testid":"switch-financial-costs","aria-label":"Enable or disable financial cost display"},null,8,["checked"])]),S.value?(i(),n("div",Za,[t[20]||(t[20]=o("h3",{class:"settings-subsection-title"},"Environmental Impact Display",-1)),o("div",Qa,[o("div",{class:g(["env-toggle-option",{active:!I.value}])},t[18]||(t[18]=[o("strong",null,'Show "??"',-1),o("span",null,"Display as placeholders",-1)]),2),e(q,{checked:I.value,"onUpdate:checked":t[2]||(t[2]=e=>I.value=e),"data-testid":"switch-environmental-costs","aria-label":"Toggle between ?? placeholders and estimates",size:"default"},null,8,["checked"]),o("div",{class:g(["env-toggle-option",{active:I.value}])},t[19]||(t[19]=[o("strong",null,"Show Estimates",-1),o("span",null,"Beta estimates (not recommended)",-1)]),2)]),I.value?(i(),k(s,{key:0,message:"These environmental estimates are very inaccurate and not currently recommended. They're shown for relative comparison only.",type:"warning","show-icon":"",class:"spacing-top-md",style:{fontSize:"12px"}})):u("",!0)])):u("",!0),I.value?(i(),k(A,{key:1,layout:"vertical",size:"small",class:"spacing-top-lg"},{default:_(()=>[e(v,{label:"Primary Environmental Metric"},{default:_(()=>[e(Z,{value:P.value,"onUpdate:value":t[3]||(t[3]=e=>P.value=e),style:{width:"200px"},size:"small","data-testid":"select-environmental-metric","aria-label":"Select primary environmental metric"},{default:_(()=>[e(Y,{value:"carbon"},{default:_(()=>t[21]||(t[21]=[m("Carbon Footprint")])),_:1,__:[21]}),e(Y,{value:"water"},{default:_(()=>t[22]||(t[22]=[m("Water Usage")])),_:1,__:[22]}),e(Y,{value:"energy"},{default:_(()=>t[23]||(t[23]=[m("Energy Consumption")])),_:1,__:[23]})]),_:1},8,["value"])]),_:1}),e(v,{label:"Show Equivalents"},{default:_(()=>[e(X,{value:E.value,"onUpdate:value":t[4]||(t[4]=e=>E.value=e),"data-testid":"checkbox-group-equivalents","aria-label":"Select environmental equivalents to display"},{default:_(()=>[e(Q,{value:"cars","data-testid":"checkbox-equiv-cars"},{default:_(()=>t[24]||(t[24]=[m("Car Miles")])),_:1,__:[24]}),e(Q,{value:"trees","data-testid":"checkbox-equiv-trees"},{default:_(()=>t[25]||(t[25]=[m("Trees Needed")])),_:1,__:[25]}),e(Q,{value:"phones","data-testid":"checkbox-equiv-phones"},{default:_(()=>t[26]||(t[26]=[m("Phone Charges")])),_:1,__:[26]}),e(Q,{value:"bottles","data-testid":"checkbox-equiv-bottles"},{default:_(()=>t[27]||(t[27]=[m("Water Bottles")])),_:1,__:[27]})]),_:1},8,["value"])]),_:1}),e(v,null,{default:_(()=>[e(z,{type:"link",onClick:j,size:"small","data-testid":"btn-configure-environmental","aria-label":"Go to environmental cost configuration"},{default:_(()=>t[28]||(t[28]=[m(" Configure Environmental Cost Data → ")])),_:1,__:[28]})]),_:1})]),_:1})):u("",!0)]),_:1}),e(L,{title:"Background Tab Protection",class:"settings-card",size:"small"},{extra:_(()=>[e(l,{color:"blue",size:"small"},{default:_(()=>t[29]||(t[29]=[m("Performance")])),_:1,__:[29]})]),default:_(()=>[e(Va)]),_:1}),e(L,{class:"settings-card danger-zone-card",size:"small"},{default:_(()=>[e(J,{activeKey:y.value,"onUpdate:activeKey":t[5]||(t[5]=e=>y.value=e),bordered:!1},{default:_(()=>[e(H,{key:"danger-zone"},{header:_(()=>t[30]||(t[30]=[o("div",{class:"collapse-header danger-zone-header"},[o("span",{class:"collapse-title danger-zone-title"},"DANGER ZONE SETTINGS"),o("small",{class:"text-danger"},"Data management & destructive actions")],-1)])),default:_(()=>[e(Ca)]),_:1})]),_:1},8,["activeKey"])]),_:1})])}}}),[["__scopeId","data-v-74c19ead"]]);export{Xa as default};
