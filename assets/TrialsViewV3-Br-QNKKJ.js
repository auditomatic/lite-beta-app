var qt=Object.defineProperty;var Kt=(a,e,t)=>e in a?qt(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var pe=(a,e,t)=>Kt(a,typeof e!="symbol"?e+"":e,t);import{b as V,I as $e,i as oe,r as q,c as M,n as ve,o as he,w as re,j as c,aa as te,k as s,y as O,aL as Ce,af as ge,m as i,_ as ie,ae as Te,aM as Qt,aN as Jt,aO as Xt,q as Y,aP as Yt,aQ as Zt,v as ee,ac as Rt,ab as ke,t as P,F as J,A as se,aH as ut,aR as es,aS as ts,aT as dt,D as z,au as Et,ag as qe,al as Vt,z as C,aU as ss,x as W,P as as,aV as ns,ax as ct,aW as Ke,aD as ls,J as os,K as At,G as is,L as rs,N as pt,aw as us,u as tt,B as le,a as m,s as Pe,d as Qe,aX as Re,aY as Ee,aZ as je,W as Ot,aK as Ft,a_ as ds,ah as Pt,a4 as cs,aq as ps,X as Lt,M as st,aJ as Je,E as fs,ai as Mt,H as ms}from"./index-CL-lquVN.js";import{F as vs}from"./FilterOutlined-Bt14e7LM.js";import{I as gs}from"./InboxOutlined-nr8xdpiD.js";import{S as hs}from"./StopOutlined-CEH26QK8.js";import{F as bs,C as ys,b as Dt,u as _s,a as Ts,c as $s}from"./useV4TrialCommands-B5XSMY5i.js";import{u as Cs}from"./useHeatmapStylingV3-C4Xp1xLn.js";import{u as ks}from"./useV4Models-D0fp-NVp.js";import"./useV4LiveQuery-DdsIQn5B.js";var Ss={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M840 836H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm0-724H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM610.8 378c6 0 9.4-7 5.7-11.7L515.7 238.7a7.14 7.14 0 00-11.3 0L403.6 366.3a7.23 7.23 0 005.7 11.7H476v268h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V378h62.8z"}}]},name:"column-height",theme:"outlined"};function ft(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){ws(a,o,t[o])})}return a}function ws(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var at=function(e,t){var l=ft({},e,t.attrs);return V($e,ft({},l,{icon:Ss}),null)};at.displayName="ColumnHeightOutlined";at.inheritAttrs=!1;var Is={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"}}]},name:"dollar",theme:"outlined"};function mt(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Rs(a,o,t[o])})}return a}function Rs(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var nt=function(e,t){var l=mt({},e,t.attrs);return V($e,mt({},l,{icon:Is}),null)};nt.displayName="DollarOutlined";nt.inheritAttrs=!1;var Es={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"}},{tag:"path",attrs:{d:"M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"}}]},name:"field-time",theme:"outlined"};function vt(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Vs(a,o,t[o])})}return a}function Vs(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var lt=function(e,t){var l=vt({},e,t.attrs);return V($e,vt({},l,{icon:Es}),null)};lt.displayName="FieldTimeOutlined";lt.inheritAttrs=!1;var As={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};function gt(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Os(a,o,t[o])})}return a}function Os(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var ot=function(e,t){var l=gt({},e,t.attrs);return V($e,gt({},l,{icon:As}),null)};ot.displayName="PauseCircleOutlined";ot.inheritAttrs=!1;var Fs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function ht(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Ps(a,o,t[o])})}return a}function Ps(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var it=function(e,t){var l=ht({},e,t.attrs);return V($e,ht({},l,{icon:Fs}),null)};it.displayName="SyncOutlined";it.inheritAttrs=!1;var Ls={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M848 359.3H627.7L825.8 109c4.1-5.3.4-13-6.3-13H436c-2.8 0-5.5 1.5-6.9 4L170 547.5c-3.1 5.3.7 12 6.9 12h174.4l-89.4 357.6c-1.9 7.8 7.5 13.3 13.3 7.7L853.5 373c5.2-4.9 1.7-13.7-5.5-13.7zM378.2 732.5l60.3-241H281.1l189.6-327.4h224.6L487 427.4h211L378.2 732.5z"}}]},name:"thunderbolt",theme:"outlined"};function bt(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){Ms(a,o,t[o])})}return a}function Ms(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var rt=function(e,t){var l=bt({},e,t.attrs);return V($e,bt({},l,{icon:Ls}),null)};rt.displayName="ThunderboltOutlined";rt.inheritAttrs=!1;var Ds={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"};function yt(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},l=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(t).filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),l.forEach(function(o){xs(a,o,t[o])})}return a}function xs(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var Ue=function(e,t){var l=yt({},e,t.attrs);return V($e,yt({},l,{icon:Ds}),null)};Ue.displayName="WarningOutlined";Ue.inheritAttrs=!1;const Us={class:"right-panel"},Ns=oe({__name:"ResizablePanelContainer",props:{storageKey:{default:"trial-list-width"},defaultWidth:{default:250},minWidth:{default:200},maxWidth:{default:600},mobileBreakpoint:{default:768}},emits:["resize","mobile-overlay-change"],setup(a,{expose:e,emit:t}){const l=a,o=t,u=q(l.defaultWidth),d=q(!1),y=q(0),r=q(0),f=q(window.innerWidth),v=q(!1),T=M(()=>f.value<l.mobileBreakpoint),h=M(()=>T.value?{width:`${Math.min(f.value*.85,400)}px`}:{width:`${u.value}px`});function _(){const A=localStorage.getItem(l.storageKey);if(A){const p=parseInt(A,10);!isNaN(p)&&p>=l.minWidth&&p<=l.maxWidth&&(u.value=p)}}function I(A){localStorage.setItem(l.storageKey,A.toString()),o("resize",A)}function b(A){d.value=!0,y.value=A.clientX,r.value=u.value,document.addEventListener("mousemove",k),document.addEventListener("mouseup",H),document.body.style.userSelect="none",document.body.style.cursor="col-resize"}function k(A){if(!d.value)return;const p=A.clientX-y.value,R=Math.max(l.minWidth,Math.min(l.maxWidth,r.value+p));u.value=R}function H(){d.value&&(d.value=!1,I(u.value),document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",H),document.body.style.userSelect="",document.body.style.cursor="")}function F(){u.value=l.defaultWidth,I(l.defaultWidth)}function g(){f.value=window.innerWidth,!T.value&&v.value&&(v.value=!1,o("mobile-overlay-change",!1))}function E(){T.value&&(v.value=!v.value,o("mobile-overlay-change",v.value))}function D(){v.value=!1,o("mobile-overlay-change",!1)}return e({toggleMobileOverlay:E,closeMobileOverlay:D}),ve(()=>{_(),window.addEventListener("resize",g)}),he(()=>{window.removeEventListener("resize",g),H()}),re(()=>l.defaultWidth,A=>{u.value===l.defaultWidth&&(u.value=A)}),(A,p)=>(i(),c("div",{class:te(["resizable-panel-container",{"mobile-overlay":T.value}])},[s("div",{class:te(["left-panel",{"overlay-visible":T.value&&v.value}]),style:ge(h.value)},[Ce(A.$slots,"left",{},void 0,!0)],6),T.value?O("",!0):(i(),c("div",{key:0,class:te(["resize-handle",{dragging:d.value}]),onMousedown:b,onDblclick:F},p[0]||(p[0]=[s("div",{class:"handle-bar"},null,-1)]),34)),s("div",Us,[Ce(A.$slots,"right",{},void 0,!0)]),T.value&&v.value?(i(),c("div",{key:1,class:"mobile-overlay-bg",onClick:D})):O("",!0)],2))}}),zs=ie(Ns,[["__scopeId","data-v-949e1df1"]]);function Ws(){var a=window.navigator.userAgent,e=a.indexOf("MSIE ");if(e>0)return parseInt(a.substring(e+5,a.indexOf(".",e)),10);var t=a.indexOf("Trident/");if(t>0){var l=a.indexOf("rv:");return parseInt(a.substring(l+3,a.indexOf(".",l)),10)}var o=a.indexOf("Edge/");return o>0?parseInt(a.substring(o+5,a.indexOf(".",o)),10):-1}let Le;function Xe(){Xe.init||(Xe.init=!0,Le=Ws()!==-1)}var Ne={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Xe(),Te(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const a=document.createElement("object");this._resizeObject=a,a.setAttribute("aria-hidden","true"),a.setAttribute("tabindex",-1),a.onload=this.addResizeHandlers,a.type="text/html",Le&&this.$el.appendChild(a),a.data="about:blank",Le||this.$el.appendChild(a)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Le&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Hs=Xt();Qt("data-v-b329ee4c");const Bs={class:"resize-observer",tabindex:"-1"};Jt();const js=Hs((a,e,t,l,o,u)=>(i(),Y("div",Bs)));Ne.render=js;Ne.__scopeId="data-v-b329ee4c";Ne.__file="src/components/ResizeObserver.vue";function Me(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Me=function(e){return typeof e}:Me=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me(a)}function Gs(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function qs(a,e){for(var t=0;t<e.length;t++){var l=e[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(a,l.key,l)}}function Ks(a,e,t){return e&&qs(a.prototype,e),a}function _t(a){return Qs(a)||Js(a)||Xs(a)||Ys()}function Qs(a){if(Array.isArray(a))return Ye(a)}function Js(a){if(typeof Symbol<"u"&&Symbol.iterator in Object(a))return Array.from(a)}function Xs(a,e){if(a){if(typeof a=="string")return Ye(a,e);var t=Object.prototype.toString.call(a).slice(8,-1);if(t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set")return Array.from(a);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ye(a,e)}}function Ye(a,e){(e==null||e>a.length)&&(e=a.length);for(var t=0,l=new Array(e);t<e;t++)l[t]=a[t];return l}function Ys(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zs(a){var e;return typeof a=="function"?e={callback:a}:e=a,e}function ea(a,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l,o,u,d=function(r){for(var f=arguments.length,v=new Array(f>1?f-1:0),T=1;T<f;T++)v[T-1]=arguments[T];if(u=v,!(l&&r===o)){var h=t.leading;typeof h=="function"&&(h=h(r,o)),(!l||r!==o)&&h&&a.apply(void 0,[r].concat(_t(u))),o=r,clearTimeout(l),l=setTimeout(function(){a.apply(void 0,[r].concat(_t(u))),l=0},e)}};return d._clear=function(){clearTimeout(l),l=null},d}function xt(a,e){if(a===e)return!0;if(Me(a)==="object"){for(var t in a)if(!xt(a[t],e[t]))return!1;return!0}return!1}var ta=function(){function a(e,t,l){Gs(this,a),this.el=e,this.observer=null,this.frozen=!1,this.createObserver(t,l)}return Ks(a,[{key:"createObserver",value:function(t,l){var o=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Zs(t),this.callback=function(y,r){o.options.callback(y,r),y&&o.options.once&&(o.frozen=!0,o.destroyObserver())},this.callback&&this.options.throttle){var u=this.options.throttleOptions||{},d=u.leading;this.callback=ea(this.callback,this.options.throttle,{leading:function(r){return d==="both"||d==="visible"&&r||d==="hidden"&&!r}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(y){var r=y[0];if(y.length>1){var f=y.find(function(T){return T.isIntersecting});f&&(r=f)}if(o.callback){var v=r.isIntersecting&&r.intersectionRatio>=o.threshold;if(v===o.oldResult)return;o.oldResult=v,o.callback(v,r)}},this.options.intersection),Te(function(){o.observer&&o.observer.observe(o.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),a}();function Ut(a,e,t){var l=e.value;if(l)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var o=new ta(a,l,t);a._vue_visibilityState=o}}function sa(a,e,t){var l=e.value,o=e.oldValue;if(!xt(l,o)){var u=a._vue_visibilityState;if(!l){Nt(a);return}u?u.createObserver(l,t):Ut(a,{value:l},t)}}function Nt(a){var e=a._vue_visibilityState;e&&(e.destroyObserver(),delete a._vue_visibilityState)}var aa={beforeMount:Ut,updated:sa,unmounted:Nt},na={itemsLimit:1e3},la=/(auto|scroll)/;function zt(a,e){return a.parentNode===null?e:zt(a.parentNode,e.concat([a]))}var Ge=function(e,t){return getComputedStyle(e,null).getPropertyValue(t)},oa=function(e){return Ge(e,"overflow")+Ge(e,"overflow-y")+Ge(e,"overflow-x")},ia=function(e){return la.test(oa(e))};function Tt(a){if(a instanceof HTMLElement||a instanceof SVGElement){for(var e=zt(a.parentNode,[]),t=0;t<e.length;t+=1)if(ia(e[t]))return e[t];return document.scrollingElement||document.documentElement}}function Ze(a){"@babel/helpers - typeof";return Ze=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(a)}var ra={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(e){return["vertical","horizontal"].includes(e)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function ua(){return this.items.length&&Ze(this.items[0])!=="object"}var et=!1;if(typeof window<"u"){et=!1;try{var da=Object.defineProperty({},"passive",{get:function(){et=!0}});window.addEventListener("test",null,da)}catch{}}let ca=0;var ze={name:"RecycleScroller",components:{ResizeObserver:Ne},directives:{ObserveVisibility:aa},props:{...ra,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const a={"-1":{accumulator:0}},e=this.items,t=this.sizeField,l=this.minItemSize;let o=1e4,u=0,d;for(let y=0,r=e.length;y<r;y++)d=e[y][t]||l,d<o&&(o=d),u+=d,a[y]={accumulator:u,size:d};return this.$_computedMinItemSize=o,a}return[]},simpleArray:ua,itemIndexByKey(){const{keyField:a,items:e}=this,t={};for(let l=0,o=e.length;l<o;l++)t[e[l][a]]=l;return t}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const a=this.$_lastUpdateScrollPosition;typeof a=="number"&&this.$nextTick(()=>{this.scrollToPosition(a)})},beforeUnmount(){this.removeListeners()},methods:{addView(a,e,t,l,o){const u=Yt({id:ca++,index:e,used:!0,key:l,type:o}),d=Zt({item:t,position:0,nr:u});return a.push(d),d},unuseView(a,e=!1){const t=this.$_unusedViews,l=a.nr.type;let o=t.get(l);o||(o=[],t.set(l,o)),o.push(a),e||(a.nr.used=!1,a.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(a){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const e=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:t}=this.updateVisibleItems(!1,!0);t||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});e(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&e()},this.updateInterval))}},handleVisibilityChange(a,e){this.ready&&(a||e.boundingClientRect.width!==0||e.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(a,e=!1){const t=this.itemSize,l=this.gridItems||1,o=this.itemSecondarySize||t,u=this.$_computedMinItemSize,d=this.typeField,y=this.simpleArray?null:this.keyField,r=this.items,f=r.length,v=this.sizes,T=this.$_views,h=this.$_unusedViews,_=this.pool,I=this.itemIndexByKey;let b,k,H,F,g;if(!f)b=k=F=g=H=0;else if(this.$_prerender)b=F=0,k=g=Math.min(this.prerender,r.length),H=null;else{const n=this.getScroll();if(e){let $=n.start-this.$_lastUpdateScrollPosition;if($<0&&($=-$),t===null&&$<u||$<t)return{continuous:!0}}this.$_lastUpdateScrollPosition=n.start;const S=this.buffer;n.start-=S,n.end+=S;let N=0;if(this.$refs.before&&(N=this.$refs.before.scrollHeight,n.start-=N),this.$refs.after){const $=this.$refs.after.scrollHeight;n.end+=$}if(t===null){let $,B=0,ae=f-1,w=~~(f/2),Z;do Z=w,$=v[w].accumulator,$<n.start?B=w:w<f-1&&v[w+1].accumulator>n.start&&(ae=w),w=~~((B+ae)/2);while(w!==Z);for(w<0&&(w=0),b=w,H=v[f-1].accumulator,k=w;k<f&&v[k].accumulator<n.end;k++);for(k===-1?k=r.length-1:(k++,k>f&&(k=f)),F=b;F<f&&N+v[F].accumulator<n.start;F++);for(g=F;g<f&&N+v[g].accumulator<n.end;g++);}else{b=~~(n.start/t*l);const $=b%l;b-=$,k=Math.ceil(n.end/t*l),F=Math.max(0,Math.floor((n.start-N)/t*l)),g=Math.floor((n.end-N)/t*l),b<0&&(b=0),k>f&&(k=f),F<0&&(F=0),g>f&&(g=f),H=Math.ceil(f/l)*t}}k-b>na.itemsLimit&&this.itemsLimitError(),this.totalSize=H;let E;const D=b<=this.$_endIndex&&k>=this.$_startIndex;if(D)for(let n=0,S=_.length;n<S;n++)E=_[n],E.nr.used&&(a&&(E.nr.index=I[E.item[y]]),(E.nr.index==null||E.nr.index<b||E.nr.index>=k)&&this.unuseView(E));const A=D?null:new Map;let p,R,U;for(let n=b;n<k;n++){p=r[n];const S=y?p[y]:p;if(S==null)throw new Error(`Key is ${S} on item (keyField is '${y}')`);if(E=T.get(S),!t&&!v[n].size){E&&this.unuseView(E);continue}R=p[d];let N=h.get(R),$=!1;if(!E)D?N&&N.length?E=N.pop():E=this.addView(_,n,p,S,R):(U=A.get(R)||0,(!N||U>=N.length)&&(E=this.addView(_,n,p,S,R),this.unuseView(E,!0),N=h.get(R)),E=N[U],A.set(R,U+1)),T.delete(E.nr.key),E.nr.used=!0,E.nr.index=n,E.nr.key=S,E.nr.type=R,T.set(S,E),$=!0;else if(!E.nr.used&&(E.nr.used=!0,$=!0,N)){const B=N.indexOf(E);B!==-1&&N.splice(B,1)}E.item=p,$&&(n===r.length-1&&this.$emit("scroll-end"),n===0&&this.$emit("scroll-start")),t===null?(E.position=v[n-1].accumulator,E.offset=0):(E.position=Math.floor(n/l)*t,E.offset=n%l*o)}return this.$_startIndex=b,this.$_endIndex=k,this.emitUpdate&&this.$emit("update",b,k,F,g),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:D}},getListenerTarget(){let a=Tt(this.$el);return window.document&&(a===window.document.documentElement||a===window.document.body)&&(a=window),a},getScroll(){const{$el:a,direction:e}=this,t=e==="vertical";let l;if(this.pageMode){const o=a.getBoundingClientRect(),u=t?o.height:o.width;let d=-(t?o.top:o.left),y=t?window.innerHeight:window.innerWidth;d<0&&(y+=d,d=0),d+y>u&&(y=u-d),l={start:d,end:d+y}}else t?l={start:a.scrollTop,end:a.scrollTop+a.clientHeight}:l={start:a.scrollLeft,end:a.scrollLeft+a.clientWidth};return l},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,et?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(a){let e;const t=this.gridItems||1;this.itemSize===null?e=a>0?this.sizes[a-1].accumulator:0:e=Math.floor(a/t)*this.itemSize,this.scrollToPosition(e)},scrollToPosition(a){const e=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let t,l,o;if(this.pageMode){const u=Tt(this.$el),d=u.tagName==="HTML"?0:u[e.scroll],y=u.getBoundingClientRect(),f=this.$el.getBoundingClientRect()[e.start]-y[e.start];t=u,l=e.scroll,o=a+d+f}else t=this.$el,l=e.scroll,o=a;t[l]=o},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((a,e)=>a.nr.index-e.nr.index)}}};const pa={key:0,ref:"before",class:"vue-recycle-scroller__slot"},fa={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function ma(a,e,t,l,o,u){const d=ee("ResizeObserver"),y=Rt("observe-visibility");return ke((i(),c("div",{class:te(["vue-recycle-scroller",{ready:o.ready,"page-mode":t.pageMode,[`direction-${a.direction}`]:!0}]),onScrollPassive:e[0]||(e[0]=(...r)=>u.handleScroll&&u.handleScroll(...r))},[a.$slots.before?(i(),c("div",pa,[Ce(a.$slots,"before")],512)):O("v-if",!0),(i(),Y(ut(t.listTag),{ref:"wrapper",style:ge({[a.direction==="vertical"?"minHeight":"minWidth"]:o.totalSize+"px"}),class:te(["vue-recycle-scroller__item-wrapper",t.listClass])},{default:P(()=>[(i(!0),c(J,null,se(o.pool,r=>(i(),Y(ut(t.itemTag),es({key:r.nr.id,style:o.ready?{transform:`translate${a.direction==="vertical"?"Y":"X"}(${r.position}px) translate${a.direction==="vertical"?"X":"Y"}(${r.offset}px)`,width:t.gridItems?`${a.direction==="vertical"&&t.itemSecondarySize||t.itemSize}px`:void 0,height:t.gridItems?`${a.direction==="horizontal"&&t.itemSecondarySize||t.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[t.itemClass,{hover:!t.skipHover&&o.hoverKey===r.nr.key}]]},ts(t.skipHover?{}:{mouseenter:()=>{o.hoverKey=r.nr.key},mouseleave:()=>{o.hoverKey=null}})),{default:P(()=>[Ce(a.$slots,"default",{item:r.item,index:r.nr.index,active:r.nr.used})]),_:2},1040,["style","class"]))),128)),Ce(a.$slots,"empty")]),_:3},8,["style","class"])),a.$slots.after?(i(),c("div",fa,[Ce(a.$slots,"after")],512)):O("v-if",!0),V(d,{onNotify:u.handleResize},null,8,["onNotify"])],34)),[[y,u.handleVisibilityChange]])}ze.render=ma;ze.__file="src/components/RecycleScroller.vue";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const $t=()=>{};function va(a,e){function t(...l){return new Promise((o,u)=>{Promise.resolve(a(()=>e.apply(this,l),{fn:e,thisArg:this,args:l})).then(o).catch(u)})}return t}function ga(a,e={}){let t,l,o=$t;const u=r=>{clearTimeout(r),o(),o=$t};let d;return r=>{const f=dt(a),v=dt(e.maxWait);return t&&u(t),f<=0||v!==void 0&&v<=0?(l&&(u(l),l=void 0),Promise.resolve(r())):new Promise((T,h)=>{o=e.rejectOnCancel?h:T,d=r,v&&!l&&(l=setTimeout(()=>{t&&u(t),l=void 0,T(d())},v)),t=setTimeout(()=>{l&&u(l),l=void 0,T(r())},f)})}}function Wt(a,e=200,t={}){return va(ga(e,t),a)}const ha={class:"trial-list-search"},ba=["value"],ya=oe({__name:"TrialListSearch",props:{modelValue:{}},emits:["update:modelValue"],setup(a,{emit:e}){const t=e,l=q(),o=Wt(f=>{t("update:modelValue",f)},300);function u(f){const v=f.target.value;o(v)}function d(){var f;t("update:modelValue",""),(f=l.value)==null||f.focus()}function y(){var f,v;(f=l.value)==null||f.focus(),(v=l.value)==null||v.select()}function r(f){f.type==="focus-trial-search"&&y()}return ve(()=>{window.addEventListener("focus-trial-search",r)}),he(()=>{window.removeEventListener("focus-trial-search",r)}),(f,v)=>(i(),c("div",ha,[V(z(Et),{class:"search-icon"}),s("input",{ref_key:"searchInput",ref:l,type:"text",class:"search-input",placeholder:"Filter trials...",value:f.modelValue,onInput:u,onKeydown:qe(d,["escape"])},null,40,ba),f.modelValue?(i(),Y(z(Vt),{key:0,class:"clear-icon",onClick:d})):O("",!0)]))}}),_a=ie(ya,[["__scopeId","data-v-3a032c2b"]]),Ta={class:"item-content"},$a={class:"item-header"},Ca=["title"],ka={key:0,class:"progress-bar"},Sa={class:"item-metadata"},wa={class:"meta-item"},Ia={class:"meta-item"},Ra={key:0,class:"meta-separator"},Ea={key:1,class:"meta-item cost"},Va=oe({__name:"TrialListItem",props:{trial:{},selected:{type:Boolean}},emits:["click"],setup(a){const e=a,t=M(()=>{if(e.trial.progress.total===0)return 0;const d=e.trial.progress.completed+e.trial.progress.failed;return Math.round(d/e.trial.progress.total*100)}),l=M(()=>{const{completed:d,failed:y,total:r}=e.trial.progress;return e.trial.status==="draft"?`${r} tasks`:`${d+y}/${r} tasks`}),o=M(()=>{const d=e.trial.started||e.trial.created;if(!d)return"";const r=new Date().getTime()-d.getTime(),f=Math.floor(r/1e3),v=Math.floor(f/60),T=Math.floor(v/60),h=Math.floor(T/24);return f<60?"now":v<60?`${v}m`:T<24?`${T}h`:`${h}d`}),u=M(()=>{if(!e.trial.configurations||e.trial.configurations.length===0)return null;let d=0;return e.trial.configurations.forEach(y=>{var f,v;const r=y.modelSnapshot;if((f=r==null?void 0:r.capabilities)!=null&&f.inputCostPerToken&&((v=r==null?void 0:r.capabilities)!=null&&v.outputCostPerToken)){const T=500*r.capabilities.inputCostPerToken+500*r.capabilities.outputCostPerToken;d+=T*(e.trial.progress.total/e.trial.configurations.length)}}),d===0?null:d<.01?"<$0.01":d<1?`$${d.toFixed(2)}`:`$${d.toFixed(0)}`});return(d,y)=>(i(),c("div",{class:te(["trial-list-item",{selected:d.selected,"has-progress":d.trial.status==="running"}]),onClick:y[0]||(y[0]=r=>d.$emit("click"))},[s("div",{class:te(["status-indicator",`status-${d.trial.status}`])},null,2),s("div",Ta,[s("div",$a,[s("span",{class:"trial-name",title:d.trial.name},C(d.trial.name),9,Ca),s("span",{class:te(["status-tag",`status-${d.trial.status}`])},C(d.trial.status.toUpperCase()),3)]),d.trial.status==="running"?(i(),c("div",ka,[s("div",{class:"progress-fill",style:ge({width:`${t.value}%`})},null,4)])):O("",!0),s("div",Sa,[s("span",wa,C(l.value),1),y[1]||(y[1]=s("span",{class:"meta-separator"},"â€¢",-1)),s("span",Ia,C(o.value),1),u.value?(i(),c("span",Ra,"â€¢")):O("",!0),u.value?(i(),c("span",Ea,C(u.value),1)):O("",!0)])])],2))}}),Ct=ie(Va,[["__scopeId","data-v-f0ccace4"]]),Aa={class:"section-title"},Oa=oe({__name:"TrialListSection",props:{title:{},background:{type:Boolean}},setup(a){return(e,t)=>(i(),c("div",{class:te(["trial-list-section",{"with-background":e.background}])},[s("span",Aa,C(e.title),1)],2))}}),kt=ie(Oa,[["__scopeId","data-v-07a26c58"]]),Fa={class:"panel-header"},Pa={class:"header-title"},La={key:0,class:"title-text"},Ma={class:"trial-count"},Da={key:0,class:"header-actions"},xa={class:"filter-count"},Ua={class:"filter-count"},Na={class:"filter-count"},za={class:"filter-count"},Wa={class:"filter-count"},Ha={key:1,class:"status-tabs"},Ba={class:"tab-count"},ja={class:"tab-count"},Ga={class:"tab-count"},qa={class:"trial-list-container"},Ka={key:1,class:"trial-list"},Qa={key:2,class:"collapsed-list"},Ja=["onClick"],Xa={class:"collapsed-count"},Ya={key:3,class:"empty-state"},Za=oe({__name:"TrialListPanelV3",props:{trials:{},selectedTrialId:{},searchQuery:{},filterStatus:{}},emits:["select-trial","create-trial","update-search","update-filter","refresh"],setup(a,{emit:e}){const t=a,l=e,o=q(!1),u=q("all"),d=q(250),y=M(()=>d.value<50),r=M(()=>t.trials.filter(A=>A.status==="running"||A.status==="paused").length),f=M(()=>t.trials.filter(A=>A.status==="completed"||A.status==="failed").length),v=M(()=>{let A=t.trials;if(t.searchQuery){const n=t.searchQuery.toLowerCase();A=A.filter(S=>{var ae,w;const N=S.name.toLowerCase().includes(n),$=(w=(ae=S.templateConfig)==null?void 0:ae.template)==null?void 0:w.toLowerCase().includes(n),B=S.configurations.some(Z=>Z.modelId.toLowerCase().includes(n)||Z.provider.toLowerCase().includes(n));return N||$||B})}t.filterStatus!=="all"&&(A=A.filter(n=>n.status===t.filterStatus)),u.value==="active"?A=A.filter(n=>n.status==="running"||n.status==="paused"):u.value==="done"&&(A=A.filter(n=>n.status==="completed"||n.status==="failed"));const p=A.filter(n=>n.status==="running"),R=A.filter(n=>n.status!=="running"),U=[];return p.length>0&&(U.push({type:"section",title:"RUNNING",background:!0,id:"section-running"}),U.push(...p.sort((n,S)=>{var N,$;return(((N=S.started)==null?void 0:N.getTime())||0)-((($=n.started)==null?void 0:$.getTime())||0)}))),R.length>0&&(p.length>0&&U.push({type:"section",title:"RECENT",background:!1,id:"section-recent"}),U.push(...R.sort((n,S)=>{var N,$;return(((N=S.created)==null?void 0:N.getTime())||0)-((($=n.created)==null?void 0:$.getTime())||0)}))),U}),T=M(()=>v.value.map(A=>({...A,height:H(A)}))),h=M(()=>t.trials.filter(A=>u.value==="active"?A.status==="running"||A.status==="paused":u.value==="done"?A.status==="completed"||A.status==="failed":!0)),_=M(()=>t.searchQuery?"No trials found":t.filterStatus==="running"?"No trials are currently running":"No trials found"),I=M(()=>t.searchQuery?"No trials match your search":t.filterStatus!=="all"?`No ${t.filterStatus} trials`:"Create your first trial to get started"),b=M(()=>t.filterStatus==="all"&&!t.searchQuery);function k(A){return t.trials.filter(p=>p.status===A).length}function H(A){var U;if(A.type==="section")return 32;const p=A.status==="running",R=(U=A.configurations)==null?void 0:U.some(n=>n.repeatCount>1);return p||R?96:80}function F(A){const p=A.progress.completed+A.progress.failed;return A.status==="running"?`${Math.round(p/A.progress.total*100)}%`:p.toString()}async function g(){o.value=!0;try{await new Promise(A=>setTimeout(A,500)),l("refresh")}finally{o.value=!1}}function E({key:A}){l("update-filter",A)}function D(){const A=document.querySelector(".trial-list-panel");A&&(d.value=A.clientWidth)}return ve(()=>{D(),window.addEventListener("resize",D);const A=document.querySelector(".trial-list-panel");A&&new ResizeObserver(()=>D()).observe(A)}),he(()=>{window.removeEventListener("resize",D)}),(A,p)=>{const R=ee("a-button"),U=ee("a-menu-item"),n=ee("a-menu-divider"),S=ee("a-menu"),N=ee("a-dropdown");return i(),c("div",{class:te(["trial-list-panel",{collapsed:y.value}])},[s("div",Fa,[s("div",Pa,[V(z(ss),{class:"title-icon"}),y.value?O("",!0):(i(),c("span",La,"Trials")),s("span",Ma,C(A.trials.length),1)]),y.value?O("",!0):(i(),c("div",Da,[V(R,{type:"primary",size:"small",onClick:p[0]||(p[0]=$=>A.$emit("create-trial"))},{default:P(()=>[V(z(as)),p[6]||(p[6]=W(" New Trial "))]),_:1,__:[6]}),V(R,{size:"small",onClick:g,loading:o.value},{default:P(()=>[V(z(it),{spin:o.value},null,8,["spin"])]),_:1},8,["loading"]),V(N,null,{overlay:P(()=>[V(S,{onClick:E},{default:P(()=>[V(U,{key:"all"},{default:P(()=>p[7]||(p[7]=[s("span",null,"All Trials",-1)])),_:1,__:[7]}),V(n),V(U,{key:"running"},{default:P(()=>[p[8]||(p[8]=s("span",null,"Running Only",-1)),s("span",xa,C(k("running")),1)]),_:1,__:[8]}),V(U,{key:"completed"},{default:P(()=>[p[9]||(p[9]=s("span",null,"Completed Only",-1)),s("span",Ua,C(k("completed")),1)]),_:1,__:[9]}),V(U,{key:"failed"},{default:P(()=>[p[10]||(p[10]=s("span",null,"Failed Only",-1)),s("span",Na,C(k("failed")),1)]),_:1,__:[10]}),V(U,{key:"paused"},{default:P(()=>[p[11]||(p[11]=s("span",null,"Paused Only",-1)),s("span",za,C(k("paused")),1)]),_:1,__:[11]}),V(U,{key:"draft"},{default:P(()=>[p[12]||(p[12]=s("span",null,"Draft Only",-1)),s("span",Wa,C(k("draft")),1)]),_:1,__:[12]})]),_:1})]),default:P(()=>[V(R,{size:"small"},{default:P(()=>[V(z(vs))]),_:1})]),_:1})]))]),y.value?O("",!0):(i(),Y(_a,{key:0,"model-value":A.searchQuery,"onUpdate:modelValue":p[1]||(p[1]=$=>A.$emit("update-search",$))},null,8,["model-value"])),y.value?O("",!0):(i(),c("div",Ha,[s("div",{class:te(["status-tab",{active:u.value==="all"}]),onClick:p[2]||(p[2]=$=>u.value="all")},[p[13]||(p[13]=s("span",{class:"tab-icon"},"ðŸ“Š",-1)),p[14]||(p[14]=s("span",{class:"tab-label"},"ALL",-1)),s("span",Ba,C(A.trials.length),1)],2),s("div",{class:te(["status-tab",{active:u.value==="active"}]),onClick:p[3]||(p[3]=$=>u.value="active")},[p[15]||(p[15]=s("span",{class:"tab-icon"},"ðŸŸ¢",-1)),p[16]||(p[16]=s("span",{class:"tab-label"},"Active",-1)),s("span",ja,C(r.value),1)],2),s("div",{class:te(["status-tab",{active:u.value==="done"}]),onClick:p[4]||(p[4]=$=>u.value="done")},[p[17]||(p[17]=s("span",{class:"tab-icon"},"âœ…",-1)),p[18]||(p[18]=s("span",{class:"tab-label"},"Done",-1)),s("span",Ga,C(f.value),1)],2)])),s("div",qa,[!y.value&&v.value.length>100?(i(),Y(z(ze),{key:0,class:"trial-list virtual-list",items:T.value,"size-field":"height","key-field":"id",buffer:10},{default:P(({item:$})=>[$.type==="section"?(i(),Y(kt,{key:0,title:$.title,background:$.background},null,8,["title","background"])):(i(),Y(Ct,{key:1,trial:$,selected:$.id===A.selectedTrialId,"data-trial-id":$.id,onClick:B=>A.$emit("select-trial",$.id)},null,8,["trial","selected","data-trial-id","onClick"]))]),_:1},8,["items"])):y.value?(i(),c("div",Qa,[(i(!0),c(J,null,se(h.value,$=>(i(),c("div",{key:$.id,class:te(["collapsed-item",{selected:$.id===A.selectedTrialId}]),onClick:B=>A.$emit("select-trial",$.id)},[s("div",{class:te(["status-dot",`status-${$.status}`])},null,2),s("span",Xa,C(F($)),1)],10,Ja))),128))])):(i(),c("div",Ka,[(i(!0),c(J,null,se(v.value,($,B)=>(i(),c(J,{key:$.id||`section-${B}`},[$.type==="section"?(i(),Y(kt,{key:0,title:$.title,background:$.background},null,8,["title","background"])):(i(),Y(Ct,{key:1,trial:$,selected:$.id===A.selectedTrialId,"data-trial-id":$.id,onClick:ae=>A.$emit("select-trial",$.id)},null,8,["trial","selected","data-trial-id","onClick"]))],64))),128))])),v.value.length===0&&!y.value?(i(),c("div",Ya,[V(z(gs),{class:"empty-icon"}),s("h3",null,C(_.value),1),s("p",null,C(I.value),1),b.value?(i(),Y(R,{key:0,type:"primary",size:"large",onClick:p[5]||(p[5]=$=>A.$emit("create-trial"))},{default:P(()=>p[19]||(p[19]=[W(" Create New Trial ")])),_:1,__:[19]})):O("",!0)])):O("",!0)])],2)}}}),en=ie(Za,[["__scopeId","data-v-46871462"]]),tn={class:"trial-header"},sn={class:"header-main"},an={class:"header-title"},nn={class:"trial-name"},ln={key:0,class:"progress-container"},on={class:"progress-bar"},rn={class:"progress-text"},un={class:"header-stats"},dn={class:"stat-item"},cn={class:"stat-value"},pn={key:0,class:"stat-item"},fn={class:"stat-value"},mn={key:1,class:"stat-item"},vn={class:"stat-value"},gn={key:2,class:"stat-item"},hn={class:"stat-value"},bn=oe({__name:"TrialHeaderV3",props:{trial:{},progress:{},isExecuting:{type:Boolean}},setup(a){const e=a,t=M(()=>{let v=e.trial.name;return v=v.replace(/\s*-\s*\d{1,2}\/\d{1,2}\/\d{4}$/,""),v=v.replace(/\s*\(Copy\)(\s*\(Copy\))*/g,""),v.trim()}),l=M(()=>e.trial.status==="running"||e.trial.status==="paused"||e.trial.status==="completed"&&e.progress),o=M(()=>e.progress?e.progress.completed+e.progress.failed:0),u=M(()=>{if(!e.progress||e.progress.total===0)return 0;const v=e.progress.completed+e.progress.failed;return Math.round(v/e.progress.total*100)}),d=M(()=>{const v=e.trial.started||e.trial.created;if(!v)return"0m";const h=(e.trial.completed||new Date).getTime()-v.getTime(),_=Math.floor(h/(1e3*60*60)),I=Math.floor(h%(1e3*60*60)/(1e3*60));return _>0?`${_}h ${I}m`:`${I}m`}),y=M(()=>!e.progress||e.progress.completed===0?null:`${(3600/1e3).toFixed(1)}s`),r=M(()=>{var _;if(!e.trial.configurations||e.trial.configurations.length===0)return null;let v=0;const T=((_=e.progress)==null?void 0:_.total)||e.trial.progress.total,h=Math.ceil(T/e.trial.configurations.length);return e.trial.configurations.forEach(I=>{var k,H;const b=I.modelSnapshot;if((k=b==null?void 0:b.capabilities)!=null&&k.inputCostPerToken&&((H=b==null?void 0:b.capabilities)!=null&&H.outputCostPerToken)){const F=500*b.capabilities.inputCostPerToken+500*b.capabilities.outputCostPerToken;v+=F*h}}),v===0?null:(e.progress&&e.progress.completed>0&&(v=v*(e.progress.completed/T)),`$${v.toFixed(2)}`)}),f=M(()=>{var b;if(e.trial.status!=="running"||!e.progress||e.progress.completed===0)return null;const T=(Date.now()-(((b=e.trial.started)==null?void 0:b.getTime())||0))/e.progress.completed,h=e.progress.pending*T,_=Math.floor(h/(1e3*60)),I=Math.floor(h%(1e3*60)/1e3);if(_>60){const k=Math.floor(_/60),H=_%60;return`${k}h ${H}m`}return`${_}m ${I}s`});return(v,T)=>{var h;return i(),c("div",tn,[s("div",sn,[s("div",an,[s("h2",nn,C(t.value),1),s("span",{class:te(["status-tag",`status-${v.trial.status}`])},C(v.trial.status.toUpperCase()),3)]),l.value?(i(),c("div",ln,[s("div",on,[s("div",{class:"progress-fill",style:ge({width:`${u.value}%`})},null,4)]),s("span",rn,C(o.value)+"/"+C(((h=v.progress)==null?void 0:h.total)||0)+" ("+C(u.value)+"%) ",1)])):O("",!0)]),s("div",un,[s("div",dn,[V(z(ns),{class:"stat-icon"}),s("span",cn,C(d.value),1)]),y.value?(i(),c("div",pn,[V(z(rt),{class:"stat-icon"}),s("span",fn,C(y.value),1)])):O("",!0),r.value?(i(),c("div",mn,[V(z(nt),{class:"stat-icon"}),s("span",vn,C(r.value),1)])):O("",!0),f.value?(i(),c("div",gn,[V(z(lt),{class:"stat-icon"}),s("span",hn,"~"+C(f.value),1)])):O("",!0)])])}}}),yn=ie(bn,[["__scopeId","data-v-36b15977"]]),_n={class:"trial-actions"},Tn={class:"action-group execution-controls"},$n={class:"action-group data-actions"},Cn={class:"action-group management-actions"},kn=oe({__name:"TrialActionsV3",props:{trial:{},isLeader:{type:Boolean},executionState:{}},emits:["start","pause","resume","cancel","duplicate","edit","delete","export-data","export-python","refresh"],setup(a,{emit:e}){const t=a,l=e,o=q(!1),u=q(!1);M(()=>{var g;return((g=t.executionState)==null?void 0:g.currentTrialId)===t.trial.id});const d=M(()=>["draft","failed","cancelled"].includes(t.trial.status)),y=M(()=>t.trial.status==="running"),r=M(()=>t.trial.status==="paused"),f=M(()=>["running","paused"].includes(t.trial.status));function v(){l("start")}function T(){l("pause")}async function h(){o.value=!0,l("resume"),setTimeout(()=>{o.value=!1},3e3)}function _(){pt.confirm({title:"Cancel trial?",content:"This will stop all pending API calls.",okText:"Cancel Trial",okType:"danger",onOk:()=>l("cancel")})}async function I(){u.value=!0,l("refresh"),setTimeout(()=>{u.value=!1},500)}function b({key:g}){g==="data"?l("export-data"):g==="python"&&l("export-python")}function k(){l("duplicate")}function H(){l("edit")}function F(){const g=t.trial.progress.total;pt.confirm({title:"Delete trial?",content:`Delete trial and all ${g} API calls?`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:()=>{l("delete")}})}return(g,E)=>{const D=ee("a-button"),A=ee("a-menu-item"),p=ee("a-menu"),R=ee("a-dropdown");return i(),c("div",_n,[s("div",Tn,[d.value?(i(),Y(D,{key:0,type:"primary",size:"large",disabled:!g.isLeader,onClick:v},{default:P(()=>[V(z(ct)),E[0]||(E[0]=W(" Start Trial "))]),_:1,__:[0]},8,["disabled"])):O("",!0),y.value?(i(),Y(D,{key:1,size:"large",disabled:!g.isLeader,onClick:T},{default:P(()=>[V(z(ot)),E[1]||(E[1]=W(" Pause "))]),_:1,__:[1]},8,["disabled"])):O("",!0),r.value?(i(),Y(D,{key:2,type:"primary",size:"large",disabled:!g.isLeader||o.value,loading:o.value,onClick:h},{default:P(()=>[o.value?(i(),Y(z(Ke),{key:1,spin:""})):(i(),Y(z(ct),{key:0})),W(" "+C(o.value?"Resuming...":"Resume"),1)]),_:1},8,["disabled","loading"])):O("",!0),f.value?(i(),Y(D,{key:3,danger:"",size:"large",disabled:!g.isLeader,onClick:_},{default:P(()=>[V(z(hs)),E[2]||(E[2]=W(" Cancel "))]),_:1,__:[2]},8,["disabled"])):O("",!0)]),s("div",$n,[V(D,{size:"large",loading:u.value,onClick:I,title:"Refresh trial data from database"},{default:P(()=>[u.value?(i(),Y(z(Ke),{key:1,spin:""})):(i(),Y(z(ls),{key:0})),W(" "+C(u.value?"Refreshing...":"Refresh"),1)]),_:1},8,["loading"]),V(R,null,{overlay:P(()=>[V(p,{onClick:b},{default:P(()=>[V(A,{key:"data"},{default:P(()=>[V(z(bs)),E[4]||(E[4]=W(" Export Data "))]),_:1,__:[4]}),V(A,{key:"python"},{default:P(()=>[V(z(ys)),E[5]||(E[5]=W(" Export Python Script "))]),_:1,__:[5]})]),_:1})]),default:P(()=>[V(D,{size:"large"},{default:P(()=>[E[3]||(E[3]=W(" Export ")),V(z(os))]),_:1,__:[3]})]),_:1})]),s("div",Cn,[V(D,{size:"large",disabled:!g.isLeader,onClick:k},{default:P(()=>[V(z(At)),E[6]||(E[6]=W(" Duplicate "))]),_:1,__:[6]},8,["disabled"]),g.trial.status==="draft"?(i(),Y(D,{key:0,size:"large",disabled:!g.isLeader,onClick:H},{default:P(()=>[V(z(is)),E[7]||(E[7]=W(" Edit "))]),_:1,__:[7]},8,["disabled"])):O("",!0),V(D,{danger:"",size:"large",disabled:!g.isLeader,onClick:F},{default:P(()=>[V(z(rs)),E[8]||(E[8]=W(" Delete "))]),_:1,__:[8]},8,["disabled"])])])}}}),Sn=ie(kn,[["__scopeId","data-v-7a269139"]]),wn={class:"trial-detail-view"},In={key:0,class:"detail-content"},Rn={class:"detail-section"},En={class:"detail-grid"},Vn={class:"detail-item"},An={key:0,class:"detail-item"},On={key:1,class:"detail-item"},Fn={class:"detail-item"},Pn={class:"detail-item"},Ln={class:"detail-section"},Mn={class:"detail-grid"},Dn={key:0,class:"detail-item full-width"},xn={key:1,class:"detail-item full-width"},Un={class:"detail-item"},Nn={class:"detail-item"},zn={key:2,class:"detail-item"},Wn={key:0,class:"detail-section"},Hn={class:"detail-grid"},Bn={class:"detail-item"},jn={class:"detail-item"},Gn={class:"detail-item"},qn={class:"detail-section"},Kn={class:"model-configs"},Qn={class:"config-header"},Jn=["src","alt"],Xn={class:"provider-name"},Yn={class:"config-details"},Zn={class:"config-item"},el={class:"config-params"},tl={class:"param-list"},sl={key:0,class:"config-item"},al={class:"cost"},nl=oe({__name:"TrialDetailView",props:{trial:{},isCollapsed:{type:Boolean}},emits:["toggle-collapse"],setup(a){const e=a,t=M(()=>{const b=e.trial.started||e.trial.created,H=(e.trial.completed||new Date).getTime()-b.getTime(),F=Math.floor(H/(1e3*60*60)),g=Math.floor(H%(1e3*60*60)/(1e3*60));return F>0?`${F}h ${g}m`:`${g}m`}),l=M(()=>({draft:"Not started",pending:"Waiting to start",running:"Executing API calls",paused:"Execution paused",completed:"All calls completed",failed:"Execution failed",cancelled:"Execution cancelled"})[e.trial.status]||e.trial.status),o=M(()=>{var b;return e.trial.type==="template"&&((b=e.trial.templateConfig)!=null&&b.variables)?Object.keys(e.trial.templateConfig.variables).length:0}),u=M(()=>Math.round(e.trial.progress.total*750)),d=M(()=>"text"),y=M(()=>1),r=M(()=>e.trial.progress.total/y.value);function f(b){return b?new Date(b).toLocaleString():"N/A"}function v(){var b;return((b=e.trial.templateConfig)==null?void 0:b.template)||"Unknown Template"}function T(){var b;return((b=e.trial.spreadsheetConfig)==null?void 0:b.datasetId)||"Unknown Dataset"}function h(b){return{"openai-chat":"OpenAI","anthropic-messages":"Anthropic",openrouter:"OpenRouter","ollama-chat":"Ollama","ollama-generate":"Ollama"}[b]||b}function _(){return null}function I(b){var F;const k=b.modelSnapshot;return(F=k==null?void 0:k.capabilities)!=null&&F.inputCostPerToken?`$${((k.capabilities.inputCostPerToken+k.capabilities.outputCostPerToken)*1e3).toFixed(4)}/1k tokens`:null}return(b,k)=>(i(),c("div",wn,[s("div",{class:"detail-header",onClick:k[0]||(k[0]=H=>b.$emit("toggle-collapse"))},[k[1]||(k[1]=s("h3",null,"Trial Details",-1)),V(z(us),{class:te(["collapse-icon",{rotated:b.isCollapsed}])},null,8,["class"])]),b.isCollapsed?O("",!0):(i(),c("div",In,[s("div",Rn,[k[7]||(k[7]=s("h4",null,"Basic Information",-1)),s("div",En,[s("div",Vn,[k[2]||(k[2]=s("label",null,"Created:",-1)),s("span",null,C(f(b.trial.created)),1)]),b.trial.started?(i(),c("div",An,[k[3]||(k[3]=s("label",null,"Started:",-1)),s("span",null,C(f(b.trial.started)),1)])):O("",!0),b.trial.completed?(i(),c("div",On,[k[4]||(k[4]=s("label",null,"Completed:",-1)),s("span",null,C(f(b.trial.completed)),1)])):O("",!0),s("div",Fn,[k[5]||(k[5]=s("label",null,"Duration:",-1)),s("span",null,C(t.value),1)]),s("div",Pn,[k[6]||(k[6]=s("label",null,"Status:",-1)),s("span",null,C(b.trial.status)+" - "+C(l.value),1)])])]),s("div",Ln,[k[13]||(k[13]=s("h4",null,"Configuration",-1)),s("div",Mn,[b.trial.type==="template"?(i(),c("div",Dn,[k[8]||(k[8]=s("label",null,"Template:",-1)),s("span",null,C(v()),1)])):O("",!0),b.trial.type==="spreadsheet"?(i(),c("div",xn,[k[9]||(k[9]=s("label",null,"Dataset:",-1)),s("span",null,C(T()),1)])):O("",!0),s("div",Un,[k[10]||(k[10]=s("label",null,"Variable Lists:",-1)),s("span",null,C(o.value)+" lists",1)]),s("div",Nn,[k[11]||(k[11]=s("label",null,"Token Estimate:",-1)),s("span",null,"~"+C(u.value)+" tokens",1)]),d.value?(i(),c("div",zn,[k[12]||(k[12]=s("label",null,"Output Type:",-1)),s("span",{class:te(["output-type",`type-${d.value}`])},C(d.value),3)])):O("",!0)])]),y.value>1?(i(),c("div",Wn,[k[17]||(k[17]=s("h4",null,"Repeat Configuration",-1)),s("div",Hn,[s("div",Bn,[k[14]||(k[14]=s("label",null,"Times per prompt:",-1)),s("span",null,C(y.value),1)]),s("div",jn,[k[15]||(k[15]=s("label",null,"Total combinations:",-1)),s("span",null,C(r.value),1)]),s("div",Gn,[k[16]||(k[16]=s("label",null,"Total API calls:",-1)),s("span",null,C(b.trial.progress.total),1)])])])):O("",!0),s("div",qn,[k[21]||(k[21]=s("h4",null,"Model Configurations",-1)),s("div",Kn,[(i(!0),c(J,null,se(b.trial.configurations,(H,F)=>(i(),c("div",{key:F,class:"model-config-card"},[s("div",Qn,[_(H.provider)?(i(),c("img",{key:0,src:_(H.provider),alt:H.provider,class:"provider-logo"},null,8,Jn)):O("",!0),s("span",Xn,C(h(H.provider)),1)]),s("div",Yn,[s("div",Zn,[k[18]||(k[18]=s("label",null,"Model:",-1)),s("span",null,C(H.modelId),1)]),s("div",el,[k[19]||(k[19]=s("label",null,"Parameters:",-1)),s("div",tl,[(i(!0),c(J,null,se(H.parameters,(g,E)=>(i(),c("span",{key:E,class:"param-tag"},C(E)+": "+C(g),1))),128))])]),I(H)?(i(),c("div",sl,[k[20]||(k[20]=s("label",null,"Est. Cost:",-1)),s("span",al,C(I(H)),1)])):O("",!0)])]))),128))])])]))]))}}),ll=ie(nl,[["__scopeId","data-v-c60de8b4"]]),ol={class:"filter-bar"},il={class:"search-container"},rl=oe({__name:"TrialResultsFilterBar",props:{statusFilter:{},configFilter:{},searchQuery:{},visibleColumns:{},configurations:{},apiCalls:{},showRepeatColumn:{type:Boolean}},emits:["update:statusFilter","update:configFilter","update:searchQuery","update:visibleColumns"],setup(a,{emit:e}){const t=a,l=e,o=M(()=>{const f=[{key:"status",label:"Status"},{key:"configuration",label:"Configuration"},{key:"variables",label:"Variables"},{key:"response",label:"Response"},{key:"parsedResponse",label:"Parsed Response"},{key:"length",label:"Length"},{key:"latency",label:"Latency"}];return t.showRepeatColumn&&f.splice(2,0,{key:"repeat",label:"Repeat Index"}),f}),u=M(()=>{const f={total:t.apiCalls.length,completed:0,failed:0,running:0,pending:0};return t.apiCalls.forEach(v=>{v.status==="completed"?f.completed++:v.status==="failed"?f.failed++:v.status==="running"?f.running++:v.status==="pending"&&f.pending++}),f});function d(f){var v;return((v=f.modelSnapshot)==null?void 0:v.displayName)||`${f.provider} - ${f.modelId}`}const y=Wt(f=>{const v=f.target.value;l("update:searchQuery",v)},300);function r(f){const v=[...t.visibleColumns],T=v.indexOf(f);if(T>-1)v.splice(T,1);else{const h=o.value.map(b=>b.key),_=h.indexOf(f);let I=0;for(let b=0;b<_;b++)v.includes(h[b])&&I++;v.splice(I,0,f)}l("update:visibleColumns",v)}return(f,v)=>{const T=ee("a-select-option"),h=ee("a-select"),_=ee("a-input"),I=ee("a-button"),b=ee("a-checkbox"),k=ee("a-menu-item"),H=ee("a-menu"),F=ee("a-dropdown");return i(),c("div",ol,[V(h,{value:f.statusFilter,onChange:v[0]||(v[0]=g=>f.$emit("update:statusFilter",g)),placeholder:"Filter by status",style:{width:"150px"}},{default:P(()=>[V(T,{value:"all"},{default:P(()=>[W(" All ("+C(u.value.total)+") ",1)]),_:1}),V(T,{value:"completed"},{default:P(()=>[W(" Completed ("+C(u.value.completed)+") ",1)]),_:1}),V(T,{value:"failed"},{default:P(()=>[W(" Failed ("+C(u.value.failed)+") ",1)]),_:1}),V(T,{value:"running"},{default:P(()=>[W(" Running ("+C(u.value.running)+") ",1)]),_:1}),V(T,{value:"pending"},{default:P(()=>[W(" Pending ("+C(u.value.pending)+") ",1)]),_:1})]),_:1},8,["value"]),V(h,{value:f.configFilter,onChange:v[1]||(v[1]=g=>f.$emit("update:configFilter",g)),mode:"multiple",placeholder:"Filter by configuration",style:{width:"250px"},"max-tag-count":2},{default:P(()=>[V(T,{value:""},{default:P(()=>v[2]||(v[2]=[W("All Configurations")])),_:1,__:[2]}),(i(!0),c(J,null,se(f.configurations,(g,E)=>(i(),Y(T,{key:E,value:E.toString()},{default:P(()=>[W(C(d(g,E)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),s("div",il,[V(_,{value:f.searchQuery,onInput:z(y),placeholder:"Search in variables and responses...",style:{width:"400px"},"allow-clear":""},{prefix:P(()=>[V(z(Et))]),_:1},8,["value","onInput"])]),V(F,null,{overlay:P(()=>[V(H,null,{default:P(()=>[(i(!0),c(J,null,se(o.value,g=>(i(),Y(k,{key:g.key},{default:P(()=>[V(b,{checked:f.visibleColumns.includes(g.key),disabled:g.key==="status",onChange:E=>r(g.key)},{default:P(()=>[W(C(g.label),1)]),_:2},1032,["checked","disabled","onChange"])]),_:2},1024))),128))]),_:1})]),default:P(()=>[V(I,null,{default:P(()=>[V(z(at)),v[3]||(v[3]=W(" Columns "))]),_:1,__:[3]})]),_:1})])}}}),ul=ie(rl,[["__scopeId","data-v-b84791d2"]]),dl={class:"modal-content"},cl={class:"section"},pl={class:"info-grid"},fl={class:"info-item"},ml={class:"monospace"},vl={class:"info-item"},gl={class:"info-item"},hl={key:0,class:"info-item"},bl={class:"info-item"},yl={key:1,class:"info-item"},_l={key:2,class:"info-item"},Tl={key:3,class:"info-item"},$l={key:0,class:"info-row"},Cl={class:"monospace"},kl={key:0,class:"section"},Sl={class:"variables-list"},wl={class:"variable-main"},Il={class:"variable-label"},Rl={class:"variable-value"},El={key:0,class:"variable-attributes"},Vl={class:"attribute-label"},Al={class:"attribute-value"},Ol={class:"section"},Fl={class:"content-box prompt-display"},Pl={key:1,class:"section"},Ll={key:0,class:"error-result"},Ml={key:1,class:"success-result"},Dl={class:"content-box response-content"},xl={key:0,class:"parsed-content-section"},Ul={class:"content-box parsed-content"},Nl={key:1,class:"refusal-warning"},zl={key:2,class:"features-section"},Wl={class:"features-grid"},Hl={class:"feature-value"},Bl={class:"extraction-config-section"},jl={class:"config-grid"},Gl={key:0,class:"config-item"},ql={class:"config-value"},Kl={key:1,class:"config-item"},Ql={class:"config-value pattern"},Jl={key:2,class:"config-item"},Xl={class:"config-value"},Yl={key:3,class:"config-item"},Zl={class:"config-value"},eo={key:4,class:"config-item no-extraction"},to={key:3,class:"usage-info"},so={class:"info-grid"},ao={class:"info-item"},no={class:"info-item"},lo={class:"info-item"},oo={key:0,class:"info-item"},io={class:"raw-data-section"},ro={class:"raw-data"},uo={key:0},co={key:1,class:"raw-data"},po={key:2},fo={key:3,class:"raw-data"},mo={class:"modal-footer"},vo=oe({__name:"APICallDetailModalV3",props:{visible:{type:Boolean},apiCall:{},trial:{}},emits:["update:visible"],setup(a,{emit:e}){const t=a,l=e,o=tt(),u=M(()=>{if(!t.apiCall.completed||!t.apiCall.created)return null;const p=new Date(t.apiCall.created).getTime();return new Date(t.apiCall.completed).getTime()-p}),d=M(()=>{const p=t.trial.configurations[t.apiCall.configurationIndex];return p?`${p.provider} / ${p.modelId}`:null}),y=M(()=>{var S,N,$;if(!((S=t.apiCall.result)!=null&&S.usage))return null;const p=t.trial.configurations[t.apiCall.configurationIndex];if(!p)return null;const R=o.models.value.find(B=>B.provider===p.provider&&B.modelId===p.modelId);if(!((N=R==null?void 0:R.capabilities)!=null&&N.inputCostPerToken)&&!(($=R==null?void 0:R.capabilities)!=null&&$.outputCostPerToken))return null;const U=(t.apiCall.result.usage.prompt_tokens||0)*(R.capabilities.inputCostPerToken||0),n=(t.apiCall.result.usage.completion_tokens||0)*(R.capabilities.outputCostPerToken||0);return U+n}),r=M(()=>{if(!t.apiCall.request)return"No request data";const p=JSON.parse(JSON.stringify(t.apiCall.request));return p.headers&&Object.keys(p.headers).forEach(R=>{(R.toLowerCase().includes("authorization")||R.toLowerCase().includes("api-key")||R.toLowerCase().includes("x-api-key"))&&(p.headers[R]="[REDACTED]")}),p.body&&typeof p.body=="object"&&(p.body.api_key&&(p.body.api_key="[REDACTED]"),p.body.apiKey&&(p.body.apiKey="[REDACTED]")),JSON.stringify(p,null,2)}),f=M(()=>t.trial.type!=="template"||!t.trial.templateConfig?{}:{outputType:t.trial.templateConfig.outputType,extractPattern:t.trial.templateConfig.extractPattern,refusalWords:t.trial.templateConfig.refusalWords,rejectRefusalWords:t.trial.templateConfig.rejectRefusalWords}),v=M(()=>{const p=f.value;return!!(p.outputType||p.extractPattern||p.refusalWords&&p.refusalWords.length>0)}),T=M(()=>t.apiCall.response?JSON.stringify({status:t.apiCall.response.status,headers:t.apiCall.response.headers,body:t.apiCall.response.body,latencyMs:t.apiCall.response.latencyMs},null,2):"No response data available"),h=M(()=>t.apiCall.result?JSON.stringify(t.apiCall.result,null,2):"No processed result available");function _(p){return{completed:"success",failed:"error",running:"processing",pending:"warning"}[p]||"default"}function I(){var R;const p=t.trial.configurations[t.apiCall.configurationIndex];return((R=p==null?void 0:p.modelSnapshot)==null?void 0:R.displayName)||(p==null?void 0:p.modelId)||`Configuration ${t.apiCall.configurationIndex+1}`}function b(p){return(typeof p=="string"?new Date(p):p).toLocaleString()}function k(p){return p<1e3?`${p}ms`:p<6e4?`${(p/1e3).toFixed(1)}s`:`${Math.floor(p/6e4)}m ${(p%6e4/1e3).toFixed(0)}s`}function H(p){return p==null?"null":typeof p=="string"?p:typeof p=="number"||typeof p=="boolean"?String(p):JSON.stringify(p,null,2)}function F(p){return{network_error_no_response:"Network Error (No Response)",api_error_received:"API Error Response",parsing_error:"Response Parsing Error",timeout:"Request Timeout",rate_limit:"Rate Limit Exceeded"}[p]||p}function g(p){return p.replace(/_/g," ").replace(/\b\w/g,R=>R.toUpperCase())}function E(p){return p==null?"N/A":typeof p=="number"?p<1?p.toFixed(4):p.toFixed(2):typeof p=="object"?JSON.stringify(p):String(p)}function D(){l("update:visible",!1)}async function A(){const p={id:t.apiCall.id,status:t.apiCall.status,configuration:I(),provider:d.value,variables:t.apiCall.variables,variableAttributes:t.apiCall.variableAttributes,prompt:t.apiCall.prompt,fullApiResponse:t.apiCall.response,processedResult:t.apiCall.result,extractionConfig:f.value,created:t.apiCall.created,completed:t.apiCall.completed,duration:u.value?`${u.value}ms`:null,cost:y.value?`$${y.value.toFixed(4)}`:null},R=JSON.stringify(p,null,2);try{await navigator.clipboard.writeText(R),le.success("Details copied to clipboard!")}catch(U){m.error("Failed to copy to clipboard",U),le.error("Failed to copy to clipboard")}}return(p,R)=>{const U=ee("a-tag"),n=ee("a-alert"),S=ee("a-collapse-panel"),N=ee("a-collapse"),$=ee("a-button"),B=ee("a-modal");return i(),Y(B,{open:p.visible,onCancel:R[0]||(R[0]=ae=>l("update:visible",!1)),title:"API Call Details",width:1400,footer:null,"body-style":{padding:0,height:"85vh",display:"flex",flexDirection:"column"},centered:!0,"destroy-on-close":!0,class:"api-call-detail-modal"},{default:P(()=>{var ae;return[s("div",dl,[s("div",cl,[R[10]||(R[10]=s("h3",null,"Overview",-1)),s("div",pl,[s("div",fl,[R[1]||(R[1]=s("label",null,"Call ID:",-1)),s("span",ml,C(p.apiCall.id),1)]),s("div",vl,[R[2]||(R[2]=s("label",null,"Status:",-1)),V(U,{color:_(p.apiCall.status)},{default:P(()=>[W(C(p.apiCall.status.toUpperCase()),1)]),_:1},8,["color"])]),s("div",gl,[R[3]||(R[3]=s("label",null,"Configuration:",-1)),s("span",null,C(I()),1)]),p.apiCall.repeatIndex!==void 0?(i(),c("div",hl,[R[4]||(R[4]=s("label",null,"Repeat:",-1)),s("span",null,"#"+C(p.apiCall.repeatIndex+1),1)])):O("",!0),s("div",bl,[R[5]||(R[5]=s("label",null,"Created:",-1)),s("span",null,C(b(p.apiCall.created)),1)]),p.apiCall.completed?(i(),c("div",yl,[R[6]||(R[6]=s("label",null,"Completed:",-1)),s("span",null,C(b(p.apiCall.completed)),1)])):O("",!0),u.value?(i(),c("div",_l,[R[7]||(R[7]=s("label",null,"Duration:",-1)),s("span",null,C(k(u.value)),1)])):O("",!0),(ae=p.apiCall.result)!=null&&ae.latency?(i(),c("div",Tl,[R[8]||(R[8]=s("label",null,"API Latency:",-1)),s("span",null,C(p.apiCall.result.latency)+"ms",1)])):O("",!0)]),d.value?(i(),c("div",$l,[R[9]||(R[9]=s("label",null,"Provider/Model:",-1)),s("span",Cl,C(d.value),1)])):O("",!0)]),p.apiCall.variables&&Object.keys(p.apiCall.variables).length>0?(i(),c("div",kl,[R[11]||(R[11]=s("h3",null,"Variables",-1)),s("div",Sl,[(i(!0),c(J,null,se(p.apiCall.variables,(w,Z)=>(i(),c("div",{key:Z,class:"variable-group"},[s("div",wl,[s("label",Il,C(Z)+":",1),s("span",Rl,C(w),1)]),p.apiCall.variableAttributes&&p.apiCall.variableAttributes[Z]?(i(),c("div",El,[(i(!0),c(J,null,se(p.apiCall.variableAttributes[Z],(ce,me)=>(i(),c("div",{key:me,class:"attribute-item"},[s("label",Vl,C(me)+":",1),s("span",Al,C(ce),1)]))),128))])):O("",!0)]))),128))])])):O("",!0),s("div",Ol,[R[12]||(R[12]=s("h3",null,"Resolved Prompt",-1)),s("div",Fl,C(p.apiCall.prompt),1)]),p.apiCall.result?(i(),c("div",Pl,[R[26]||(R[26]=s("h3",null,"Response",-1)),p.apiCall.status==="failed"&&p.apiCall.result.error?(i(),c("div",Ll,[V(n,{type:"error",message:p.apiCall.result.error,description:p.apiCall.result.errorType?`Error Type: ${F(p.apiCall.result.errorType)}`:void 0,"show-icon":""},null,8,["message","description"])])):p.apiCall.result.content?(i(),c("div",Ml,[s("div",Dl,C(p.apiCall.result.content),1),p.apiCall.result.parsedContent!==void 0?(i(),c("div",xl,[R[13]||(R[13]=s("h4",null,"Extracted Value",-1)),s("div",Ul,C(H(p.apiCall.result.parsedContent)),1)])):O("",!0),p.apiCall.result.refused?(i(),c("div",Nl,[V(n,{type:"warning",message:"Response flagged as refusal",description:"This response matched configured refusal patterns","show-icon":""})])):O("",!0),p.apiCall.result.features&&Object.keys(p.apiCall.result.features).length>0?(i(),c("div",zl,[R[14]||(R[14]=s("h4",null,"Response Features",-1)),s("div",Wl,[(i(!0),c(J,null,se(p.apiCall.result.features,(w,Z)=>(i(),c("div",{key:Z,class:"feature-item"},[s("label",null,C(g(Z))+":",1),s("span",Hl,C(E(w)),1)]))),128))])])):O("",!0),s("div",Bl,[R[20]||(R[20]=s("h4",null,"Extraction Configuration",-1)),s("div",jl,[f.value.outputType?(i(),c("div",Gl,[R[15]||(R[15]=s("label",null,"Output Type:",-1)),s("span",ql,C(f.value.outputType),1)])):O("",!0),f.value.extractPattern?(i(),c("div",Kl,[R[16]||(R[16]=s("label",null,"Extract Pattern:",-1)),s("span",Ql,C(f.value.extractPattern),1)])):O("",!0),f.value.refusalWords&&f.value.refusalWords.length>0?(i(),c("div",Jl,[R[17]||(R[17]=s("label",null,"Refusal Words:",-1)),s("span",Xl,C(f.value.refusalWords.join(", ")),1)])):O("",!0),f.value.rejectRefusalWords!==void 0?(i(),c("div",Yl,[R[18]||(R[18]=s("label",null,"Reject on Refusal:",-1)),s("span",Zl,C(f.value.rejectRefusalWords?"Yes":"No"),1)])):O("",!0),v.value?O("",!0):(i(),c("div",eo,R[19]||(R[19]=[s("span",{class:"no-config-message"},"No extraction configuration set for this trial",-1)])))])]),p.apiCall.result.usage?(i(),c("div",to,[R[25]||(R[25]=s("h4",null,"Token Usage",-1)),s("div",so,[s("div",ao,[R[21]||(R[21]=s("label",null,"Prompt Tokens:",-1)),s("span",null,C(p.apiCall.result.usage.prompt_tokens||0),1)]),s("div",no,[R[22]||(R[22]=s("label",null,"Completion Tokens:",-1)),s("span",null,C(p.apiCall.result.usage.completion_tokens||0),1)]),s("div",lo,[R[23]||(R[23]=s("label",null,"Total Tokens:",-1)),s("span",null,C(p.apiCall.result.usage.total_tokens||0),1)]),y.value?(i(),c("div",oo,[R[24]||(R[24]=s("label",null,"Cost:",-1)),s("span",null,"$"+C(y.value.toFixed(4)),1)])):O("",!0)])])):O("",!0)])):O("",!0)])):O("",!0),V(N,{ghost:""},{default:P(()=>[V(S,{key:"raw",header:"Raw Data"},{default:P(()=>[s("div",io,[R[27]||(R[27]=s("h4",null,"HTTP Request",-1)),s("pre",ro,C(r.value),1),p.apiCall.response?(i(),c("h4",uo,"Full API Response")):O("",!0),p.apiCall.response?(i(),c("pre",co,C(T.value),1)):O("",!0),p.apiCall.result?(i(),c("h4",po,"Processed Result")):O("",!0),p.apiCall.result?(i(),c("pre",fo,C(h.value),1)):O("",!0)])]),_:1})]),_:1})]),s("div",mo,[V($,{onClick:D,size:"large"},{default:P(()=>R[28]||(R[28]=[W(" Close ")])),_:1,__:[28]}),V($,{type:"primary",onClick:A,size:"large"},{default:P(()=>[V(z(At)),R[29]||(R[29]=W(" Copy Details "))]),_:1,__:[29]})])]}),_:1},8,["open"])}}}),go=ie(vo,[["__scopeId","data-v-79804335"]]);class ho{constructor(){pe(this,"apiCalls",Pe([]));pe(this,"currentTrialId",Pe(null));pe(this,"executionProgress",Pe(null));pe(this,"isStreaming",Pe(!1));pe(this,"progress",M(()=>{var T,h;const e=performance.now(),t=this.apiCalls.value;if(t.length===0)return{trialId:this.currentTrialId.value||"",total:0,completed:0,failed:0,cancelled:0,pending:0,running:0,networkErrors:0,lastUpdated:new Date};let l=0,o=0,u=0,d=0,y=0,r=0;m.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Computing progress from ${t.length} calls in store`);for(const _ of t)switch(_.status){case"completed":l++;break;case"failed":o++,(h=(T=_.result)==null?void 0:T.error)!=null&&h.includes("network")&&r++;break;case"cancelled":u++;break;case"pending":d++;break;case"running":y++;break}const f=performance.now(),v={trialId:this.currentTrialId.value||"",total:t.length,completed:l,failed:o,cancelled:u,pending:d,running:y,networkErrors:r,lastUpdated:new Date};return m.info(`V4_STORE_PROGRESS: Computed in ${(f-e).toFixed(1)}ms - ${l}/${t.length} completed, ${y} running, ${d} pending`),m.info(`V4_TRIAL_DEBUG_PROGRESS_CALC: Final result - completed: ${l}, failed: ${o}, running: ${y}, pending: ${d}, total: ${t.length}`),v}));pe(this,"pivotData",M(()=>{const e=performance.now(),t=this.apiCalls.value,l={rows:[],columns:[],cells:new Map};if(t.length===0)return l;const o=new Set,u=new Set;for(const y of t){if(y.status!=="completed")continue;const r=`Config ${y.configurationIndex}`;o.add(r);const f=Object.keys(y.variables||{}),v=f.length>0?String(y.variables[f[0]]):"default";u.add(v),l.cells.has(r)||l.cells.set(r,new Map);const T=l.cells.get(r);T.has(v)||T.set(v,[]),T.get(v).push(y)}l.rows=Array.from(o).sort(),l.columns=Array.from(u).sort();const d=performance.now();return m.info(`V4_TRIAL_SWITCH: Store pivotData computed for ${t.length} calls in ${(d-e).toFixed(1)}ms`),l}));pe(this,"stats",M(()=>{var T;const e=performance.now(),t=this.apiCalls.value,l=t.length;if(l===0)return{total:0,completed:0,failed:0,pending:0,running:0,avgLatency:0,errorRate:0};let o=0,u=0,d=0,y=0,r=0,f=0;for(const h of t)switch(h.status){case"completed":o++,(T=h.response)!=null&&T.latencyMs&&(r+=h.response.latencyMs,f++);break;case"failed":u++;break;case"pending":d++;break;case"running":y++;break}const v=performance.now();return m.info(`V4_TRIAL_SWITCH: Store stats computed for ${t.length} calls in ${(v-e).toFixed(1)}ms`),{total:l,completed:o,failed:u,pending:d,running:y,avgLatency:f>0?r/f:0,errorRate:l>0?u/l*100:0}}))}updateApiCalls(e){performance.now();for(const t of e)switch(t.status){}this.apiCalls.value=Object.freeze(e),performance.now()}updateProgress(e){m.info("STORE_V4: Updating progress:",e.type),this.executionProgress.value=e}setStreaming(e){m.info(`STORE_V4: Set streaming: ${e}`),this.isStreaming.value=e}setCurrentTrial(e){m.info(`STORE_V4: Set current trial: ${e}`),this.currentTrialId.value=e,e||this.clear()}clear(){m.info("STORE_V4: Clearing store data"),this.apiCalls.value=[],this.executionProgress.value=null,this.isStreaming.value=!1}async refreshFromDatabase(e){m.info(`STORE_V4: Refreshing data from database for trial ${e}`);try{const t=await Qe.apiCalls.where("trialId").equals(e).toArray();m.info(`STORE_V4: Loaded ${t.length} calls from database`),t.sort((l,o)=>{const u=r=>{switch(r){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},d=u(l.status),y=u(o.status);return d!==y?d-y:l.order-o.order}),this.updateApiCalls(t),this.setCurrentTrial(e),m.info("STORE_V4: Refresh complete - store updated with fresh data")}catch(t){throw m.error("STORE_V4: Failed to refresh from database:",t),t}}}let De=null;function We(){return De||(De=new ho,m.info("STORE_V4: Created singleton store instance")),De}typeof window<"u"&&(window.__trialDataStoreV4=()=>De);const bo={class:"trial-results-table"},yo={class:"table-container"},_o={class:"results-table"},To={key:0,class:"col-status"},$o={key:1,class:"col-configuration"},Co={key:2,class:"col-repeat"},ko={key:3,class:"col-variables"},So={key:4,class:"col-response"},wo={key:5,class:"col-parsed"},Io={key:6,class:"col-length"},Ro={key:7,class:"col-latency"},Eo={class:"results-table"},Vo=["onClick"],Ao={key:0,class:"col-status"},Oo={class:"status-cell"},Fo={class:"status-time"},Po={key:1,class:"col-configuration"},Lo={key:2,class:"col-repeat"},Mo={key:3,class:"col-variables"},Do={class:"variable-tags"},xo={key:0,class:"var-item"},Uo={key:1,class:"var-item"},No={key:2},zo={key:3},Wo={key:4,class:"col-response"},Ho={class:"response-content"},Bo={key:5,class:"col-parsed"},jo={key:6,class:"col-length"},Go={key:7,class:"col-latency"},qo={key:1,class:"results-table"},Ko={key:0,class:"col-status"},Qo={key:1,class:"col-configuration"},Jo={key:2,class:"col-repeat"},Xo={key:3,class:"col-variables"},Yo={key:4,class:"col-response"},Zo={key:5,class:"col-parsed"},ei={key:6,class:"col-length"},ti={key:7,class:"col-latency"},si=["onClick"],ai={key:0,class:"col-status"},ni={class:"status-cell"},li={class:"status-time"},oi={key:1,class:"col-configuration"},ii={key:2,class:"col-repeat"},ri={key:3,class:"col-variables"},ui={class:"variable-tags"},di={key:0,class:"var-item"},ci={key:1,class:"var-item"},pi={key:2},fi={key:3},mi={key:4,class:"col-response"},vi={class:"response-content"},gi={key:5,class:"col-parsed"},hi={key:6,class:"col-length"},bi={key:7,class:"col-latency"},yi={key:0},_i=["colspan"],Ti={key:0},$i={key:1},St="trial-results-visible-columns",Ci=oe({__name:"TrialResultsTableV3",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(a){const e=a,t=q("all"),l=q([]),o=q(""),u=q(["status","configuration","variables","response","parsedResponse","length","latency"]),d=q(null),y=We(),r=M(()=>{var n;return((n=y.apiCalls)==null?void 0:n.value)||[]}),f=M(()=>e.apiCalls||r.value);re(f,(n,S)=>{const N=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 calls data changed from ${(S==null?void 0:S.length)||0} to ${n.length} calls`),setTimeout(()=>{const $=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 reactive update completed in ${($-N).toFixed(1)}ms`)},0)});const v=n=>{if(!o.value)return n;const S=o.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),N=new RegExp(`(${S})`,"gi");return n.replace(N,"<mark>$1</mark>")},T=M(()=>{const n=performance.now();let S=[...f.value];if(t.value!=="all"&&(S=S.filter($=>$.status===t.value)),l.value.length>0&&(S=S.filter($=>l.value.includes(String($.configurationIndex)))),o.value){const $=o.value.toLowerCase();S=S.filter(B=>{var ae,w,Z,ce,me;return!!((ae=B.prompt)!=null&&ae.toLowerCase().includes($)||(Z=(w=B.result)==null?void 0:w.content)!=null&&Z.toLowerCase().includes($)||(me=(ce=B.result)==null?void 0:ce.error)!=null&&me.toLowerCase().includes($))})}const N=performance.now();return m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls computed ${S.length} calls in ${(N-n).toFixed(1)}ms`),S});re(T,(n,S)=>{const N=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls changed from ${(S==null?void 0:S.length)||0} to ${n.length} items`),setTimeout(()=>{const $=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 filteredCalls render completed in ${($-N).toFixed(1)}ms`)},0)});const h=M(()=>f.value),_=M(()=>f.value.length),I=M(()=>e.trial.configurations.some(n=>n.repeatCount>1)),b=M(()=>60);function k(n){}function H(n){var N;const S=e.trial.configurations[n];return S?((N=S.modelSnapshot)==null?void 0:N.displayName)||`${S.modelId}`:`Config ${n+1}`}function F(n){var S,N,$,B,ae;return n.status==="pending"?"Waiting...":n.status==="running"?"Processing...":n.status==="failed"?((S=n.result)==null?void 0:S.errorType)==="refusal_detected"||((N=n.result)==null?void 0:N.error)==="REFUSED"?(($=n.result)==null?void 0:$.content)||"REFUSED":((B=n.result)==null?void 0:B.error)||"Error occurred":((ae=n.result)==null?void 0:ae.content)||""}function g(n){if(!n.result)return"";if(n.result.parsedContent!==void 0){const S=n.result.parsedContent;return S===null?"null":typeof S=="string"?S:typeof S=="number"||typeof S=="boolean"?String(S):JSON.stringify(S)}return""}function E(n){var $;const S=(($=n.result)==null?void 0:$.content)||"";if(!S)return"";const N=S.length;return N>1e3?`${(N/1e3).toFixed(1)}k chars`:`${N} chars`}function D(n){return n?n<1e3?`${n}ms`:`${(n/1e3).toFixed(1)}s`:""}function A(n){let S;switch(n.status){case"completed":case"failed":S=n.completed;break;case"running":S=n.started;break;case"pending":case"cancelled":S=n.created;break}if(!S)return"";const N=new Date(S),$=N.getHours().toString().padStart(2,"0"),B=N.getMinutes().toString().padStart(2,"0"),ae=N.getSeconds().toString().padStart(2,"0");return`Â Â ${$}:${B}:${ae}`}function p(n){return n?n<1e3?"latency-fast":n<5e3?"latency-medium":"latency-slow":""}function R(n){return v(n)}function U(n){d.value=n}return re(u,n=>{localStorage.setItem(St,JSON.stringify(n))},{deep:!0}),ve(()=>{const n=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 MOUNTED with ${f.value.length} calls`);const S=localStorage.getItem(St);if(S)try{u.value=JSON.parse(S)}catch{}Te(()=>{const N=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 DOM ready in ${(N-n).toFixed(1)}ms`),setTimeout(()=>{const $=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 virtual scrolling ready in ${($-n).toFixed(1)}ms`)},100)}),setTimeout(()=>{const N=performance.now();m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 mount completed in ${(N-n).toFixed(1)}ms`)},0)}),Re(()=>{m.info(`V4_TRIAL_SWITCH: TrialResultsTableV3 ACTIVATED (cache hit) with ${f.value.length} calls`)}),Ee(()=>{m.info("V4_TRIAL_SWITCH: TrialResultsTableV3 DEACTIVATED (cached)")}),he(()=>{m.info("V4_TRIAL_SWITCH: TrialResultsTableV3 UNMOUNTED (evicted)")}),(n,S)=>{const N=Rt("dompurify-html");return i(),c("div",bo,[V(ul,{"status-filter":t.value,"onUpdate:statusFilter":S[0]||(S[0]=$=>t.value=$),"config-filter":l.value,"onUpdate:configFilter":S[1]||(S[1]=$=>l.value=$),"search-query":o.value,"onUpdate:searchQuery":S[2]||(S[2]=$=>o.value=$),"visible-columns":u.value,"onUpdate:visibleColumns":S[3]||(S[3]=$=>u.value=$),configurations:n.trial.configurations,"api-calls":h.value,"show-repeat-column":I.value},null,8,["status-filter","config-filter","search-query","visible-columns","configurations","api-calls","show-repeat-column"]),s("div",yo,[_.value>100?(i(),Y(z(ze),{key:0,class:"results-scroller",items:T.value,"item-size":b.value,"key-field":"id",buffer:10,onVisibleRange:k},{before:P(()=>[s("table",_o,[s("thead",null,[s("tr",null,[u.value.includes("status")?(i(),c("th",To,"Status")):O("",!0),u.value.includes("configuration")?(i(),c("th",$o,"Configuration")):O("",!0),u.value.includes("repeat")&&I.value?(i(),c("th",Co,"Repeat")):O("",!0),u.value.includes("variables")?(i(),c("th",ko,"Variables")):O("",!0),u.value.includes("response")?(i(),c("th",So,"Response")):O("",!0),u.value.includes("parsedResponse")?(i(),c("th",wo,"Parsed Response")):O("",!0),u.value.includes("length")?(i(),c("th",Io,"Length")):O("",!0),u.value.includes("latency")?(i(),c("th",Ro,"Latency")):O("",!0)])])])]),default:P(({item:$})=>{var B,ae;return[s("table",Eo,[s("tbody",null,[s("tr",{class:te(["result-row",`status-${$.status}`]),onClick:w=>U($)},[u.value.includes("status")?(i(),c("td",Ao,[s("div",Oo,[s("span",{class:te(["status-tag",`status-${$.status}`])},C($.status.toUpperCase()),3),s("span",Fo,C(A($)),1)])])):O("",!0),u.value.includes("configuration")?(i(),c("td",Po,C(H($.configurationIndex)),1)):O("",!0),u.value.includes("repeat")&&I.value?(i(),c("td",Lo," #"+C(($.repeatIndex||0)+1),1)):O("",!0),u.value.includes("variables")?(i(),c("td",Mo,[s("div",Do,[(i(!0),c(J,null,se($.variables,(w,Z,ce)=>(i(),c(J,{key:Z},[S[6]||(S[6]=s("span",{class:"var-bullet"},"â€¢ ",-1)),Object.keys($.variables).length<=2?(i(),c("span",xo,C(Z)+": "+C(w),1)):(i(),c("span",Uo,C(w),1)),Object.keys($.variables).length===2&&ce===0?(i(),c("span",No,S[5]||(S[5]=[s("br",null,null,-1)]))):ce!==void 0&&ce<Object.keys($.variables).length-1?(i(),c("span",zo,C("Â Â "))):O("",!0)],64))),128))])])):O("",!0),u.value.includes("response")?(i(),c("td",Wo,[ke(s("div",Ho,null,512),[[N,R(F($)),"apiResponse"]])])):O("",!0),u.value.includes("parsedResponse")?(i(),c("td",Bo,C(g($)),1)):O("",!0),u.value.includes("length")?(i(),c("td",jo,C(E($)),1)):O("",!0),u.value.includes("latency")?(i(),c("td",Go,[s("span",{class:te(p((B=$.response)==null?void 0:B.latencyMs))},C(D((ae=$.response)==null?void 0:ae.latencyMs)),3)])):O("",!0)],10,Vo)])])]}),_:1},8,["items","item-size"])):(i(),c("table",qo,[s("thead",null,[s("tr",null,[u.value.includes("status")?(i(),c("th",Ko,"Status")):O("",!0),u.value.includes("configuration")?(i(),c("th",Qo,"Configuration")):O("",!0),u.value.includes("repeat")&&I.value?(i(),c("th",Jo,"Repeat")):O("",!0),u.value.includes("variables")?(i(),c("th",Xo,"Variables")):O("",!0),u.value.includes("response")?(i(),c("th",Yo,"Response")):O("",!0),u.value.includes("parsedResponse")?(i(),c("th",Zo,"Parsed Response")):O("",!0),u.value.includes("length")?(i(),c("th",ei,"Length")):O("",!0),u.value.includes("latency")?(i(),c("th",ti,"Latency")):O("",!0)])]),s("tbody",null,[(i(!0),c(J,null,se(T.value,$=>{var B,ae;return i(),c("tr",{key:$.id,class:te(["result-row",`status-${$.status}`]),onClick:w=>U($)},[u.value.includes("status")?(i(),c("td",ai,[s("div",ni,[s("span",{class:te(["status-tag",`status-${$.status}`])},C($.status.toUpperCase()),3),s("span",li,C(A($)),1)])])):O("",!0),u.value.includes("configuration")?(i(),c("td",oi,C(H($.configurationIndex)),1)):O("",!0),u.value.includes("repeat")&&I.value?(i(),c("td",ii," #"+C(($.repeatIndex||0)+1),1)):O("",!0),u.value.includes("variables")?(i(),c("td",ri,[s("div",ui,[(i(!0),c(J,null,se($.variables,(w,Z,ce)=>(i(),c(J,{key:Z},[S[8]||(S[8]=s("span",{class:"var-bullet"},"â€¢ ",-1)),Object.keys($.variables).length<=2?(i(),c("span",di,C(Z)+": "+C(w),1)):(i(),c("span",ci,C(w),1)),Object.keys($.variables).length===2&&ce===0?(i(),c("span",pi,S[7]||(S[7]=[s("br",null,null,-1)]))):ce<Object.keys($.variables).length-1?(i(),c("span",fi,C("Â Â "))):O("",!0)],64))),128))])])):O("",!0),u.value.includes("response")?(i(),c("td",mi,[ke(s("div",vi,null,512),[[N,R(F($)),"apiResponse"]])])):O("",!0),u.value.includes("parsedResponse")?(i(),c("td",gi,C(g($)),1)):O("",!0),u.value.includes("length")?(i(),c("td",hi,C(E($)),1)):O("",!0),u.value.includes("latency")?(i(),c("td",bi,[s("span",{class:te(p((B=$.response)==null?void 0:B.latencyMs))},C(D((ae=$.response)==null?void 0:ae.latencyMs)),3)])):O("",!0)],10,si)}),128)),T.value.length===0?(i(),c("tr",yi,[s("td",{colspan:u.value.length,class:"empty-state"},[r.value.length===0?(i(),c("div",Ti," No API calls yet. Start the trial to begin execution. ")):(i(),c("div",$i," No results match your filters. "))],8,_i)])):O("",!0)])]))]),d.value?(i(),Y(go,{key:0,visible:!!d.value,"api-call":d.value,trial:n.trial,"onUpdate:visible":S[4]||(S[4]=$=>d.value=null)},null,8,["visible","api-call","trial"])):O("",!0)])}}}),ki=ie(Ci,[["__scopeId","data-v-eb7d359e"]]),Si={class:"trial-analysis-view"},wi=oe({__name:"TrialAnalysisView",props:{trial:{},progress:{},isExecuting:{type:Boolean},apiCalls:{},isStreaming:{type:Boolean},isLoading:{type:Boolean}},setup(a){const e=a;return ve(()=>{const t=performance.now();m.info(`V4_TRIAL_SWITCH: TrialAnalysisView MOUNTED for trial ${e.trial.id}`),Te(()=>{const l=performance.now();m.info(`V4_TRIAL_SWITCH: TrialAnalysisView DOM ready in ${(l-t).toFixed(1)}ms`)}),setTimeout(()=>{const l=performance.now();m.info(`V4_TRIAL_SWITCH: TrialAnalysisView mount completed in ${(l-t).toFixed(1)}ms`)},0)}),Re(()=>{m.info(`V4_TRIAL_SWITCH: TrialAnalysisView ACTIVATED (cache hit) for trial ${e.trial.id}`)}),Ee(()=>{m.info(`V4_TRIAL_SWITCH: TrialAnalysisView DEACTIVATED (cached) for trial ${e.trial.id}`)}),he(()=>{m.info(`V4_TRIAL_SWITCH: TrialAnalysisView UNMOUNTED (evicted) for trial ${e.trial.id}`)}),(t,l)=>(i(),c("div",Si,[V(ki,{trial:t.trial,progress:t.progress,"is-executing":t.isExecuting,"api-calls":t.apiCalls,"is-streaming":t.isStreaming,"is-loading":t.isLoading},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])]))}}),Ii=ie(wi,[["__scopeId","data-v-602f5d5a"]]);function Ri(a,e){const t=new Set,l=new Set,o=new Set;a.forEach(v=>{v.variables&&Object.keys(v.variables).forEach(T=>t.add(T)),v.variableAttributes&&Object.values(v.variableAttributes).forEach(T=>{T&&Object.keys(T).forEach(h=>l.add(h))})});const u=Array.from(t).sort(),d=Array.from(l).sort(),y=Array.from(o).sort(),r=[],f=["success","refused","parsed_response",...r,...y];return{categorical:[...u,...d,"model","status","error_type"],numeric:["response_time","total_tokens","prompt_tokens","completion_tokens",...r].sort(),extracted:f}}function Ie(a,e,t){var l,o,u,d,y,r,f,v,T,h,_,I,b,k,H,F,g,E,D,A,p;switch(e){case"model":return t&&a.configurationIndex<t.configurations.length&&t.configurations[a.configurationIndex].modelId||"Unknown";case"status":return a.status;case"response_time":return((l=a.response)==null?void 0:l.latencyMs)||0;case"total_tokens":if((u=(o=a.response)==null?void 0:o.body)!=null&&u.usage){const R=a.response.body.usage;return R.total_tokens||R.prompt_tokens+R.completion_tokens||0}return 0;case"prompt_tokens":return((r=(y=(d=a.response)==null?void 0:d.body)==null?void 0:y.usage)==null?void 0:r.prompt_tokens)||((T=(v=(f=a.response)==null?void 0:f.body)==null?void 0:v.usage)==null?void 0:T.input_tokens)||0;case"completion_tokens":return((I=(_=(h=a.response)==null?void 0:h.body)==null?void 0:_.usage)==null?void 0:I.completion_tokens)||((H=(k=(b=a.response)==null?void 0:b.body)==null?void 0:k.usage)==null?void 0:H.output_tokens)||0;case"error_type":return((F=a.result)==null?void 0:F.errorType)||(((g=a.result)==null?void 0:g.success)===!1?"api_error":"success");case"success":return(E=a.result)!=null&&E.success?1:0;case"refused":return(D=a.result)!=null&&D.refused?1:0;case"parsed_response":if(((A=a.result)==null?void 0:A.parsedContent)!==void 0){const R=a.result.parsedContent;return typeof R=="object"?JSON.stringify(R):R}return null}if(((p=a.variables)==null?void 0:p[e])!==void 0)return a.variables[e];if(a.variableAttributes)for(const R of Object.keys(a.variableAttributes)){const U=a.variableAttributes[R];if(U&&U[e]!==void 0)return U[e]}return null}const Ve={count:{label:"Count",calculate:a=>a.length,format:a=>a.toString(),needsNumeric:!1},sum:{label:"Sum",calculate:a=>{const e=a.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?e.reduce((t,l)=>t+l,0):null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},mean:{label:"Mean",calculate:a=>{const e=a.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?e.reduce((t,l)=>t+l,0)/e.length:null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},median:{label:"Median",calculate:a=>{const e=a.map(o=>typeof o=="number"?o:null).filter(o=>o!==null);if(e.length===0)return null;const t=[...e].sort((o,u)=>o-u),l=Math.floor(t.length/2);return t.length%2===0?(t[l-1]+t[l])/2:t[l]},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},mode:{label:"Mode",calculate:a=>{if(a.length===0)return null;const e=new Map;a.forEach(o=>e.set(o,(e.get(o)||0)+1));let t=0,l=null;return e.forEach((o,u)=>{o>t&&(t=o,l=u)}),{value:l,count:t,total:a.length}},format:a=>a?`${a.value} (${a.count}/${a.total})`:"-",needsNumeric:!1},variance:{label:"Variance",calculate:a=>{const e=a.map(o=>typeof o=="number"?o:null).filter(o=>o!==null);if(e.length<=1)return null;const t=e.reduce((o,u)=>o+u,0)/e.length;return e.reduce((o,u)=>o+Math.pow(u-t,2),0)/(e.length-1)},format:a=>(a==null?void 0:a.toFixed(3))||"-",needsNumeric:!0},std_dev:{label:"Std Dev",calculate:a=>{const e=Ve.variance.calculate(a);return e!==null?Math.sqrt(e):null},format:a=>(a==null?void 0:a.toFixed(3))||"-",needsNumeric:!0},min:{label:"Min",calculate:a=>{const e=a.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?Math.min(...e):null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},max:{label:"Max",calculate:a=>{const e=a.map(t=>typeof t=="number"?t:null).filter(t=>t!==null);return e.length>0?Math.max(...e):null},format:a=>(a==null?void 0:a.toFixed(2))||"-",needsNumeric:!0},success_rate:{label:"Success Rate",calculate:(a,e)=>{const t=e.filter(l=>{var o;return(o=l.result)==null?void 0:o.success}).length;return e.length>0?t/e.length:0},format:a=>`${Math.round(a*100)}%`,needsNumeric:!1,usesApiCalls:!0},refusal_rate:{label:"Refusal Rate",calculate:(a,e)=>{const t=e.filter(l=>{var o;return(o=l.result)==null?void 0:o.refused}).length;return e.length>0?t/e.length:0},format:a=>`${Math.round(a*100)}%`,needsNumeric:!1,usesApiCalls:!0},avg_time:{label:"Avg Time (ms)",calculate:(a,e)=>{const t=e.filter(l=>{var o;return(o=l.response)==null?void 0:o.latencyMs}).map(l=>l.response.latencyMs);return t.length>0?t.reduce((l,o)=>l+o,0)/t.length:null},format:a=>a?`${Math.round(a)}ms`:"-",needsNumeric:!1,usesApiCalls:!0}};function wt(a,e,t){const l=new Map,o=new Set,u=new Set;a.forEach(I=>{const b=String(Ie(I,e.rowField,t)||"Unknown"),k=String(Ie(I,e.columnField,t)||"Unknown");o.add(b),u.add(k),l.has(b)||l.set(b,new Map),l.get(b).has(k)||l.get(b).set(k,[]),l.get(b).get(k).push(I)});const d=I=>I.every(k=>!isNaN(Number(k))&&k.trim()!=="")?I.sort((k,H)=>Number(k)-Number(H)):I.sort(),y=(I,b)=>(t&&(t.type,t.type),d(I)),r=e.rowSort==="original"?y(Array.from(o),e.rowField):d(Array.from(o)),f=e.columnSort==="original"?y(Array.from(u),e.columnField):d(Array.from(u)),v=Ve[e.aggregation];function T(I){const b=I.map(g=>Ie(g,e.valueField,t));if(!v||typeof v.calculate!="function")return m.error("Invalid aggregation function:",e.aggregation,v),{value:null,count:I.length,apiCalls:I,rawValues:b,error:"Invalid aggregation function"};const k={nonNumeric:0,nullUndefined:0};return v.needsNumeric&&(k.nonNumeric=b.filter(g=>typeof g!="number").length),k.nullUndefined=b.filter(g=>g==null).length,{value:v.usesApiCalls?v.calculate(b,I):v.calculate(b),count:I.length,apiCalls:I,rawValues:b,excludedCounts:k}}const h=r.map(I=>{const b=[],k=[];return f.forEach(H=>{var g;const F=((g=l.get(I))==null?void 0:g.get(H))||[];b.push(F.length>0?T(F):null),k.push(...F)}),{label:I,cells:b,total:T(k)}}),_=f.map(I=>{const b=[];return r.forEach(k=>{var F;const H=((F=l.get(k))==null?void 0:F.get(I))||[];b.push(...H)}),T(b)});return{rows:h,columns:f,totals:_,grandTotal:T(a)}}function ye(a,e){return!a||a.value===null?"-":Ve[e].format(a.value)}function Ei(a,e,t,l=q({}),o={}){const{debounceMs:u=100}=o,d=q({rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}}),y=q({categorical:[],numeric:[],extracted:[]}),r=q(!1),f=q(0),v=M(()=>{const I=l.value;return Object.values(I).some(k=>k!=="")?a.value.filter(k=>{var H;if(I.model&&I.model!==""&&(!t.value||k.configurationIndex>=t.value.configurations.length||(t.value.configurations[k.configurationIndex].modelId||"Unknown")!==I.model)||I.status&&I.status!==""&&k.status!==I.status)return!1;for(const[F,g]of Object.entries(I))if(g&&g!==""&&F!=="model"&&F!=="status"&&((H=k.variables)==null?void 0:H[F])!==g)return!1;return!0}):a.value}),T=je(()=>{if(v.value.length===0){d.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}r.value=!0;const I=performance.now();try{d.value=wt(v.value,e.value,t.value);const b=performance.now()-I;f.value=b,m.debug("Pivot data computed (config change)",{apiCallCount:v.value.length,computeTimeMs:b,rowCount:d.value.rows.length,columnCount:d.value.columns.length})}catch(b){m.error("Error computing pivot data",b)}finally{r.value=!1}},u),h=je(()=>{if(v.value.length===0){d.value={rows:[],columns:[],totals:[],grandTotal:{value:0,count:0,apiCalls:[],rawValues:[]}};return}r.value=!0;const I=performance.now();try{d.value=wt(v.value,e.value,t.value);const b=performance.now()-I;f.value=b,m.debug("Pivot data computed (stream update)",{apiCallCount:v.value.length,computeTimeMs:b,rowCount:d.value.rows.length,columnCount:d.value.columns.length})}catch(b){m.error("Error computing pivot data",b)}finally{r.value=!1}},1e3),_=je(()=>{y.value=Ri(a.value,t.value)},200);return re([e],()=>{h.cancel(),T()},{deep:!0}),re(()=>v.value,(I,b)=>{m.info(`PIVOT_DEBUG: filteredApiCalls changed from ${(b==null?void 0:b.length)||0} to ${I.length}`),h()},{immediate:!1}),re(()=>[a.value,t.value],()=>{m.info("PIVOT_DEBUG: apiCalls or trial changed, updating fields"),_(),h()},{immediate:!1}),_(),T(),{pivotData:M(()=>d.value),availableFields:M(()=>y.value),isComputing:M(()=>r.value),lastComputeTime:M(()=>f.value),formatCellValue:ye,extractFieldValue:Ie,aggregationFunctions:Ve}}const Vi={class:"pivot-config-v3"},Ai={class:"config-row"},Oi={class:"config-group"},Fi=["value","aria-label"],Pi={label:"Categorical"},Li=["value"],Mi={class:"config-group sort-group"},Di=["value","aria-label"],xi={class:"config-group"},Ui=["value","aria-label"],Ni={label:"Categorical"},zi=["value"],Wi={class:"config-group sort-group"},Hi=["value","aria-label"],Bi={class:"config-group"},ji=["value","aria-label"],Gi={label:"Extracted Values"},qi=["value"],Ki={label:"Numeric Fields"},Qi=["value"],Ji={class:"config-group"},Xi=["value","aria-label"],Yi=oe({__name:"PivotConfigurationV3",props:{config:{},availableFields:{}},emits:["update-config"],setup(a,{emit:e}){const t=e;function l(u,d){t("update-config",u,d)}function o(u){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[u]||u.replace(/_/g," ").replace(/\b\w/g,y=>y.toUpperCase())}return(u,d)=>(i(),c("div",Vi,[s("div",Ai,[s("div",Oi,[d[6]||(d[6]=s("label",{for:"pivot-row-field"},"Rows (Group by):",-1)),s("select",{id:"pivot-row-field",value:u.config.rowField,"aria-label":"Group rows by "+o(u.config.rowField),onChange:d[0]||(d[0]=y=>l("rowField",y.target.value))},[s("optgroup",Pi,[(i(!0),c(J,null,se(u.availableFields.categorical,y=>(i(),c("option",{key:y,value:y},C(o(y)),9,Li))),128))])],40,Fi)]),s("div",Mi,[d[8]||(d[8]=s("label",{for:"pivot-row-sort"},"Sort Rows:",-1)),s("select",{id:"pivot-row-sort",value:u.config.rowSort||"original","aria-label":"Sort rows by "+(u.config.rowSort||"original")+" order",onChange:d[1]||(d[1]=y=>l("rowSort",y.target.value))},d[7]||(d[7]=[s("option",{value:"original"},"Original",-1),s("option",{value:"alpha"},"Alphabetical",-1)]),40,Di)]),s("div",xi,[d[9]||(d[9]=s("label",{for:"pivot-column-field"},"Columns (Group by):",-1)),s("select",{id:"pivot-column-field",value:u.config.columnField,"aria-label":"Group columns by "+o(u.config.columnField),onChange:d[2]||(d[2]=y=>l("columnField",y.target.value))},[s("optgroup",Ni,[(i(!0),c(J,null,se(u.availableFields.categorical,y=>(i(),c("option",{key:y,value:y},C(o(y)),9,zi))),128))])],40,Ui)]),s("div",Wi,[d[11]||(d[11]=s("label",{for:"pivot-column-sort"},"Sort Columns:",-1)),s("select",{id:"pivot-column-sort",value:u.config.columnSort||"original","aria-label":"Sort columns by "+(u.config.columnSort||"original")+" order",onChange:d[3]||(d[3]=y=>l("columnSort",y.target.value))},d[10]||(d[10]=[s("option",{value:"original"},"Original",-1),s("option",{value:"alpha"},"Alphabetical",-1)]),40,Hi)]),s("div",Bi,[d[12]||(d[12]=s("label",{for:"pivot-value-field"},"Values (Aggregate):",-1)),s("select",{id:"pivot-value-field",value:u.config.valueField,"aria-label":"Aggregate "+u.config.valueField+" values",onChange:d[4]||(d[4]=y=>l("valueField",y.target.value))},[s("optgroup",Gi,[(i(!0),c(J,null,se(u.availableFields.extracted,y=>(i(),c("option",{key:y,value:y},C(y),9,qi))),128))]),s("optgroup",Ki,[(i(!0),c(J,null,se(u.availableFields.numeric,y=>(i(),c("option",{key:y,value:y},C(o(y)),9,Qi))),128))])],40,ji)]),s("div",Ji,[d[14]||(d[14]=s("label",{for:"pivot-aggregation"},"Aggregation:",-1)),s("select",{id:"pivot-aggregation",value:u.config.aggregation,"aria-label":"Aggregation method: "+u.config.aggregation,onChange:d[5]||(d[5]=y=>l("aggregation",y.target.value))},d[13]||(d[13]=[Ot('<optgroup label="Statistical" data-v-0d3a0d50><option value="mean" data-v-0d3a0d50>Mean</option><option value="median" data-v-0d3a0d50>Median</option><option value="variance" data-v-0d3a0d50>Variance</option><option value="std_dev" data-v-0d3a0d50>Std Dev</option><option value="min" data-v-0d3a0d50>Min</option><option value="max" data-v-0d3a0d50>Max</option><option value="sum" data-v-0d3a0d50>Sum</option></optgroup><optgroup label="Frequency" data-v-0d3a0d50><option value="count" data-v-0d3a0d50>Count</option><option value="mode" data-v-0d3a0d50>Mode</option></optgroup><optgroup label="Performance" data-v-0d3a0d50><option value="success_rate" data-v-0d3a0d50>Success Rate</option><option value="refusal_rate" data-v-0d3a0d50>Refusal Rate</option><option value="avg_time" data-v-0d3a0d50>Avg Time</option></optgroup>',3)]),40,Xi)])])]))}}),Zi=ie(Yi,[["__scopeId","data-v-0d3a0d50"]]),er={class:"heatmap-controls-v3"},tr={class:"color-scale-selector"},sr=["value","aria-label"],ar={class:"gradient-mode-selector"},nr={class:"gradient-toggle",role:"group","aria-label":"Gradient mode selector"},lr=["aria-pressed"],or=["aria-pressed"],ir=["aria-pressed"],rr=["title","aria-label"],ur=oe({__name:"PivotHeatmapV3",props:{selectedColorScale:{},gradientMode:{},isFullscreen:{type:Boolean}},emits:["update-color-scale","update-gradient-mode","toggle-fullscreen"],setup(a,{emit:e}){const t=e;function l(u){const d=u.target.value;t("update-color-scale",d)}function o(u){t("update-gradient-mode",u)}return(u,d)=>(i(),c("div",er,[s("div",tr,[d[5]||(d[5]=s("label",{for:"heatmap-color-scale"},"Color Scale:",-1)),s("select",{id:"heatmap-color-scale",value:u.selectedColorScale,"aria-label":"Color scale: "+u.selectedColorScale,onChange:l},d[4]||(d[4]=[Ot('<option value="blue-subtle" data-v-dcb6369b>Blue (Subtle)</option><option value="green-red" data-v-dcb6369b>Green-Red (Success)</option><option value="blue-yellow" data-v-dcb6369b>Blue-Yellow (Performance)</option><option value="purple-orange" data-v-dcb6369b>Purple-Orange (General)</option><option value="viridis" data-v-dcb6369b>Viridis</option><option value="inferno" data-v-dcb6369b>Inferno</option><option value="magma" data-v-dcb6369b>Magma</option><option value="plasma" data-v-dcb6369b>Plasma</option><option value="grayscale" data-v-dcb6369b>Grayscale</option>',9)]),40,sr)]),s("div",ar,[d[6]||(d[6]=s("label",null,"Gradient Mode:",-1)),s("div",nr,[s("button",{type:"button",class:te(["toggle-btn",{active:u.gradientMode==="global"}]),"aria-pressed":u.gradientMode==="global",onClick:d[0]||(d[0]=y=>o("global"))}," Global ",10,lr),s("button",{type:"button",class:te(["toggle-btn",{active:u.gradientMode==="column"}]),"aria-pressed":u.gradientMode==="column",onClick:d[1]||(d[1]=y=>o("column"))}," Per Column ",10,or),s("button",{type:"button",class:te(["toggle-btn",{active:u.gradientMode==="row"}]),"aria-pressed":u.gradientMode==="row",onClick:d[2]||(d[2]=y=>o("row"))}," Per Row ",10,ir)])]),s("button",{type:"button",class:"fullscreen-btn",title:u.isFullscreen?"Exit Fullscreen":"Enter Fullscreen","aria-label":u.isFullscreen?"Exit fullscreen mode":"Enter fullscreen mode",onClick:d[3]||(d[3]=y=>u.$emit("toggle-fullscreen"))},C(u.isFullscreen?"âŠŸ":"âŠž"),9,rr)]))}}),dr=ie(ur,[["__scopeId","data-v-dcb6369b"]]),cr={class:"pivot-filters-v3"},pr={class:"filters-row"},fr={key:0,class:"filter-group"},mr=["value"],vr=["value"],gr=["for"],hr=["id","value","aria-label","onChange"],br={value:""},yr=["value"],_r={key:1,class:"filter-group"},Tr=["value"],$r=["value"],Cr=oe({__name:"PivotFiltersV3",props:{apiCalls:{},trial:{},activeFilters:{}},emits:["update-filters","clear-filters"],setup(a,{emit:e}){const t=a,l=e,o=q({});let u=0;const d=()=>{if(t.apiCalls.length===0){o.value={};return}const T={};t.apiCalls.forEach(_=>{if(t.trial&&_.configurationIndex<t.trial.configurations.length){const b=t.trial.configurations[_.configurationIndex].modelId||"Unknown";T.model||(T.model=new Set),T.model.add(b)}_.status&&(T.status||(T.status=new Set),T.status.add(_.status)),_.variables&&Object.entries(_.variables).forEach(([I,b])=>{b&&String(b).trim()&&(T[I]||(T[I]=new Set),T[I].add(String(b)))})});const h={};Object.entries(T).forEach(([_,I])=>{h[_]=Array.from(I).sort()}),o.value=h};re(()=>t.apiCalls.length,T=>{(T===0||u===0||T-u>=5)&&(d(),u=T)},{immediate:!0});const y=M(()=>{const{model:T,status:h,..._}=o.value;return _}),r=M(()=>Object.values(t.activeFilters).some(T=>T!==""));function f(T){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",extracted_value:"Extracted Value"}[T]||T.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())}function v(T,h){const _={...t.activeFilters};h===""?delete _[T]:_[T]=h,l("update-filters",_)}return(T,h)=>(i(),c("div",cr,[s("div",pr,[o.value.model&&o.value.model.length>1?(i(),c("div",fr,[h[4]||(h[4]=s("label",{for:"filter-model",class:"filter-label"},"Model:",-1)),s("select",{id:"filter-model",value:T.activeFilters.model||"",class:"filter-select","aria-label":"Filter by model",onChange:h[0]||(h[0]=_=>v("model",_.target.value))},[h[3]||(h[3]=s("option",{value:""},"All Models",-1)),(i(!0),c(J,null,se(o.value.model,_=>(i(),c("option",{key:_,value:_},C(_),9,vr))),128))],40,mr)])):O("",!0),(i(!0),c(J,null,se(y.value,(_,I)=>(i(),c("div",{key:I,class:"filter-group"},[s("label",{for:`filter-${I}`,class:"filter-label"},C(f(String(I)))+": ",9,gr),s("select",{id:`filter-${I}`,value:T.activeFilters[I]||"",class:"filter-select","aria-label":`Filter by ${f(String(I))}`,onChange:b=>v(I,b.target.value)},[s("option",br,"All "+C(f(String(I))),1),(i(!0),c(J,null,se(_,b=>(i(),c("option",{key:b,value:b},C(b),9,yr))),128))],40,hr)]))),128)),o.value.status&&o.value.status.length>1?(i(),c("div",_r,[h[6]||(h[6]=s("label",{for:"filter-status",class:"filter-label"},"Status:",-1)),s("select",{id:"filter-status",value:T.activeFilters.status||"",class:"filter-select","aria-label":"Filter by status",onChange:h[1]||(h[1]=_=>v("status",_.target.value))},[h[5]||(h[5]=s("option",{value:""},"All Statuses",-1)),(i(!0),c(J,null,se(o.value.status,_=>(i(),c("option",{key:_,value:_},C(_),9,$r))),128))],40,Tr)])):O("",!0),r.value?(i(),c("button",{key:2,type:"button",class:"clear-filters-btn",title:"Clear all filters","aria-label":"Clear all filters",onClick:h[2]||(h[2]=_=>T.$emit("clear-filters"))}," Clear Filters ")):O("",!0)])]))}}),kr=ie(Cr,[["__scopeId","data-v-7e1a1f6a"]]),Sr={class:"collapse-icon"},wr={class:"options-content"},Ir={class:"controls-row"},Rr={key:0,class:"performance-info"},Er={class:"table-view"},Vr={key:0,class:"empty-state","data-testid":"empty-data-message"},Ar={key:1,class:"error-state","data-testid":"invalid-aggregation-error"},Or={key:2,class:"loading-state","data-testid":"computing-state"},Fr={key:3,class:"pivot-table-container"},Pr={class:"pivot-table-grid responsive-table",role:"table"},Lr={role:"row"},Mr={class:"corner-cell",role:"columnheader"},Dr={key:0,class:"total-header",role:"columnheader"},xr={class:"row-header",role:"rowheader"},Ur=["data-testid","title","aria-label","role","onClick","onKeydown"],Nr={key:0,class:"cell-content"},zr=["title"],Wr={class:"cell-value"},Hr={class:"error-message"},Br={key:1},jr=oe({__name:"PivotTableV3",props:{apiCalls:{},trial:{default:null},config:{},maxTableRows:{default:1e4},showTotals:{type:Boolean,default:!0},showPerformanceInfo:{type:Boolean,default:!1}},emits:["config-change","cell-click"],setup(a,{emit:e}){var w,Z,ce,me,Se,Ae;const t=a,l=e,o=q(!1),u=q("viridis"),d=q("global"),y=q(!1),r=q({rowField:((w=t.config)==null?void 0:w.rowField)||"",columnField:((Z=t.config)==null?void 0:Z.columnField)||"",valueField:((ce=t.config)==null?void 0:ce.valueField)||"",aggregation:((me=t.config)==null?void 0:me.aggregation)||"mean",rowSort:((Se=t.config)==null?void 0:Se.rowSort)||"original",columnSort:((Ae=t.config)==null?void 0:Ae.columnSort)||"original"});re(()=>t.config,j=>{j&&Object.assign(r.value,j)},{deep:!0});const f=q({}),v=We(),T=M(()=>v.apiCalls?v.apiCalls.value||[]:t.apiCalls||[]),h=T,_=M(()=>t.trial),{pivotData:I,availableFields:b,isComputing:k,lastComputeTime:H}=Ei(h,r,_,f,{debounceMs:750});re(I,(j,K)=>{var fe,Oe;const G=performance.now(),Q=((fe=j==null?void 0:j.rows)==null?void 0:fe.length)||0,ue=((Oe=j==null?void 0:j.columns)==null?void 0:Oe.length)||0;m.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData computed: ${Q}x${ue} matrix`),setTimeout(()=>{const He=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 pivotData render completed in ${(He-G).toFixed(1)}ms`)},0)}),re(k,j=>{j?m.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING STARTED with ${T.value.length} API calls`):m.info(`V4_TRIAL_SWITCH: PivotTableV3 COMPUTING FINISHED in ${H.value.toFixed(1)}ms`)}),re(T,(j,K)=>{const G=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls changed from ${(K==null?void 0:K.length)||0} to ${j.length} calls`),setTimeout(()=>{const Q=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 apiCalls prop update completed in ${(Q-G).toFixed(1)}ms`)},0)});const F=M(()=>I.value.rows.slice(0,t.maxTableRows)),g=M(()=>Object.values(f.value).some(K=>K!=="")?T.value.filter(K=>{var G;if(f.value.model&&f.value.model!==""&&(!t.trial||K.configurationIndex>=t.trial.configurations.length||(t.trial.configurations[K.configurationIndex].modelId||"Unknown")!==f.value.model)||f.value.status&&f.value.status!==""&&K.status!==f.value.status)return!1;for(const[Q,ue]of Object.entries(f.value))if(ue&&ue!==""&&Q!=="model"&&Q!=="status"&&((G=K.variables)==null?void 0:G[Q])!==ue)return!1;return!0}).length:T.value.length),{getCellStyle:E,getSummaryStyle:D,styleKey:A}=Cs(I,u,d);function p(j){return{model:"Model",status:"Status",response_time:"Response Time (ms)",total_tokens:"Total Tokens",prompt_tokens:"Prompt Tokens",completion_tokens:"Completion Tokens",error_type:"Error Type",success:"Success",refused:"Refused",parsed_response:"Parsed Response"}[j]||j.replace(/_/g," ").replace(/\b\w/g,G=>G.toUpperCase())}function R(j,K,G){if(!G)return`${j} Ã— ${K}: No data`;const Q=ye(G,r.value.aggregation);let ue=`${j} Ã— ${K}: ${Q} (${G.count} calls)`;if(G.excludedCounts){const fe=[];G.excludedCounts.nonNumeric>0&&fe.push(`${G.excludedCounts.nonNumeric} non-numeric responses excluded`),G.excludedCounts.nullUndefined>0&&fe.push(`${G.excludedCounts.nullUndefined} null/empty responses`),fe.length>0&&(ue+=` | ${fe.join(", ")}`)}return G.error&&(ue+=` - ERROR: ${G.error}`),ue}function U(j,K,G){if(!G)return`${j} by ${K}: No data`;const Q=ye(G,r.value.aggregation);return G.error?`${j} by ${K}: ${Q} with data integrity error: ${G.error}`:`${j} by ${K}: ${Q} from ${G.count} API calls`}function n(j,K){(j==="rowField"||j==="columnField"||j==="valueField"||j==="aggregation"||j==="rowSort"||j==="columnSort")&&(r.value[j]=K),l("config-change",{...r.value})}function S(j){f.value={...j}}function N(){f.value={}}function $(j,K,G){G&&l("cell-click",{row:j,column:K,cell:G})}function B(){y.value=!y.value}function ae(){o.value=!o.value,o.value?document.body.style.overflow="hidden":document.body.style.overflow=""}return ve(()=>{var K;const j=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 MOUNTED for trial ${((K=t.trial)==null?void 0:K.id)||"unknown"} with ${T.value.length} calls`),Te(()=>{const G=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 DOM ready in ${(G-j).toFixed(1)}ms`)}),setTimeout(()=>{const G=performance.now();m.info(`V4_TRIAL_SWITCH: PivotTableV3 mount completed in ${(G-j).toFixed(1)}ms`)},0)}),Re(()=>{var j;m.info(`V4_TRIAL_SWITCH: PivotTableV3 ACTIVATED (cache hit) for trial ${((j=t.trial)==null?void 0:j.id)||"unknown"} with ${T.value.length} calls`)}),Ee(()=>{var j;m.info(`V4_TRIAL_SWITCH: PivotTableV3 DEACTIVATED (cached) for trial ${((j=t.trial)==null?void 0:j.id)||"unknown"}`)}),he(()=>{var j;m.info(`V4_TRIAL_SWITCH: PivotTableV3 UNMOUNTED (evicted) for trial ${((j=t.trial)==null?void 0:j.id)||"unknown"}`),o.value&&(document.body.style.overflow="")}),re([b,T],([j])=>{if(T.value.length>0&&(!r.value.rowField||r.value.rowField==="")&&j.categorical.length>0){if(r.value.rowField=j.categorical.find(K=>K!=="model"&&K!=="status"&&K!=="error_type")||j.categorical[0]||"model",r.value.columnField=r.value.columnField||"model",r.value.valueField=r.value.valueField||"parsed_response",!r.value.aggregation||r.value.aggregation===""){const K=T.value.slice(0,3).map(Q=>Ie(Q,r.value.valueField,t.trial)).filter(Q=>Q!=null),G=K.length>0&&K.every(Q=>typeof Q=="number");r.value.aggregation=G?"mean":"mode"}l("config-change",{...r.value})}},{immediate:!0}),(j,K)=>(i(),c("div",{class:te(["pivot-table-v3",{fullscreen:o.value}])},[s("div",{class:te(["pivot-options-container",{collapsed:y.value}])},[s("div",{class:"options-header",onClick:B},[K[3]||(K[3]=s("span",{class:"options-title"},"Pivot Table Options",-1)),s("span",Sr,C(y.value?"â–¶":"â–¼"),1)]),ke(s("div",wr,[ds([z(b),r.value],()=>(i(),c("div",null,[V(Zi,{config:r.value,"available-fields":z(b),onUpdateConfig:n},null,8,["config","available-fields"])])),K,0),s("div",Ir,[T.value.length>0?(i(),Y(kr,{key:0,"api-calls":T.value,trial:j.trial,"active-filters":f.value,onUpdateFilters:S,onClearFilters:N},null,8,["api-calls","trial","active-filters"])):O("",!0),V(dr,{"selected-color-scale":u.value,"gradient-mode":d.value,"is-fullscreen":o.value,onUpdateColorScale:K[1]||(K[1]=G=>u.value=G),onUpdateGradientMode:K[2]||(K[2]=G=>d.value=G),onToggleFullscreen:ae},null,8,["selected-color-scale","gradient-mode","is-fullscreen"])])],512),[[Ft,!y.value]])],2),j.showPerformanceInfo?(i(),c("div",Rr,[s("span",null,"Computing: "+C(z(k)?"Yes":"No"),1),s("span",null,"Last Compute: "+C(z(H).toFixed(1))+"ms",1),s("span",null,"API Calls: "+C(T.value.length),1),s("span",null,"Filtered: "+C(g.value),1)])):O("",!0),s("div",Er,[T.value.length===0?(i(),c("div",Vr,K[4]||(K[4]=[s("p",null,"No data available for pivot table analysis.",-1)]))):r.value.aggregation in z(Ve)?z(k)?(i(),c("div",Or,K[6]||(K[6]=[s("p",null,"Computing pivot table...",-1)]))):(i(),c("div",Fr,[s("table",Pr,[s("thead",null,[s("tr",Lr,[s("th",Mr,C(p(r.value.rowField)||"Items")+" / "+C(p(r.value.columnField)||"Aggregated"),1),(i(!0),c(J,null,se(z(I).columns,G=>(i(),c("th",{key:G,class:"column-header",role:"columnheader"},C(G),1))),128)),r.value.columnField&&j.showTotals?(i(),c("th",Dr," Total ")):O("",!0)])]),s("tbody",null,[(i(!0),c(J,null,se(F.value,G=>(i(),c("tr",{key:`${G.label}-${z(A)}`,class:"data-row",role:"row"},[s("td",xr,C(G.label),1),(i(!0),c(J,null,se(G.cells,(Q,ue)=>(i(),c("td",{key:`${ue}-${z(A)}`,class:te(["data-cell",{"error-cell":Q==null?void 0:Q.error}]),"data-testid":Q!=null&&Q.error?"pivot-cell-error":"pivot-cell",style:ge(z(E)(Q,G.label,ue)),title:R(G.label,z(I).columns[ue],Q),"aria-label":U(G.label,z(I).columns[ue],Q),role:Q!=null&&Q.error?"alert":"cell",tabindex:"0",onClick:fe=>$(G.label,z(I).columns[ue],Q),onKeydown:[qe(fe=>$(G.label,z(I).columns[ue],Q),["enter"]),qe(Pt(fe=>$(G.label,z(I).columns[ue],Q),["prevent"]),["space"])]},[Q!=null&&Q.error?(i(),c("div",Nr,[s("span",{class:"error-indicator",title:Q.error},"âš ï¸",8,zr),s("span",Wr,C(Q?z(ye)(Q,r.value.aggregation):"-"),1),s("div",Hr,C(Q.error),1)])):(i(),c("span",Br,C(Q?z(ye)(Q,r.value.aggregation):"-"),1))],46,Ur))),128)),r.value.columnField&&j.showTotals?(i(),c("td",{key:0,class:"total-cell",style:ge(z(D)(G.total)),role:"cell"},C(z(ye)(G.total,r.value.aggregation)),5)):O("",!0)]))),128)),r.value.rowField&&j.showTotals?(i(),c("tr",{key:`totals-${z(A)}`,class:"total-row",role:"row"},[K[7]||(K[7]=s("td",{class:"row-header",role:"rowheader"},"Total",-1)),(i(!0),c(J,null,se(z(I).totals,(G,Q)=>(i(),c("td",{key:`total-${Q}-${z(A)}`,class:"total-cell",style:ge(z(D)(G)),role:"cell"},C(z(ye)(G,r.value.aggregation)),5))),128)),r.value.columnField?(i(),c("td",{key:0,class:"grand-total-cell",style:ge(z(D)(z(I).grandTotal)),role:"cell"},C(z(ye)(z(I).grandTotal,r.value.aggregation)),5)):O("",!0)])):O("",!0)])])])):(i(),c("div",Ar,[s("p",null,"Invalid aggregation function: "+C(r.value.aggregation),1),K[5]||(K[5]=s("p",null,"Please select a valid aggregation method.",-1))]))])],2))}}),Gr=ie(jr,[["__scopeId","data-v-a13bd12e"]]),qr={class:"modal-content"},Kr={class:"modal-header"},Qr={class:"modal-title"},Jr={class:"summary-row"},Xr={key:0},Yr={key:0,class:"filter-row"},Zr=["onUpdate:modelValue","aria-label"],eu={value:""},tu=["value"],su={class:"table-container"},au={class:"api-calls-table"},nu=["title"],lu=["title"],ou=oe({__name:"PivotCellDetailV3",props:{visible:{type:Boolean},row:{},column:{},apiCalls:{},trial:{},value:{}},emits:["close"],setup(a){const e=a,t=cs({}),l=M(()=>{const g=new Set;return e.apiCalls.forEach(E=>{E.variables&&Object.keys(E.variables).forEach(D=>g.add(D)),E.attributedVariables&&Object.entries(E.attributedVariables).forEach(([D,A])=>{A&&typeof A=="object"&&Object.keys(A).forEach(p=>{g.add(`${D}.${p}`)})})}),Array.from(g).sort()}),o=M(()=>l.value.map(g=>({title:g,dataIndex:`var_${g}`,key:`var_${g}`,width:150}))),u=[{title:"Status",dataIndex:"status",key:"status",width:100},{title:"Model",dataIndex:"model",key:"model",width:150}],d=[{title:"Response",dataIndex:"response",key:"response",width:300},{title:"Extracted",dataIndex:"extracted",key:"extracted",width:150},{title:"Duration",dataIndex:"duration",key:"duration",width:100},{title:"Cost",dataIndex:"cost",key:"cost",width:100}],y=M(()=>[...u,...o.value,...d]),r=M(()=>`${e.row} Ã— ${e.column} - ${e.apiCalls.length} API Calls`),f=M(()=>e.apiCalls.map(g=>{var D,A;const E={id:g.id,status:g.status,model:g.model||"-",response:((D=g.result)==null?void 0:D.content)||((A=g.result)==null?void 0:A.error)||"-",extracted:g.extracted||"-",duration:g.duration?`${g.duration}ms`:"-",cost:g.cost||0};return l.value.forEach(p=>{var R,U,n;if(p.includes(".")){const[S,N]=p.split("."),$=(U=(R=g.attributedVariables)==null?void 0:R[S])==null?void 0:U[N];E[`var_${p}`]=$!==void 0?String($):"-"}else E[`var_${p}`]=((n=g.variables)==null?void 0:n[p])||"-"}),E})),v=M(()=>Object.values(t).some(g=>g!==void 0&&g!=="")),T=M(()=>v.value?f.value.filter(g=>Object.entries(t).every(([E,D])=>D?g[E]===D:!0)):f.value),h=M(()=>{const g=e.apiCalls.filter(E=>E.status==="completed").length;return Math.round(g/e.apiCalls.length*100)}),_=M(()=>{const g=e.apiCalls.filter(E=>E.duration).map(E=>E.duration);return g.length===0?0:Math.round(g.reduce((E,D)=>E+D,0)/g.length)}),I=M(()=>e.apiCalls.filter(E=>E.cost).map(E=>E.cost).reduce((E,D)=>E+D,0));function b(g){switch(g){case"completed":return"status-success";case"failed":return"status-error";case"pending":return"status-warning";case"running":return"status-processing";default:return"status-default"}}function k(g,E){return g?g.length<=E?g:g.slice(0,E)+"...":""}function H(g){const E=new Set;return f.value.forEach(D=>{const A=D[g];A&&A!=="-"&&E.add(A)}),Array.from(E).sort()}function F(){Object.keys(t).forEach(g=>{delete t[g]})}return(g,E)=>(i(),c("div",{class:te(["pivot-cell-detail-modal-v3",{visible:g.visible}]),onClick:E[1]||(E[1]=Pt(D=>g.$emit("close"),["self"]))},[s("div",qr,[s("div",Kr,[s("h3",Qr,C(r.value),1),s("button",{type:"button",class:"close-btn","aria-label":"Close modal",onClick:E[0]||(E[0]=D=>g.$emit("close"))}," Ã— ")]),s("div",Jr,[s("span",null,[E[2]||(E[2]=s("b",null,"Total:",-1)),W(" "+C(g.apiCalls.length),1)]),s("span",null,[E[3]||(E[3]=s("b",null,"Success Rate:",-1)),W(" "+C(h.value)+"%",1)]),s("span",null,[E[4]||(E[4]=s("b",null,"Avg Duration:",-1)),W(" "+C(_.value)+"ms",1)]),I.value>0?(i(),c("span",Xr,[E[5]||(E[5]=s("b",null,"Total Cost:",-1)),W(" $"+C(I.value),1)])):O("",!0)]),o.value.length>0?(i(),c("div",Yr,[(i(!0),c(J,null,se(o.value,D=>(i(),c("div",{key:D.key,class:"variable-filter"},[ke(s("select",{"onUpdate:modelValue":A=>t[D.key]=A,"aria-label":`Filter ${D.title}`,class:"filter-select"},[s("option",eu,"All "+C(D.title),1),(i(!0),c(J,null,se(H(D.key),A=>(i(),c("option",{key:A,value:A},C(A),9,tu))),128))],8,Zr),[[ps,t[D.key]]])]))),128)),v.value?(i(),c("button",{key:0,type:"button",class:"clear-filters-btn",onClick:F}," Clear Filters ")):O("",!0)])):O("",!0),s("div",su,[s("table",au,[s("thead",null,[s("tr",null,[(i(!0),c(J,null,se(y.value,D=>(i(),c("th",{key:D.key,class:"table-header",style:ge({width:D.width?`${D.width}px`:"auto"})},C(D.title),5))),128))])]),s("tbody",null,[(i(!0),c(J,null,se(T.value,D=>(i(),c("tr",{key:D.id,class:"table-row"},[(i(!0),c(J,null,se(y.value,A=>(i(),c("td",{key:A.key,class:te(["table-cell",{"status-cell":A.key==="status"}])},[A.key==="status"?(i(),c("span",{key:0,class:te(["status-tag",b(D.status)])},C(D.status),3)):A.key==="response"?(i(),c("span",{key:1,class:"response-cell",title:D.response},C(k(D.response,100)),9,nu)):A.key==="cost"?(i(),c(J,{key:2},[W(C(D.cost===0?"-":`$${D.cost.toFixed(4)}`),1)],64)):A.key.startsWith("var_")?(i(),c("span",{key:3,class:"variable-cell",title:D[A.key]},C(D[A.key]||"-"),9,lu)):(i(),c(J,{key:4},[W(C(D[A.key]||"-"),1)],64))],2))),128))]))),128))])])])])],2))}}),iu=ie(ou,[["__scopeId","data-v-925c111e"]]),ru={class:"trial-tab-content"},uu={class:"tab-pane-content"},du={class:"tab-pane-content"},cu={key:0,class:"no-data-message"},pu={class:"tab-pane-content"},It="trial-details-active-tab",fu=oe({__name:"TrialTabContentV3",props:{trial:{},progress:{},isLeader:{type:Boolean},executionState:{}},setup(a){const e=a,t=Lt(),l=st(),o=We(),u=M(()=>{var F;return((F=o.apiCalls)==null?void 0:F.value)||[]}),d=M(()=>{var F;return((F=o.isStreaming)==null?void 0:F.value)||!1});re(u,(F,g)=>{const E=performance.now();m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls changed from ${(g==null?void 0:g.length)||0} to ${F.length} calls`),setTimeout(()=>{const D=performance.now();m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 apiCalls reactive update completed in ${(D-E).toFixed(1)}ms`)},0)});const y=M(()=>!1),f=q((()=>{const F=t.query.tab;return F==="status"?"details":F&&["details","tasks","pivot"].includes(F)?F:"tasks"})()),v=q(!1),T=q(!1),h=q({row:"",column:"",apiCalls:[],value:null}),_=M(()=>e.executionState.status==="executing"&&e.executionState.currentTrialId===e.trial.id),I=M(()=>e.trial.progress.completed>0);function b(){localStorage.setItem(It,f.value);const F={...t.query};F.tab=f.value,t.query.tab!==f.value&&(l.replace({query:F}),m.info(`TAB_ROUTING: Updated URL tab parameter to '${f.value}'`))}function k(){const F=localStorage.getItem(It);F==="status"?f.value="details":F&&["details","tasks","pivot"].includes(F)&&(f.value=F)}function H(F){!F.cell||!F.cell.apiCalls.length||(h.value={row:F.row,column:F.column,apiCalls:F.cell.apiCalls,value:F.cell.value},T.value=!0)}return re(f,()=>{b()}),re(()=>t.query.tab,F=>{if(F&&typeof F=="string"){let g=F==="status"?"details":F;["details","tasks","pivot"].includes(g)&&f.value!==g&&(f.value=g,m.info(`TAB_ROUTING: Synced tab to URL parameter '${g}'`))}}),ve(()=>{const F=performance.now();if(m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 MOUNTED for trial ${e.trial.id}`),!t.query.tab){const g={...t.query};g.tab=f.value,l.replace({query:g}),m.info(`TAB_ROUTING: Set initial URL tab parameter to '${f.value}'`)}k(),setTimeout(()=>{const g=performance.now();m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 mount completed in ${(g-F).toFixed(1)}ms`)},0)}),Re(()=>{m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 ACTIVATED (cache hit) for trial ${e.trial.id}`)}),Ee(()=>{m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 DEACTIVATED (cached) for trial ${e.trial.id}`)}),he(()=>{m.info(`V4_TRIAL_SWITCH: TrialTabContentV3 UNMOUNTED (evicted) for trial ${e.trial.id}`)}),(F,g)=>{const E=ee("a-tab-pane"),D=ee("a-tabs");return i(),c("div",ru,[V(D,{activeKey:f.value,"onUpdate:activeKey":g[1]||(g[1]=A=>f.value=A),type:"card",class:"trial-tabs"},{default:P(()=>[V(E,{key:"tasks",tab:"Task View"},{default:P(()=>[s("div",uu,[(i(),Y(Je,null,[V(Ii,{trial:F.trial,progress:F.progress,"is-executing":_.value,"api-calls":u.value,"is-streaming":d.value,"is-loading":y.value},null,8,["trial","progress","is-executing","api-calls","is-streaming","is-loading"])],1024))])]),_:1}),V(E,{key:"pivot",tab:"Pivot Table"},{default:P(()=>[s("div",du,[(i(),Y(Je,null,[I.value&&u.value.length>0?(i(),Y(Gr,{key:0,"api-calls":u.value,trial:F.trial,"show-performance-info":!1,onCellClick:H},null,8,["api-calls","trial"])):O("",!0)],1024)),I.value&&u.value.length>0?O("",!0):(i(),c("div",cu,g[3]||(g[3]=[s("p",null,"No completed API calls available for pivot analysis.",-1),s("p",null,"Run the trial to see pivot table data.",-1)])))])]),_:1}),V(E,{key:"details",tab:"Details"},{default:P(()=>[s("div",pu,[V(ll,{trial:F.trial,"is-collapsed":v.value,onToggleCollapse:g[0]||(g[0]=A=>v.value=!v.value)},null,8,["trial","is-collapsed"])])]),_:1})]),_:1},8,["activeKey"]),T.value?(i(),Y(iu,{key:0,visible:T.value,row:h.value.row,column:h.value.column,"api-calls":h.value.apiCalls,trial:F.trial,value:h.value.value,onClose:g[2]||(g[2]=A=>T.value=!1)},null,8,["visible","row","column","api-calls","trial","value"])):O("",!0)])}}}),mu=ie(fu,[["__scopeId","data-v-513628c4"]]),vu={class:"export-content"},gu={class:"section"},hu={class:"section"},bu={class:"field-actions"},yu={class:"field-groups"},_u={class:"field-group"},Tu={class:"field-list"},$u={class:"field-group"},Cu={class:"field-list"},ku={class:"field-group"},Su={class:"field-list"},wu={class:"field-group"},Iu={class:"field-list"},Ru={class:"field-group"},Eu={class:"field-list"},Vu={key:0,class:"field-group"},Au={class:"field-list"},Ou={key:1,class:"field-group"},Fu={class:"field-list"},Pu={class:"section"},Lu={class:"preview-info"},Mu={class:"info-item"},Du={class:"value"},xu={class:"info-item"},Uu={class:"value"},Nu={class:"info-item"},zu={class:"value"},Wu={class:"export-actions"},Hu=oe({__name:"ExportDataModalV3",props:{visible:{type:Boolean},trial:{}},emits:["update:visible"],setup(a,{emit:e}){const t=a,l=e,o=tt(),u=q("csv"),d=q(["order","status","configuration","prompt","response","latency"]),y=q(!1),r=q({}),f=q([]),v=q([]),T=q([]),h=["order","status","configuration","prompt","response","latency"],_=q([]),I=["id","order","status","created","completed","configuration","provider","modelId","parameters","prompt","variables","response","parsedResponse","latency","promptTokens","completionTokens","totalTokens","cost","request","response_raw","error","repeatIndex"],b=M(()=>{var S,N;const U=((S=t.trial.progress)==null?void 0:S.completed)||0,n=((N=t.trial.progress)==null?void 0:N.failed)||0;return U+n}),k=M(()=>{const n=d.value.length*50*b.value;return n<1024?`${n} B`:n<1024*1024?`${(n/1024).toFixed(1)} KB`:`${(n/(1024*1024)).toFixed(1)} MB`});function H(){m.info("EXPORT_DEBUG: ExportModal initializeFieldSelection with allFields",_.value.length),_.value.forEach(S=>{r.value[S]=!1}),h.forEach(S=>{r.value[S]=!0});const U=v.value.map(S=>S.id),n=T.value.map(S=>S.id);U.forEach(S=>{r.value[S]=!0}),n.forEach(S=>{r.value[S]=!0}),m.info("EXPORT_DEBUG: ExportModal default selection includes",{standardDefaults:h.length,parameterDefaults:U.length,variableDefaults:n.length,totalDefaults:h.length+U.length+n.length}),F()}function F(){d.value=_.value.filter(U=>r.value[U])}function g(U,n){r.value[U]=n,F()}function E(){_.value.forEach(U=>{r.value[U]=!0}),F()}function D(){_.value.forEach(S=>{r.value[S]=!1}),h.forEach(S=>{r.value[S]=!0});const U=v.value.map(S=>S.id),n=T.value.map(S=>S.id);U.forEach(S=>{r.value[S]=!0}),n.forEach(S=>{r.value[S]=!0}),F()}function A(){_.value.forEach(U=>{r.value[U]=!1}),F()}function p(){l("update:visible",!1)}async function R(){if(d.value.length===0){le.warning("Please select at least one field to export");return}y.value=!0;try{const U={format:u.value,fields:d.value,includeHeaders:!0,addBOM:u.value==="excel"||u.value==="csv"},n=await o.dataExport.exportTrialData(t.trial.id,U);n.ok?(le.success("Export completed successfully"),l("update:visible",!1)):le.error(`Export failed: ${n.error.message}`)}catch(U){le.error("Export failed: "+U.message)}finally{y.value=!1}}return ve(async()=>{m.info("EXPORT_DEBUG: ExportModal discovering available fields for trial",t.trial.id);const U=await o.dataExport.getAvailableFields(t.trial.id);if(U.ok){f.value=U.value.standardFields,v.value=U.value.parameterFields,T.value=U.value.variableFields||[];const n=U.value.standardFields.map($=>$.id).filter($=>$!=="parameters"&&$!=="variables"),S=U.value.parameterFields.map($=>$.id),N=(U.value.variableFields||[]).map($=>$.id);_.value=[...n,...S,...N],m.info("EXPORT_DEBUG: ExportModal discovered fields",{standardFields:U.value.standardFields.length,parameterFields:U.value.parameterFields.length,variableFields:(U.value.variableFields||[]).length,totalFields:_.value.length,parameterFieldNames:U.value.parameterFields.map($=>$.id),variableFieldNames:(U.value.variableFields||[]).map($=>$.id),allFieldNames:_.value})}else m.info("EXPORT_DEBUG: ExportModal field discovery failed",U.error),_.value=[...I];H()}),(U,n)=>{const S=ee("a-radio-button"),N=ee("a-radio-group"),$=ee("a-button"),B=ee("a-checkbox"),ae=ee("a-modal");return i(),Y(ae,{visible:U.visible,"onUpdate:visible":n[45]||(n[45]=w=>U.$emit("update:visible",w)),title:"Export Trial Data",width:800,footer:null,"destroy-on-close":!0,class:"export-data-modal"},{default:P(()=>[s("div",vu,[s("div",gu,[n[51]||(n[51]=s("h4",null,"Export Format",-1)),V(N,{value:u.value,"onUpdate:value":n[0]||(n[0]=w=>u.value=w),class:"format-options"},{default:P(()=>[V(S,{value:"csv"},{default:P(()=>n[46]||(n[46]=[W("CSV")])),_:1,__:[46]}),V(S,{value:"tsv"},{default:P(()=>n[47]||(n[47]=[W("TSV")])),_:1,__:[47]}),V(S,{value:"excel"},{default:P(()=>n[48]||(n[48]=[W("Excel")])),_:1,__:[48]}),V(S,{value:"json"},{default:P(()=>n[49]||(n[49]=[W("JSON")])),_:1,__:[49]}),V(S,{value:"jsonl"},{default:P(()=>n[50]||(n[50]=[W("JSONL")])),_:1,__:[50]})]),_:1},8,["value"])]),s("div",hu,[n[84]||(n[84]=s("h4",null,"Fields to Export",-1)),s("div",bu,[V($,{size:"small",onClick:E},{default:P(()=>n[52]||(n[52]=[W("Select All")])),_:1,__:[52]}),V($,{size:"small",onClick:D},{default:P(()=>n[53]||(n[53]=[W("Select Defaults")])),_:1,__:[53]}),V($,{size:"small",onClick:A},{default:P(()=>n[54]||(n[54]=[W("Clear All")])),_:1,__:[54]})]),s("div",yu,[s("div",_u,[n[60]||(n[60]=s("h5",null,"Basic Information",-1)),s("div",Tu,[V(B,{checked:r.value.id,"onUpdate:checked":n[1]||(n[1]=w=>r.value.id=w),onChange:n[2]||(n[2]=w=>g("id",w.target.checked))},{default:P(()=>n[55]||(n[55]=[W("Call ID")])),_:1,__:[55]},8,["checked"]),V(B,{checked:r.value.order,"onUpdate:checked":n[3]||(n[3]=w=>r.value.order=w),onChange:n[4]||(n[4]=w=>g("order",w.target.checked))},{default:P(()=>n[56]||(n[56]=[W("Order")])),_:1,__:[56]},8,["checked"]),V(B,{checked:r.value.status,"onUpdate:checked":n[5]||(n[5]=w=>r.value.status=w),onChange:n[6]||(n[6]=w=>g("status",w.target.checked))},{default:P(()=>n[57]||(n[57]=[W("Status")])),_:1,__:[57]},8,["checked"]),V(B,{checked:r.value.created,"onUpdate:checked":n[7]||(n[7]=w=>r.value.created=w),onChange:n[8]||(n[8]=w=>g("created",w.target.checked))},{default:P(()=>n[58]||(n[58]=[W("Created Time")])),_:1,__:[58]},8,["checked"]),V(B,{checked:r.value.completed,"onUpdate:checked":n[9]||(n[9]=w=>r.value.completed=w),onChange:n[10]||(n[10]=w=>g("completed",w.target.checked))},{default:P(()=>n[59]||(n[59]=[W("Completed Time")])),_:1,__:[59]},8,["checked"])])]),s("div",$u,[n[65]||(n[65]=s("h5",null,"Configuration",-1)),s("div",Cu,[V(B,{checked:r.value.configuration,"onUpdate:checked":n[11]||(n[11]=w=>r.value.configuration=w),onChange:n[12]||(n[12]=w=>g("configuration",w.target.checked))},{default:P(()=>n[61]||(n[61]=[W("Configuration Name")])),_:1,__:[61]},8,["checked"]),V(B,{checked:r.value.provider,"onUpdate:checked":n[13]||(n[13]=w=>r.value.provider=w),onChange:n[14]||(n[14]=w=>g("provider",w.target.checked))},{default:P(()=>n[62]||(n[62]=[W("Provider")])),_:1,__:[62]},8,["checked"]),V(B,{checked:r.value.modelId,"onUpdate:checked":n[15]||(n[15]=w=>r.value.modelId=w),onChange:n[16]||(n[16]=w=>g("modelId",w.target.checked))},{default:P(()=>n[63]||(n[63]=[W("Model ID")])),_:1,__:[63]},8,["checked"]),V(B,{checked:r.value.parameters,"onUpdate:checked":n[17]||(n[17]=w=>r.value.parameters=w),onChange:n[18]||(n[18]=w=>g("parameters",w.target.checked))},{default:P(()=>n[64]||(n[64]=[W("Parameters")])),_:1,__:[64]},8,["checked"])])]),s("div",ku,[n[70]||(n[70]=s("h5",null,"Content",-1)),s("div",Su,[V(B,{checked:r.value.prompt,"onUpdate:checked":n[19]||(n[19]=w=>r.value.prompt=w),onChange:n[20]||(n[20]=w=>g("prompt",w.target.checked))},{default:P(()=>n[66]||(n[66]=[W("Prompt")])),_:1,__:[66]},8,["checked"]),V(B,{checked:r.value.variables,"onUpdate:checked":n[21]||(n[21]=w=>r.value.variables=w),onChange:n[22]||(n[22]=w=>g("variables",w.target.checked))},{default:P(()=>n[67]||(n[67]=[W("Variables")])),_:1,__:[67]},8,["checked"]),V(B,{checked:r.value.response,"onUpdate:checked":n[23]||(n[23]=w=>r.value.response=w),onChange:n[24]||(n[24]=w=>g("response",w.target.checked))},{default:P(()=>n[68]||(n[68]=[W("Response")])),_:1,__:[68]},8,["checked"]),V(B,{checked:r.value.parsedResponse,"onUpdate:checked":n[25]||(n[25]=w=>r.value.parsedResponse=w),onChange:n[26]||(n[26]=w=>g("parsedResponse",w.target.checked))},{default:P(()=>n[69]||(n[69]=[W("Parsed Response")])),_:1,__:[69]},8,["checked"])])]),s("div",wu,[n[76]||(n[76]=s("h5",null,"Performance",-1)),s("div",Iu,[V(B,{checked:r.value.latency,"onUpdate:checked":n[27]||(n[27]=w=>r.value.latency=w),onChange:n[28]||(n[28]=w=>g("latency",w.target.checked))},{default:P(()=>n[71]||(n[71]=[W("Latency (ms)")])),_:1,__:[71]},8,["checked"]),V(B,{checked:r.value.promptTokens,"onUpdate:checked":n[29]||(n[29]=w=>r.value.promptTokens=w),onChange:n[30]||(n[30]=w=>g("promptTokens",w.target.checked))},{default:P(()=>n[72]||(n[72]=[W("Prompt Tokens")])),_:1,__:[72]},8,["checked"]),V(B,{checked:r.value.completionTokens,"onUpdate:checked":n[31]||(n[31]=w=>r.value.completionTokens=w),onChange:n[32]||(n[32]=w=>g("completionTokens",w.target.checked))},{default:P(()=>n[73]||(n[73]=[W("Completion Tokens")])),_:1,__:[73]},8,["checked"]),V(B,{checked:r.value.totalTokens,"onUpdate:checked":n[33]||(n[33]=w=>r.value.totalTokens=w),onChange:n[34]||(n[34]=w=>g("totalTokens",w.target.checked))},{default:P(()=>n[74]||(n[74]=[W("Total Tokens")])),_:1,__:[74]},8,["checked"]),V(B,{checked:r.value.cost,"onUpdate:checked":n[35]||(n[35]=w=>r.value.cost=w),onChange:n[36]||(n[36]=w=>g("cost",w.target.checked))},{default:P(()=>n[75]||(n[75]=[W("Cost (USD)")])),_:1,__:[75]},8,["checked"])])]),s("div",Ru,[n[81]||(n[81]=s("h5",null,"Technical Details",-1)),s("div",Eu,[V(B,{checked:r.value.request,"onUpdate:checked":n[37]||(n[37]=w=>r.value.request=w),onChange:n[38]||(n[38]=w=>g("request",w.target.checked))},{default:P(()=>n[77]||(n[77]=[W("Full Request")])),_:1,__:[77]},8,["checked"]),V(B,{checked:r.value.response_raw,"onUpdate:checked":n[39]||(n[39]=w=>r.value.response_raw=w),onChange:n[40]||(n[40]=w=>g("response_raw",w.target.checked))},{default:P(()=>n[78]||(n[78]=[W("Raw Response")])),_:1,__:[78]},8,["checked"]),V(B,{checked:r.value.error,"onUpdate:checked":n[41]||(n[41]=w=>r.value.error=w),onChange:n[42]||(n[42]=w=>g("error",w.target.checked))},{default:P(()=>n[79]||(n[79]=[W("Error Details")])),_:1,__:[79]},8,["checked"]),V(B,{checked:r.value.repeatIndex,"onUpdate:checked":n[43]||(n[43]=w=>r.value.repeatIndex=w),onChange:n[44]||(n[44]=w=>g("repeatIndex",w.target.checked))},{default:P(()=>n[80]||(n[80]=[W("Repeat Index")])),_:1,__:[80]},8,["checked"])])]),v.value.length>0?(i(),c("div",Vu,[n[82]||(n[82]=s("h5",null,"Parameters (Individual Columns)",-1)),s("div",Au,[(i(!0),c(J,null,se(v.value,w=>(i(),Y(B,{key:w.id,checked:r.value[w.id],"onUpdate:checked":Z=>r.value[w.id]=Z,onChange:Z=>g(w.id,Z.target.checked)},{default:P(()=>[W(C(w.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):O("",!0),T.value.length>0?(i(),c("div",Ou,[n[83]||(n[83]=s("h5",null,"Attributes (Individual Columns)",-1)),s("div",Fu,[(i(!0),c(J,null,se(T.value,w=>(i(),Y(B,{key:w.id,checked:r.value[w.id],"onUpdate:checked":Z=>r.value[w.id]=Z,onChange:Z=>g(w.id,Z.target.checked)},{default:P(()=>[W(C(w.name),1)]),_:2},1032,["checked","onUpdate:checked","onChange"]))),128))])])):O("",!0)])]),s("div",Pu,[n[88]||(n[88]=s("h4",null,"Export Preview",-1)),s("div",Lu,[s("div",Mu,[n[85]||(n[85]=s("span",{class:"label"},"Records:",-1)),s("span",Du,C(b.value),1)]),s("div",xu,[n[86]||(n[86]=s("span",{class:"label"},"Fields:",-1)),s("span",Uu,C(d.value.length),1)]),s("div",Nu,[n[87]||(n[87]=s("span",{class:"label"},"Estimated Size:",-1)),s("span",zu,C(k.value),1)])])]),s("div",Wu,[V($,{onClick:p},{default:P(()=>n[89]||(n[89]=[W("Cancel")])),_:1,__:[89]}),V($,{type:"primary",onClick:R,loading:y.value,disabled:d.value.length===0},{default:P(()=>[V(z(fs)),n[90]||(n[90]=W(" Export "))]),_:1,__:[90]},8,["loading","disabled"])])])]),_:1},8,["visible"])}}}),Bu=ie(Hu,[["__scopeId","data-v-d6076c55"]]);class ju{constructor(){pe(this,"subscription",null);pe(this,"progressSubscription",null);pe(this,"store",We());pe(this,"v4Control",Dt());pe(this,"isActive",!1);pe(this,"currentTrialId",null)}async startStreaming(e){const t=performance.now();m.info(`V4_TRIAL_SWITCH: Stream manager starting for trial ${e}`),this.cleanupSubscriptions();const l=performance.now();m.info(`V4_TRIAL_SWITCH: Stream cleanup completed in ${(l-t).toFixed(1)}ms`),this.isActive=!0,m.info(`V4_TRIAL_SWITCH: Set isActive = true to pause reactive queries at ${(l-t).toFixed(1)}ms`),this.currentTrialId=e,this.store.setCurrentTrial(e),this.store.setStreaming(!0);const o=performance.now();m.info(`V4_TRIAL_SWITCH: Store updated in ${(o-l).toFixed(1)}ms`);const u=performance.now();m.info("V4_TRIAL_SWITCH: ALWAYS loading complete historical data first"),await this.loadHistoricalData(e);const d=performance.now();m.info(`V4_TRIAL_SWITCH: Historical data loading completed in ${(d-u).toFixed(1)}ms - store now has complete dataset`);const y=performance.now();m.info("V4_TRIAL_SWITCH: Checking for active streams to overlay updates");const r=this.v4Control.getActiveStreams(e),f=performance.now();if(m.info(`V4_TRIAL_SWITCH: Stream check completed in ${(f-y).toFixed(1)}ms, result: ${r?"FOUND":"NONE"}`),!r){m.info(`V4_TRIAL_SWITCH: No active streams for trial ${e}, using complete historical data only`);const v=await Qe.trials.get(e);if(v&&v.status==="running"){m.info(`V4_TRIAL_SWITCH: Running trial ${e}, setting up retry for potential streaming`);let T=0;const h=5,_=setInterval(()=>{T++,m.info(`V4_TRIAL_SWITCH: Retry ${T}/${h} checking for active streams`);const I=this.v4Control.getActiveStreams(e);I?(m.info(`V4_TRIAL_SWITCH: Found active streams after ${T} retries - starting live updates`),clearInterval(_),this.connectToTrialStream(e,I)):T>=h&&(m.info(`V4_TRIAL_SWITCH: No streams after ${h} retries - staying with historical data only`),clearInterval(_))},500)}else m.info(`V4_TRIAL_SWITCH: Non-running trial ${(v==null?void 0:v.status)||"NOT_FOUND"} - complete with historical data only`);return}this.connectToTrialStream(e,r)}connectToTrialStream(e,t){var o,u;m.info(`V4_STREAM_CONNECT: Connecting to streams for trial ${e} with historical foundation`),m.info(`V4_STREAM_CONNECT: Entry point - starting stream connection for trial ${e}`),this.isActive=!0;const l=t.callsSubject||t.sharedCalls$;m.info(`V4_STREAM_CONNECT: Subscribing to calls stream for updates, type: ${(o=l==null?void 0:l.constructor)==null?void 0:o.name}`),m.info(`V4_STREAM_CONNECT: Calls stream available: ${!!l}, type: ${(u=l==null?void 0:l.constructor)==null?void 0:u.name}`),this.subscription=l.subscribe({next:d=>{if(d&&d.length>0){m.info(`V4_STREAM_CONNECT: Merging ${d.length} streaming updates`);const y=[...this.store.apiCalls.value];d.forEach(r=>{const f=y.findIndex(v=>v.id===r.id);f>=0?y[f]=r:y.push(r)}),y.sort((r,f)=>{const v=_=>{switch(_){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},T=v(r.status),h=v(f.status);if(T!==h)return T-h;if(r.status==="completed"&&f.status==="completed"){const _=r.completed?new Date(r.completed).getTime():0;return(f.completed?new Date(f.completed).getTime():0)-_}if(r.status==="running"&&f.status==="running"){const _=r.started?new Date(r.started).getTime():0;return(f.started?new Date(f.started).getTime():0)-_}return r.order-f.order}),this.store.updateApiCalls(y)}},error:d=>{m.error("V4_STREAM_CONNECT: Stream error:",d),m.info("V4_STREAM_CONNECT: Calls stream ERROR:",d),this.store.setStreaming(!1),this.isActive=!1},complete:()=>{m.info(`V4_TRIAL_DEBUG_STREAMS_MGR: Stream completed for trial ${e}`),m.info(`V4_TRIAL_DEBUG_STREAMS: Calls stream COMPLETED for trial ${e}`),this.store.setStreaming(!1),this.isActive=!1,this.loadHistoricalData(e)}}),t.sharedProgress$&&(m.info("V4_STREAM_CONNECT: Subscribing to progress stream"),m.info(`V4_STREAM_CONNECT: Progress stream available: ${!!t.sharedProgress$}`),this.progressSubscription=t.sharedProgress$.subscribe({next:d=>{m.info("V4_STREAM_CONNECT: Received progress update:",d.type),m.info(`V4_STREAM_CONNECT: Progress update - ${d.type}`),m.info(`ðŸš¨ COMPLETION_DEBUG: Stream manager received progress event: ${d.type} at ${new Date().toISOString()}`),d.type==="completed"&&(m.info(`V4_TRIAL_DEBUG_STREAMS: Trial ${e} COMPLETED via progress stream`),m.info("ðŸš¨ COMPLETION_DEBUG: âœ… TRIAL COMPLETED EVENT RECEIVED BY STREAM MANAGER!"),m.info(`V4_TRIAL_COMPLETION: Loading final data from database for completed trial ${e}`),this.loadHistoricalData(e).then(()=>{m.info("V4_TRIAL_COMPLETION: Final data loaded - UI should now show accurate completion counts"),m.info("ðŸš¨ COMPLETION_DEBUG: âœ… UI SHOULD BE UPDATED NOW!")}).catch(y=>{m.error("V4_TRIAL_COMPLETION: Failed to load final data:",y)})),this.store.updateProgress(d)},error:d=>{m.error("V4_STREAM_CONNECT: Progress stream error:",d),m.info("V4_STREAM_CONNECT: Progress stream ERROR:",d)}})),m.info("V4_STREAM_CONNECT: Successfully connected to streams with historical foundation"),m.info(`V4_STREAM_CONNECT: Stream subscriptions complete for trial ${e}`)}cleanupSubscriptions(){m.info("STREAM_MGR_V4: Cleaning up existing subscriptions"),this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.progressSubscription&&(this.progressSubscription.unsubscribe(),this.progressSubscription=null),this.store.setStreaming(!1)}stopStreaming(){m.info("STREAM_MGR_V4: Stopping streaming"),m.info(`V4_TRIAL_DEBUG_STREAMS: stopStreaming() called for trial ${this.currentTrialId}`),m.info(`V4_TRIAL_DEBUG_STREAMS: Current isActive: ${this.isActive}`),this.cleanupSubscriptions(),this.isActive=!1,m.info("V4_TRIAL_DEBUG_STREAMS: Stopped streaming, isActive set to false")}async loadHistoricalData(e){const t=performance.now();m.info(`V4_TRIAL_SWITCH: loadHistoricalData() ENTRY for trial ${e}`);try{const l=performance.now();m.info(`V4_TRIAL_SWITCH: Checking database availability at ${(l-t).toFixed(1)}ms`);const o=performance.now();m.info(`V4_TRIAL_SWITCH: Preparing database query at ${(o-t).toFixed(1)}ms`);const u=performance.now();m.info(`V4_TRIAL_SWITCH: Starting IndexedDB query at ${(u-t).toFixed(1)}ms`);const d=await Qe.apiCalls.where("trialId").equals(e).toArray(),y=performance.now();m.info(`V4_TRIAL_SWITCH: IndexedDB query COMPLETED - loaded ${d.length} calls in ${(y-u).toFixed(1)}ms`),m.info(`V4_TRIAL_SWITCH: Total time to query completion: ${(y-t).toFixed(1)}ms`);const r=performance.now();d.sort((_,I)=>{const b=F=>{switch(F){case"running":return 0;case"completed":return 1;case"failed":return 2;case"pending":return 3;default:return 4}},k=b(_.status),H=b(I.status);if(k!==H)return k-H;if(_.status==="completed"&&I.status==="completed"){const F=_.completed?new Date(_.completed).getTime():0;return(I.completed?new Date(I.completed).getTime():0)-F}if(_.status==="running"&&I.status==="running"){const F=_.started?new Date(_.started).getTime():0;return(I.started?new Date(I.started).getTime():0)-F}return _.order-I.order});const f=performance.now();m.info(`V4_TRIAL_SWITCH: Sorting ${d.length} calls took ${(f-r).toFixed(1)}ms`);const v=performance.now();this.store.updateApiCalls(d),this.store.setStreaming(!1);const T=performance.now();m.info(`V4_TRIAL_SWITCH: Store update took ${(T-v).toFixed(1)}ms`),m.info(`V4_TRIAL_SWITCH: loadHistoricalData keeping isActive = ${this.isActive} to maintain reactive query pause`);const h=performance.now();m.info(`V4_TRIAL_SWITCH: loadHistoricalData TOTAL: ${(h-t).toFixed(1)}ms`)}catch(l){m.error("STREAM_MGR_V4: Failed to load historical data:",l),this.store.clear()}}destroy(){m.info("STREAM_MGR_V4: Destroying stream manager"),this.stopStreaming(),this.currentTrialId=null,this.store.clear()}}let xe=null;function Ht(){return xe||(xe=new ju,m.info("STREAM_MGR_V4: Created singleton manager instance")),xe}typeof window<"u"&&(window.__trialStreamManagerV4=()=>xe);const Gu={class:"trial-details-panel"},qu={key:0,class:"loading-state"},Ku={key:1,class:"error-state"},Qu={class:"error-actions"},Ju={key:0,class:"observer-banner"},Xu=oe({__name:"TrialDetailsPanelV3",props:{trial:{},isLeader:{type:Boolean},executionState:{},progress:{}},emits:["start-trial","pause-trial","resume-trial","cancel-trial","duplicate-trial","edit-trial","delete-trial","export-data","export-python"],setup(a){const e=a,t=st(),l=q(!1),o=q(null),u=q(!1),d=Ht(),y=M(()=>{var h,_,I;return((h=e.executionState)==null?void 0:h.status)==="executing"&&((_=e.executionState)==null?void 0:_.currentTrialId)===((I=e.trial)==null?void 0:I.id)});function r(){o.value=null}function f(){t.push("/trials")}function v(){u.value=!0}async function T(){if(e.trial){m.info(`REFRESH: Manually refreshing trial ${e.trial.id} data from database`);try{d.isActive&&d.currentTrialId===e.trial.id&&(m.info("REFRESH: Temporarily stopping active stream to reload data"),d.stopStreaming()),await d.loadHistoricalData(e.trial.id),m.info(`REFRESH: Successfully refreshed trial ${e.trial.id} data`),(e.trial.status==="running"||e.trial.status==="paused")&&(m.info("REFRESH: Restarting streaming for active trial"),await d.startStreaming(e.trial.id))}catch(h){m.error("REFRESH: Failed to refresh trial data:",h)}}}return re(()=>e.trial,(h,_)=>{h&&h.id!==(_==null?void 0:_.id)&&(o.value=null,m.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 switching from ${_==null?void 0:_.id} to ${h.id}`))}),ve(()=>{var _;const h=(_=e.trial)==null?void 0:_.id;m.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 MOUNTED for trial ${h}`)}),Re(()=>{var _;const h=(_=e.trial)==null?void 0:_.id;m.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 ACTIVATED (cache hit) for trial ${h}`)}),Ee(()=>{var _;const h=(_=e.trial)==null?void 0:_.id;m.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 DEACTIVATED (cached) for trial ${h}`)}),he(()=>{var _;const h=(_=e.trial)==null?void 0:_.id;m.info(`V4_TRIAL_SWITCH: TrialDetailsPanelV3 UNMOUNTED (evicted) for trial ${h}`)}),(h,_)=>{const I=ee("a-button");return i(),c("div",Gu,[l.value?(i(),c("div",qu,[V(z(Ke),{class:"loading-spinner",spin:""}),_[9]||(_[9]=s("span",null,"Loading trial details...",-1))])):o.value?(i(),c("div",Ku,[V(z(Ue),{class:"error-icon"}),_[12]||(_[12]=s("h3",null,"Failed to load trial",-1)),s("p",null,C(o.value),1),s("div",Qu,[V(I,{onClick:r},{default:P(()=>_[10]||(_[10]=[W("Retry")])),_:1,__:[10]}),V(I,{type:"link",onClick:f},{default:P(()=>_[11]||(_[11]=[W("Go Back")])),_:1,__:[11]})])])):h.trial?(i(),c(J,{key:2},[h.isLeader?O("",!0):(i(),c("div",Ju,[V(z(Mt),{class:"observer-icon"}),_[13]||(_[13]=s("div",{class:"observer-content"},[s("span",{class:"observer-title"},"Read-Only Mode"),s("span",{class:"observer-desc"},"All actions disabled. Close other tabs to regain control.")],-1))])),V(yn,{trial:h.trial,progress:h.progress,"is-executing":y.value},null,8,["trial","progress","is-executing"]),V(Sn,{trial:h.trial,"is-leader":h.isLeader,"execution-state":h.executionState,onStart:_[0]||(_[0]=b=>h.$emit("start-trial")),onPause:_[1]||(_[1]=b=>h.$emit("pause-trial")),onResume:_[2]||(_[2]=b=>h.$emit("resume-trial")),onCancel:_[3]||(_[3]=b=>h.$emit("cancel-trial")),onDuplicate:_[4]||(_[4]=b=>h.$emit("duplicate-trial",h.trial.id)),onEdit:_[5]||(_[5]=b=>h.$emit("edit-trial",h.trial.id)),onDelete:_[6]||(_[6]=b=>h.$emit("delete-trial",h.trial.id)),onExportData:v,onExportPython:_[7]||(_[7]=b=>h.$emit("export-python",h.trial.id)),onRefresh:T},null,8,["trial","is-leader","execution-state"]),h.trial&&u.value?(i(),Y(Bu,{key:1,visible:u.value,trial:h.trial,"onUpdate:visible":_[8]||(_[8]=b=>u.value=!1)},null,8,["visible","trial"])):O("",!0),V(mu,{trial:h.trial,progress:h.progress,"is-leader":h.isLeader,"execution-state":h.executionState},null,8,["trial","progress","is-leader","execution-state"])],64)):O("",!0)])}}}),Yu=ie(Xu,[["__scopeId","data-v-e11f0f77"]]),Zu={class:"trials-view-v3"},ed={key:0,class:"provider-warning-banner"},td={class:"banner-content"},sd={key:1,class:"observer-mode-banner"},ad={class:"banner-content"},nd={key:1,class:"loading-left-pane"},ld={key:0,class:"no-selection"},od={key:0,class:"observer-note"},id=oe({__name:"TrialsViewV3",setup(a){const e=Dt(),{trials:t}=_s(),{enabledModels:l}=ks(),{duplicateTrial:o,deleteTrial:u}=Ts(),d=Ht(),y=tt(),r=Lt(),f=st(),v=q(),T=q(!0),h=q(null),_=q(""),I=q("all"),b=q(-1),k=q(!1),H=q(!1),F=M(()=>l.value.length>0),g=M(()=>!F.value&&!H.value),E=e.isLeader,D=e.execution,{trial:A}=$s(h),p=M(()=>{var x;const L=(x=A.value)==null?void 0:x.progress;return L?{trialId:h.value||"",...L,lastUpdated:new Date}:null}),R=M(()=>{let L=t.value;if(_.value){const x=_.value.toLowerCase();L=L.filter(X=>{var _e,Fe;const ne=X.name.toLowerCase().includes(x),be=(Fe=(_e=X.templateConfig)==null?void 0:_e.template)==null?void 0:Fe.toLowerCase().includes(x),de=X.configurations.some(we=>we.modelId.toLowerCase().includes(x)||we.provider.toLowerCase().includes(x));return ne||be||de})}return I.value!=="all"&&(L=L.filter(x=>x.status===I.value)),L});async function U(){var x;const L=r.query;if(L.duplicate){const X=L.duplicate,ne=await o(X);ne.ok?await f.push({path:"/trials/create",query:{duplicate:ne.value,edit:L.edit==="true"?"true":void 0}}):le.error(`Failed to duplicate trial: ${((x=ne.error)==null?void 0:x.message)||"Unknown error"}`),await f.replace({query:{}});return}if(L.designId||L.promptSource){await f.push({path:"/trials/create",query:L});return}if(r.query.trialId){const X=r.query.trialId;S(X)}}function n(){if(h.value)return;if(t.value.length===0){m.info("V4_TRIALS: No trials available for auto-selection");return}const L=t.value.find(x=>x.status==="running");if(L){S(L.id);return}S(t.value[0].id)}async function S(L){const x=performance.now();m.info(`V4_TRIAL_SWITCH: Starting trial selection: ${L}`),h.value=L;const X=performance.now();if(m.info(`V4_TRIAL_SWITCH: UI updated in ${(X-x).toFixed(1)}ms`),t.value.length>0){const de=R.value.findIndex(_e=>_e.id===L);de>=0&&(b.value=de)}const ne=performance.now();if(m.info(`V4_TRIAL_SWITCH: Starting stream manager for trial ${L} at ${(ne-x).toFixed(1)}ms`),d.startStreaming(L).catch(de=>{m.error(`V4_TRIAL_SWITCH: Failed to start streaming for trial ${L}`,de)}),r.query.trialId!==L){const de={...r.query};de.trialId=L,de.tab||(de.tab="status"),f.push({path:"/trials",query:de}),m.info(`V4_TRIAL_SWITCH: URL updated to preserve tab '${de.tab}' at ${(performance.now()-x).toFixed(1)}ms`)}v.value&&v.value.closeMobileOverlay();const be=performance.now();m.info(`V4_TRIAL_SWITCH: selectTrial() completed in ${(be-x).toFixed(1)}ms`)}function N(L){_.value=L,b.value=-1}function $(L){I.value=L,b.value=-1}async function B(){le.info("Refreshing trial list...")}function ae(L){const x=R.value;if(x.length!==0){if((L.metaKey||L.ctrlKey)&&L.key==="k"){L.preventDefault(),window.dispatchEvent(new CustomEvent("focus-trial-search"));return}(L.key==="j"||L.key==="ArrowDown")&&(L.preventDefault(),b.value=Math.min(b.value+1,x.length-1),b.value>=0&&(S(x[b.value].id),w(x[b.value].id))),(L.key==="k"||L.key==="ArrowUp")&&(L.preventDefault(),b.value=Math.max(b.value-1,0),S(x[b.value].id),w(x[b.value].id)),L.key==="Enter"&&h.value,L.key==="Escape"&&(_.value="",h.value=null,b.value=-1)}}function w(L){Te(()=>{const x=document.querySelector(`[data-trial-id="${L}"]`);x&&x.scrollIntoView({behavior:"smooth",block:"nearest"})})}function Z(L){m.debug("Trial list panel resized",{width:L})}function ce(L){m.debug("Mobile overlay changed",{visible:L})}function me(){H.value=!0}async function Se(){await f.push("/trials/create")}async function Ae(){var L,x,X,ne;if(h.value){if(k.value){m.info("Start trial already in progress, ignoring duplicate request");return}k.value=!0,m.info("V4_EXECUTION:",(L=e.execution)==null?void 0:L.value),m.info("V4_STATUS:",(X=(x=e.execution)==null?void 0:x.value)==null?void 0:X.status);try{m.info("V4: Starting trial with streaming",h.value);const be=await e.startTrialWithStreaming(h.value);if(!be.ok){le.error(((ne=be.error)==null?void 0:ne.message)||"Unknown error");return}m.info("V4_STREAMING: Restarting stream manager after trial start"),await d.startStreaming(h.value),m.info("V4: Trial started with streaming, stream manager connected");const de={...r.query};de.tab="tasks",f.replace({query:de})}finally{k.value=!1}}}async function j(){var x;m.info(`V4_TRIAL_DEBUG_PAUSE: UI pauseTrial() called for trial: ${h.value}`),m.info(`V4_TRIAL_DEBUG_PAUSE: Current execution state: ${e.execution.value.status}`),m.info(`V4_TRIAL_DEBUG_PAUSE: Is leader: ${e.isLeader.value}`);const L=await e.pauseExecution();m.info("V4_TRIAL_DEBUG_PAUSE: UI pauseTrial result:",L),L.ok?m.info(`V4_TRIAL_DEBUG_PAUSE: Pause successful, execution state: ${e.execution.value.status}`):(m.info("V4_TRIAL_DEBUG_PAUSE: Pause failed from UI:",L.error.message),le.error(((x=L.error)==null?void 0:x.message)||"Unknown error"))}async function K(){var x,X;if(!h.value)return;m.info(`V4_TRIAL_DEBUG_RESUME: UI resumeTrial() called for trial: ${h.value}`),m.info(`V4_TRIAL_DEBUG_RESUME: Current execution state: ${e.execution.value.status}`),m.info(`V4_TRIAL_DEBUG_RESUME: Is leader: ${e.isLeader.value}`);const L=((x=e.execution.value)==null?void 0:x.status)||"idle";if(m.info(`V4_TRIAL_DEBUG_RESUME: Current execution status: ${L}`),L==="paused"){m.info("V4_TRIAL_DEBUG_RESUME: Execution is paused, using resumeExecution()");const ne=await e.resumeExecution(h.value);m.info("V4_TRIAL_DEBUG_RESUME: resumeExecution result:",ne),ne.ok?(m.info("V4_TRIAL_DEBUG_RESUME: Resume successful - existing pipeline will continue automatically via pause$ = false"),m.info("V4_TRIAL_DEBUG_RESUME: Resume complete - existing V3 pipeline should continue processing pending calls")):(m.info("V4_TRIAL_DEBUG_RESUME: Resume failed:",ne.error.message),le.error(ne.error.message))}else{m.info("V4_TRIAL_DEBUG_RESUME: No paused execution found, using startTrialWithStreaming (fresh start)");const ne=await e.startTrialWithStreaming(h.value);m.info("V4_TRIAL_DEBUG_RESUME: startTrialWithStreaming result for fresh start:",ne),ne.ok?(m.info("V4_TRIAL_DEBUG_RESUME: Fresh start successful, starting stream manager"),await d.startStreaming(h.value),m.info("V4_TRIAL_DEBUG_RESUME: Stream manager started for fresh execution")):(m.info("V4_TRIAL_DEBUG_RESUME: Fresh start failed:",ne.error.message),le.error(((X=ne.error)==null?void 0:X.message)||"Unknown error"))}}async function G(){var x;const L=await e.cancelExecution();L.ok||le.error(((x=L.error)==null?void 0:x.message)||"Unknown error")}async function Q(L){var X;const x=await o(L);x.ok?(le.success("Trial duplicated"),x.value&&S(x.value)):le.error(((X=x.error)==null?void 0:X.message)||"Unknown error")}async function ue(L){await f.push({path:"/trials/create",query:{duplicate:L,edit:"true"}})}async function fe(L){var X;const x=await u(L);x.ok?(le.success("Trial deleted"),h.value===L&&(h.value=null)):le.error(((X=x.error)==null?void 0:X.message)||"Unknown error")}async function Oe(L,x){var ne;const X=await y.dataExport.exportTrialData(L,{format:x,fields:void 0,includeHeaders:!0,addBOM:x==="excel"});X.ok?le.success(`Exported ${X.value.recordCount} API calls to ${X.value.filename}`):le.error(((ne=X.error)==null?void 0:ne.message)||"Unknown error")}async function He(L){var X;const x=await y.pythonGeneration.generatePythonScript(L,{template:"basic",includeAnalysis:!0,includeComments:!0});x.ok?le.success("Python script exported"):le.error(((X=x.error)==null?void 0:X.message)||"Unknown error")}return re(()=>r.query.trialId,L=>{L&&L!==h.value&&S(L)}),re(T,(L,x)=>{const X=performance.now();m.info(`V4_TRIAL_SWITCH: isLoadingInitial changed from ${x} to ${L} at ${X}`),L||m.info("V4_TRIAL_SWITCH: Both panes should now be VISIBLE (no longer loading initial)")},{immediate:!0}),re(t,(L,x)=>{const X=performance.now();m.info(`V4_TRIAL_SWITCH: trials array changed from ${(x==null?void 0:x.length)||0} to ${L.length} trials at ${X}`)},{immediate:!0}),ve(async()=>{const L=performance.now();m.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() ENTRY at ${L}`);const x=performance.now();m.info(`V4_TRIAL_SWITCH: Starting V4 execution system initialization at ${(x-L).toFixed(1)}ms`);try{await e.initialize();const Be=performance.now();m.info(`V4_TRIAL_SWITCH: V4 execution system initialized in ${(Be-x).toFixed(1)}ms`)}catch(Be){const Gt=performance.now();m.error(`V4_TRIAL_SWITCH: V4 initialization failed in ${(Gt-x).toFixed(1)}ms:`,Be)}const X=performance.now();window.addEventListener("keydown",ae),m.info(`V4_TRIAL_SWITCH: Keyboard listener added in ${(X-L).toFixed(1)}ms`);const ne=performance.now();m.info(`V4_TRIAL_SWITCH: Starting nextTick wait at ${(ne-L).toFixed(1)}ms`),await Te();const be=performance.now();m.info(`V4_TRIAL_SWITCH: nextTick completed in ${(be-ne).toFixed(1)}ms`);const de=performance.now();T.value=!1,m.info(`V4_TRIAL_SWITCH: isLoadingInitial set to false at ${(de-L).toFixed(1)}ms`);const _e=performance.now();m.info(`V4_TRIAL_SWITCH: Starting URL parameter processing at ${(_e-L).toFixed(1)}ms`),await U();const Fe=performance.now();m.info(`V4_TRIAL_SWITCH: URL parameter processing completed in ${(Fe-_e).toFixed(1)}ms`);const we=performance.now();m.info(`V4_TRIAL_SWITCH: Starting auto-selection at ${(we-L).toFixed(1)}ms`),n();const Bt=performance.now();m.info(`V4_TRIAL_SWITCH: Auto-selection completed in ${(Bt-we).toFixed(1)}ms`);const jt=performance.now();m.info(`V4_TRIAL_SWITCH: TrialsViewV3 onMounted() TOTAL: ${(jt-L).toFixed(1)}ms`)}),he(()=>{m.info("V4_SINGLETON_DEBUG: TrialsViewV3 onUnmounted() - NOT calling v4ExecutionControl.cleanup() to preserve singleton"),window.removeEventListener("keydown",ae),d.destroy(),m.info("V4_SINGLETON_DEBUG: V4 execution system preserved, initialized flag should remain true")}),(L,x)=>{const X=ee("router-link"),ne=ee("a-button");return i(),c("div",Zu,[g.value?(i(),c("div",ed,[s("div",td,[V(z(Ue),{class:"warning-icon"}),x[1]||(x[1]=s("span",null,"No LLM providers configured. Please add API keys in Settings to run trials.",-1)),V(X,{to:"/settings",class:"settings-link"},{default:P(()=>x[0]||(x[0]=[W("Go to Settings")])),_:1,__:[0]}),V(z(Vt),{class:"close-icon",onClick:me})]),x[2]||(x[2]=s("div",{class:"banner-note"},"Note: Ollama doesn't require API keys",-1))])):O("",!0),z(E)?O("",!0):(i(),c("div",sd,[s("div",ad,[V(z(Mt),{class:"observer-icon"}),x[3]||(x[3]=s("span",null,[s("strong",null,"Observer Mode"),W(" - This tab is read-only. Close other tabs to enable actions.")],-1)),x[4]||(x[4]=s("div",{class:"leader-hint"},"Only one tab can control Auditomatic at a time",-1))])])),V(zs,{ref_key:"splitPanel",ref:v,"storage-key":"trial-list-width","default-width":250,"min-width":200,"max-width":600,onResize:Z,onMobileOverlayChange:ce},{left:P(()=>[T.value?(i(),c("div",nd," Loading trials... ")):(i(),Y(en,{key:0,trials:z(t),"selected-trial-id":h.value,"search-query":_.value,"filter-status":I.value,onSelectTrial:S,onCreateTrial:Se,onUpdateSearch:N,onUpdateFilter:$,onRefresh:B},null,8,["trials","selected-trial-id","search-query","filter-status"]))]),right:P(()=>[(i(),Y(Je,{max:5},[h.value?(i(),Y(Yu,{key:h.value,trial:z(A),"is-leader":z(E),"execution-state":z(D),progress:p.value,onStartTrial:Ae,onPauseTrial:j,onResumeTrial:K,onCancelTrial:G,onDuplicateTrial:Q,onEditTrial:ue,onDeleteTrial:fe,onExportData:Oe,onExportPython:He},null,8,["trial","is-leader","execution-state","progress"])):O("",!0)],1024)),!h.value||!z(A)?ke((i(),c("div",ld,[V(z(ms),{class:"empty-icon"}),x[6]||(x[6]=s("h3",null,"Select a trial to view details",-1)),x[7]||(x[7]=s("p",null,"Choose from the list or create a new one",-1)),V(ne,{type:"primary",size:"large",disabled:!z(E),onClick:Se},{default:P(()=>x[5]||(x[5]=[W(" Create New Trial ")])),_:1,__:[5]},8,["disabled"]),z(E)?O("",!0):(i(),c("div",od," Close other tabs to enable trial creation "))],512)),[[Ft,!T.value]]):O("",!0)]),_:1},512)])}}}),hd=ie(id,[["__scopeId","data-v-b950f701"]]);export{hd as default};
