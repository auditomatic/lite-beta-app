import{d as e,c as a,aa as t,a3 as l,F as o,$ as s,a0 as n,G as i,a2 as u,Z as d,f as r,r as c,w as p,X as m,Y as v,_ as f,k,ab as g,B as y,u as h}from"./vendor-BKA9Ybw0.js";import{d as b,l as C,m as x,_ as T,c as _,p as $,a3 as w,x as F}from"./index-BTLG4nFQ.js";import{a as O}from"./cost-formatting-Bv_drrqY.js";const U={key:0,class:"cost-group"},P={class:"cost-item"},z={class:"cost-value"},I={class:"cost-value"},S={key:1,class:"cost-group"},M={class:"enviro-group"},L={class:"enviro-item"},E={class:"enviro-item"},j={class:"enviro-item"},N={key:0,class:"cost-group"},W={class:"cost-item"},A={class:"cost-value"},B={class:"cost-value"},D={class:"enviro-group"},K={class:"enviro-item"},G={class:"enviro-item"},R={class:"enviro-item"},q={key:0,class:"cost-item financial"},X={key:0,class:"cost-value"},Y={key:1,class:"cost-value"},Z={class:"cost-item environmental"},H={class:"enviro-item"},J={class:"enviro-value"},Q={class:"enviro-item"},V={class:"enviro-value"},ee={class:"enviro-item"},ae={class:"enviro-value"},te={key:0,class:"cost-unit"},le=T(e({__name:"ModelCostDisplay",props:{model:{},mode:{default:"per-thousand"},inputTokens:{default:1e3},outputTokens:{default:1e3},minOutputTokens:{default:10},maxOutputTokens:{},layout:{default:"inline"},size:{default:"medium"}},setup(e){const r=e,c=b(),p=a(()=>{const e=c.financialCostsEnabled;return C.debug("ModelCostDisplay showFinancial check",{financialCostsEnabled:e,settingsStoreReady:!c.isLoading,mode:r.mode,model:r.model?.displayName}),e});function m(){if(!r.model.capabilities)return"â€”";const e=r.model.capabilities.inputCostPerToken||0,a=r.model.capabilities.outputCostPerToken||0;if("per-thousand"===r.mode){return O(1e3*(e+a))}if("total"===r.mode){const t=e*r.inputTokens+a*r.outputTokens;return O(t)}return"â€”"}function v(e){if(0===e)return"0";if(e>=.01)return e.toFixed(2).replace(/\.?0+$/,"");const a=e.toFixed(10).match(/^0\.0*[1-9]/);if(a){const t=a[0].length-2;return e.toFixed(t)}return e.toFixed(4)}function f(){if(!r.model.capabilities)return"0";return v(1e3*(r.model.capabilities.inputCostPerToken||0))}function k(){if(!r.model.capabilities)return"0";return v(1e3*(r.model.capabilities.outputCostPerToken||0))}function g(){if(!r.model.capabilities)return"?";const e=r.model.capabilities.inputCostPerToken||0,a=r.model.capabilities.outputCostPerToken||0,t=e*r.inputTokens+a*r.minOutputTokens;return C.debug("formatRangeMin",{inputTokens:r.inputTokens,minOutputTokens:r.minOutputTokens,inputCost:e,outputCost:a,minCost:t}),v(t)}function y(){if(!r.model.capabilities||!r.maxOutputTokens)return"?";const e=r.model.capabilities.inputCostPerToken||0,a=r.model.capabilities.outputCostPerToken||0,t=e*r.inputTokens+a*r.maxOutputTokens;return C.debug("formatRangeMax",{inputTokens:r.inputTokens,maxOutputTokens:r.maxOutputTokens,inputCost:e,outputCost:a,maxCost:t}),v(t)}function h(e){if(!c.environmentalCostsEnabled)return"??";if(!x.hasDataForModel(r.model.provider,r.model.modelId))return"-";const a="total"===r.mode?r.inputTokens+r.outputTokens:1e3,t=x.calculateEnvironmentalCostUnsafe(r.model.provider,r.model.modelId,a)[e];if(0===t)return"-";switch(e){case"carbon":return t<.001?"<1Î¼g":t<1?`${(1e3*t).toFixed(0)}Î¼g`:t<1e3?`${t.toFixed(1)}mg`:`${(t/1e3).toFixed(1)}g`;case"water":return t<.001?"<1nL":t<1?`${(1e3*t).toFixed(0)}nL`:t<1e3?`${t.toFixed(1)}Î¼L`:`${(t/1e3).toFixed(1)}mL`;case"energy":return t<.001?"<1Î¼Wh":t<1?`${(1e3*t).toFixed(0)}Î¼Wh`:t<1e3?`${t.toFixed(1)}mWh`:`${(t/1e3).toFixed(1)}Wh`;default:return"-"}}function T(e){if(!c.environmentalCostsEnabled)return"??";if(!x.hasDataForModel(r.model.provider,r.model.modelId))return"-";if(!r.maxOutputTokens)return"?";const a=r.inputTokens+r.minOutputTokens,t=r.inputTokens+r.maxOutputTokens,l=x.calculateEnvironmentalCostUnsafe(r.model.provider,r.model.modelId,a),o=x.calculateEnvironmentalCostUnsafe(r.model.provider,r.model.modelId,t),s=l[e],n=o[e];if(0===s&&0===n)return"-";const i=a=>{switch(e){case"carbon":return a<.001?"<1Î¼g":a<1?`${(1e3*a).toFixed(0)}Î¼g`:a<1e3?`${a.toFixed(0)}mg`:`${(a/1e3).toFixed(1)}g`;case"water":return a<.001?"<1nL":a<1?`${(1e3*a).toFixed(0)}nL`:a<1e3?`${a.toFixed(0)}Î¼L`:`${(a/1e3).toFixed(1)}mL`;case"energy":return a<.001?"<1Î¼Wh":a<1?`${(1e3*a).toFixed(0)}Î¼Wh`:a<1e3?`${a.toFixed(0)}mWh`:`${(a/1e3).toFixed(1)}Wh`;default:return"-"}};return`${i(s)}-${i(n)}`}return C.debug("ModelCostDisplay props received",{model:r.model?.displayName,mode:r.mode,inputTokens:r.inputTokens,outputTokens:r.outputTokens,minOutputTokens:r.minOutputTokens,maxOutputTokens:r.maxOutputTokens,modelCapabilities:!!r.model?.capabilities,inputCostPerToken:r.model?.capabilities?.inputCostPerToken,outputCostPerToken:r.model?.capabilities?.outputCostPerToken}),(e,a)=>(d(),t("div",{class:l(["model-cost-display",[`layout-${e.layout}`,`size-${e.size}`]])},["range"===e.mode?(d(),t(o,{key:0},[p.value&&e.maxOutputTokens?(d(),t("span",U,[n("span",P,[n("span",z,"$"+u(g()),1),a[0]||(a[0]=i(" - ")),n("span",I,"$"+u(y()),1)])])):p.value?(d(),t("span",S,a[1]||(a[1]=[n("span",{class:"cost-item"},[n("span",{class:"cost-value"},"Cost: ??")],-1)]))):s("",!0),a[4]||(a[4]=n("span",{class:"cost-tab"},null,-1)),n("span",M,[n("span",L,"COâ‚‚ "+u(T("carbon")),1),a[2]||(a[2]=n("span",{class:"cost-tab"},null,-1)),n("span",E,"ðŸ’§"+u(T("water")),1),a[3]||(a[3]=n("span",{class:"cost-tab"},null,-1)),n("span",j,"âš¡"+u(T("energy")),1)])],64)):"input-output"===e.mode?(d(),t(o,{key:1},[p.value?(d(),t("span",N,[n("span",W,[n("span",A,"$"+u(f()),1),a[5]||(a[5]=i("/1K input + ")),n("span",B,"$"+u(k()),1),a[6]||(a[6]=i("/1K output "))])])):s("",!0),a[9]||(a[9]=n("span",{class:"cost-tab"},null,-1)),n("span",D,[n("span",K,"COâ‚‚ "+u(h("carbon")),1),a[7]||(a[7]=n("span",{class:"cost-tab"},null,-1)),n("span",G,"ðŸ’§"+u(h("water")),1),a[8]||(a[8]=n("span",{class:"cost-tab"},null,-1)),n("span",R,"âš¡"+u(h("energy")),1)])],64)):(d(),t(o,{key:2},[p.value?(d(),t("div",q,["per-thousand"===e.mode?(d(),t("span",X,[i(u(m())+" ",1),a[10]||(a[10]=n("span",{class:"cost-unit"},"/ 1,000 tokens",-1))])):"total"===e.mode?(d(),t("span",Y,u(m()),1)):s("",!0)])):s("",!0),n("div",Z,[n("span",H,[a[11]||(a[11]=n("span",{class:"enviro-icon"},"COâ‚‚",-1)),n("span",J,u(h("carbon")),1)]),n("span",Q,[a[12]||(a[12]=n("span",{class:"enviro-icon"},"ðŸ’§",-1)),n("span",V,u(h("water")),1)]),n("span",ee,[a[13]||(a[13]=n("span",{class:"enviro-icon"},"âš¡",-1)),n("span",ae,u(h("energy")),1)]),"per-thousand"===e.mode?(d(),t("span",te,"/ 1,000")):s("",!0)])],64))],2))}}),[["__scopeId","data-v-0e44d7ba"]]),oe={class:"modal-content-wrapper"},se={class:"modal-content"},ne={class:"models-panel"},ie={class:"panel-header"},ue={class:"search-container"},de={class:"models-list"},re={class:"provider-header"},ce={class:"provider-name"},pe={class:"provider-model-count"},me={class:"provider-models"},ve=["onClick"],fe={class:"model-name"},ke={class:"model-specs"},ge={key:0,class:"config-panel"},ye={class:"config-header"},he={class:"config-header-title"},be={class:"total-cost"},Ce={key:0,class:"cost-info"},xe={key:0,class:"config-content"},Te={class:"param-description"},_e={class:"param-description"},$e={class:"config-footer"},we=T(e({__name:"GenericModelSelectorModal",props:{open:{type:Boolean},mode:{},design:{},title:{},existingConfigurations:{}},emits:["close","add-configuration","select-model"],setup(e,{emit:b}){const C=e,x=b,T=_(),O=r(""),U=r([]),P=r(null),z=r(""),I=c({}),S=r(null),M=a(()=>{let e=T.enabledModels;if(O.value){const a=O.value.toLowerCase();e=e.filter(e=>e.displayName.toLowerCase().includes(a)||e.modelId.toLowerCase().includes(a))}const a={};for(const t of e)a[t.provider]||(a[t.provider]=[]),a[t.provider].push(t);for(const t in a)a[t].sort((e,a)=>e.displayName.localeCompare(a.displayName));return a}),L=a(()=>{if("trial"!==C.mode||!C.design)return 1;let e=1;for(const a of Object.values(C.design.variableBindings))"direct"===a.type&&(e*=a.values?.length||1);return e}),E=a(()=>P.value?$.getBasicParameters(P.value.provider,P.value.modelId):{}),j=a(()=>P.value?$.getAdvancedParameters(P.value.provider,P.value.modelId):{});function N(e){return e.replace(/\./g," â€º ").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function W(){if(!P.value||!z.value)return;const e={},a=(e,a,t)=>{const l=a.split(".");let o=e;for(let s=0;s<l.length-1;s++)o[l[s]]||(o[l[s]]={}),o=o[l[s]];o[l[l.length-1]]=t};for(const[t,l]of Object.entries(I))(null!=l&&""!==l||!1===l)&&a(e,t,l);x("add-configuration",{name:z.value,provider:P.value.provider,modelId:P.value.modelId,parameters:e})}function A(){P.value&&(x("select-model",P.value),x("close"))}function B(){P.value=null,z.value="",Object.keys(I).forEach(e=>delete I[e])}function D(e){return"trial"===C.mode&&C.design?C.design.tokenEstimate?.avgTokens||150:1e3}function K(e){if("trial"===C.mode){return F.getOutputTokenLimit(e.provider,e.modelId,I)||256}return 1e3}return p([P,I],async()=>{if(P.value&&"trial"===C.mode&&C.design)try{S.value=await F.calculateCostEstimate(C.design,P.value,I)}catch(e){console.error("Failed to calculate cost estimate:",e),S.value=null}else S.value=null}),(e,a)=>{const r=v("a-input-search"),c=v("a-button"),p=v("a-collapse-panel"),b=v("a-collapse"),T=v("a-input"),_=v("a-form-item"),F=v("a-input-number"),G=v("a-switch"),R=v("a-select-option"),q=v("a-select"),X=v("a-col"),Y=v("a-row"),Z=v("a-form"),H=v("a-modal");return d(),m(H,{open:e.open,onCancel:a[3]||(a[3]=a=>e.$emit("close")),title:e.title||"Select Model",width:"97.5%",footer:null,bodyStyle:{padding:0,height:"80vh",display:"flex",flexDirection:"column"},maskClosable:!1,centered:!0,class:"full-width-modal"},{default:f(()=>[n("div",oe,[n("div",se,[n("div",ne,[n("div",ie,[a[5]||(a[5]=n("h3",null,"Available Models",-1)),n("div",ue,[a[4]||(a[4]=n("span",{class:"search-label"},"Search:",-1)),k(r,{value:O.value,"onUpdate:value":a[0]||(a[0]=e=>O.value=e),placeholder:"Search models...",size:"large","allow-clear":"",class:"search-input"},null,8,["value"])])]),n("div",de,[k(b,{activeKey:U.value,"onUpdate:activeKey":a[1]||(a[1]=e=>U.value=e),bordered:!1},{default:f(()=>[(d(!0),t(o,null,g(M.value,(a,s)=>(d(),m(p,{key:s,class:"provider-panel"},{header:f(()=>[n("div",re,[n("span",ce,u(s),1),n("span",pe,u(a.length)+" models",1)])]),extra:f(()=>[k(c,{size:"small",type:"text",onClick:y(e=>function(e){const a=U.value.indexOf(e);a>-1?U.value.splice(a,1):U.value.push(e)}(s),["stop"])},{default:f(()=>[i(u(U.value.includes(s)?"Collapse":"Expand"),1)]),_:2},1032,["onClick"])]),default:f(()=>[n("div",me,[(d(!0),t(o,null,g(a,a=>(d(),t("div",{key:a.id,class:l(["model-row",{selected:P.value?.id===a.id}]),onClick:e=>function(e){if(P.value=e,"playground"===C.mode)return x("select-model",e),void x("close");if("trial"===C.mode){z.value=e.displayName,Object.keys(I).forEach(e=>delete I[e]);const a={...$.getBasicParameters(e.provider,e.modelId),...$.getAdvancedParameters(e.provider,e.modelId)};for(const[e,t]of Object.entries(a))void 0!==t.default&&(I[e]=t.default)}}(a)},[n("div",fe,u(a.displayName),1),n("div",ke,[k(le,{model:a,mode:"trial"===e.mode?"range":"input-output","input-tokens":D(),"min-output-tokens":10,"max-output-tokens":K(a),layout:"inline",size:"medium"},null,8,["model","mode","input-tokens","max-output-tokens"])])],10,ve))),128))])]),_:2},1024))),128))]),_:1},8,["activeKey"])])]),P.value&&"trial"===e.mode?(d(),t("div",ge,[n("div",ye,[n("div",he,[n("h3",null,u("trial"===e.mode?"Configure":"Selected")+": "+u(P.value.displayName),1),k(c,{type:"text",onClick:B,class:"config-close-btn","aria-label":"Close configuration panel"},{default:f(()=>[k(h(w))]),_:1})]),n("div",be,[k(le,{model:P.value,mode:"trial"===e.mode?"total":"input-output","input-tokens":S.value?.inputTokens.avgTokens||D(P.value),"output-tokens":S.value?.outputTokens||K(P.value),layout:"inline",size:"large"},null,8,["model","mode","input-tokens","output-tokens"]),"trial"===e.mode&&L.value>1?(d(),t("span",Ce,"("+u(L.value)+" calls)",1)):s("",!0)])]),"trial"===e.mode?(d(),t("div",xe,[k(Z,{layout:"vertical"},{default:f(()=>[k(_,{label:"Configuration Name",required:""},{default:f(()=>[k(T,{value:z.value,"onUpdate:value":a[2]||(a[2]=e=>z.value=e),placeholder:"e.g., GPT-4 Creative, Claude-3 Analytical",size:"large"},null,8,["value"])]),_:1}),k(b,{"default-active-key":["basic"],ghost:""},{default:f(()=>[k(p,{key:"basic",header:"Basic Parameters"},{default:f(()=>[k(Y,{gutter:16},{default:f(()=>[(d(!0),t(o,null,g(E.value,(e,l)=>(d(),m(X,{key:l,span:12},{default:f(()=>[k(_,{label:N(l)},{default:f(()=>["number"===e.type?(d(),m(F,{key:0,value:I[l],"onUpdate:value":e=>I[l]=e,min:e.min,max:e.max,step:.1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"integer"===e.type?(d(),m(F,{key:1,value:I[l],"onUpdate:value":e=>I[l]=e,min:e.min,max:e.max,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","placeholder"])):"boolean"===e.type?(d(),m(G,{key:2,checked:I[l],"onUpdate:checked":e=>I[l]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(d(),m(q,{key:3,value:I[l],"onUpdate:value":e=>I[l]=e,placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:f(()=>[k(R,{value:void 0},{default:f(()=>a[6]||(a[6]=[n("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[6]}),(d(!0),t(o,null,g(e.enum,e=>(d(),m(R,{key:e,value:e},{default:f(()=>[i(u(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(d(),m(T,{key:4,value:I[l],"onUpdate:value":e=>I[l]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),n("div",Te,u(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1}),Object.keys(j.value).length>0?(d(),m(p,{key:"advanced",header:"Advanced Parameters"},{default:f(()=>[k(Y,{gutter:16},{default:f(()=>[(d(!0),t(o,null,g(j.value,(e,l)=>(d(),m(X,{key:l,span:12},{default:f(()=>[k(_,{label:N(l)},{default:f(()=>["number"===e.type||"integer"===e.type?(d(),m(F,{key:0,value:I[l],"onUpdate:value":e=>I[l]=e,min:e.min,max:e.max,step:"number"===e.type?.1:1,placeholder:String(e.default),style:{width:"100%"},size:"large"},null,8,["value","onUpdate:value","min","max","step","placeholder"])):"boolean"===e.type?(d(),m(G,{key:1,checked:I[l],"onUpdate:checked":e=>I[l]=e,"checked-children":"true","un-checked-children":"false"},null,8,["checked","onUpdate:checked"])):"string"===e.type&&e.enum?(d(),m(q,{key:2,value:I[l],"onUpdate:value":e=>I[l]=e,placeholder:e.default?String(e.default):"<not set>",size:"large",style:{width:"100%"},allowClear:""},{default:f(()=>[k(R,{value:void 0},{default:f(()=>a[7]||(a[7]=[n("span",{style:{color:"#999"}},"<not set>",-1)])),_:1,__:[7]}),(d(!0),t(o,null,g(e.enum,e=>(d(),m(R,{key:e,value:e},{default:f(()=>[i(u(e),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):(d(),m(T,{key:3,value:I[l],"onUpdate:value":e=>I[l]=e,placeholder:String(e.default),size:"large"},null,8,["value","onUpdate:value","placeholder"])),n("div",_e,u(e.description),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1})):s("",!0)]),_:1})]),_:1})])):s("",!0),n("div",$e,["trial"===e.mode?(d(),m(c,{key:0,type:"primary",size:"large",onClick:W,disabled:!z.value||!P.value},{default:f(()=>a[8]||(a[8]=[i(" Add Configuration ")])),_:1,__:[8]},8,["disabled"])):(d(),m(c,{key:1,type:"primary",size:"large",onClick:A,disabled:!P.value},{default:f(()=>a[9]||(a[9]=[i(" Select Model ")])),_:1,__:[9]},8,["disabled"]))])])):s("",!0)])])]),_:1},8,["open","title"])}}}),[["__scopeId","data-v-1d22c094"]]);export{we as G,le as M};
